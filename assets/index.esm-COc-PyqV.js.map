{"version":3,"file":"index.esm-COc-PyqV.js","sources":["../../../libs/core/storage/index.esm.js"],"sourcesContent":["// libs/core/src/lib/storage/storage.ts\nvar Storage = class {\n  constructor(config) {\n    this.config = config;\n    this.storage = getStorage();\n  }\n  get prefix() {\n    return this.config.storagePrefix ?? \"\";\n  }\n  get separator() {\n    return this.config.storageSeparator ?? \":\";\n  }\n  set(key, data) {\n    if (!this.storage) return;\n    try {\n      const _key = this.key(key);\n      const strData = typeof data !== \"string\" ? JSON.stringify(data) : data;\n      this.storage.setItem(_key, strData);\n    } catch (error) {\n      console.warn(error);\n    }\n  }\n  get(key, parser) {\n    if (!this.storage) return null;\n    try {\n      const _key = this.key(key);\n      const strData = this.storage.getItem(_key);\n      if (strData === null) return null;\n      return parser(strData);\n    } catch (error) {\n      console.warn(error);\n      return null;\n    }\n  }\n  remove(key) {\n    if (!this.storage) return;\n    try {\n      const _key = this.key(key);\n      this.storage.removeItem(_key);\n    } catch (error) {\n      console.warn(error);\n    }\n  }\n  update(key, updates) {\n    const value = this.get(key, JsonParser);\n    const newValue = updates(value);\n    this.set(key, newValue);\n    return newValue;\n  }\n  updateEntity(key, entityKey, value) {\n    const entity = this.get(key, JsonParser) ?? {};\n    const newEntity = { ...entity, [entityKey]: value };\n    this.set(key, newEntity);\n  }\n  key(rawKey) {\n    return [this.prefix, rawKey].join(this.separator);\n  }\n};\nfunction getStorage() {\n  if (isSupportedStorage(window.localStorage)) {\n    return window.localStorage;\n  }\n  if (isSupportedStorage(window.sessionStorage)) {\n    return window.sessionStorage;\n  }\n  return null;\n}\nfunction isSupportedStorage(storage2) {\n  if (window?.localStorage) {\n    try {\n      storage2.setItem(\"@__test__@\", \"1\");\n      const item1 = window.localStorage.getItem(\"@__test__@\");\n      storage2.removeItem(\"@__test__@\");\n      const item2 = storage2.getItem(\"@__test__@\");\n      return item1 === \"1\" && item2 === null;\n    } catch {\n      return false;\n    }\n  }\n  return false;\n}\nfunction JsonParser(value) {\n  return JSON.parse(value);\n}\nvar storage = new Storage({\n  storagePrefix: \"one-inch\",\n  storageSeparator: \":\"\n});\nexport {\n  JsonParser,\n  Storage,\n  storage\n};\n//# sourceMappingURL=index.esm.js.map\n"],"names":["Storage","config","getStorage","key","data","_key","strData","error","parser","updates","value","JsonParser","newValue","entityKey","newEntity","rawKey","isSupportedStorage","storage2","item1","item2","storage"],"mappings":"AACG,IAACA,EAAU,KAAM,CAClB,YAAYC,EAAQ,CAClB,KAAK,OAASA,EACd,KAAK,QAAUC,GAChB,CACD,IAAI,QAAS,CACX,OAAO,KAAK,OAAO,eAAiB,EACrC,CACD,IAAI,WAAY,CACd,OAAO,KAAK,OAAO,kBAAoB,GACxC,CACD,IAAIC,EAAKC,EAAM,CACb,GAAK,KAAK,QACV,GAAI,CACF,MAAMC,EAAO,KAAK,IAAIF,CAAG,EACnBG,EAAU,OAAOF,GAAS,SAAW,KAAK,UAAUA,CAAI,EAAIA,EAClE,KAAK,QAAQ,QAAQC,EAAMC,CAAO,CACnC,OAAQC,EAAO,CACd,QAAQ,KAAKA,CAAK,CACnB,CACF,CACD,IAAIJ,EAAKK,EAAQ,CACf,GAAI,CAAC,KAAK,QAAS,OAAO,KAC1B,GAAI,CACF,MAAMH,EAAO,KAAK,IAAIF,CAAG,EACnBG,EAAU,KAAK,QAAQ,QAAQD,CAAI,EACzC,OAAIC,IAAY,KAAa,KACtBE,EAAOF,CAAO,CACtB,OAAQC,EAAO,CACd,eAAQ,KAAKA,CAAK,EACX,IACR,CACF,CACD,OAAOJ,EAAK,CACV,GAAK,KAAK,QACV,GAAI,CACF,MAAME,EAAO,KAAK,IAAIF,CAAG,EACzB,KAAK,QAAQ,WAAWE,CAAI,CAC7B,OAAQE,EAAO,CACd,QAAQ,KAAKA,CAAK,CACnB,CACF,CACD,OAAOJ,EAAKM,EAAS,CACnB,MAAMC,EAAQ,KAAK,IAAIP,EAAKQ,CAAU,EAChCC,EAAWH,EAAQC,CAAK,EAC9B,YAAK,IAAIP,EAAKS,CAAQ,EACfA,CACR,CACD,aAAaT,EAAKU,EAAWH,EAAO,CAElC,MAAMI,EAAY,CAAE,GADL,KAAK,IAAIX,EAAKQ,CAAU,GAAK,GACb,CAACE,CAAS,EAAGH,CAAK,EACjD,KAAK,IAAIP,EAAKW,CAAS,CACxB,CACD,IAAIC,EAAQ,CACV,MAAO,CAAC,KAAK,OAAQA,CAAM,EAAE,KAAK,KAAK,SAAS,CACjD,CACH,EACA,SAASb,GAAa,CACpB,OAAIc,EAAmB,OAAO,YAAY,EACjC,OAAO,aAEZA,EAAmB,OAAO,cAAc,EACnC,OAAO,eAET,IACT,CACA,SAASA,EAAmBC,EAAU,CACpC,GAAI,qBAAQ,aACV,GAAI,CACFA,EAAS,QAAQ,aAAc,GAAG,EAClC,MAAMC,EAAQ,OAAO,aAAa,QAAQ,YAAY,EACtDD,EAAS,WAAW,YAAY,EAChC,MAAME,EAAQF,EAAS,QAAQ,YAAY,EAC3C,OAAOC,IAAU,KAAOC,IAAU,IACxC,MAAY,CACN,MAAO,EACR,CAEH,MAAO,EACT,CACA,SAASR,EAAWD,EAAO,CACzB,OAAO,KAAK,MAAMA,CAAK,CACzB,CACG,IAACU,EAAU,IAAIpB,EAAQ,CACxB,cAAe,WACf,iBAAkB,GACpB,CAAC"}