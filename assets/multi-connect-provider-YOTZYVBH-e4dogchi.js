const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C_FqkN9J.js","assets/index-BNjDdafE.js","assets/wallet-connect-init-options-ACAHGVFG-DifWqtPm.js","assets/index.esm-DhwY4kHm.js","assets/index.esm-Cc9myTra.js","assets/index.esm-COc-PyqV.js"])))=>i.map(i=>d[i]);
import{_ as zl}from"./index-BNjDdafE.js";import{C as J_,f as Y_}from"./index.esm-DhwY4kHm.js";import{g as gs,a as Z1,c as Wc,D as X_}from"./import-wrapper-prod-hit9ecK7.js";import{storage as xp}from"./index.esm-COc-PyqV.js";import{g as Z_}from"./index.esm-5Aerb1sL.js";import{aa as Q_,m as e5}from"./index.esm-Cc9myTra.js";import{t as t5}from"./tap-DGvjHJum.js";var Q1={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function n(d,p,b){this.fn=d,this.context=p,this.once=b||!1}function a(d,p,b,w,R){if(typeof b!="function")throw new TypeError("The listener must be a function");var O=new n(b,w||d,R),C=t?t+p:p;return d._events[C]?d._events[C].fn?d._events[C]=[d._events[C],O]:d._events[C].push(O):(d._events[C]=O,d._eventsCount++),d}function c(d,p){--d._eventsCount===0?d._events=new i:delete d._events[p]}function h(){this._events=new i,this._eventsCount=0}h.prototype.eventNames=function(){var p=[],b,w;if(this._eventsCount===0)return p;for(w in b=this._events)e.call(b,w)&&p.push(t?w.slice(1):w);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(b)):p},h.prototype.listeners=function(p){var b=t?t+p:p,w=this._events[b];if(!w)return[];if(w.fn)return[w.fn];for(var R=0,O=w.length,C=new Array(O);R<O;R++)C[R]=w[R].fn;return C},h.prototype.listenerCount=function(p){var b=t?t+p:p,w=this._events[b];return w?w.fn?1:w.length:0},h.prototype.emit=function(p,b,w,R,O,C){var q=t?t+p:p;if(!this._events[q])return!1;var V=this._events[q],Y=arguments.length,H,X;if(V.fn){switch(V.once&&this.removeListener(p,V.fn,void 0,!0),Y){case 1:return V.fn.call(V.context),!0;case 2:return V.fn.call(V.context,b),!0;case 3:return V.fn.call(V.context,b,w),!0;case 4:return V.fn.call(V.context,b,w,R),!0;case 5:return V.fn.call(V.context,b,w,R,O),!0;case 6:return V.fn.call(V.context,b,w,R,O,C),!0}for(X=1,H=new Array(Y-1);X<Y;X++)H[X-1]=arguments[X];V.fn.apply(V.context,H)}else{var k=V.length,W;for(X=0;X<k;X++)switch(V[X].once&&this.removeListener(p,V[X].fn,void 0,!0),Y){case 1:V[X].fn.call(V[X].context);break;case 2:V[X].fn.call(V[X].context,b);break;case 3:V[X].fn.call(V[X].context,b,w);break;case 4:V[X].fn.call(V[X].context,b,w,R);break;default:if(!H)for(W=1,H=new Array(Y-1);W<Y;W++)H[W-1]=arguments[W];V[X].fn.apply(V[X].context,H)}}return!0},h.prototype.on=function(p,b,w){return a(this,p,b,w,!1)},h.prototype.once=function(p,b,w){return a(this,p,b,w,!0)},h.prototype.removeListener=function(p,b,w,R){var O=t?t+p:p;if(!this._events[O])return this;if(!b)return c(this,O),this;var C=this._events[O];if(C.fn)C.fn===b&&(!R||C.once)&&(!w||C.context===w)&&c(this,O);else{for(var q=0,V=[],Y=C.length;q<Y;q++)(C[q].fn!==b||R&&!C[q].once||w&&C[q].context!==w)&&V.push(C[q]);V.length?this._events[O]=V.length===1?V[0]:V:c(this,O)}return this},h.prototype.removeAllListeners=function(p){var b;return p?(b=t?t+p:p,this._events[b]&&c(this,b)):(this._events=new i,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=t,h.EventEmitter=h,r.exports=h})(Q1);var r5=Q1.exports;const i5=gs(r5);var Fl={exports:{}},Ra=typeof Reflect=="object"?Reflect:null,Ep=Ra&&typeof Ra.apply=="function"?Ra.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},bc;Ra&&typeof Ra.ownKeys=="function"?bc=Ra.ownKeys:Object.getOwnPropertySymbols?bc=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:bc=function(e){return Object.getOwnPropertyNames(e)};function n5(r){console&&console.warn&&console.warn(r)}var eg=Number.isNaN||function(e){return e!==e};function zt(){zt.init.call(this)}Fl.exports=zt;Fl.exports.once=f5;zt.EventEmitter=zt;zt.prototype._events=void 0;zt.prototype._eventsCount=0;zt.prototype._maxListeners=void 0;var Sp=10;function Vc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(zt,"defaultMaxListeners",{enumerable:!0,get:function(){return Sp},set:function(r){if(typeof r!="number"||r<0||eg(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Sp=r}});zt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};zt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||eg(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function tg(r){return r._maxListeners===void 0?zt.defaultMaxListeners:r._maxListeners}zt.prototype.getMaxListeners=function(){return tg(this)};zt.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",a=this._events;if(a!==void 0)n=n&&a.error===void 0;else if(!n)return!1;if(n){var c;if(t.length>0&&(c=t[0]),c instanceof Error)throw c;var h=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw h.context=c,h}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")Ep(d,this,t);else for(var p=d.length,b=ag(d,p),i=0;i<p;++i)Ep(b[i],this,t);return!0};function rg(r,e,t,i){var n,a,c;if(Vc(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),c=a[e]),c===void 0)c=a[e]=t,++r._eventsCount;else if(typeof c=="function"?c=a[e]=i?[t,c]:[c,t]:i?c.unshift(t):c.push(t),n=tg(r),n>0&&c.length>n&&!c.warned){c.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=r,h.type=e,h.count=c.length,n5(h)}return r}zt.prototype.addListener=function(e,t){return rg(this,e,t,!1)};zt.prototype.on=zt.prototype.addListener;zt.prototype.prependListener=function(e,t){return rg(this,e,t,!0)};function s5(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ig(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=s5.bind(i);return n.listener=t,i.wrapFn=n,n}zt.prototype.once=function(e,t){return Vc(t),this.on(e,ig(this,e,t)),this};zt.prototype.prependOnceListener=function(e,t){return Vc(t),this.prependListener(e,ig(this,e,t)),this};zt.prototype.removeListener=function(e,t){var i,n,a,c,h;if(Vc(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(a=-1,c=i.length-1;c>=0;c--)if(i[c]===t||i[c].listener===t){h=i[c].listener,a=c;break}if(a<0)return this;a===0?i.shift():a5(i,a),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,h||t)}return this};zt.prototype.off=zt.prototype.removeListener;zt.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var a=Object.keys(i),c;for(n=0;n<a.length;++n)c=a[n],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function ng(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?o5(n):ag(n,n.length)}zt.prototype.listeners=function(e){return ng(this,e,!0)};zt.prototype.rawListeners=function(e){return ng(this,e,!1)};zt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):sg.call(r,e)};zt.prototype.listenerCount=sg;function sg(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}zt.prototype.eventNames=function(){return this._eventsCount>0?bc(this._events):[]};function ag(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function a5(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function o5(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function f5(r,e){return new Promise(function(t,i){function n(c){r.removeListener(e,a),i(c)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}og(r,e,a,{once:!0}),e!=="error"&&c5(r,n,{once:!0})})}function c5(r,e,t){typeof r.on=="function"&&og(r,"error",e,t)}function og(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(a){i.once&&r.removeEventListener(e,n),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var vi=Fl.exports;const kl=gs(vi);var Mp=function(r,e,t){if(t||arguments.length===2)for(var i=0,n=e.length,a;i<n;i++)(a||!(i in e))&&(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return r.concat(a||Array.prototype.slice.call(e))},h5=function(){function r(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}return r}(),u5=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),l5=function(){function r(e,t,i,n){this.name=e,this.version=t,this.os=i,this.bot=n,this.type="bot-device"}return r}(),d5=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),p5=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),v5=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,g5=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ip=3,b5=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",v5]],Ap=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function m5(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new p5:typeof navigator<"u"?w5(navigator.userAgent):x5()}function y5(r){return r!==""&&b5.reduce(function(e,t){var i=t[0],n=t[1];if(e)return e;var a=n.exec(r);return!!a&&[i,a]},!1)}function w5(r){var e=y5(r);if(!e)return null;var t=e[0],i=e[1];if(t==="searchbot")return new d5;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Ip&&(n=Mp(Mp([],n,!0),E5(Ip-n.length),!0)):n=[];var a=n.join("."),c=_5(r),h=g5.exec(r);return h&&h[1]?new l5(t,a,c,h[1]):new h5(t,a,c)}function _5(r){for(var e=0,t=Ap.length;e<t;e++){var i=Ap[e],n=i[0],a=i[1],c=a.exec(r);if(c)return n}return null}function x5(){var r=typeof process<"u"&&process.version;return r?new u5(process.version.slice(1)):null}function E5(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var Se={};var ul=function(r,e){return ul=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},ul(r,e)};function S5(r,e){ul(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ll=function(){return ll=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ll.apply(this,arguments)};function M5(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(t[i[n]]=r[i[n]]);return t}function I5(r,e,t,i){var n=arguments.length,a=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,e,t,i);else for(var h=r.length-1;h>=0;h--)(c=r[h])&&(a=(n<3?c(a):n>3?c(e,t,a):c(e,t))||a);return n>3&&a&&Object.defineProperty(e,t,a),a}function A5(r,e){return function(t,i){e(t,i,r)}}function P5(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function D5(r,e,t,i){function n(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(b){try{p(i.next(b))}catch(w){c(w)}}function d(b){try{p(i.throw(b))}catch(w){c(w)}}function p(b){b.done?a(b.value):n(b.value).then(h,d)}p((i=i.apply(r,e||[])).next())})}function O5(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,n,a,c;return c={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function h(p){return function(b){return d([p,b])}}function d(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,n&&(a=p[0]&2?n.return:p[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,p[1])).done)return a;switch(n=0,a&&(p=[p[0]&2,a.value]),p[0]){case 0:case 1:a=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,n=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){t.label=p[1];break}if(p[0]===6&&t.label<a[1]){t.label=a[1],a=p;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(p);break}a[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(b){p=[6,b],n=0}finally{i=a=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function R5(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function C5(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function dl(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function fg(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),n,a=[],c;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(h){c={error:h}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(c)throw c.error}}return a}function N5(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(fg(arguments[e]));return r}function T5(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),n=0,e=0;e<t;e++)for(var a=arguments[e],c=0,h=a.length;c<h;c++,n++)i[n]=a[c];return i}function qo(r){return this instanceof qo?(this.v=r,this):new qo(r)}function $5(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),n,a=[];return n={},c("next"),c("throw"),c("return"),n[Symbol.asyncIterator]=function(){return this},n;function c(R){i[R]&&(n[R]=function(O){return new Promise(function(C,q){a.push([R,O,C,q])>1||h(R,O)})})}function h(R,O){try{d(i[R](O))}catch(C){w(a[0][3],C)}}function d(R){R.value instanceof qo?Promise.resolve(R.value.v).then(p,b):w(a[0][2],R)}function p(R){h("next",R)}function b(R){h("throw",R)}function w(R,O){R(O),a.shift(),a.length&&h(a[0][0],a[0][1])}}function L5(r){var e,t;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,a){e[n]=r[n]?function(c){return(t=!t)?{value:qo(r[n](c)),done:n==="return"}:a?a(c):c}:a}}function q5(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof dl=="function"?dl(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=r[a]&&function(c){return new Promise(function(h,d){c=r[a](c),n(h,d,c.done,c.value)})}}function n(a,c,h,d){Promise.resolve(d).then(function(p){a({value:p,done:h})},c)}}function U5(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function B5(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function z5(r){return r&&r.__esModule?r:{default:r}}function F5(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function k5(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const H5=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ll},__asyncDelegator:L5,__asyncGenerator:$5,__asyncValues:q5,__await:qo,__awaiter:D5,__classPrivateFieldGet:F5,__classPrivateFieldSet:k5,__createBinding:R5,__decorate:I5,__exportStar:C5,__extends:S5,__generator:O5,__importDefault:z5,__importStar:B5,__makeTemplateObject:U5,__metadata:P5,__param:A5,__read:fg,__rest:M5,__spread:N5,__spreadArrays:T5,__values:dl},Symbol.toStringTag,{value:"Module"})),Ko=Z1(H5);var Ou={},mo={},Pp;function K5(){if(Pp)return mo;Pp=1,Object.defineProperty(mo,"__esModule",{value:!0}),mo.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return mo.delay=r,mo}var Ls={},Ru={},qs={},Dp;function j5(){return Dp||(Dp=1,Object.defineProperty(qs,"__esModule",{value:!0}),qs.ONE_THOUSAND=qs.ONE_HUNDRED=void 0,qs.ONE_HUNDRED=100,qs.ONE_THOUSAND=1e3),qs}var Cu={},Op;function W5(){return Op||(Op=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(Cu)),Cu}var Rp;function cg(){return Rp||(Rp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ko;e.__exportStar(j5(),r),e.__exportStar(W5(),r)}(Ru)),Ru}var Cp;function V5(){if(Cp)return Ls;Cp=1,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.fromMiliseconds=Ls.toMiliseconds=void 0;const r=cg();function e(i){return i*r.ONE_THOUSAND}Ls.toMiliseconds=e;function t(i){return Math.floor(i/r.ONE_THOUSAND)}return Ls.fromMiliseconds=t,Ls}var Np;function G5(){return Np||(Np=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ko;e.__exportStar(K5(),r),e.__exportStar(V5(),r)}(Ou)),Ou}var xa={},Tp;function J5(){if(Tp)return xa;Tp=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const i=this.get(t);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const n=Date.now()-i.started;this.timestamps.set(t,{started:i.started,elapsed:n})}get(t){const i=this.timestamps.get(t);if(typeof i>"u")throw new Error(`No timestamp found for label: ${t}`);return i}elapsed(t){const i=this.get(t);return i.elapsed||Date.now()-i.started}}return xa.Watch=r,xa.default=r,xa}var Nu={},yo={},$p;function Y5(){if($p)return yo;$p=1,Object.defineProperty(yo,"__esModule",{value:!0}),yo.IWatch=void 0;class r{}return yo.IWatch=r,yo}var Lp;function X5(){return Lp||(Lp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ko.__exportStar(Y5(),r)}(Nu)),Nu}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ko;e.__exportStar(G5(),r),e.__exportStar(J5(),r),e.__exportStar(X5(),r),e.__exportStar(cg(),r)})(Se);var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.getLocalStorage=Wt.getLocalStorageOrThrow=Wt.getCrypto=Wt.getCryptoOrThrow=hg=Wt.getLocation=Wt.getLocationOrThrow=Hl=Wt.getNavigator=Wt.getNavigatorOrThrow=jo=Wt.getDocument=Wt.getDocumentOrThrow=Wt.getFromWindowOrThrow=Wt.getFromWindow=void 0;function Xs(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}Wt.getFromWindow=Xs;function za(r){const e=Xs(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}Wt.getFromWindowOrThrow=za;function Z5(){return za("document")}Wt.getDocumentOrThrow=Z5;function Q5(){return Xs("document")}var jo=Wt.getDocument=Q5;function e8(){return za("navigator")}Wt.getNavigatorOrThrow=e8;function t8(){return Xs("navigator")}var Hl=Wt.getNavigator=t8;function r8(){return za("location")}Wt.getLocationOrThrow=r8;function i8(){return Xs("location")}var hg=Wt.getLocation=i8;function n8(){return za("crypto")}Wt.getCryptoOrThrow=n8;function s8(){return Xs("crypto")}Wt.getCrypto=s8;function a8(){return za("localStorage")}Wt.getLocalStorageOrThrow=a8;function o8(){return Xs("localStorage")}Wt.getLocalStorage=o8;var Kl={};Object.defineProperty(Kl,"__esModule",{value:!0});var ug=Kl.getWindowMetadata=void 0;const qp=Wt;function f8(){let r,e;try{r=qp.getDocumentOrThrow(),e=qp.getLocationOrThrow()}catch{return null}function t(){const w=r.getElementsByTagName("link"),R=[];for(let O=0;O<w.length;O++){const C=w[O],q=C.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const V=C.getAttribute("href");if(V)if(V.toLowerCase().indexOf("https:")===-1&&V.toLowerCase().indexOf("http:")===-1&&V.indexOf("//")!==0){let Y=e.protocol+"//"+e.host;if(V.indexOf("/")===0)Y+=V;else{const H=e.pathname.split("/");H.pop();const X=H.join("/");Y+=X+"/"+V}R.push(Y)}else if(V.indexOf("//")===0){const Y=e.protocol+V;R.push(Y)}else R.push(V)}}return R}function i(...w){const R=r.getElementsByTagName("meta");for(let O=0;O<R.length;O++){const C=R[O],q=["itemprop","property","name"].map(V=>C.getAttribute(V)).filter(V=>V?w.includes(V):!1);if(q.length&&q){const V=C.getAttribute("content");if(V)return V}}return""}function n(){let w=i("name","og:site_name","og:title","twitter:title");return w||(w=r.title),w}function a(){return i("description","og:description","twitter:description","keywords")}const c=n(),h=a(),d=e.origin,p=t();return{description:h,url:d,icons:p,name:c}}ug=Kl.getWindowMetadata=f8;var Uo={},c8=r=>encodeURIComponent(r).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),lg="%[a-f0-9]{2}",Up=new RegExp("("+lg+")|([^%]+?)","gi"),Bp=new RegExp("("+lg+")+","gi");function pl(r,e){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;e=e||1;var t=r.slice(0,e),i=r.slice(e);return Array.prototype.concat.call([],pl(t),pl(i))}function h8(r){try{return decodeURIComponent(r)}catch{for(var e=r.match(Up)||[],t=1;t<e.length;t++)r=pl(e,t).join(""),e=r.match(Up)||[];return r}}function u8(r){for(var e={"%FE%FF":"��","%FF%FE":"��"},t=Bp.exec(r);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var i=h8(t[0]);i!==t[0]&&(e[t[0]]=i)}t=Bp.exec(r)}e["%C2"]="�";for(var n=Object.keys(e),a=0;a<n.length;a++){var c=n[a];r=r.replace(new RegExp(c,"g"),e[c])}return r}var l8=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return u8(r)}},d8=(r,e)=>{if(!(typeof r=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[r];const t=r.indexOf(e);return t===-1?[r]:[r.slice(0,t),r.slice(t+e.length)]},p8=function(r,e){for(var t={},i=Object.keys(r),n=Array.isArray(e),a=0;a<i.length;a++){var c=i[a],h=r[c];(n?e.indexOf(c)!==-1:e(c,h,r))&&(t[c]=h)}return t};(function(r){const e=c8,t=l8,i=d8,n=p8,a=H=>H==null,c=Symbol("encodeFragmentIdentifier");function h(H){switch(H.arrayFormat){case"index":return X=>(k,W)=>{const J=k.length;return W===void 0||H.skipNull&&W===null||H.skipEmptyString&&W===""?k:W===null?[...k,[b(X,H),"[",J,"]"].join("")]:[...k,[b(X,H),"[",b(J,H),"]=",b(W,H)].join("")]};case"bracket":return X=>(k,W)=>W===void 0||H.skipNull&&W===null||H.skipEmptyString&&W===""?k:W===null?[...k,[b(X,H),"[]"].join("")]:[...k,[b(X,H),"[]=",b(W,H)].join("")];case"colon-list-separator":return X=>(k,W)=>W===void 0||H.skipNull&&W===null||H.skipEmptyString&&W===""?k:W===null?[...k,[b(X,H),":list="].join("")]:[...k,[b(X,H),":list=",b(W,H)].join("")];case"comma":case"separator":case"bracket-separator":{const X=H.arrayFormat==="bracket-separator"?"[]=":"=";return k=>(W,J)=>J===void 0||H.skipNull&&J===null||H.skipEmptyString&&J===""?W:(J=J===null?"":J,W.length===0?[[b(k,H),X,b(J,H)].join("")]:[[W,b(J,H)].join(H.arrayFormatSeparator)])}default:return X=>(k,W)=>W===void 0||H.skipNull&&W===null||H.skipEmptyString&&W===""?k:W===null?[...k,b(X,H)]:[...k,[b(X,H),"=",b(W,H)].join("")]}}function d(H){let X;switch(H.arrayFormat){case"index":return(k,W,J)=>{if(X=/\[(\d*)\]$/.exec(k),k=k.replace(/\[\d*\]$/,""),!X){J[k]=W;return}J[k]===void 0&&(J[k]={}),J[k][X[1]]=W};case"bracket":return(k,W,J)=>{if(X=/(\[\])$/.exec(k),k=k.replace(/\[\]$/,""),!X){J[k]=W;return}if(J[k]===void 0){J[k]=[W];return}J[k]=[].concat(J[k],W)};case"colon-list-separator":return(k,W,J)=>{if(X=/(:list)$/.exec(k),k=k.replace(/:list$/,""),!X){J[k]=W;return}if(J[k]===void 0){J[k]=[W];return}J[k]=[].concat(J[k],W)};case"comma":case"separator":return(k,W,J)=>{const M=typeof W=="string"&&W.includes(H.arrayFormatSeparator),B=typeof W=="string"&&!M&&w(W,H).includes(H.arrayFormatSeparator);W=B?w(W,H):W;const ae=M||B?W.split(H.arrayFormatSeparator).map(de=>w(de,H)):W===null?W:w(W,H);J[k]=ae};case"bracket-separator":return(k,W,J)=>{const M=/(\[\])$/.test(k);if(k=k.replace(/\[\]$/,""),!M){J[k]=W&&w(W,H);return}const B=W===null?[]:W.split(H.arrayFormatSeparator).map(ae=>w(ae,H));if(J[k]===void 0){J[k]=B;return}J[k]=[].concat(J[k],B)};default:return(k,W,J)=>{if(J[k]===void 0){J[k]=W;return}J[k]=[].concat(J[k],W)}}}function p(H){if(typeof H!="string"||H.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function b(H,X){return X.encode?X.strict?e(H):encodeURIComponent(H):H}function w(H,X){return X.decode?t(H):H}function R(H){return Array.isArray(H)?H.sort():typeof H=="object"?R(Object.keys(H)).sort((X,k)=>Number(X)-Number(k)).map(X=>H[X]):H}function O(H){const X=H.indexOf("#");return X!==-1&&(H=H.slice(0,X)),H}function C(H){let X="";const k=H.indexOf("#");return k!==-1&&(X=H.slice(k)),X}function q(H){H=O(H);const X=H.indexOf("?");return X===-1?"":H.slice(X+1)}function V(H,X){return X.parseNumbers&&!Number.isNaN(Number(H))&&typeof H=="string"&&H.trim()!==""?H=Number(H):X.parseBooleans&&H!==null&&(H.toLowerCase()==="true"||H.toLowerCase()==="false")&&(H=H.toLowerCase()==="true"),H}function Y(H,X){X=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},X),p(X.arrayFormatSeparator);const k=d(X),W=Object.create(null);if(typeof H!="string"||(H=H.trim().replace(/^[?#&]/,""),!H))return W;for(const J of H.split("&")){if(J==="")continue;let[M,B]=i(X.decode?J.replace(/\+/g," "):J,"=");B=B===void 0?null:["comma","separator","bracket-separator"].includes(X.arrayFormat)?B:w(B,X),k(w(M,X),B,W)}for(const J of Object.keys(W)){const M=W[J];if(typeof M=="object"&&M!==null)for(const B of Object.keys(M))M[B]=V(M[B],X);else W[J]=V(M,X)}return X.sort===!1?W:(X.sort===!0?Object.keys(W).sort():Object.keys(W).sort(X.sort)).reduce((J,M)=>{const B=W[M];return B&&typeof B=="object"&&!Array.isArray(B)?J[M]=R(B):J[M]=B,J},Object.create(null))}r.extract=q,r.parse=Y,r.stringify=(H,X)=>{if(!H)return"";X=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},X),p(X.arrayFormatSeparator);const k=B=>X.skipNull&&a(H[B])||X.skipEmptyString&&H[B]==="",W=h(X),J={};for(const B of Object.keys(H))k(B)||(J[B]=H[B]);const M=Object.keys(J);return X.sort!==!1&&M.sort(X.sort),M.map(B=>{const ae=H[B];return ae===void 0?"":ae===null?b(B,X):Array.isArray(ae)?ae.length===0&&X.arrayFormat==="bracket-separator"?b(B,X)+"[]":ae.reduce(W(B),[]).join("&"):b(B,X)+"="+b(ae,X)}).filter(B=>B.length>0).join("&")},r.parseUrl=(H,X)=>{X=Object.assign({decode:!0},X);const[k,W]=i(H,"#");return Object.assign({url:k.split("?")[0]||"",query:Y(q(H),X)},X&&X.parseFragmentIdentifier&&W?{fragmentIdentifier:w(W,X)}:{})},r.stringifyUrl=(H,X)=>{X=Object.assign({encode:!0,strict:!0,[c]:!0},X);const k=O(H.url).split("?")[0]||"",W=r.extract(H.url),J=r.parse(W,{sort:!1}),M=Object.assign(J,H.query);let B=r.stringify(M,X);B&&(B=`?${B}`);let ae=C(H.url);return H.fragmentIdentifier&&(ae=`#${X[c]?b(H.fragmentIdentifier,X):H.fragmentIdentifier}`),`${k}${B}${ae}`},r.pick=(H,X,k)=>{k=Object.assign({parseFragmentIdentifier:!0,[c]:!1},k);const{url:W,query:J,fragmentIdentifier:M}=r.parseUrl(H,k);return r.stringifyUrl({url:W,query:n(J,X),fragmentIdentifier:M},k)},r.exclude=(H,X,k)=>{const W=Array.isArray(X)?J=>!X.includes(J):(J,M)=>!X(J,M);return r.pick(H,W,k)}})(Uo);var dg={exports:{}};(function(r){var e={};(function(){var t="input is invalid type",i="finalize already called",n=typeof window=="object",a=n?window:{};a.JS_SHA3_NO_WINDOW&&(n=!1);var c=!n&&typeof self=="object",h=!a.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;h?a=e:c&&(a=self);var d=!a.JS_SHA3_NO_COMMON_JS&&!0&&r.exports,p=!a.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",b="0123456789abcdef".split(""),w=[31,7936,2031616,520093696],R=[4,1024,262144,67108864],O=[1,256,65536,16777216],C=[6,1536,393216,100663296],q=[0,8,16,24],V=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],Y=[224,256,384,512],H=[128,256],X=["hex","buffer","arrayBuffer","array","digest"],k={128:168,256:136};(a.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(D){return Object.prototype.toString.call(D)==="[object Array]"}),p&&(a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(D){return typeof D=="object"&&D.buffer&&D.buffer.constructor===ArrayBuffer});for(var W=function(D,F,j){return function(L){return new T(D,F,D).update(L)[j]()}},J=function(D,F,j){return function(L,_){return new T(D,F,_).update(L)[j]()}},M=function(D,F,j){return function(L,_,K,re){return u["cshake"+D].update(L,_,K,re)[j]()}},B=function(D,F,j){return function(L,_,K,re){return u["kmac"+D].update(L,_,K,re)[j]()}},ae=function(D,F,j,L){for(var _=0;_<X.length;++_){var K=X[_];D[K]=F(j,L,K)}return D},de=function(D,F){var j=W(D,F,"hex");return j.create=function(){return new T(D,F,D)},j.update=function(L){return j.create().update(L)},ae(j,W,D,F)},U=function(D,F){var j=J(D,F,"hex");return j.create=function(L){return new T(D,F,L)},j.update=function(L,_){return j.create(_).update(L)},ae(j,J,D,F)},m=function(D,F){var j=k[D],L=M(D,F,"hex");return L.create=function(_,K,re){return!K&&!re?u["shake"+D].create(_):new T(D,F,_).bytepad([K,re],j)},L.update=function(_,K,re,se){return L.create(K,re,se).update(_)},ae(L,M,D,F)},g=function(D,F){var j=k[D],L=B(D,F,"hex");return L.create=function(_,K,re){return new ne(D,F,K).bytepad(["KMAC",re],j).bytepad([_],j)},L.update=function(_,K,re,se){return L.create(_,re,se).update(K)},ae(L,B,D,F)},f=[{name:"keccak",padding:O,bits:Y,createMethod:de},{name:"sha3",padding:C,bits:Y,createMethod:de},{name:"shake",padding:w,bits:H,createMethod:U},{name:"cshake",padding:R,bits:H,createMethod:m},{name:"kmac",padding:R,bits:H,createMethod:g}],u={},y=[],A=0;A<f.length;++A)for(var P=f[A],S=P.bits,v=0;v<S.length;++v){var E=P.name+"_"+S[v];if(y.push(E),u[E]=P.createMethod(S[v],P.padding),P.name!=="sha3"){var x=P.name+S[v];y.push(x),u[x]=u[E]}}function T(D,F,j){this.blocks=[],this.s=[],this.padding=F,this.outputBits=j,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(D<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=j>>5,this.extraBytes=(j&31)>>3;for(var L=0;L<50;++L)this.s[L]=0}T.prototype.update=function(D){if(this.finalized)throw new Error(i);var F,j=typeof D;if(j!=="string"){if(j==="object"){if(D===null)throw new Error(t);if(p&&D.constructor===ArrayBuffer)D=new Uint8Array(D);else if(!Array.isArray(D)&&(!p||!ArrayBuffer.isView(D)))throw new Error(t)}else throw new Error(t);F=!0}for(var L=this.blocks,_=this.byteCount,K=D.length,re=this.blockCount,se=0,we=this.s,ce,me;se<K;){if(this.reset)for(this.reset=!1,L[0]=this.block,ce=1;ce<re+1;++ce)L[ce]=0;if(F)for(ce=this.start;se<K&&ce<_;++se)L[ce>>2]|=D[se]<<q[ce++&3];else for(ce=this.start;se<K&&ce<_;++se)me=D.charCodeAt(se),me<128?L[ce>>2]|=me<<q[ce++&3]:me<2048?(L[ce>>2]|=(192|me>>6)<<q[ce++&3],L[ce>>2]|=(128|me&63)<<q[ce++&3]):me<55296||me>=57344?(L[ce>>2]|=(224|me>>12)<<q[ce++&3],L[ce>>2]|=(128|me>>6&63)<<q[ce++&3],L[ce>>2]|=(128|me&63)<<q[ce++&3]):(me=65536+((me&1023)<<10|D.charCodeAt(++se)&1023),L[ce>>2]|=(240|me>>18)<<q[ce++&3],L[ce>>2]|=(128|me>>12&63)<<q[ce++&3],L[ce>>2]|=(128|me>>6&63)<<q[ce++&3],L[ce>>2]|=(128|me&63)<<q[ce++&3]);if(this.lastByteIndex=ce,ce>=_){for(this.start=ce-_,this.block=L[re],ce=0;ce<re;++ce)we[ce]^=L[ce];fe(we),this.reset=!0}else this.start=ce}return this},T.prototype.encode=function(D,F){var j=D&255,L=1,_=[j];for(D=D>>8,j=D&255;j>0;)_.unshift(j),D=D>>8,j=D&255,++L;return F?_.push(L):_.unshift(L),this.update(_),_.length},T.prototype.encodeString=function(D){var F,j=typeof D;if(j!=="string"){if(j==="object"){if(D===null)throw new Error(t);if(p&&D.constructor===ArrayBuffer)D=new Uint8Array(D);else if(!Array.isArray(D)&&(!p||!ArrayBuffer.isView(D)))throw new Error(t)}else throw new Error(t);F=!0}var L=0,_=D.length;if(F)L=_;else for(var K=0;K<D.length;++K){var re=D.charCodeAt(K);re<128?L+=1:re<2048?L+=2:re<55296||re>=57344?L+=3:(re=65536+((re&1023)<<10|D.charCodeAt(++K)&1023),L+=4)}return L+=this.encode(L*8),this.update(D),L},T.prototype.bytepad=function(D,F){for(var j=this.encode(F),L=0;L<D.length;++L)j+=this.encodeString(D[L]);var _=F-j%F,K=[];return K.length=_,this.update(K),this},T.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var D=this.blocks,F=this.lastByteIndex,j=this.blockCount,L=this.s;if(D[F>>2]|=this.padding[F&3],this.lastByteIndex===this.byteCount)for(D[0]=D[j],F=1;F<j+1;++F)D[F]=0;for(D[j-1]|=2147483648,F=0;F<j;++F)L[F]^=D[F];fe(L)}},T.prototype.toString=T.prototype.hex=function(){this.finalize();for(var D=this.blockCount,F=this.s,j=this.outputBlocks,L=this.extraBytes,_=0,K=0,re="",se;K<j;){for(_=0;_<D&&K<j;++_,++K)se=F[_],re+=b[se>>4&15]+b[se&15]+b[se>>12&15]+b[se>>8&15]+b[se>>20&15]+b[se>>16&15]+b[se>>28&15]+b[se>>24&15];K%D===0&&(fe(F),_=0)}return L&&(se=F[_],re+=b[se>>4&15]+b[se&15],L>1&&(re+=b[se>>12&15]+b[se>>8&15]),L>2&&(re+=b[se>>20&15]+b[se>>16&15])),re},T.prototype.arrayBuffer=function(){this.finalize();var D=this.blockCount,F=this.s,j=this.outputBlocks,L=this.extraBytes,_=0,K=0,re=this.outputBits>>3,se;L?se=new ArrayBuffer(j+1<<2):se=new ArrayBuffer(re);for(var we=new Uint32Array(se);K<j;){for(_=0;_<D&&K<j;++_,++K)we[K]=F[_];K%D===0&&fe(F)}return L&&(we[_]=F[_],se=se.slice(0,re)),se},T.prototype.buffer=T.prototype.arrayBuffer,T.prototype.digest=T.prototype.array=function(){this.finalize();for(var D=this.blockCount,F=this.s,j=this.outputBlocks,L=this.extraBytes,_=0,K=0,re=[],se,we;K<j;){for(_=0;_<D&&K<j;++_,++K)se=K<<2,we=F[_],re[se]=we&255,re[se+1]=we>>8&255,re[se+2]=we>>16&255,re[se+3]=we>>24&255;K%D===0&&fe(F)}return L&&(se=K<<2,we=F[_],re[se]=we&255,L>1&&(re[se+1]=we>>8&255),L>2&&(re[se+2]=we>>16&255)),re};function ne(D,F,j){T.call(this,D,F,j)}ne.prototype=new T,ne.prototype.finalize=function(){return this.encode(this.outputBits,!0),T.prototype.finalize.call(this)};var fe=function(D){var F,j,L,_,K,re,se,we,ce,me,Ke,Me,Je,Fe,ye,Ie,Ce,ge,$e,Ae,be,Oe,Ne,_e,De,ke,xe,je,We,He,dt,mt,Ge,pt,St,Ye,nt,Ze,Te,Qe,et,Le,Xe,ct,Be,tt,ht,qe,st,rt,Re,ut,Ct,at,Nt,Rt,yt,Dr,Or,Rr,Cr,Nr,Qt;for(L=0;L<48;L+=2)_=D[0]^D[10]^D[20]^D[30]^D[40],K=D[1]^D[11]^D[21]^D[31]^D[41],re=D[2]^D[12]^D[22]^D[32]^D[42],se=D[3]^D[13]^D[23]^D[33]^D[43],we=D[4]^D[14]^D[24]^D[34]^D[44],ce=D[5]^D[15]^D[25]^D[35]^D[45],me=D[6]^D[16]^D[26]^D[36]^D[46],Ke=D[7]^D[17]^D[27]^D[37]^D[47],Me=D[8]^D[18]^D[28]^D[38]^D[48],Je=D[9]^D[19]^D[29]^D[39]^D[49],F=Me^(re<<1|se>>>31),j=Je^(se<<1|re>>>31),D[0]^=F,D[1]^=j,D[10]^=F,D[11]^=j,D[20]^=F,D[21]^=j,D[30]^=F,D[31]^=j,D[40]^=F,D[41]^=j,F=_^(we<<1|ce>>>31),j=K^(ce<<1|we>>>31),D[2]^=F,D[3]^=j,D[12]^=F,D[13]^=j,D[22]^=F,D[23]^=j,D[32]^=F,D[33]^=j,D[42]^=F,D[43]^=j,F=re^(me<<1|Ke>>>31),j=se^(Ke<<1|me>>>31),D[4]^=F,D[5]^=j,D[14]^=F,D[15]^=j,D[24]^=F,D[25]^=j,D[34]^=F,D[35]^=j,D[44]^=F,D[45]^=j,F=we^(Me<<1|Je>>>31),j=ce^(Je<<1|Me>>>31),D[6]^=F,D[7]^=j,D[16]^=F,D[17]^=j,D[26]^=F,D[27]^=j,D[36]^=F,D[37]^=j,D[46]^=F,D[47]^=j,F=me^(_<<1|K>>>31),j=Ke^(K<<1|_>>>31),D[8]^=F,D[9]^=j,D[18]^=F,D[19]^=j,D[28]^=F,D[29]^=j,D[38]^=F,D[39]^=j,D[48]^=F,D[49]^=j,Fe=D[0],ye=D[1],tt=D[11]<<4|D[10]>>>28,ht=D[10]<<4|D[11]>>>28,je=D[20]<<3|D[21]>>>29,We=D[21]<<3|D[20]>>>29,Rr=D[31]<<9|D[30]>>>23,Cr=D[30]<<9|D[31]>>>23,Le=D[40]<<18|D[41]>>>14,Xe=D[41]<<18|D[40]>>>14,pt=D[2]<<1|D[3]>>>31,St=D[3]<<1|D[2]>>>31,Ie=D[13]<<12|D[12]>>>20,Ce=D[12]<<12|D[13]>>>20,qe=D[22]<<10|D[23]>>>22,st=D[23]<<10|D[22]>>>22,He=D[33]<<13|D[32]>>>19,dt=D[32]<<13|D[33]>>>19,Nr=D[42]<<2|D[43]>>>30,Qt=D[43]<<2|D[42]>>>30,at=D[5]<<30|D[4]>>>2,Nt=D[4]<<30|D[5]>>>2,Ye=D[14]<<6|D[15]>>>26,nt=D[15]<<6|D[14]>>>26,ge=D[25]<<11|D[24]>>>21,$e=D[24]<<11|D[25]>>>21,rt=D[34]<<15|D[35]>>>17,Re=D[35]<<15|D[34]>>>17,mt=D[45]<<29|D[44]>>>3,Ge=D[44]<<29|D[45]>>>3,_e=D[6]<<28|D[7]>>>4,De=D[7]<<28|D[6]>>>4,Rt=D[17]<<23|D[16]>>>9,yt=D[16]<<23|D[17]>>>9,Ze=D[26]<<25|D[27]>>>7,Te=D[27]<<25|D[26]>>>7,Ae=D[36]<<21|D[37]>>>11,be=D[37]<<21|D[36]>>>11,ut=D[47]<<24|D[46]>>>8,Ct=D[46]<<24|D[47]>>>8,ct=D[8]<<27|D[9]>>>5,Be=D[9]<<27|D[8]>>>5,ke=D[18]<<20|D[19]>>>12,xe=D[19]<<20|D[18]>>>12,Dr=D[29]<<7|D[28]>>>25,Or=D[28]<<7|D[29]>>>25,Qe=D[38]<<8|D[39]>>>24,et=D[39]<<8|D[38]>>>24,Oe=D[48]<<14|D[49]>>>18,Ne=D[49]<<14|D[48]>>>18,D[0]=Fe^~Ie&ge,D[1]=ye^~Ce&$e,D[10]=_e^~ke&je,D[11]=De^~xe&We,D[20]=pt^~Ye&Ze,D[21]=St^~nt&Te,D[30]=ct^~tt&qe,D[31]=Be^~ht&st,D[40]=at^~Rt&Dr,D[41]=Nt^~yt&Or,D[2]=Ie^~ge&Ae,D[3]=Ce^~$e&be,D[12]=ke^~je&He,D[13]=xe^~We&dt,D[22]=Ye^~Ze&Qe,D[23]=nt^~Te&et,D[32]=tt^~qe&rt,D[33]=ht^~st&Re,D[42]=Rt^~Dr&Rr,D[43]=yt^~Or&Cr,D[4]=ge^~Ae&Oe,D[5]=$e^~be&Ne,D[14]=je^~He&mt,D[15]=We^~dt&Ge,D[24]=Ze^~Qe&Le,D[25]=Te^~et&Xe,D[34]=qe^~rt&ut,D[35]=st^~Re&Ct,D[44]=Dr^~Rr&Nr,D[45]=Or^~Cr&Qt,D[6]=Ae^~Oe&Fe,D[7]=be^~Ne&ye,D[16]=He^~mt&_e,D[17]=dt^~Ge&De,D[26]=Qe^~Le&pt,D[27]=et^~Xe&St,D[36]=rt^~ut&ct,D[37]=Re^~Ct&Be,D[46]=Rr^~Nr&at,D[47]=Cr^~Qt&Nt,D[8]=Oe^~Fe&Ie,D[9]=Ne^~ye&Ce,D[18]=mt^~_e&ke,D[19]=Ge^~De&xe,D[28]=Le^~pt&Ye,D[29]=Xe^~St&nt,D[38]=ut^~ct&tt,D[39]=Ct^~Be&ht,D[48]=Nr^~at&Rt,D[49]=Qt^~Nt&yt,D[0]^=V[L],D[1]^=V[L+1]};if(d)r.exports=u;else for(A=0;A<y.length;++A)a[y[A]]=u[y[A]]})()})(dg);var v8=dg.exports;const g8=gs(v8),b8="logger/5.7.0";let zp=!1,Fp=!1;const mc={debug:1,default:2,info:2,warning:3,error:4,off:5};let kp=mc.default,Tu=null;function m8(){try{const r=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{r.push(e)}}),r.length)throw new Error("missing "+r.join(", "));if("é".normalize("NFD")!=="é")throw new Error("broken implementation")}catch(r){return r.message}return null}const Hp=m8();var vl;(function(r){r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF"})(vl||(vl={}));var en;(function(r){r.UNKNOWN_ERROR="UNKNOWN_ERROR",r.NOT_IMPLEMENTED="NOT_IMPLEMENTED",r.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.TIMEOUT="TIMEOUT",r.BUFFER_OVERRUN="BUFFER_OVERRUN",r.NUMERIC_FAULT="NUMERIC_FAULT",r.MISSING_NEW="MISSING_NEW",r.INVALID_ARGUMENT="INVALID_ARGUMENT",r.MISSING_ARGUMENT="MISSING_ARGUMENT",r.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",r.CALL_EXCEPTION="CALL_EXCEPTION",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.NONCE_EXPIRED="NONCE_EXPIRED",r.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",r.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",r.TRANSACTION_REPLACED="TRANSACTION_REPLACED",r.ACTION_REJECTED="ACTION_REJECTED"})(en||(en={}));const Kp="0123456789abcdef";class Yt{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const i=e.toLowerCase();mc[i]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(kp>mc[i])&&console.log.apply(console,t)}debug(...e){this._log(Yt.levels.DEBUG,e)}info(...e){this._log(Yt.levels.INFO,e)}warn(...e){this._log(Yt.levels.WARNING,e)}makeError(e,t,i){if(Fp)return this.makeError("censored error",t,{});t||(t=Yt.errors.UNKNOWN_ERROR),i||(i={});const n=[];Object.keys(i).forEach(d=>{const p=i[d];try{if(p instanceof Uint8Array){let b="";for(let w=0;w<p.length;w++)b+=Kp[p[w]>>4],b+=Kp[p[w]&15];n.push(d+"=Uint8Array(0x"+b+")")}else n.push(d+"="+JSON.stringify(p))}catch{n.push(d+"="+JSON.stringify(i[d].toString()))}}),n.push(`code=${t}`),n.push(`version=${this.version}`);const a=e;let c="";switch(t){case en.NUMERIC_FAULT:{c="NUMERIC_FAULT";const d=e;switch(d){case"overflow":case"underflow":case"division-by-zero":c+="-"+d;break;case"negative-power":case"negative-width":c+="-unsupported";break;case"unbound-bitwise-result":c+="-unbound-result";break}break}case en.CALL_EXCEPTION:case en.INSUFFICIENT_FUNDS:case en.MISSING_NEW:case en.NONCE_EXPIRED:case en.REPLACEMENT_UNDERPRICED:case en.TRANSACTION_REPLACED:case en.UNPREDICTABLE_GAS_LIMIT:c=t;break}c&&(e+=" [ See: https://links.ethers.org/v5-errors-"+c+" ]"),n.length&&(e+=" ("+n.join(", ")+")");const h=new Error(e);return h.reason=a,h.code=t,Object.keys(i).forEach(function(d){h[d]=i[d]}),h}throwError(e,t,i){throw this.makeError(e,t,i)}throwArgumentError(e,t,i){return this.throwError(e,Yt.errors.INVALID_ARGUMENT,{argument:t,value:i})}assert(e,t,i,n){e||this.throwError(t,i,n)}assertArgument(e,t,i,n){e||this.throwArgumentError(t,i,n)}checkNormalize(e){Hp&&this.throwError("platform missing String.prototype.normalize",Yt.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Hp})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,Yt.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,Yt.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,i){i?i=": "+i:i="",e<t&&this.throwError("missing argument"+i,Yt.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+i,Yt.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",Yt.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",Yt.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",Yt.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return Tu||(Tu=new Yt(b8)),Tu}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",Yt.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),zp){if(!e)return;this.globalLogger().throwError("error censorship permanent",Yt.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Fp=!!e,zp=!!t}static setLogLevel(e){const t=mc[e.toLowerCase()];if(t==null){Yt.globalLogger().warn("invalid log level - "+e);return}kp=t}static from(e){return new Yt(e)}}Yt.errors=en;Yt.levels=vl;const y8="bytes/5.7.0",or=new Yt(y8);function pg(r){return!!r.toHexString}function Ca(r){return r.slice||(r.slice=function(){const e=Array.prototype.slice.call(arguments);return Ca(new Uint8Array(Array.prototype.slice.apply(r,e)))}),r}function w8(r){return bn(r)&&!(r.length%2)||jl(r)}function jp(r){return typeof r=="number"&&r==r&&r%1===0}function jl(r){if(r==null)return!1;if(r.constructor===Uint8Array)return!0;if(typeof r=="string"||!jp(r.length)||r.length<0)return!1;for(let e=0;e<r.length;e++){const t=r[e];if(!jp(t)||t<0||t>=256)return!1}return!0}function ur(r,e){if(e||(e={}),typeof r=="number"){or.checkSafeUint53(r,"invalid arrayify value");const t=[];for(;r;)t.unshift(r&255),r=parseInt(String(r/256));return t.length===0&&t.push(0),Ca(new Uint8Array(t))}if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),pg(r)&&(r=r.toHexString()),bn(r)){let t=r.substring(2);t.length%2&&(e.hexPad==="left"?t="0"+t:e.hexPad==="right"?t+="0":or.throwArgumentError("hex data is odd-length","value",r));const i=[];for(let n=0;n<t.length;n+=2)i.push(parseInt(t.substring(n,n+2),16));return Ca(new Uint8Array(i))}return jl(r)?Ca(new Uint8Array(r)):or.throwArgumentError("invalid arrayify value","value",r)}function _8(r){const e=r.map(n=>ur(n)),t=e.reduce((n,a)=>n+a.length,0),i=new Uint8Array(t);return e.reduce((n,a)=>(i.set(a,n),n+a.length),0),Ca(i)}function x8(r,e){r=ur(r),r.length>e&&or.throwArgumentError("value out of range","value",arguments[0]);const t=new Uint8Array(e);return t.set(r,e-r.length),Ca(t)}function bn(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||e&&r.length!==2+2*e)}const $u="0123456789abcdef";function di(r,e){if(e||(e={}),typeof r=="number"){or.checkSafeUint53(r,"invalid hexlify value");let t="";for(;r;)t=$u[r&15]+t,r=Math.floor(r/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if(typeof r=="bigint")return r=r.toString(16),r.length%2?"0x0"+r:"0x"+r;if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),pg(r))return r.toHexString();if(bn(r))return r.length%2&&(e.hexPad==="left"?r="0x0"+r.substring(2):e.hexPad==="right"?r+="0":or.throwArgumentError("hex data is odd-length","value",r)),r.toLowerCase();if(jl(r)){let t="0x";for(let i=0;i<r.length;i++){let n=r[i];t+=$u[(n&240)>>4]+$u[n&15]}return t}return or.throwArgumentError("invalid hexlify value","value",r)}function E8(r){if(typeof r!="string")r=di(r);else if(!bn(r)||r.length%2)return null;return(r.length-2)/2}function Wp(r,e,t){return typeof r!="string"?r=di(r):(!bn(r)||r.length%2)&&or.throwArgumentError("invalid hexData","value",r),e=2+2*e,"0x"+r.substring(e)}function Na(r,e){for(typeof r!="string"?r=di(r):bn(r)||or.throwArgumentError("invalid hex string","value",r),r.length>2*e+2&&or.throwArgumentError("value out of range","value",arguments[1]);r.length<2*e+2;)r="0x0"+r.substring(2);return r}function vg(r){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(w8(r)){let t=ur(r);t.length===64?(e.v=27+(t[32]>>7),t[32]&=127,e.r=di(t.slice(0,32)),e.s=di(t.slice(32,64))):t.length===65?(e.r=di(t.slice(0,32)),e.s=di(t.slice(32,64)),e.v=t[64]):or.throwArgumentError("invalid signature string","signature",r),e.v<27&&(e.v===0||e.v===1?e.v+=27:or.throwArgumentError("signature invalid v byte","signature",r)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(t[32]|=128),e._vs=di(t.slice(32,64))}else{if(e.r=r.r,e.s=r.s,e.v=r.v,e.recoveryParam=r.recoveryParam,e._vs=r._vs,e._vs!=null){const n=x8(ur(e._vs),32);e._vs=di(n);const a=n[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=a:e.recoveryParam!==a&&or.throwArgumentError("signature recoveryParam mismatch _vs","signature",r),n[0]&=127;const c=di(n);e.s==null?e.s=c:e.s!==c&&or.throwArgumentError("signature v mismatch _vs","signature",r)}if(e.recoveryParam==null)e.v==null?or.throwArgumentError("signature missing v and recoveryParam","signature",r):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const n=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==n&&or.throwArgumentError("signature recoveryParam mismatch v","signature",r)}e.r==null||!bn(e.r)?or.throwArgumentError("signature missing or invalid r","signature",r):e.r=Na(e.r,32),e.s==null||!bn(e.s)?or.throwArgumentError("signature missing or invalid s","signature",r):e.s=Na(e.s,32);const t=ur(e.s);t[0]>=128&&or.throwArgumentError("signature s out of range","signature",r),e.recoveryParam&&(t[0]|=128);const i=di(t);e._vs&&(bn(e._vs)||or.throwArgumentError("signature invalid _vs","signature",r),e._vs=Na(e._vs,32)),e._vs==null?e._vs=i:e._vs!==i&&or.throwArgumentError("signature _vs mismatch v and s","signature",r)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}function Wl(r){return"0x"+g8.keccak_256(ur(r))}var Vl={exports:{}};const S8={},M8=Object.freeze(Object.defineProperty({__proto__:null,default:S8},Symbol.toStringTag,{value:"Module"})),Gc=Z1(M8);Vl.exports;(function(r){(function(e,t){function i(g,f){if(!g)throw new Error(f||"Assertion failed")}function n(g,f){g.super_=f;var u=function(){};u.prototype=f.prototype,g.prototype=new u,g.prototype.constructor=g}function a(g,f,u){if(a.isBN(g))return g;this.negative=0,this.words=null,this.length=0,this.red=null,g!==null&&((f==="le"||f==="be")&&(u=f,f=10),this._init(g||0,f||10,u||"be"))}typeof e=="object"?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=Gc.Buffer}catch{}a.isBN=function(f){return f instanceof a?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===a.wordSize&&Array.isArray(f.words)},a.max=function(f,u){return f.cmp(u)>0?f:u},a.min=function(f,u){return f.cmp(u)<0?f:u},a.prototype._init=function(f,u,y){if(typeof f=="number")return this._initNumber(f,u,y);if(typeof f=="object")return this._initArray(f,u,y);u==="hex"&&(u=16),i(u===(u|0)&&u>=2&&u<=36),f=f.toString().replace(/\s+/g,"");var A=0;f[0]==="-"&&(A++,this.negative=1),A<f.length&&(u===16?this._parseHex(f,A,y):(this._parseBase(f,u,A),y==="le"&&this._initArray(this.toArray(),u,y)))},a.prototype._initNumber=function(f,u,y){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(i(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),y==="le"&&this._initArray(this.toArray(),u,y)},a.prototype._initArray=function(f,u,y){if(i(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var P,S,v=0;if(y==="be")for(A=f.length-1,P=0;A>=0;A-=3)S=f[A]|f[A-1]<<8|f[A-2]<<16,this.words[P]|=S<<v&67108863,this.words[P+1]=S>>>26-v&67108863,v+=24,v>=26&&(v-=26,P++);else if(y==="le")for(A=0,P=0;A<f.length;A+=3)S=f[A]|f[A+1]<<8|f[A+2]<<16,this.words[P]|=S<<v&67108863,this.words[P+1]=S>>>26-v&67108863,v+=24,v>=26&&(v-=26,P++);return this._strip()};function h(g,f){var u=g.charCodeAt(f);if(u>=48&&u<=57)return u-48;if(u>=65&&u<=70)return u-55;if(u>=97&&u<=102)return u-87;i(!1,"Invalid character in "+g)}function d(g,f,u){var y=h(g,u);return u-1>=f&&(y|=h(g,u-1)<<4),y}a.prototype._parseHex=function(f,u,y){this.length=Math.ceil((f.length-u)/6),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var P=0,S=0,v;if(y==="be")for(A=f.length-1;A>=u;A-=2)v=d(f,u,A)<<P,this.words[S]|=v&67108863,P>=18?(P-=18,S+=1,this.words[S]|=v>>>26):P+=8;else{var E=f.length-u;for(A=E%2===0?u+1:u;A<f.length;A+=2)v=d(f,u,A)<<P,this.words[S]|=v&67108863,P>=18?(P-=18,S+=1,this.words[S]|=v>>>26):P+=8}this._strip()};function p(g,f,u,y){for(var A=0,P=0,S=Math.min(g.length,u),v=f;v<S;v++){var E=g.charCodeAt(v)-48;A*=y,E>=49?P=E-49+10:E>=17?P=E-17+10:P=E,i(E>=0&&P<y,"Invalid character"),A+=P}return A}a.prototype._parseBase=function(f,u,y){this.words=[0],this.length=1;for(var A=0,P=1;P<=67108863;P*=u)A++;A--,P=P/u|0;for(var S=f.length-y,v=S%A,E=Math.min(S,S-v)+y,x=0,T=y;T<E;T+=A)x=p(f,T,T+A,u),this.imuln(P),this.words[0]+x<67108864?this.words[0]+=x:this._iaddn(x);if(v!==0){var ne=1;for(x=p(f,T,f.length,u),T=0;T<v;T++)ne*=u;this.imuln(ne),this.words[0]+x<67108864?this.words[0]+=x:this._iaddn(x)}this._strip()},a.prototype.copy=function(f){f.words=new Array(this.length);for(var u=0;u<this.length;u++)f.words[u]=this.words[u];f.length=this.length,f.negative=this.negative,f.red=this.red};function b(g,f){g.words=f.words,g.length=f.length,g.negative=f.negative,g.red=f.red}if(a.prototype._move=function(f){b(f,this)},a.prototype.clone=function(){var f=new a(null);return this.copy(f),f},a.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=w}catch{a.prototype.inspect=w}else a.prototype.inspect=w;function w(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var R=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],O=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],C=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(f,u){f=f||10,u=u|0||1;var y;if(f===16||f==="hex"){y="";for(var A=0,P=0,S=0;S<this.length;S++){var v=this.words[S],E=((v<<A|P)&16777215).toString(16);P=v>>>24-A&16777215,A+=2,A>=26&&(A-=26,S--),P!==0||S!==this.length-1?y=R[6-E.length]+E+y:y=E+y}for(P!==0&&(y=P.toString(16)+y);y.length%u!==0;)y="0"+y;return this.negative!==0&&(y="-"+y),y}if(f===(f|0)&&f>=2&&f<=36){var x=O[f],T=C[f];y="";var ne=this.clone();for(ne.negative=0;!ne.isZero();){var fe=ne.modrn(T).toString(f);ne=ne.idivn(T),ne.isZero()?y=fe+y:y=R[x-fe.length]+fe+y}for(this.isZero()&&(y="0"+y);y.length%u!==0;)y="0"+y;return this.negative!==0&&(y="-"+y),y}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},a.prototype.toJSON=function(){return this.toString(16,2)},c&&(a.prototype.toBuffer=function(f,u){return this.toArrayLike(c,f,u)}),a.prototype.toArray=function(f,u){return this.toArrayLike(Array,f,u)};var q=function(f,u){return f.allocUnsafe?f.allocUnsafe(u):new f(u)};a.prototype.toArrayLike=function(f,u,y){this._strip();var A=this.byteLength(),P=y||Math.max(1,A);i(A<=P,"byte array longer than desired length"),i(P>0,"Requested array length <= 0");var S=q(f,P),v=u==="le"?"LE":"BE";return this["_toArrayLike"+v](S,A),S},a.prototype._toArrayLikeLE=function(f,u){for(var y=0,A=0,P=0,S=0;P<this.length;P++){var v=this.words[P]<<S|A;f[y++]=v&255,y<f.length&&(f[y++]=v>>8&255),y<f.length&&(f[y++]=v>>16&255),S===6?(y<f.length&&(f[y++]=v>>24&255),A=0,S=0):(A=v>>>24,S+=2)}if(y<f.length)for(f[y++]=A;y<f.length;)f[y++]=0},a.prototype._toArrayLikeBE=function(f,u){for(var y=f.length-1,A=0,P=0,S=0;P<this.length;P++){var v=this.words[P]<<S|A;f[y--]=v&255,y>=0&&(f[y--]=v>>8&255),y>=0&&(f[y--]=v>>16&255),S===6?(y>=0&&(f[y--]=v>>24&255),A=0,S=0):(A=v>>>24,S+=2)}if(y>=0)for(f[y--]=A;y>=0;)f[y--]=0},Math.clz32?a.prototype._countBits=function(f){return 32-Math.clz32(f)}:a.prototype._countBits=function(f){var u=f,y=0;return u>=4096&&(y+=13,u>>>=13),u>=64&&(y+=7,u>>>=7),u>=8&&(y+=4,u>>>=4),u>=2&&(y+=2,u>>>=2),y+u},a.prototype._zeroBits=function(f){if(f===0)return 26;var u=f,y=0;return u&8191||(y+=13,u>>>=13),u&127||(y+=7,u>>>=7),u&15||(y+=4,u>>>=4),u&3||(y+=2,u>>>=2),u&1||y++,y},a.prototype.bitLength=function(){var f=this.words[this.length-1],u=this._countBits(f);return(this.length-1)*26+u};function V(g){for(var f=new Array(g.bitLength()),u=0;u<f.length;u++){var y=u/26|0,A=u%26;f[u]=g.words[y]>>>A&1}return f}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,u=0;u<this.length;u++){var y=this._zeroBits(this.words[u]);if(f+=y,y!==26)break}return f},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},a.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var u=0;u<f.length;u++)this.words[u]=this.words[u]|f.words[u];return this._strip()},a.prototype.ior=function(f){return i((this.negative|f.negative)===0),this.iuor(f)},a.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},a.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},a.prototype.iuand=function(f){var u;this.length>f.length?u=f:u=this;for(var y=0;y<u.length;y++)this.words[y]=this.words[y]&f.words[y];return this.length=u.length,this._strip()},a.prototype.iand=function(f){return i((this.negative|f.negative)===0),this.iuand(f)},a.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},a.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},a.prototype.iuxor=function(f){var u,y;this.length>f.length?(u=this,y=f):(u=f,y=this);for(var A=0;A<y.length;A++)this.words[A]=u.words[A]^y.words[A];if(this!==u)for(;A<u.length;A++)this.words[A]=u.words[A];return this.length=u.length,this._strip()},a.prototype.ixor=function(f){return i((this.negative|f.negative)===0),this.iuxor(f)},a.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},a.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},a.prototype.inotn=function(f){i(typeof f=="number"&&f>=0);var u=Math.ceil(f/26)|0,y=f%26;this._expand(u),y>0&&u--;for(var A=0;A<u;A++)this.words[A]=~this.words[A]&67108863;return y>0&&(this.words[A]=~this.words[A]&67108863>>26-y),this._strip()},a.prototype.notn=function(f){return this.clone().inotn(f)},a.prototype.setn=function(f,u){i(typeof f=="number"&&f>=0);var y=f/26|0,A=f%26;return this._expand(y+1),u?this.words[y]=this.words[y]|1<<A:this.words[y]=this.words[y]&~(1<<A),this._strip()},a.prototype.iadd=function(f){var u;if(this.negative!==0&&f.negative===0)return this.negative=0,u=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,u=this.isub(f),f.negative=1,u._normSign();var y,A;this.length>f.length?(y=this,A=f):(y=f,A=this);for(var P=0,S=0;S<A.length;S++)u=(y.words[S]|0)+(A.words[S]|0)+P,this.words[S]=u&67108863,P=u>>>26;for(;P!==0&&S<y.length;S++)u=(y.words[S]|0)+P,this.words[S]=u&67108863,P=u>>>26;if(this.length=y.length,P!==0)this.words[this.length]=P,this.length++;else if(y!==this)for(;S<y.length;S++)this.words[S]=y.words[S];return this},a.prototype.add=function(f){var u;return f.negative!==0&&this.negative===0?(f.negative=0,u=this.sub(f),f.negative^=1,u):f.negative===0&&this.negative!==0?(this.negative=0,u=f.sub(this),this.negative=1,u):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},a.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var u=this.iadd(f);return f.negative=1,u._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var y=this.cmp(f);if(y===0)return this.negative=0,this.length=1,this.words[0]=0,this;var A,P;y>0?(A=this,P=f):(A=f,P=this);for(var S=0,v=0;v<P.length;v++)u=(A.words[v]|0)-(P.words[v]|0)+S,S=u>>26,this.words[v]=u&67108863;for(;S!==0&&v<A.length;v++)u=(A.words[v]|0)+S,S=u>>26,this.words[v]=u&67108863;if(S===0&&v<A.length&&A!==this)for(;v<A.length;v++)this.words[v]=A.words[v];return this.length=Math.max(this.length,v),A!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(f){return this.clone().isub(f)};function Y(g,f,u){u.negative=f.negative^g.negative;var y=g.length+f.length|0;u.length=y,y=y-1|0;var A=g.words[0]|0,P=f.words[0]|0,S=A*P,v=S&67108863,E=S/67108864|0;u.words[0]=v;for(var x=1;x<y;x++){for(var T=E>>>26,ne=E&67108863,fe=Math.min(x,f.length-1),D=Math.max(0,x-g.length+1);D<=fe;D++){var F=x-D|0;A=g.words[F]|0,P=f.words[D]|0,S=A*P+ne,T+=S/67108864|0,ne=S&67108863}u.words[x]=ne|0,E=T|0}return E!==0?u.words[x]=E|0:u.length--,u._strip()}var H=function(f,u,y){var A=f.words,P=u.words,S=y.words,v=0,E,x,T,ne=A[0]|0,fe=ne&8191,D=ne>>>13,F=A[1]|0,j=F&8191,L=F>>>13,_=A[2]|0,K=_&8191,re=_>>>13,se=A[3]|0,we=se&8191,ce=se>>>13,me=A[4]|0,Ke=me&8191,Me=me>>>13,Je=A[5]|0,Fe=Je&8191,ye=Je>>>13,Ie=A[6]|0,Ce=Ie&8191,ge=Ie>>>13,$e=A[7]|0,Ae=$e&8191,be=$e>>>13,Oe=A[8]|0,Ne=Oe&8191,_e=Oe>>>13,De=A[9]|0,ke=De&8191,xe=De>>>13,je=P[0]|0,We=je&8191,He=je>>>13,dt=P[1]|0,mt=dt&8191,Ge=dt>>>13,pt=P[2]|0,St=pt&8191,Ye=pt>>>13,nt=P[3]|0,Ze=nt&8191,Te=nt>>>13,Qe=P[4]|0,et=Qe&8191,Le=Qe>>>13,Xe=P[5]|0,ct=Xe&8191,Be=Xe>>>13,tt=P[6]|0,ht=tt&8191,qe=tt>>>13,st=P[7]|0,rt=st&8191,Re=st>>>13,ut=P[8]|0,Ct=ut&8191,at=ut>>>13,Nt=P[9]|0,Rt=Nt&8191,yt=Nt>>>13;y.negative=f.negative^u.negative,y.length=19,E=Math.imul(fe,We),x=Math.imul(fe,He),x=x+Math.imul(D,We)|0,T=Math.imul(D,He);var Dr=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Dr>>>26)|0,Dr&=67108863,E=Math.imul(j,We),x=Math.imul(j,He),x=x+Math.imul(L,We)|0,T=Math.imul(L,He),E=E+Math.imul(fe,mt)|0,x=x+Math.imul(fe,Ge)|0,x=x+Math.imul(D,mt)|0,T=T+Math.imul(D,Ge)|0;var Or=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Or>>>26)|0,Or&=67108863,E=Math.imul(K,We),x=Math.imul(K,He),x=x+Math.imul(re,We)|0,T=Math.imul(re,He),E=E+Math.imul(j,mt)|0,x=x+Math.imul(j,Ge)|0,x=x+Math.imul(L,mt)|0,T=T+Math.imul(L,Ge)|0,E=E+Math.imul(fe,St)|0,x=x+Math.imul(fe,Ye)|0,x=x+Math.imul(D,St)|0,T=T+Math.imul(D,Ye)|0;var Rr=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Rr>>>26)|0,Rr&=67108863,E=Math.imul(we,We),x=Math.imul(we,He),x=x+Math.imul(ce,We)|0,T=Math.imul(ce,He),E=E+Math.imul(K,mt)|0,x=x+Math.imul(K,Ge)|0,x=x+Math.imul(re,mt)|0,T=T+Math.imul(re,Ge)|0,E=E+Math.imul(j,St)|0,x=x+Math.imul(j,Ye)|0,x=x+Math.imul(L,St)|0,T=T+Math.imul(L,Ye)|0,E=E+Math.imul(fe,Ze)|0,x=x+Math.imul(fe,Te)|0,x=x+Math.imul(D,Ze)|0,T=T+Math.imul(D,Te)|0;var Cr=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Cr>>>26)|0,Cr&=67108863,E=Math.imul(Ke,We),x=Math.imul(Ke,He),x=x+Math.imul(Me,We)|0,T=Math.imul(Me,He),E=E+Math.imul(we,mt)|0,x=x+Math.imul(we,Ge)|0,x=x+Math.imul(ce,mt)|0,T=T+Math.imul(ce,Ge)|0,E=E+Math.imul(K,St)|0,x=x+Math.imul(K,Ye)|0,x=x+Math.imul(re,St)|0,T=T+Math.imul(re,Ye)|0,E=E+Math.imul(j,Ze)|0,x=x+Math.imul(j,Te)|0,x=x+Math.imul(L,Ze)|0,T=T+Math.imul(L,Te)|0,E=E+Math.imul(fe,et)|0,x=x+Math.imul(fe,Le)|0,x=x+Math.imul(D,et)|0,T=T+Math.imul(D,Le)|0;var Nr=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,E=Math.imul(Fe,We),x=Math.imul(Fe,He),x=x+Math.imul(ye,We)|0,T=Math.imul(ye,He),E=E+Math.imul(Ke,mt)|0,x=x+Math.imul(Ke,Ge)|0,x=x+Math.imul(Me,mt)|0,T=T+Math.imul(Me,Ge)|0,E=E+Math.imul(we,St)|0,x=x+Math.imul(we,Ye)|0,x=x+Math.imul(ce,St)|0,T=T+Math.imul(ce,Ye)|0,E=E+Math.imul(K,Ze)|0,x=x+Math.imul(K,Te)|0,x=x+Math.imul(re,Ze)|0,T=T+Math.imul(re,Te)|0,E=E+Math.imul(j,et)|0,x=x+Math.imul(j,Le)|0,x=x+Math.imul(L,et)|0,T=T+Math.imul(L,Le)|0,E=E+Math.imul(fe,ct)|0,x=x+Math.imul(fe,Be)|0,x=x+Math.imul(D,ct)|0,T=T+Math.imul(D,Be)|0;var Qt=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,E=Math.imul(Ce,We),x=Math.imul(Ce,He),x=x+Math.imul(ge,We)|0,T=Math.imul(ge,He),E=E+Math.imul(Fe,mt)|0,x=x+Math.imul(Fe,Ge)|0,x=x+Math.imul(ye,mt)|0,T=T+Math.imul(ye,Ge)|0,E=E+Math.imul(Ke,St)|0,x=x+Math.imul(Ke,Ye)|0,x=x+Math.imul(Me,St)|0,T=T+Math.imul(Me,Ye)|0,E=E+Math.imul(we,Ze)|0,x=x+Math.imul(we,Te)|0,x=x+Math.imul(ce,Ze)|0,T=T+Math.imul(ce,Te)|0,E=E+Math.imul(K,et)|0,x=x+Math.imul(K,Le)|0,x=x+Math.imul(re,et)|0,T=T+Math.imul(re,Le)|0,E=E+Math.imul(j,ct)|0,x=x+Math.imul(j,Be)|0,x=x+Math.imul(L,ct)|0,T=T+Math.imul(L,Be)|0,E=E+Math.imul(fe,ht)|0,x=x+Math.imul(fe,qe)|0,x=x+Math.imul(D,ht)|0,T=T+Math.imul(D,qe)|0;var Wr=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Wr>>>26)|0,Wr&=67108863,E=Math.imul(Ae,We),x=Math.imul(Ae,He),x=x+Math.imul(be,We)|0,T=Math.imul(be,He),E=E+Math.imul(Ce,mt)|0,x=x+Math.imul(Ce,Ge)|0,x=x+Math.imul(ge,mt)|0,T=T+Math.imul(ge,Ge)|0,E=E+Math.imul(Fe,St)|0,x=x+Math.imul(Fe,Ye)|0,x=x+Math.imul(ye,St)|0,T=T+Math.imul(ye,Ye)|0,E=E+Math.imul(Ke,Ze)|0,x=x+Math.imul(Ke,Te)|0,x=x+Math.imul(Me,Ze)|0,T=T+Math.imul(Me,Te)|0,E=E+Math.imul(we,et)|0,x=x+Math.imul(we,Le)|0,x=x+Math.imul(ce,et)|0,T=T+Math.imul(ce,Le)|0,E=E+Math.imul(K,ct)|0,x=x+Math.imul(K,Be)|0,x=x+Math.imul(re,ct)|0,T=T+Math.imul(re,Be)|0,E=E+Math.imul(j,ht)|0,x=x+Math.imul(j,qe)|0,x=x+Math.imul(L,ht)|0,T=T+Math.imul(L,qe)|0,E=E+Math.imul(fe,rt)|0,x=x+Math.imul(fe,Re)|0,x=x+Math.imul(D,rt)|0,T=T+Math.imul(D,Re)|0;var Bi=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Bi>>>26)|0,Bi&=67108863,E=Math.imul(Ne,We),x=Math.imul(Ne,He),x=x+Math.imul(_e,We)|0,T=Math.imul(_e,He),E=E+Math.imul(Ae,mt)|0,x=x+Math.imul(Ae,Ge)|0,x=x+Math.imul(be,mt)|0,T=T+Math.imul(be,Ge)|0,E=E+Math.imul(Ce,St)|0,x=x+Math.imul(Ce,Ye)|0,x=x+Math.imul(ge,St)|0,T=T+Math.imul(ge,Ye)|0,E=E+Math.imul(Fe,Ze)|0,x=x+Math.imul(Fe,Te)|0,x=x+Math.imul(ye,Ze)|0,T=T+Math.imul(ye,Te)|0,E=E+Math.imul(Ke,et)|0,x=x+Math.imul(Ke,Le)|0,x=x+Math.imul(Me,et)|0,T=T+Math.imul(Me,Le)|0,E=E+Math.imul(we,ct)|0,x=x+Math.imul(we,Be)|0,x=x+Math.imul(ce,ct)|0,T=T+Math.imul(ce,Be)|0,E=E+Math.imul(K,ht)|0,x=x+Math.imul(K,qe)|0,x=x+Math.imul(re,ht)|0,T=T+Math.imul(re,qe)|0,E=E+Math.imul(j,rt)|0,x=x+Math.imul(j,Re)|0,x=x+Math.imul(L,rt)|0,T=T+Math.imul(L,Re)|0,E=E+Math.imul(fe,Ct)|0,x=x+Math.imul(fe,at)|0,x=x+Math.imul(D,Ct)|0,T=T+Math.imul(D,at)|0;var Vr=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Vr>>>26)|0,Vr&=67108863,E=Math.imul(ke,We),x=Math.imul(ke,He),x=x+Math.imul(xe,We)|0,T=Math.imul(xe,He),E=E+Math.imul(Ne,mt)|0,x=x+Math.imul(Ne,Ge)|0,x=x+Math.imul(_e,mt)|0,T=T+Math.imul(_e,Ge)|0,E=E+Math.imul(Ae,St)|0,x=x+Math.imul(Ae,Ye)|0,x=x+Math.imul(be,St)|0,T=T+Math.imul(be,Ye)|0,E=E+Math.imul(Ce,Ze)|0,x=x+Math.imul(Ce,Te)|0,x=x+Math.imul(ge,Ze)|0,T=T+Math.imul(ge,Te)|0,E=E+Math.imul(Fe,et)|0,x=x+Math.imul(Fe,Le)|0,x=x+Math.imul(ye,et)|0,T=T+Math.imul(ye,Le)|0,E=E+Math.imul(Ke,ct)|0,x=x+Math.imul(Ke,Be)|0,x=x+Math.imul(Me,ct)|0,T=T+Math.imul(Me,Be)|0,E=E+Math.imul(we,ht)|0,x=x+Math.imul(we,qe)|0,x=x+Math.imul(ce,ht)|0,T=T+Math.imul(ce,qe)|0,E=E+Math.imul(K,rt)|0,x=x+Math.imul(K,Re)|0,x=x+Math.imul(re,rt)|0,T=T+Math.imul(re,Re)|0,E=E+Math.imul(j,Ct)|0,x=x+Math.imul(j,at)|0,x=x+Math.imul(L,Ct)|0,T=T+Math.imul(L,at)|0,E=E+Math.imul(fe,Rt)|0,x=x+Math.imul(fe,yt)|0,x=x+Math.imul(D,Rt)|0,T=T+Math.imul(D,yt)|0;var zi=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(zi>>>26)|0,zi&=67108863,E=Math.imul(ke,mt),x=Math.imul(ke,Ge),x=x+Math.imul(xe,mt)|0,T=Math.imul(xe,Ge),E=E+Math.imul(Ne,St)|0,x=x+Math.imul(Ne,Ye)|0,x=x+Math.imul(_e,St)|0,T=T+Math.imul(_e,Ye)|0,E=E+Math.imul(Ae,Ze)|0,x=x+Math.imul(Ae,Te)|0,x=x+Math.imul(be,Ze)|0,T=T+Math.imul(be,Te)|0,E=E+Math.imul(Ce,et)|0,x=x+Math.imul(Ce,Le)|0,x=x+Math.imul(ge,et)|0,T=T+Math.imul(ge,Le)|0,E=E+Math.imul(Fe,ct)|0,x=x+Math.imul(Fe,Be)|0,x=x+Math.imul(ye,ct)|0,T=T+Math.imul(ye,Be)|0,E=E+Math.imul(Ke,ht)|0,x=x+Math.imul(Ke,qe)|0,x=x+Math.imul(Me,ht)|0,T=T+Math.imul(Me,qe)|0,E=E+Math.imul(we,rt)|0,x=x+Math.imul(we,Re)|0,x=x+Math.imul(ce,rt)|0,T=T+Math.imul(ce,Re)|0,E=E+Math.imul(K,Ct)|0,x=x+Math.imul(K,at)|0,x=x+Math.imul(re,Ct)|0,T=T+Math.imul(re,at)|0,E=E+Math.imul(j,Rt)|0,x=x+Math.imul(j,yt)|0,x=x+Math.imul(L,Rt)|0,T=T+Math.imul(L,yt)|0;var Fi=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Fi>>>26)|0,Fi&=67108863,E=Math.imul(ke,St),x=Math.imul(ke,Ye),x=x+Math.imul(xe,St)|0,T=Math.imul(xe,Ye),E=E+Math.imul(Ne,Ze)|0,x=x+Math.imul(Ne,Te)|0,x=x+Math.imul(_e,Ze)|0,T=T+Math.imul(_e,Te)|0,E=E+Math.imul(Ae,et)|0,x=x+Math.imul(Ae,Le)|0,x=x+Math.imul(be,et)|0,T=T+Math.imul(be,Le)|0,E=E+Math.imul(Ce,ct)|0,x=x+Math.imul(Ce,Be)|0,x=x+Math.imul(ge,ct)|0,T=T+Math.imul(ge,Be)|0,E=E+Math.imul(Fe,ht)|0,x=x+Math.imul(Fe,qe)|0,x=x+Math.imul(ye,ht)|0,T=T+Math.imul(ye,qe)|0,E=E+Math.imul(Ke,rt)|0,x=x+Math.imul(Ke,Re)|0,x=x+Math.imul(Me,rt)|0,T=T+Math.imul(Me,Re)|0,E=E+Math.imul(we,Ct)|0,x=x+Math.imul(we,at)|0,x=x+Math.imul(ce,Ct)|0,T=T+Math.imul(ce,at)|0,E=E+Math.imul(K,Rt)|0,x=x+Math.imul(K,yt)|0,x=x+Math.imul(re,Rt)|0,T=T+Math.imul(re,yt)|0;var Gr=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Gr>>>26)|0,Gr&=67108863,E=Math.imul(ke,Ze),x=Math.imul(ke,Te),x=x+Math.imul(xe,Ze)|0,T=Math.imul(xe,Te),E=E+Math.imul(Ne,et)|0,x=x+Math.imul(Ne,Le)|0,x=x+Math.imul(_e,et)|0,T=T+Math.imul(_e,Le)|0,E=E+Math.imul(Ae,ct)|0,x=x+Math.imul(Ae,Be)|0,x=x+Math.imul(be,ct)|0,T=T+Math.imul(be,Be)|0,E=E+Math.imul(Ce,ht)|0,x=x+Math.imul(Ce,qe)|0,x=x+Math.imul(ge,ht)|0,T=T+Math.imul(ge,qe)|0,E=E+Math.imul(Fe,rt)|0,x=x+Math.imul(Fe,Re)|0,x=x+Math.imul(ye,rt)|0,T=T+Math.imul(ye,Re)|0,E=E+Math.imul(Ke,Ct)|0,x=x+Math.imul(Ke,at)|0,x=x+Math.imul(Me,Ct)|0,T=T+Math.imul(Me,at)|0,E=E+Math.imul(we,Rt)|0,x=x+Math.imul(we,yt)|0,x=x+Math.imul(ce,Rt)|0,T=T+Math.imul(ce,yt)|0;var yi=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(yi>>>26)|0,yi&=67108863,E=Math.imul(ke,et),x=Math.imul(ke,Le),x=x+Math.imul(xe,et)|0,T=Math.imul(xe,Le),E=E+Math.imul(Ne,ct)|0,x=x+Math.imul(Ne,Be)|0,x=x+Math.imul(_e,ct)|0,T=T+Math.imul(_e,Be)|0,E=E+Math.imul(Ae,ht)|0,x=x+Math.imul(Ae,qe)|0,x=x+Math.imul(be,ht)|0,T=T+Math.imul(be,qe)|0,E=E+Math.imul(Ce,rt)|0,x=x+Math.imul(Ce,Re)|0,x=x+Math.imul(ge,rt)|0,T=T+Math.imul(ge,Re)|0,E=E+Math.imul(Fe,Ct)|0,x=x+Math.imul(Fe,at)|0,x=x+Math.imul(ye,Ct)|0,T=T+Math.imul(ye,at)|0,E=E+Math.imul(Ke,Rt)|0,x=x+Math.imul(Ke,yt)|0,x=x+Math.imul(Me,Rt)|0,T=T+Math.imul(Me,yt)|0;var wi=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(wi>>>26)|0,wi&=67108863,E=Math.imul(ke,ct),x=Math.imul(ke,Be),x=x+Math.imul(xe,ct)|0,T=Math.imul(xe,Be),E=E+Math.imul(Ne,ht)|0,x=x+Math.imul(Ne,qe)|0,x=x+Math.imul(_e,ht)|0,T=T+Math.imul(_e,qe)|0,E=E+Math.imul(Ae,rt)|0,x=x+Math.imul(Ae,Re)|0,x=x+Math.imul(be,rt)|0,T=T+Math.imul(be,Re)|0,E=E+Math.imul(Ce,Ct)|0,x=x+Math.imul(Ce,at)|0,x=x+Math.imul(ge,Ct)|0,T=T+Math.imul(ge,at)|0,E=E+Math.imul(Fe,Rt)|0,x=x+Math.imul(Fe,yt)|0,x=x+Math.imul(ye,Rt)|0,T=T+Math.imul(ye,yt)|0;var lr=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(lr>>>26)|0,lr&=67108863,E=Math.imul(ke,ht),x=Math.imul(ke,qe),x=x+Math.imul(xe,ht)|0,T=Math.imul(xe,qe),E=E+Math.imul(Ne,rt)|0,x=x+Math.imul(Ne,Re)|0,x=x+Math.imul(_e,rt)|0,T=T+Math.imul(_e,Re)|0,E=E+Math.imul(Ae,Ct)|0,x=x+Math.imul(Ae,at)|0,x=x+Math.imul(be,Ct)|0,T=T+Math.imul(be,at)|0,E=E+Math.imul(Ce,Rt)|0,x=x+Math.imul(Ce,yt)|0,x=x+Math.imul(ge,Rt)|0,T=T+Math.imul(ge,yt)|0;var ki=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(ki>>>26)|0,ki&=67108863,E=Math.imul(ke,rt),x=Math.imul(ke,Re),x=x+Math.imul(xe,rt)|0,T=Math.imul(xe,Re),E=E+Math.imul(Ne,Ct)|0,x=x+Math.imul(Ne,at)|0,x=x+Math.imul(_e,Ct)|0,T=T+Math.imul(_e,at)|0,E=E+Math.imul(Ae,Rt)|0,x=x+Math.imul(Ae,yt)|0,x=x+Math.imul(be,Rt)|0,T=T+Math.imul(be,yt)|0;var Hi=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(Hi>>>26)|0,Hi&=67108863,E=Math.imul(ke,Ct),x=Math.imul(ke,at),x=x+Math.imul(xe,Ct)|0,T=Math.imul(xe,at),E=E+Math.imul(Ne,Rt)|0,x=x+Math.imul(Ne,yt)|0,x=x+Math.imul(_e,Rt)|0,T=T+Math.imul(_e,yt)|0;var _s=(v+E|0)+((x&8191)<<13)|0;v=(T+(x>>>13)|0)+(_s>>>26)|0,_s&=67108863,E=Math.imul(ke,Rt),x=Math.imul(ke,yt),x=x+Math.imul(xe,Rt)|0,T=Math.imul(xe,yt);var xs=(v+E|0)+((x&8191)<<13)|0;return v=(T+(x>>>13)|0)+(xs>>>26)|0,xs&=67108863,S[0]=Dr,S[1]=Or,S[2]=Rr,S[3]=Cr,S[4]=Nr,S[5]=Qt,S[6]=Wr,S[7]=Bi,S[8]=Vr,S[9]=zi,S[10]=Fi,S[11]=Gr,S[12]=yi,S[13]=wi,S[14]=lr,S[15]=ki,S[16]=Hi,S[17]=_s,S[18]=xs,v!==0&&(S[19]=v,y.length++),y};Math.imul||(H=Y);function X(g,f,u){u.negative=f.negative^g.negative,u.length=g.length+f.length;for(var y=0,A=0,P=0;P<u.length-1;P++){var S=A;A=0;for(var v=y&67108863,E=Math.min(P,f.length-1),x=Math.max(0,P-g.length+1);x<=E;x++){var T=P-x,ne=g.words[T]|0,fe=f.words[x]|0,D=ne*fe,F=D&67108863;S=S+(D/67108864|0)|0,F=F+v|0,v=F&67108863,S=S+(F>>>26)|0,A+=S>>>26,S&=67108863}u.words[P]=v,y=S,S=A}return y!==0?u.words[P]=y:u.length--,u._strip()}function k(g,f,u){return X(g,f,u)}a.prototype.mulTo=function(f,u){var y,A=this.length+f.length;return this.length===10&&f.length===10?y=H(this,f,u):A<63?y=Y(this,f,u):A<1024?y=X(this,f,u):y=k(this,f,u),y},a.prototype.mul=function(f){var u=new a(null);return u.words=new Array(this.length+f.length),this.mulTo(f,u)},a.prototype.mulf=function(f){var u=new a(null);return u.words=new Array(this.length+f.length),k(this,f,u)},a.prototype.imul=function(f){return this.clone().mulTo(f,this)},a.prototype.imuln=function(f){var u=f<0;u&&(f=-f),i(typeof f=="number"),i(f<67108864);for(var y=0,A=0;A<this.length;A++){var P=(this.words[A]|0)*f,S=(P&67108863)+(y&67108863);y>>=26,y+=P/67108864|0,y+=S>>>26,this.words[A]=S&67108863}return y!==0&&(this.words[A]=y,this.length++),u?this.ineg():this},a.prototype.muln=function(f){return this.clone().imuln(f)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(f){var u=V(f);if(u.length===0)return new a(1);for(var y=this,A=0;A<u.length&&u[A]===0;A++,y=y.sqr());if(++A<u.length)for(var P=y.sqr();A<u.length;A++,P=P.sqr())u[A]!==0&&(y=y.mul(P));return y},a.prototype.iushln=function(f){i(typeof f=="number"&&f>=0);var u=f%26,y=(f-u)/26,A=67108863>>>26-u<<26-u,P;if(u!==0){var S=0;for(P=0;P<this.length;P++){var v=this.words[P]&A,E=(this.words[P]|0)-v<<u;this.words[P]=E|S,S=v>>>26-u}S&&(this.words[P]=S,this.length++)}if(y!==0){for(P=this.length-1;P>=0;P--)this.words[P+y]=this.words[P];for(P=0;P<y;P++)this.words[P]=0;this.length+=y}return this._strip()},a.prototype.ishln=function(f){return i(this.negative===0),this.iushln(f)},a.prototype.iushrn=function(f,u,y){i(typeof f=="number"&&f>=0);var A;u?A=(u-u%26)/26:A=0;var P=f%26,S=Math.min((f-P)/26,this.length),v=67108863^67108863>>>P<<P,E=y;if(A-=S,A=Math.max(0,A),E){for(var x=0;x<S;x++)E.words[x]=this.words[x];E.length=S}if(S!==0)if(this.length>S)for(this.length-=S,x=0;x<this.length;x++)this.words[x]=this.words[x+S];else this.words[0]=0,this.length=1;var T=0;for(x=this.length-1;x>=0&&(T!==0||x>=A);x--){var ne=this.words[x]|0;this.words[x]=T<<26-P|ne>>>P,T=ne&v}return E&&T!==0&&(E.words[E.length++]=T),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(f,u,y){return i(this.negative===0),this.iushrn(f,u,y)},a.prototype.shln=function(f){return this.clone().ishln(f)},a.prototype.ushln=function(f){return this.clone().iushln(f)},a.prototype.shrn=function(f){return this.clone().ishrn(f)},a.prototype.ushrn=function(f){return this.clone().iushrn(f)},a.prototype.testn=function(f){i(typeof f=="number"&&f>=0);var u=f%26,y=(f-u)/26,A=1<<u;if(this.length<=y)return!1;var P=this.words[y];return!!(P&A)},a.prototype.imaskn=function(f){i(typeof f=="number"&&f>=0);var u=f%26,y=(f-u)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=y)return this;if(u!==0&&y++,this.length=Math.min(y,this.length),u!==0){var A=67108863^67108863>>>u<<u;this.words[this.length-1]&=A}return this._strip()},a.prototype.maskn=function(f){return this.clone().imaskn(f)},a.prototype.iaddn=function(f){return i(typeof f=="number"),i(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<=f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},a.prototype._iaddn=function(f){this.words[0]+=f;for(var u=0;u<this.length&&this.words[u]>=67108864;u++)this.words[u]-=67108864,u===this.length-1?this.words[u+1]=1:this.words[u+1]++;return this.length=Math.max(this.length,u+1),this},a.prototype.isubn=function(f){if(i(typeof f=="number"),i(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var u=0;u<this.length&&this.words[u]<0;u++)this.words[u]+=67108864,this.words[u+1]-=1;return this._strip()},a.prototype.addn=function(f){return this.clone().iaddn(f)},a.prototype.subn=function(f){return this.clone().isubn(f)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(f,u,y){var A=f.length+y,P;this._expand(A);var S,v=0;for(P=0;P<f.length;P++){S=(this.words[P+y]|0)+v;var E=(f.words[P]|0)*u;S-=E&67108863,v=(S>>26)-(E/67108864|0),this.words[P+y]=S&67108863}for(;P<this.length-y;P++)S=(this.words[P+y]|0)+v,v=S>>26,this.words[P+y]=S&67108863;if(v===0)return this._strip();for(i(v===-1),v=0,P=0;P<this.length;P++)S=-(this.words[P]|0)+v,v=S>>26,this.words[P]=S&67108863;return this.negative=1,this._strip()},a.prototype._wordDiv=function(f,u){var y=this.length-f.length,A=this.clone(),P=f,S=P.words[P.length-1]|0,v=this._countBits(S);y=26-v,y!==0&&(P=P.ushln(y),A.iushln(y),S=P.words[P.length-1]|0);var E=A.length-P.length,x;if(u!=="mod"){x=new a(null),x.length=E+1,x.words=new Array(x.length);for(var T=0;T<x.length;T++)x.words[T]=0}var ne=A.clone()._ishlnsubmul(P,1,E);ne.negative===0&&(A=ne,x&&(x.words[E]=1));for(var fe=E-1;fe>=0;fe--){var D=(A.words[P.length+fe]|0)*67108864+(A.words[P.length+fe-1]|0);for(D=Math.min(D/S|0,67108863),A._ishlnsubmul(P,D,fe);A.negative!==0;)D--,A.negative=0,A._ishlnsubmul(P,1,fe),A.isZero()||(A.negative^=1);x&&(x.words[fe]=D)}return x&&x._strip(),A._strip(),u!=="div"&&y!==0&&A.iushrn(y),{div:x||null,mod:A}},a.prototype.divmod=function(f,u,y){if(i(!f.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var A,P,S;return this.negative!==0&&f.negative===0?(S=this.neg().divmod(f,u),u!=="mod"&&(A=S.div.neg()),u!=="div"&&(P=S.mod.neg(),y&&P.negative!==0&&P.iadd(f)),{div:A,mod:P}):this.negative===0&&f.negative!==0?(S=this.divmod(f.neg(),u),u!=="mod"&&(A=S.div.neg()),{div:A,mod:S.mod}):this.negative&f.negative?(S=this.neg().divmod(f.neg(),u),u!=="div"&&(P=S.mod.neg(),y&&P.negative!==0&&P.isub(f)),{div:S.div,mod:P}):f.length>this.length||this.cmp(f)<0?{div:new a(0),mod:this}:f.length===1?u==="div"?{div:this.divn(f.words[0]),mod:null}:u==="mod"?{div:null,mod:new a(this.modrn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new a(this.modrn(f.words[0]))}:this._wordDiv(f,u)},a.prototype.div=function(f){return this.divmod(f,"div",!1).div},a.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},a.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},a.prototype.divRound=function(f){var u=this.divmod(f);if(u.mod.isZero())return u.div;var y=u.div.negative!==0?u.mod.isub(f):u.mod,A=f.ushrn(1),P=f.andln(1),S=y.cmp(A);return S<0||P===1&&S===0?u.div:u.div.negative!==0?u.div.isubn(1):u.div.iaddn(1)},a.prototype.modrn=function(f){var u=f<0;u&&(f=-f),i(f<=67108863);for(var y=(1<<26)%f,A=0,P=this.length-1;P>=0;P--)A=(y*A+(this.words[P]|0))%f;return u?-A:A},a.prototype.modn=function(f){return this.modrn(f)},a.prototype.idivn=function(f){var u=f<0;u&&(f=-f),i(f<=67108863);for(var y=0,A=this.length-1;A>=0;A--){var P=(this.words[A]|0)+y*67108864;this.words[A]=P/f|0,y=P%f}return this._strip(),u?this.ineg():this},a.prototype.divn=function(f){return this.clone().idivn(f)},a.prototype.egcd=function(f){i(f.negative===0),i(!f.isZero());var u=this,y=f.clone();u.negative!==0?u=u.umod(f):u=u.clone();for(var A=new a(1),P=new a(0),S=new a(0),v=new a(1),E=0;u.isEven()&&y.isEven();)u.iushrn(1),y.iushrn(1),++E;for(var x=y.clone(),T=u.clone();!u.isZero();){for(var ne=0,fe=1;!(u.words[0]&fe)&&ne<26;++ne,fe<<=1);if(ne>0)for(u.iushrn(ne);ne-- >0;)(A.isOdd()||P.isOdd())&&(A.iadd(x),P.isub(T)),A.iushrn(1),P.iushrn(1);for(var D=0,F=1;!(y.words[0]&F)&&D<26;++D,F<<=1);if(D>0)for(y.iushrn(D);D-- >0;)(S.isOdd()||v.isOdd())&&(S.iadd(x),v.isub(T)),S.iushrn(1),v.iushrn(1);u.cmp(y)>=0?(u.isub(y),A.isub(S),P.isub(v)):(y.isub(u),S.isub(A),v.isub(P))}return{a:S,b:v,gcd:y.iushln(E)}},a.prototype._invmp=function(f){i(f.negative===0),i(!f.isZero());var u=this,y=f.clone();u.negative!==0?u=u.umod(f):u=u.clone();for(var A=new a(1),P=new a(0),S=y.clone();u.cmpn(1)>0&&y.cmpn(1)>0;){for(var v=0,E=1;!(u.words[0]&E)&&v<26;++v,E<<=1);if(v>0)for(u.iushrn(v);v-- >0;)A.isOdd()&&A.iadd(S),A.iushrn(1);for(var x=0,T=1;!(y.words[0]&T)&&x<26;++x,T<<=1);if(x>0)for(y.iushrn(x);x-- >0;)P.isOdd()&&P.iadd(S),P.iushrn(1);u.cmp(y)>=0?(u.isub(y),A.isub(P)):(y.isub(u),P.isub(A))}var ne;return u.cmpn(1)===0?ne=A:ne=P,ne.cmpn(0)<0&&ne.iadd(f),ne},a.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var u=this.clone(),y=f.clone();u.negative=0,y.negative=0;for(var A=0;u.isEven()&&y.isEven();A++)u.iushrn(1),y.iushrn(1);do{for(;u.isEven();)u.iushrn(1);for(;y.isEven();)y.iushrn(1);var P=u.cmp(y);if(P<0){var S=u;u=y,y=S}else if(P===0||y.cmpn(1)===0)break;u.isub(y)}while(!0);return y.iushln(A)},a.prototype.invm=function(f){return this.egcd(f).a.umod(f)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(f){return this.words[0]&f},a.prototype.bincn=function(f){i(typeof f=="number");var u=f%26,y=(f-u)/26,A=1<<u;if(this.length<=y)return this._expand(y+1),this.words[y]|=A,this;for(var P=A,S=y;P!==0&&S<this.length;S++){var v=this.words[S]|0;v+=P,P=v>>>26,v&=67108863,this.words[S]=v}return P!==0&&(this.words[S]=P,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(f){var u=f<0;if(this.negative!==0&&!u)return-1;if(this.negative===0&&u)return 1;this._strip();var y;if(this.length>1)y=1;else{u&&(f=-f),i(f<=67108863,"Number is too big");var A=this.words[0]|0;y=A===f?0:A<f?-1:1}return this.negative!==0?-y|0:y},a.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var u=this.ucmp(f);return this.negative!==0?-u|0:u},a.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var u=0,y=this.length-1;y>=0;y--){var A=this.words[y]|0,P=f.words[y]|0;if(A!==P){A<P?u=-1:A>P&&(u=1);break}}return u},a.prototype.gtn=function(f){return this.cmpn(f)===1},a.prototype.gt=function(f){return this.cmp(f)===1},a.prototype.gten=function(f){return this.cmpn(f)>=0},a.prototype.gte=function(f){return this.cmp(f)>=0},a.prototype.ltn=function(f){return this.cmpn(f)===-1},a.prototype.lt=function(f){return this.cmp(f)===-1},a.prototype.lten=function(f){return this.cmpn(f)<=0},a.prototype.lte=function(f){return this.cmp(f)<=0},a.prototype.eqn=function(f){return this.cmpn(f)===0},a.prototype.eq=function(f){return this.cmp(f)===0},a.red=function(f){return new U(f)},a.prototype.toRed=function(f){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(f){return this.red=f,this},a.prototype.forceRed=function(f){return i(!this.red,"Already a number in reduction context"),this._forceRed(f)},a.prototype.redAdd=function(f){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},a.prototype.redIAdd=function(f){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},a.prototype.redSub=function(f){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},a.prototype.redISub=function(f){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},a.prototype.redShl=function(f){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},a.prototype.redMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},a.prototype.redIMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(f){return i(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var W={k256:null,p224:null,p192:null,p25519:null};function J(g,f){this.name=g,this.p=new a(f,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}J.prototype._tmp=function(){var f=new a(null);return f.words=new Array(Math.ceil(this.n/13)),f},J.prototype.ireduce=function(f){var u=f,y;do this.split(u,this.tmp),u=this.imulK(u),u=u.iadd(this.tmp),y=u.bitLength();while(y>this.n);var A=y<this.n?-1:u.ucmp(this.p);return A===0?(u.words[0]=0,u.length=1):A>0?u.isub(this.p):u.strip!==void 0?u.strip():u._strip(),u},J.prototype.split=function(f,u){f.iushrn(this.n,0,u)},J.prototype.imulK=function(f){return f.imul(this.k)};function M(){J.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(M,J),M.prototype.split=function(f,u){for(var y=4194303,A=Math.min(f.length,9),P=0;P<A;P++)u.words[P]=f.words[P];if(u.length=A,f.length<=9){f.words[0]=0,f.length=1;return}var S=f.words[9];for(u.words[u.length++]=S&y,P=10;P<f.length;P++){var v=f.words[P]|0;f.words[P-10]=(v&y)<<4|S>>>22,S=v}S>>>=22,f.words[P-10]=S,S===0&&f.length>10?f.length-=10:f.length-=9},M.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var u=0,y=0;y<f.length;y++){var A=f.words[y]|0;u+=A*977,f.words[y]=u&67108863,u=A*64+(u/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function B(){J.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(B,J);function ae(){J.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(ae,J);function de(){J.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(de,J),de.prototype.imulK=function(f){for(var u=0,y=0;y<f.length;y++){var A=(f.words[y]|0)*19+u,P=A&67108863;A>>>=26,f.words[y]=P,u=A}return u!==0&&(f.words[f.length++]=u),f},a._prime=function(f){if(W[f])return W[f];var u;if(f==="k256")u=new M;else if(f==="p224")u=new B;else if(f==="p192")u=new ae;else if(f==="p25519")u=new de;else throw new Error("Unknown prime "+f);return W[f]=u,u};function U(g){if(typeof g=="string"){var f=a._prime(g);this.m=f.p,this.prime=f}else i(g.gtn(1),"modulus must be greater than 1"),this.m=g,this.prime=null}U.prototype._verify1=function(f){i(f.negative===0,"red works only with positives"),i(f.red,"red works only with red numbers")},U.prototype._verify2=function(f,u){i((f.negative|u.negative)===0,"red works only with positives"),i(f.red&&f.red===u.red,"red works only with red numbers")},U.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):(b(f,f.umod(this.m)._forceRed(this)),f)},U.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},U.prototype.add=function(f,u){this._verify2(f,u);var y=f.add(u);return y.cmp(this.m)>=0&&y.isub(this.m),y._forceRed(this)},U.prototype.iadd=function(f,u){this._verify2(f,u);var y=f.iadd(u);return y.cmp(this.m)>=0&&y.isub(this.m),y},U.prototype.sub=function(f,u){this._verify2(f,u);var y=f.sub(u);return y.cmpn(0)<0&&y.iadd(this.m),y._forceRed(this)},U.prototype.isub=function(f,u){this._verify2(f,u);var y=f.isub(u);return y.cmpn(0)<0&&y.iadd(this.m),y},U.prototype.shl=function(f,u){return this._verify1(f),this.imod(f.ushln(u))},U.prototype.imul=function(f,u){return this._verify2(f,u),this.imod(f.imul(u))},U.prototype.mul=function(f,u){return this._verify2(f,u),this.imod(f.mul(u))},U.prototype.isqr=function(f){return this.imul(f,f.clone())},U.prototype.sqr=function(f){return this.mul(f,f)},U.prototype.sqrt=function(f){if(f.isZero())return f.clone();var u=this.m.andln(3);if(i(u%2===1),u===3){var y=this.m.add(new a(1)).iushrn(2);return this.pow(f,y)}for(var A=this.m.subn(1),P=0;!A.isZero()&&A.andln(1)===0;)P++,A.iushrn(1);i(!A.isZero());var S=new a(1).toRed(this),v=S.redNeg(),E=this.m.subn(1).iushrn(1),x=this.m.bitLength();for(x=new a(2*x*x).toRed(this);this.pow(x,E).cmp(v)!==0;)x.redIAdd(v);for(var T=this.pow(x,A),ne=this.pow(f,A.addn(1).iushrn(1)),fe=this.pow(f,A),D=P;fe.cmp(S)!==0;){for(var F=fe,j=0;F.cmp(S)!==0;j++)F=F.redSqr();i(j<D);var L=this.pow(T,new a(1).iushln(D-j-1));ne=ne.redMul(L),T=L.redSqr(),fe=fe.redMul(T),D=j}return ne},U.prototype.invm=function(f){var u=f._invmp(this.m);return u.negative!==0?(u.negative=0,this.imod(u).redNeg()):this.imod(u)},U.prototype.pow=function(f,u){if(u.isZero())return new a(1).toRed(this);if(u.cmpn(1)===0)return f.clone();var y=4,A=new Array(1<<y);A[0]=new a(1).toRed(this),A[1]=f;for(var P=2;P<A.length;P++)A[P]=this.mul(A[P-1],f);var S=A[0],v=0,E=0,x=u.bitLength()%26;for(x===0&&(x=26),P=u.length-1;P>=0;P--){for(var T=u.words[P],ne=x-1;ne>=0;ne--){var fe=T>>ne&1;if(S!==A[0]&&(S=this.sqr(S)),fe===0&&v===0){E=0;continue}v<<=1,v|=fe,E++,!(E!==y&&(P!==0||ne!==0))&&(S=this.mul(S,A[v]),E=0,v=0)}x=26}return S},U.prototype.convertTo=function(f){var u=f.umod(this.m);return u===f?u.clone():u},U.prototype.convertFrom=function(f){var u=f.clone();return u.red=null,u},a.mont=function(f){return new m(f)};function m(g){U.call(this,g),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(m,U),m.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},m.prototype.convertFrom=function(f){var u=this.imod(f.mul(this.rinv));return u.red=null,u},m.prototype.imul=function(f,u){if(f.isZero()||u.isZero())return f.words[0]=0,f.length=1,f;var y=f.imul(u),A=y.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),P=y.isub(A).iushrn(this.shift),S=P;return P.cmp(this.m)>=0?S=P.isub(this.m):P.cmpn(0)<0&&(S=P.iadd(this.m)),S._forceRed(this)},m.prototype.mul=function(f,u){if(f.isZero()||u.isZero())return new a(0)._forceRed(this);var y=f.mul(u),A=y.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),P=y.isub(A).iushrn(this.shift),S=P;return P.cmp(this.m)>=0?S=P.isub(this.m):P.cmpn(0)<0&&(S=P.iadd(this.m)),S._forceRed(this)},m.prototype.invm=function(f){var u=this.imod(f._invmp(this.m).mul(this.r2));return u._forceRed(this)}})(r,Wc)})(Vl);var I8=Vl.exports;const bt=gs(I8);var A8=bt.BN;function P8(r){return new A8(r,36).toString(16)}const D8="strings/5.7.0",O8=new Yt(D8);var Ac;(function(r){r.current="",r.NFC="NFC",r.NFD="NFD",r.NFKC="NFKC",r.NFKD="NFKD"})(Ac||(Ac={}));var Vp;(function(r){r.UNEXPECTED_CONTINUE="unexpected continuation byte",r.BAD_PREFIX="bad codepoint prefix",r.OVERRUN="string overrun",r.MISSING_CONTINUE="missing continuation byte",r.OUT_OF_RANGE="out of UTF-8 range",r.UTF16_SURROGATE="UTF-16 surrogate",r.OVERLONG="overlong representation"})(Vp||(Vp={}));function Lu(r,e=Ac.current){e!=Ac.current&&(O8.checkNormalize(),r=r.normalize(e));let t=[];for(let i=0;i<r.length;i++){const n=r.charCodeAt(i);if(n<128)t.push(n);else if(n<2048)t.push(n>>6|192),t.push(n&63|128);else if((n&64512)==55296){i++;const a=r.charCodeAt(i);if(i>=r.length||(a&64512)!==56320)throw new Error("invalid utf-8 string");const c=65536+((n&1023)<<10)+(a&1023);t.push(c>>18|240),t.push(c>>12&63|128),t.push(c>>6&63|128),t.push(c&63|128)}else t.push(n>>12|224),t.push(n>>6&63|128),t.push(n&63|128)}return ur(t)}const R8=`Ethereum Signed Message:
`;function gg(r){return typeof r=="string"&&(r=Lu(r)),Wl(_8([Lu(R8),Lu(String(r.length)),r]))}const C8="address/5.7.0",Do=new Yt(C8);function Gp(r){bn(r,20)||Do.throwArgumentError("invalid address","address",r),r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let n=0;n<40;n++)t[n]=e[n].charCodeAt(0);const i=ur(Wl(t));for(let n=0;n<40;n+=2)i[n>>1]>>4>=8&&(e[n]=e[n].toUpperCase()),(i[n>>1]&15)>=8&&(e[n+1]=e[n+1].toUpperCase());return"0x"+e.join("")}const N8=9007199254740991;function T8(r){return Math.log10?Math.log10(r):Math.log(r)/Math.LN10}const Gl={};for(let r=0;r<10;r++)Gl[String(r)]=String(r);for(let r=0;r<26;r++)Gl[String.fromCharCode(65+r)]=String(10+r);const Jp=Math.floor(T8(N8));function $8(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(i=>Gl[i]).join("");for(;e.length>=Jp;){let i=e.substring(0,Jp);e=parseInt(i,10)%97+e.substring(i.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}function L8(r){let e=null;if(typeof r!="string"&&Do.throwArgumentError("invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/))r.substring(0,2)!=="0x"&&(r="0x"+r),e=Gp(r),r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==r&&Do.throwArgumentError("bad address checksum","address",r);else if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(r.substring(2,4)!==$8(r)&&Do.throwArgumentError("bad icap checksum","address",r),e=P8(r.substring(4));e.length<40;)e="0"+e;e=Gp("0x"+e)}else Do.throwArgumentError("invalid address","address",r);return e}function wo(r,e,t){Object.defineProperty(r,e,{enumerable:!0,value:t,writable:!1})}var Wo={},Pt={},Zs=bg;function bg(r,e){if(!r)throw new Error(e||"Assertion failed")}bg.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)};var gl={exports:{}};typeof Object.create=="function"?gl.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:gl.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}};var Jc=gl.exports,q8=Zs,U8=Jc;Pt.inherits=U8;function B8(r,e){return(r.charCodeAt(e)&64512)!==55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)===56320}function z8(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!==0&&(r="0"+r),n=0;n<r.length;n+=2)t.push(parseInt(r[n]+r[n+1],16))}else for(var i=0,n=0;n<r.length;n++){var a=r.charCodeAt(n);a<128?t[i++]=a:a<2048?(t[i++]=a>>6|192,t[i++]=a&63|128):B8(r,n)?(a=65536+((a&1023)<<10)+(r.charCodeAt(++n)&1023),t[i++]=a>>18|240,t[i++]=a>>12&63|128,t[i++]=a>>6&63|128,t[i++]=a&63|128):(t[i++]=a>>12|224,t[i++]=a>>6&63|128,t[i++]=a&63|128)}else for(n=0;n<r.length;n++)t[n]=r[n]|0;return t}Pt.toArray=z8;function F8(r){for(var e="",t=0;t<r.length;t++)e+=yg(r[t].toString(16));return e}Pt.toHex=F8;function mg(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}Pt.htonl=mg;function k8(r,e){for(var t="",i=0;i<r.length;i++){var n=r[i];e==="little"&&(n=mg(n)),t+=wg(n.toString(16))}return t}Pt.toHex32=k8;function yg(r){return r.length===1?"0"+r:r}Pt.zero2=yg;function wg(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}Pt.zero8=wg;function H8(r,e,t,i){var n=t-e;q8(n%4===0);for(var a=new Array(n/4),c=0,h=e;c<a.length;c++,h+=4){var d;i==="big"?d=r[h]<<24|r[h+1]<<16|r[h+2]<<8|r[h+3]:d=r[h+3]<<24|r[h+2]<<16|r[h+1]<<8|r[h],a[c]=d>>>0}return a}Pt.join32=H8;function K8(r,e){for(var t=new Array(r.length*4),i=0,n=0;i<r.length;i++,n+=4){var a=r[i];e==="big"?(t[n]=a>>>24,t[n+1]=a>>>16&255,t[n+2]=a>>>8&255,t[n+3]=a&255):(t[n+3]=a>>>24,t[n+2]=a>>>16&255,t[n+1]=a>>>8&255,t[n]=a&255)}return t}Pt.split32=K8;function j8(r,e){return r>>>e|r<<32-e}Pt.rotr32=j8;function W8(r,e){return r<<e|r>>>32-e}Pt.rotl32=W8;function V8(r,e){return r+e>>>0}Pt.sum32=V8;function G8(r,e,t){return r+e+t>>>0}Pt.sum32_3=G8;function J8(r,e,t,i){return r+e+t+i>>>0}Pt.sum32_4=J8;function Y8(r,e,t,i,n){return r+e+t+i+n>>>0}Pt.sum32_5=Y8;function X8(r,e,t,i){var n=r[e],a=r[e+1],c=i+a>>>0,h=(c<i?1:0)+t+n;r[e]=h>>>0,r[e+1]=c}Pt.sum64=X8;function Z8(r,e,t,i){var n=e+i>>>0,a=(n<e?1:0)+r+t;return a>>>0}Pt.sum64_hi=Z8;function Q8(r,e,t,i){var n=e+i;return n>>>0}Pt.sum64_lo=Q8;function e4(r,e,t,i,n,a,c,h){var d=0,p=e;p=p+i>>>0,d+=p<e?1:0,p=p+a>>>0,d+=p<a?1:0,p=p+h>>>0,d+=p<h?1:0;var b=r+t+n+c+d;return b>>>0}Pt.sum64_4_hi=e4;function t4(r,e,t,i,n,a,c,h){var d=e+i+a+h;return d>>>0}Pt.sum64_4_lo=t4;function r4(r,e,t,i,n,a,c,h,d,p){var b=0,w=e;w=w+i>>>0,b+=w<e?1:0,w=w+a>>>0,b+=w<a?1:0,w=w+h>>>0,b+=w<h?1:0,w=w+p>>>0,b+=w<p?1:0;var R=r+t+n+c+d+b;return R>>>0}Pt.sum64_5_hi=r4;function i4(r,e,t,i,n,a,c,h,d,p){var b=e+i+a+h+p;return b>>>0}Pt.sum64_5_lo=i4;function n4(r,e,t){var i=e<<32-t|r>>>t;return i>>>0}Pt.rotr64_hi=n4;function s4(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Pt.rotr64_lo=s4;function a4(r,e,t){return r>>>t}Pt.shr64_hi=a4;function o4(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Pt.shr64_lo=o4;var Fa={},Yp=Pt,f4=Zs;function Yc(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Fa.BlockHash=Yc;Yc.prototype.update=function(e,t){if(e=Yp.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=Yp.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};Yc.prototype.digest=function(e){return this.update(this._pad()),f4(this.pending===null),this._digest(e)};Yc.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,n=new Array(i+this.padLength);n[0]=128;for(var a=1;a<i;a++)n[a]=0;if(e<<=3,this.endian==="big"){for(var c=8;c<this.padLength;c++)n[a++]=0;n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=e>>>24&255,n[a++]=e>>>16&255,n[a++]=e>>>8&255,n[a++]=e&255}else for(n[a++]=e&255,n[a++]=e>>>8&255,n[a++]=e>>>16&255,n[a++]=e>>>24&255,n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=0,c=8;c<this.padLength;c++)n[a++]=0;return n};var ka={},An={},c4=Pt,mn=c4.rotr32;function h4(r,e,t,i){if(r===0)return _g(e,t,i);if(r===1||r===3)return Eg(e,t,i);if(r===2)return xg(e,t,i)}An.ft_1=h4;function _g(r,e,t){return r&e^~r&t}An.ch32=_g;function xg(r,e,t){return r&e^r&t^e&t}An.maj32=xg;function Eg(r,e,t){return r^e^t}An.p32=Eg;function u4(r){return mn(r,2)^mn(r,13)^mn(r,22)}An.s0_256=u4;function l4(r){return mn(r,6)^mn(r,11)^mn(r,25)}An.s1_256=l4;function d4(r){return mn(r,7)^mn(r,18)^r>>>3}An.g0_256=d4;function p4(r){return mn(r,17)^mn(r,19)^r>>>10}An.g1_256=p4;var La=Pt,v4=Fa,g4=An,qu=La.rotl32,_o=La.sum32,b4=La.sum32_5,m4=g4.ft_1,Sg=v4.BlockHash,y4=[1518500249,1859775393,2400959708,3395469782];function xn(){if(!(this instanceof xn))return new xn;Sg.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}La.inherits(xn,Sg);var w4=xn;xn.blockSize=512;xn.outSize=160;xn.hmacStrength=80;xn.padLength=64;xn.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=qu(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var a=this.h[0],c=this.h[1],h=this.h[2],d=this.h[3],p=this.h[4];for(n=0;n<i.length;n++){var b=~~(n/20),w=b4(qu(a,5),m4(b,c,h,d),p,i[n],y4[b]);p=d,d=h,h=qu(c,30),c=a,a=w}this.h[0]=_o(this.h[0],a),this.h[1]=_o(this.h[1],c),this.h[2]=_o(this.h[2],h),this.h[3]=_o(this.h[3],d),this.h[4]=_o(this.h[4],p)};xn.prototype._digest=function(e){return e==="hex"?La.toHex32(this.h,"big"):La.split32(this.h,"big")};var qa=Pt,_4=Fa,Ha=An,x4=Zs,Ji=qa.sum32,E4=qa.sum32_4,S4=qa.sum32_5,M4=Ha.ch32,I4=Ha.maj32,A4=Ha.s0_256,P4=Ha.s1_256,D4=Ha.g0_256,O4=Ha.g1_256,Mg=_4.BlockHash,R4=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function En(){if(!(this instanceof En))return new En;Mg.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=R4,this.W=new Array(64)}qa.inherits(En,Mg);var Ig=En;En.blockSize=512;En.outSize=256;En.hmacStrength=192;En.padLength=64;En.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=E4(O4(i[n-2]),i[n-7],D4(i[n-15]),i[n-16]);var a=this.h[0],c=this.h[1],h=this.h[2],d=this.h[3],p=this.h[4],b=this.h[5],w=this.h[6],R=this.h[7];for(x4(this.k.length===i.length),n=0;n<i.length;n++){var O=S4(R,P4(p),M4(p,b,w),this.k[n],i[n]),C=Ji(A4(a),I4(a,c,h));R=w,w=b,b=p,p=Ji(d,O),d=h,h=c,c=a,a=Ji(O,C)}this.h[0]=Ji(this.h[0],a),this.h[1]=Ji(this.h[1],c),this.h[2]=Ji(this.h[2],h),this.h[3]=Ji(this.h[3],d),this.h[4]=Ji(this.h[4],p),this.h[5]=Ji(this.h[5],b),this.h[6]=Ji(this.h[6],w),this.h[7]=Ji(this.h[7],R)};En.prototype._digest=function(e){return e==="hex"?qa.toHex32(this.h,"big"):qa.split32(this.h,"big")};var bl=Pt,Ag=Ig;function Vn(){if(!(this instanceof Vn))return new Vn;Ag.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}bl.inherits(Vn,Ag);var C4=Vn;Vn.blockSize=512;Vn.outSize=224;Vn.hmacStrength=192;Vn.padLength=64;Vn.prototype._digest=function(e){return e==="hex"?bl.toHex32(this.h.slice(0,7),"big"):bl.split32(this.h.slice(0,7),"big")};var ni=Pt,N4=Fa,T4=Zs,yn=ni.rotr64_hi,wn=ni.rotr64_lo,Pg=ni.shr64_hi,Dg=ni.shr64_lo,os=ni.sum64,Uu=ni.sum64_hi,Bu=ni.sum64_lo,$4=ni.sum64_4_hi,L4=ni.sum64_4_lo,q4=ni.sum64_5_hi,U4=ni.sum64_5_lo,Og=N4.BlockHash,B4=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function rn(){if(!(this instanceof rn))return new rn;Og.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=B4,this.W=new Array(160)}ni.inherits(rn,Og);var Rg=rn;rn.blockSize=1024;rn.outSize=512;rn.hmacStrength=192;rn.padLength=128;rn.prototype._prepareBlock=function(e,t){for(var i=this.W,n=0;n<32;n++)i[n]=e[t+n];for(;n<i.length;n+=2){var a=Y4(i[n-4],i[n-3]),c=X4(i[n-4],i[n-3]),h=i[n-14],d=i[n-13],p=G4(i[n-30],i[n-29]),b=J4(i[n-30],i[n-29]),w=i[n-32],R=i[n-31];i[n]=$4(a,c,h,d,p,b,w,R),i[n+1]=L4(a,c,h,d,p,b,w,R)}};rn.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,n=this.h[0],a=this.h[1],c=this.h[2],h=this.h[3],d=this.h[4],p=this.h[5],b=this.h[6],w=this.h[7],R=this.h[8],O=this.h[9],C=this.h[10],q=this.h[11],V=this.h[12],Y=this.h[13],H=this.h[14],X=this.h[15];T4(this.k.length===i.length);for(var k=0;k<i.length;k+=2){var W=H,J=X,M=W4(R,O),B=V4(R,O),ae=z4(R,O,C,q,V),de=F4(R,O,C,q,V,Y),U=this.k[k],m=this.k[k+1],g=i[k],f=i[k+1],u=q4(W,J,M,B,ae,de,U,m,g,f),y=U4(W,J,M,B,ae,de,U,m,g,f);W=K4(n,a),J=j4(n,a),M=k4(n,a,c,h,d),B=H4(n,a,c,h,d,p);var A=Uu(W,J,M,B),P=Bu(W,J,M,B);H=V,X=Y,V=C,Y=q,C=R,q=O,R=Uu(b,w,u,y),O=Bu(w,w,u,y),b=d,w=p,d=c,p=h,c=n,h=a,n=Uu(u,y,A,P),a=Bu(u,y,A,P)}os(this.h,0,n,a),os(this.h,2,c,h),os(this.h,4,d,p),os(this.h,6,b,w),os(this.h,8,R,O),os(this.h,10,C,q),os(this.h,12,V,Y),os(this.h,14,H,X)};rn.prototype._digest=function(e){return e==="hex"?ni.toHex32(this.h,"big"):ni.split32(this.h,"big")};function z4(r,e,t,i,n){var a=r&t^~r&n;return a<0&&(a+=4294967296),a}function F4(r,e,t,i,n,a){var c=e&i^~e&a;return c<0&&(c+=4294967296),c}function k4(r,e,t,i,n){var a=r&t^r&n^t&n;return a<0&&(a+=4294967296),a}function H4(r,e,t,i,n,a){var c=e&i^e&a^i&a;return c<0&&(c+=4294967296),c}function K4(r,e){var t=yn(r,e,28),i=yn(e,r,2),n=yn(e,r,7),a=t^i^n;return a<0&&(a+=4294967296),a}function j4(r,e){var t=wn(r,e,28),i=wn(e,r,2),n=wn(e,r,7),a=t^i^n;return a<0&&(a+=4294967296),a}function W4(r,e){var t=yn(r,e,14),i=yn(r,e,18),n=yn(e,r,9),a=t^i^n;return a<0&&(a+=4294967296),a}function V4(r,e){var t=wn(r,e,14),i=wn(r,e,18),n=wn(e,r,9),a=t^i^n;return a<0&&(a+=4294967296),a}function G4(r,e){var t=yn(r,e,1),i=yn(r,e,8),n=Pg(r,e,7),a=t^i^n;return a<0&&(a+=4294967296),a}function J4(r,e){var t=wn(r,e,1),i=wn(r,e,8),n=Dg(r,e,7),a=t^i^n;return a<0&&(a+=4294967296),a}function Y4(r,e){var t=yn(r,e,19),i=yn(e,r,29),n=Pg(r,e,6),a=t^i^n;return a<0&&(a+=4294967296),a}function X4(r,e){var t=wn(r,e,19),i=wn(e,r,29),n=Dg(r,e,6),a=t^i^n;return a<0&&(a+=4294967296),a}var ml=Pt,Cg=Rg;function Gn(){if(!(this instanceof Gn))return new Gn;Cg.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}ml.inherits(Gn,Cg);var Z4=Gn;Gn.blockSize=1024;Gn.outSize=384;Gn.hmacStrength=192;Gn.padLength=128;Gn.prototype._digest=function(e){return e==="hex"?ml.toHex32(this.h.slice(0,12),"big"):ml.split32(this.h.slice(0,12),"big")};ka.sha1=w4;ka.sha224=C4;ka.sha256=Ig;ka.sha384=Z4;ka.sha512=Rg;var Ng={},Vs=Pt,Q4=Fa,cc=Vs.rotl32,Xp=Vs.sum32,xo=Vs.sum32_3,Zp=Vs.sum32_4,Tg=Q4.BlockHash;function Sn(){if(!(this instanceof Sn))return new Sn;Tg.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Vs.inherits(Sn,Tg);Ng.ripemd160=Sn;Sn.blockSize=512;Sn.outSize=160;Sn.hmacStrength=192;Sn.padLength=64;Sn.prototype._update=function(e,t){for(var i=this.h[0],n=this.h[1],a=this.h[2],c=this.h[3],h=this.h[4],d=i,p=n,b=a,w=c,R=h,O=0;O<80;O++){var C=Xp(cc(Zp(i,Qp(O,n,a,c),e[r7[O]+t],e7(O)),n7[O]),h);i=h,h=c,c=cc(a,10),a=n,n=C,C=Xp(cc(Zp(d,Qp(79-O,p,b,w),e[i7[O]+t],t7(O)),s7[O]),R),d=R,R=w,w=cc(b,10),b=p,p=C}C=xo(this.h[1],a,w),this.h[1]=xo(this.h[2],c,R),this.h[2]=xo(this.h[3],h,d),this.h[3]=xo(this.h[4],i,p),this.h[4]=xo(this.h[0],n,b),this.h[0]=C};Sn.prototype._digest=function(e){return e==="hex"?Vs.toHex32(this.h,"little"):Vs.split32(this.h,"little")};function Qp(r,e,t,i){return r<=15?e^t^i:r<=31?e&t|~e&i:r<=47?(e|~t)^i:r<=63?e&i|t&~i:e^(t|~i)}function e7(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function t7(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var r7=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],i7=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],n7=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],s7=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],a7=Pt,o7=Zs;function Ua(r,e,t){if(!(this instanceof Ua))return new Ua(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(a7.toArray(e,t))}var f7=Ua;Ua.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),o7(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};Ua.prototype.update=function(e,t){return this.inner.update(e,t),this};Ua.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};(function(r){var e=r;e.utils=Pt,e.common=Fa,e.sha=ka,e.ripemd=Ng,e.hmac=f7,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(Wo);const kn=gs(Wo);function Ka(r,e,t){return t={path:e,exports:{},require:function(i,n){return c7(i,n??t.path)}},r(t,t.exports),t.exports}function c7(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Jl=$g;function $g(r,e){if(!r)throw new Error(e||"Assertion failed")}$g.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)};var tn=Ka(function(r,e){var t=e;function i(c,h){if(Array.isArray(c))return c.slice();if(!c)return[];var d=[];if(typeof c!="string"){for(var p=0;p<c.length;p++)d[p]=c[p]|0;return d}if(h==="hex"){c=c.replace(/[^a-z0-9]+/ig,""),c.length%2!==0&&(c="0"+c);for(var p=0;p<c.length;p+=2)d.push(parseInt(c[p]+c[p+1],16))}else for(var p=0;p<c.length;p++){var b=c.charCodeAt(p),w=b>>8,R=b&255;w?d.push(w,R):d.push(R)}return d}t.toArray=i;function n(c){return c.length===1?"0"+c:c}t.zero2=n;function a(c){for(var h="",d=0;d<c.length;d++)h+=n(c[d].toString(16));return h}t.toHex=a,t.encode=function(h,d){return d==="hex"?a(h):h}}),gi=Ka(function(r,e){var t=e;t.assert=Jl,t.toArray=tn.toArray,t.zero2=tn.zero2,t.toHex=tn.toHex,t.encode=tn.encode;function i(d,p,b){var w=new Array(Math.max(d.bitLength(),b)+1);w.fill(0);for(var R=1<<p+1,O=d.clone(),C=0;C<w.length;C++){var q,V=O.andln(R-1);O.isOdd()?(V>(R>>1)-1?q=(R>>1)-V:q=V,O.isubn(q)):q=0,w[C]=q,O.iushrn(1)}return w}t.getNAF=i;function n(d,p){var b=[[],[]];d=d.clone(),p=p.clone();for(var w=0,R=0,O;d.cmpn(-w)>0||p.cmpn(-R)>0;){var C=d.andln(3)+w&3,q=p.andln(3)+R&3;C===3&&(C=-1),q===3&&(q=-1);var V;C&1?(O=d.andln(7)+w&7,(O===3||O===5)&&q===2?V=-C:V=C):V=0,b[0].push(V);var Y;q&1?(O=p.andln(7)+R&7,(O===3||O===5)&&C===2?Y=-q:Y=q):Y=0,b[1].push(Y),2*w===V+1&&(w=1-w),2*R===Y+1&&(R=1-R),d.iushrn(1),p.iushrn(1)}return b}t.getJSF=n;function a(d,p,b){var w="_"+p;d.prototype[p]=function(){return this[w]!==void 0?this[w]:this[w]=b.call(this)}}t.cachedProperty=a;function c(d){return typeof d=="string"?t.toArray(d,"hex"):d}t.parseBytes=c;function h(d){return new bt(d,"hex","le")}t.intFromLE=h}),Pc=gi.getNAF,h7=gi.getJSF,Dc=gi.assert;function bs(r,e){this.type=r,this.p=new bt(e.p,16),this.red=e.prime?bt.red(e.prime):bt.mont(this.p),this.zero=new bt(0).toRed(this.red),this.one=new bt(1).toRed(this.red),this.two=new bt(2).toRed(this.red),this.n=e.n&&new bt(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Qs=bs;bs.prototype.point=function(){throw new Error("Not implemented")};bs.prototype.validate=function(){throw new Error("Not implemented")};bs.prototype._fixedNafMul=function(e,t){Dc(e.precomputed);var i=e._getDoubles(),n=Pc(t,1,this._bitLength),a=(1<<i.step+1)-(i.step%2===0?2:1);a/=3;var c=[],h,d;for(h=0;h<n.length;h+=i.step){d=0;for(var p=h+i.step-1;p>=h;p--)d=(d<<1)+n[p];c.push(d)}for(var b=this.jpoint(null,null,null),w=this.jpoint(null,null,null),R=a;R>0;R--){for(h=0;h<c.length;h++)d=c[h],d===R?w=w.mixedAdd(i.points[h]):d===-R&&(w=w.mixedAdd(i.points[h].neg()));b=b.add(w)}return b.toP()};bs.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var a=n.points,c=Pc(t,i,this._bitLength),h=this.jpoint(null,null,null),d=c.length-1;d>=0;d--){for(var p=0;d>=0&&c[d]===0;d--)p++;if(d>=0&&p++,h=h.dblp(p),d<0)break;var b=c[d];Dc(b!==0),e.type==="affine"?b>0?h=h.mixedAdd(a[b-1>>1]):h=h.mixedAdd(a[-b-1>>1].neg()):b>0?h=h.add(a[b-1>>1]):h=h.add(a[-b-1>>1].neg())}return e.type==="affine"?h.toP():h};bs.prototype._wnafMulAdd=function(e,t,i,n,a){var c=this._wnafT1,h=this._wnafT2,d=this._wnafT3,p=0,b,w,R;for(b=0;b<n;b++){R=t[b];var O=R._getNAFPoints(e);c[b]=O.wnd,h[b]=O.points}for(b=n-1;b>=1;b-=2){var C=b-1,q=b;if(c[C]!==1||c[q]!==1){d[C]=Pc(i[C],c[C],this._bitLength),d[q]=Pc(i[q],c[q],this._bitLength),p=Math.max(d[C].length,p),p=Math.max(d[q].length,p);continue}var V=[t[C],null,null,t[q]];t[C].y.cmp(t[q].y)===0?(V[1]=t[C].add(t[q]),V[2]=t[C].toJ().mixedAdd(t[q].neg())):t[C].y.cmp(t[q].y.redNeg())===0?(V[1]=t[C].toJ().mixedAdd(t[q]),V[2]=t[C].add(t[q].neg())):(V[1]=t[C].toJ().mixedAdd(t[q]),V[2]=t[C].toJ().mixedAdd(t[q].neg()));var Y=[-3,-1,-5,-7,0,7,5,1,3],H=h7(i[C],i[q]);for(p=Math.max(H[0].length,p),d[C]=new Array(p),d[q]=new Array(p),w=0;w<p;w++){var X=H[0][w]|0,k=H[1][w]|0;d[C][w]=Y[(X+1)*3+(k+1)],d[q][w]=0,h[C]=V}}var W=this.jpoint(null,null,null),J=this._wnafT4;for(b=p;b>=0;b--){for(var M=0;b>=0;){var B=!0;for(w=0;w<n;w++)J[w]=d[w][b]|0,J[w]!==0&&(B=!1);if(!B)break;M++,b--}if(b>=0&&M++,W=W.dblp(M),b<0)break;for(w=0;w<n;w++){var ae=J[w];ae!==0&&(ae>0?R=h[w][ae-1>>1]:ae<0&&(R=h[w][-ae-1>>1].neg()),R.type==="affine"?W=W.mixedAdd(R):W=W.add(R))}}for(b=0;b<n;b++)h[b]=null;return a?W:W.toP()};function $i(r,e){this.curve=r,this.type=e,this.precomputed=null}bs.BasePoint=$i;$i.prototype.eq=function(){throw new Error("Not implemented")};$i.prototype.validate=function(){return this.curve.validate(this)};bs.prototype.decodePoint=function(e,t){e=gi.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?Dc(e[e.length-1]%2===0):e[0]===7&&Dc(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};$i.prototype.encodeCompressed=function(e){return this.encode(e,!0)};$i.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};$i.prototype.encode=function(e,t){return gi.encode(this._encode(t),e)};$i.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};$i.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};$i.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,a=0;a<t;a+=e){for(var c=0;c<e;c++)n=n.dbl();i.push(n)}return{step:e,points:i}};$i.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),a=1;a<i;a++)t[a]=t[a-1].add(n);return{wnd:e,points:t}};$i.prototype._getBeta=function(){return null};$i.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t};var Yl=Ka(function(r){typeof Object.create=="function"?r.exports=function(t,i){i&&(t.super_=i,t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(t,i){if(i){t.super_=i;var n=function(){};n.prototype=i.prototype,t.prototype=new n,t.prototype.constructor=t}}}),u7=gi.assert;function Li(r){Qs.call(this,"short",r),this.a=new bt(r.a,16).toRed(this.red),this.b=new bt(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Yl(Li,Qs);var l7=Li;Li.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new bt(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(e.lambda)i=new bt(e.lambda,16);else{var a=this._getEndoRoots(this.n);this.g.mul(a[0]).x.cmp(this.g.x.redMul(t))===0?i=a[0]:(i=a[1],u7(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var c;return e.basis?c=e.basis.map(function(h){return{a:new bt(h.a,16),b:new bt(h.b,16)}}):c=this._getEndoBasis(i),{beta:t,lambda:i,basis:c}}};Li.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:bt.mont(e),i=new bt(2).toRed(t).redInvm(),n=i.redNeg(),a=new bt(3).toRed(t).redNeg().redSqrt().redMul(i),c=n.redAdd(a).fromRed(),h=n.redSub(a).fromRed();return[c,h]};Li.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),a=new bt(1),c=new bt(0),h=new bt(0),d=new bt(1),p,b,w,R,O,C,q,V=0,Y,H;i.cmpn(0)!==0;){var X=n.div(i);Y=n.sub(X.mul(i)),H=h.sub(X.mul(a));var k=d.sub(X.mul(c));if(!w&&Y.cmp(t)<0)p=q.neg(),b=a,w=Y.neg(),R=H;else if(w&&++V===2)break;q=Y,n=i,i=Y,h=a,a=H,d=c,c=k}O=Y.neg(),C=H;var W=w.sqr().add(R.sqr()),J=O.sqr().add(C.sqr());return J.cmp(W)>=0&&(O=p,C=b),w.negative&&(w=w.neg(),R=R.neg()),O.negative&&(O=O.neg(),C=C.neg()),[{a:w,b:R},{a:O,b:C}]};Li.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],a=n.b.mul(e).divRound(this.n),c=i.b.neg().mul(e).divRound(this.n),h=a.mul(i.a),d=c.mul(n.a),p=a.mul(i.b),b=c.mul(n.b),w=e.sub(h).sub(d),R=p.add(b).neg();return{k1:w,k2:R}};Li.prototype.pointFromX=function(e,t){e=new bt(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var a=n.fromRed().isOdd();return(t&&!a||!t&&a)&&(n=n.redNeg()),this.point(e,n)};Li.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),a=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(a).cmpn(0)===0};Li.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,a=this._endoWnafT2,c=0;c<e.length;c++){var h=this._endoSplit(t[c]),d=e[c],p=d._getBeta();h.k1.negative&&(h.k1.ineg(),d=d.neg(!0)),h.k2.negative&&(h.k2.ineg(),p=p.neg(!0)),n[c*2]=d,n[c*2+1]=p,a[c*2]=h.k1,a[c*2+1]=h.k2}for(var b=this._wnafMulAdd(1,n,a,c*2,i),w=0;w<c*2;w++)n[w]=null,a[w]=null;return b};function xr(r,e,t,i){Qs.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new bt(e,16),this.y=new bt(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Yl(xr,Qs.BasePoint);Li.prototype.point=function(e,t,i){return new xr(this,e,t,i)};Li.prototype.pointFromJSON=function(e,t){return xr.fromJSON(this,e,t)};xr.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(a){return i.point(a.x.redMul(i.endo.beta),a.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}};xr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};xr.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function a(h){return e.point(h[0],h[1],i)}var c=t[2];return n.precomputed={beta:null,doubles:c.doubles&&{step:c.doubles.step,points:[n].concat(c.doubles.points.map(a))},naf:c.naf&&{wnd:c.naf.wnd,points:[n].concat(c.naf.points.map(a))}},n};xr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};xr.prototype.isInfinity=function(){return this.inf};xr.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};xr.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),a=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),c=a.redSqr().redISub(this.x.redAdd(this.x)),h=a.redMul(this.x.redSub(c)).redISub(this.y);return this.curve.point(c,h)};xr.prototype.getX=function(){return this.x.fromRed()};xr.prototype.getY=function(){return this.y.fromRed()};xr.prototype.mul=function(e){return e=new bt(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};xr.prototype.mulAdd=function(e,t,i){var n=[this,t],a=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,a):this.curve._wnafMulAdd(1,n,a,2)};xr.prototype.jmulAdd=function(e,t,i){var n=[this,t],a=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,a,!0):this.curve._wnafMulAdd(1,n,a,2,!0)};xr.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};xr.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(a){return a.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t};xr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Mr(r,e,t,i){Qs.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new bt(0)):(this.x=new bt(e,16),this.y=new bt(t,16),this.z=new bt(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Yl(Mr,Qs.BasePoint);Li.prototype.jpoint=function(e,t,i){return new Mr(this,e,t,i)};Mr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)};Mr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Mr.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),a=e.x.redMul(i),c=this.y.redMul(t.redMul(e.z)),h=e.y.redMul(i.redMul(this.z)),d=n.redSub(a),p=c.redSub(h);if(d.cmpn(0)===0)return p.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=d.redSqr(),w=b.redMul(d),R=n.redMul(b),O=p.redSqr().redIAdd(w).redISub(R).redISub(R),C=p.redMul(R.redISub(O)).redISub(c.redMul(w)),q=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(O,C,q)};Mr.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),a=this.y,c=e.y.redMul(t).redMul(this.z),h=i.redSub(n),d=a.redSub(c);if(h.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var p=h.redSqr(),b=p.redMul(h),w=i.redMul(p),R=d.redSqr().redIAdd(b).redISub(w).redISub(w),O=d.redMul(w.redISub(R)).redISub(a.redMul(b)),C=this.z.redMul(h);return this.curve.jpoint(R,O,C)};Mr.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,a=this.curve.tinv,c=this.x,h=this.y,d=this.z,p=d.redSqr().redSqr(),b=h.redAdd(h);for(t=0;t<e;t++){var w=c.redSqr(),R=b.redSqr(),O=R.redSqr(),C=w.redAdd(w).redIAdd(w).redIAdd(n.redMul(p)),q=c.redMul(R),V=C.redSqr().redISub(q.redAdd(q)),Y=q.redISub(V),H=C.redMul(Y);H=H.redIAdd(H).redISub(O);var X=b.redMul(d);t+1<e&&(p=p.redMul(O)),c=V,d=X,b=H}return this.curve.jpoint(c,b.redMul(a),d)};Mr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Mr.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),a=this.y.redSqr(),c=a.redSqr(),h=this.x.redAdd(a).redSqr().redISub(n).redISub(c);h=h.redIAdd(h);var d=n.redAdd(n).redIAdd(n),p=d.redSqr().redISub(h).redISub(h),b=c.redIAdd(c);b=b.redIAdd(b),b=b.redIAdd(b),e=p,t=d.redMul(h.redISub(p)).redISub(b),i=this.y.redAdd(this.y)}else{var w=this.x.redSqr(),R=this.y.redSqr(),O=R.redSqr(),C=this.x.redAdd(R).redSqr().redISub(w).redISub(O);C=C.redIAdd(C);var q=w.redAdd(w).redIAdd(w),V=q.redSqr(),Y=O.redIAdd(O);Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),e=V.redISub(C).redISub(C),t=q.redMul(C.redISub(e)).redISub(Y),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};Mr.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),a=this.y.redSqr(),c=a.redSqr(),h=this.x.redAdd(a).redSqr().redISub(n).redISub(c);h=h.redIAdd(h);var d=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),p=d.redSqr().redISub(h).redISub(h);e=p;var b=c.redIAdd(c);b=b.redIAdd(b),b=b.redIAdd(b),t=d.redMul(h.redISub(p)).redISub(b),i=this.y.redAdd(this.y)}else{var w=this.z.redSqr(),R=this.y.redSqr(),O=this.x.redMul(R),C=this.x.redSub(w).redMul(this.x.redAdd(w));C=C.redAdd(C).redIAdd(C);var q=O.redIAdd(O);q=q.redIAdd(q);var V=q.redAdd(q);e=C.redSqr().redISub(V),i=this.y.redAdd(this.z).redSqr().redISub(R).redISub(w);var Y=R.redSqr();Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),t=C.redMul(q.redISub(e)).redISub(Y)}return this.curve.jpoint(e,t,i)};Mr.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,a=n.redSqr().redSqr(),c=t.redSqr(),h=i.redSqr(),d=c.redAdd(c).redIAdd(c).redIAdd(e.redMul(a)),p=t.redAdd(t);p=p.redIAdd(p);var b=p.redMul(h),w=d.redSqr().redISub(b.redAdd(b)),R=b.redISub(w),O=h.redSqr();O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O);var C=d.redMul(R).redISub(O),q=i.redAdd(i).redMul(n);return this.curve.jpoint(w,C,q)};Mr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),a=e.redAdd(e).redIAdd(e),c=a.redSqr(),h=this.x.redAdd(t).redSqr().redISub(e).redISub(n);h=h.redIAdd(h),h=h.redAdd(h).redIAdd(h),h=h.redISub(c);var d=h.redSqr(),p=n.redIAdd(n);p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var b=a.redIAdd(h).redSqr().redISub(c).redISub(d).redISub(p),w=t.redMul(b);w=w.redIAdd(w),w=w.redIAdd(w);var R=this.x.redMul(d).redISub(w);R=R.redIAdd(R),R=R.redIAdd(R);var O=this.y.redMul(b.redMul(p.redISub(b)).redISub(h.redMul(d)));O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O);var C=this.z.redAdd(h).redSqr().redISub(i).redISub(d);return this.curve.jpoint(R,O,C)};Mr.prototype.mul=function(e,t){return e=new bt(e,t),this.curve._wnafMul(this,e)};Mr.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),a=i.redMul(e.z);return this.y.redMul(a).redISub(e.y.redMul(n)).cmpn(0)===0};Mr.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),a=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(a),this.x.cmp(i)===0)return!0}};Mr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Mr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var yc=Ka(function(r,e){var t=e;t.base=Qs,t.short=l7,t.mont=null,t.edwards=null}),wc=Ka(function(r,e){var t=e,i=gi.assert;function n(h){h.type==="short"?this.curve=new yc.short(h):h.type==="edwards"?this.curve=new yc.edwards(h):this.curve=new yc.mont(h),this.g=this.curve.g,this.n=this.curve.n,this.hash=h.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=n;function a(h,d){Object.defineProperty(t,h,{configurable:!0,enumerable:!0,get:function(){var p=new n(d);return Object.defineProperty(t,h,{configurable:!0,enumerable:!0,value:p}),p}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:kn.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:kn.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:kn.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:kn.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:kn.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:kn.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:kn.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var c;try{c=null.crash()}catch{c=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:kn.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",c]})});function ps(r){if(!(this instanceof ps))return new ps(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=tn.toArray(r.entropy,r.entropyEnc||"hex"),t=tn.toArray(r.nonce,r.nonceEnc||"hex"),i=tn.toArray(r.pers,r.persEnc||"hex");Jl(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}var Lg=ps;ps.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var a=0;a<this.V.length;a++)this.K[a]=0,this.V[a]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};ps.prototype._hmac=function(){return new kn.hmac(this.hash,this.K)};ps.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};ps.prototype.reseed=function(e,t,i,n){typeof t!="string"&&(n=i,i=t,t=null),e=tn.toArray(e,t),i=tn.toArray(i,n),Jl(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};ps.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=i,i=t,t=null),i&&(i=tn.toArray(i,n||"hex"),this._update(i));for(var a=[];a.length<e;)this.V=this._hmac().update(this.V).digest(),a=a.concat(this.V);var c=a.slice(0,e);return this._update(i),this._reseed++,tn.encode(c,t)};var yl=gi.assert;function qr(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var Xl=qr;qr.fromPublic=function(e,t,i){return t instanceof qr?t:new qr(e,{pub:t,pubEnc:i})};qr.fromPrivate=function(e,t,i){return t instanceof qr?t:new qr(e,{priv:t,privEnc:i})};qr.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};qr.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};qr.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};qr.prototype._importPrivate=function(e,t){this.priv=new bt(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};qr.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?yl(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&yl(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};qr.prototype.derive=function(e){return e.validate()||yl(e.validate(),"public point not validated"),e.mul(this.priv).getX()};qr.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};qr.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};qr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var d7=gi.assert;function Xc(r,e){if(r instanceof Xc)return r;this._importDER(r,e)||(d7(r.r&&r.s,"Signature without r or s"),this.r=new bt(r.r,16),this.s=new bt(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var Zc=Xc;function p7(){this.place=0}function zu(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4)return!1;for(var n=0,a=0,c=e.place;a<i;a++,c++)n<<=8,n|=r[c],n>>>=0;return n<=127?!1:(e.place=c,n)}function ev(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}Xc.prototype._importDER=function(e,t){e=gi.toArray(e,t);var i=new p7;if(e[i.place++]!==48)return!1;var n=zu(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var a=zu(e,i);if(a===!1)return!1;var c=e.slice(i.place,a+i.place);if(i.place+=a,e[i.place++]!==2)return!1;var h=zu(e,i);if(h===!1||e.length!==h+i.place)return!1;var d=e.slice(i.place,h+i.place);if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;if(d[0]===0)if(d[1]&128)d=d.slice(1);else return!1;return this.r=new bt(c),this.s=new bt(d),this.recoveryParam=null,!0};function Fu(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}Xc.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=ev(t),i=ev(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];Fu(n,t.length),n=n.concat(t),n.push(2),Fu(n,i.length);var a=n.concat(i),c=[48];return Fu(c,a.length),c=c.concat(a),gi.encode(c,e)};var v7=function(){throw new Error("unsupported")},qg=gi.assert;function Ni(r){if(!(this instanceof Ni))return new Ni(r);typeof r=="string"&&(qg(Object.prototype.hasOwnProperty.call(wc,r),"Unknown curve "+r),r=wc[r]),r instanceof wc.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var g7=Ni;Ni.prototype.keyPair=function(e){return new Xl(this,e)};Ni.prototype.keyFromPrivate=function(e,t){return Xl.fromPrivate(this,e,t)};Ni.prototype.keyFromPublic=function(e,t){return Xl.fromPublic(this,e,t)};Ni.prototype.genKeyPair=function(e){e||(e={});for(var t=new Lg({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||v7(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new bt(2));;){var a=new bt(t.generate(i));if(!(a.cmp(n)>0))return a.iaddn(1),this.keyFromPrivate(a)}};Ni.prototype._truncateToN=function(e,t){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};Ni.prototype.sign=function(e,t,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new bt(e,16));for(var a=this.n.byteLength(),c=t.getPrivate().toArray("be",a),h=e.toArray("be",a),d=new Lg({hash:this.hash,entropy:c,nonce:h,pers:n.pers,persEnc:n.persEnc||"utf8"}),p=this.n.sub(new bt(1)),b=0;;b++){var w=n.k?n.k(b):new bt(d.generate(this.n.byteLength()));if(w=this._truncateToN(w,!0),!(w.cmpn(1)<=0||w.cmp(p)>=0)){var R=this.g.mul(w);if(!R.isInfinity()){var O=R.getX(),C=O.umod(this.n);if(C.cmpn(0)!==0){var q=w.invm(this.n).mul(C.mul(t.getPrivate()).iadd(e));if(q=q.umod(this.n),q.cmpn(0)!==0){var V=(R.getY().isOdd()?1:0)|(O.cmp(C)!==0?2:0);return n.canonical&&q.cmp(this.nh)>0&&(q=this.n.sub(q),V^=1),new Zc({r:C,s:q,recoveryParam:V})}}}}}};Ni.prototype.verify=function(e,t,i,n){e=this._truncateToN(new bt(e,16)),i=this.keyFromPublic(i,n),t=new Zc(t,"hex");var a=t.r,c=t.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0||c.cmpn(1)<0||c.cmp(this.n)>=0)return!1;var h=c.invm(this.n),d=h.mul(e).umod(this.n),p=h.mul(a).umod(this.n),b;return this.curve._maxwellTrick?(b=this.g.jmulAdd(d,i.getPublic(),p),b.isInfinity()?!1:b.eqXToP(a)):(b=this.g.mulAdd(d,i.getPublic(),p),b.isInfinity()?!1:b.getX().umod(this.n).cmp(a)===0)};Ni.prototype.recoverPubKey=function(r,e,t,i){qg((3&t)===t,"The recovery param is more than two bits"),e=new Zc(e,i);var n=this.n,a=new bt(r),c=e.r,h=e.s,d=t&1,p=t>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&p)throw new Error("Unable to find sencond key candinate");p?c=this.curve.pointFromX(c.add(this.curve.n),d):c=this.curve.pointFromX(c,d);var b=e.r.invm(n),w=n.sub(a).mul(b).umod(n),R=h.mul(b).umod(n);return this.g.mulAdd(w,c,R)};Ni.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new Zc(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var a;try{a=this.recoverPubKey(r,e,n)}catch{continue}if(a.eq(t))return n}throw new Error("Unable to find valid recovery factor")};var b7=Ka(function(r,e){var t=e;t.version="6.5.4",t.utils=gi,t.rand=function(){throw new Error("unsupported")},t.curve=yc,t.curves=wc,t.ec=g7,t.eddsa=null}),m7=b7.ec;const y7="signing-key/5.7.0",wl=new Yt(y7);let ku=null;function fs(){return ku||(ku=new m7("secp256k1")),ku}class w7{constructor(e){wo(this,"curve","secp256k1"),wo(this,"privateKey",di(e)),E8(this.privateKey)!==32&&wl.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const t=fs().keyFromPrivate(ur(this.privateKey));wo(this,"publicKey","0x"+t.getPublic(!1,"hex")),wo(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),wo(this,"_isSigningKey",!0)}_addPoint(e){const t=fs().keyFromPublic(ur(this.publicKey)),i=fs().keyFromPublic(ur(e));return"0x"+t.pub.add(i.pub).encodeCompressed("hex")}signDigest(e){const t=fs().keyFromPrivate(ur(this.privateKey)),i=ur(e);i.length!==32&&wl.throwArgumentError("bad digest length","digest",e);const n=t.sign(i,{canonical:!0});return vg({recoveryParam:n.recoveryParam,r:Na("0x"+n.r.toString(16),32),s:Na("0x"+n.s.toString(16),32)})}computeSharedSecret(e){const t=fs().keyFromPrivate(ur(this.privateKey)),i=fs().keyFromPublic(ur(Ug(e)));return Na("0x"+t.derive(i.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function _7(r,e){const t=vg(e),i={r:ur(t.r),s:ur(t.s)};return"0x"+fs().recoverPubKey(ur(r),i,t.recoveryParam).encode("hex",!1)}function Ug(r,e){const t=ur(r);return t.length===32?new w7(t).publicKey:t.length===33?"0x"+fs().keyFromPublic(t).getPublic(!1,"hex"):t.length===65?di(t):wl.throwArgumentError("invalid public or private key","key","[REDACTED]")}var tv;(function(r){r[r.legacy=0]="legacy",r[r.eip2930=1]="eip2930",r[r.eip1559=2]="eip1559"})(tv||(tv={}));function x7(r){const e=Ug(r);return L8(Wp(Wl(Wp(e,1)),12))}function E7(r,e){return x7(_7(ur(r),e))}var Zl={},Qc={},wt={},Bg={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(h,d){var p=h>>>16&65535,b=h&65535,w=d>>>16&65535,R=d&65535;return b*R+(p*R+b*w<<16>>>0)|0}r.mul=Math.imul||e;function t(h,d){return h+d|0}r.add=t;function i(h,d){return h-d|0}r.sub=i;function n(h,d){return h<<d|h>>>32-d}r.rotl=n;function a(h,d){return h<<32-d|h>>>d}r.rotr=a;function c(h){return typeof h=="number"&&isFinite(h)&&Math.floor(h)===h}r.isInteger=Number.isInteger||c,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(h){return r.isInteger(h)&&h>=-r.MAX_SAFE_INTEGER&&h<=r.MAX_SAFE_INTEGER}})(Bg);Object.defineProperty(wt,"__esModule",{value:!0});var zg=Bg;function S7(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}wt.readInt16BE=S7;function M7(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}wt.readUint16BE=M7;function I7(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}wt.readInt16LE=I7;function A7(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}wt.readUint16LE=A7;function Fg(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}wt.writeUint16BE=Fg;wt.writeInt16BE=Fg;function kg(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}wt.writeUint16LE=kg;wt.writeInt16LE=kg;function _l(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}wt.readInt32BE=_l;function xl(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}wt.readUint32BE=xl;function El(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}wt.readInt32LE=El;function Sl(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}wt.readUint32LE=Sl;function Oc(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}wt.writeUint32BE=Oc;wt.writeInt32BE=Oc;function Rc(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}wt.writeUint32LE=Rc;wt.writeInt32LE=Rc;function P7(r,e){e===void 0&&(e=0);var t=_l(r,e),i=_l(r,e+4);return t*4294967296+i-(i>>31)*4294967296}wt.readInt64BE=P7;function D7(r,e){e===void 0&&(e=0);var t=xl(r,e),i=xl(r,e+4);return t*4294967296+i}wt.readUint64BE=D7;function O7(r,e){e===void 0&&(e=0);var t=El(r,e),i=El(r,e+4);return i*4294967296+t-(t>>31)*4294967296}wt.readInt64LE=O7;function R7(r,e){e===void 0&&(e=0);var t=Sl(r,e),i=Sl(r,e+4);return i*4294967296+t}wt.readUint64LE=R7;function Hg(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Oc(r/4294967296>>>0,e,t),Oc(r>>>0,e,t+4),e}wt.writeUint64BE=Hg;wt.writeInt64BE=Hg;function Kg(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Rc(r>>>0,e,t),Rc(r/4294967296>>>0,e,t+4),e}wt.writeUint64LE=Kg;wt.writeInt64LE=Kg;function C7(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,a=r/8+t-1;a>=t;a--)i+=e[a]*n,n*=256;return i}wt.readUintBE=C7;function N7(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,a=t;a<t+r/8;a++)i+=e[a]*n,n*=256;return i}wt.readUintLE=N7;function T7(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!zg.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,a=r/8+i-1;a>=i;a--)t[a]=e/n&255,n*=256;return t}wt.writeUintBE=T7;function $7(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!zg.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,a=i;a<i+r/8;a++)t[a]=e/n&255,n*=256;return t}wt.writeUintLE=$7;function L7(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}wt.readFloat32BE=L7;function q7(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}wt.readFloat32LE=q7;function U7(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}wt.readFloat64BE=U7;function B7(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}wt.readFloat64LE=B7;function z7(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}wt.writeFloat32BE=z7;function F7(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}wt.writeFloat32LE=F7;function k7(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}wt.writeFloat64BE=k7;function H7(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}wt.writeFloat64LE=H7;var bi={};Object.defineProperty(bi,"__esModule",{value:!0});function K7(r){for(var e=0;e<r.length;e++)r[e]=0;return r}bi.wipe=K7;Object.defineProperty(Qc,"__esModule",{value:!0});var Lr=wt,Ml=bi,j7=20;function W7(r,e,t){for(var i=1634760805,n=857760878,a=2036477234,c=1797285236,h=t[3]<<24|t[2]<<16|t[1]<<8|t[0],d=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],b=t[15]<<24|t[14]<<16|t[13]<<8|t[12],w=t[19]<<24|t[18]<<16|t[17]<<8|t[16],R=t[23]<<24|t[22]<<16|t[21]<<8|t[20],O=t[27]<<24|t[26]<<16|t[25]<<8|t[24],C=t[31]<<24|t[30]<<16|t[29]<<8|t[28],q=e[3]<<24|e[2]<<16|e[1]<<8|e[0],V=e[7]<<24|e[6]<<16|e[5]<<8|e[4],Y=e[11]<<24|e[10]<<16|e[9]<<8|e[8],H=e[15]<<24|e[14]<<16|e[13]<<8|e[12],X=i,k=n,W=a,J=c,M=h,B=d,ae=p,de=b,U=w,m=R,g=O,f=C,u=q,y=V,A=Y,P=H,S=0;S<j7;S+=2)X=X+M|0,u^=X,u=u>>>16|u<<16,U=U+u|0,M^=U,M=M>>>20|M<<12,k=k+B|0,y^=k,y=y>>>16|y<<16,m=m+y|0,B^=m,B=B>>>20|B<<12,W=W+ae|0,A^=W,A=A>>>16|A<<16,g=g+A|0,ae^=g,ae=ae>>>20|ae<<12,J=J+de|0,P^=J,P=P>>>16|P<<16,f=f+P|0,de^=f,de=de>>>20|de<<12,W=W+ae|0,A^=W,A=A>>>24|A<<8,g=g+A|0,ae^=g,ae=ae>>>25|ae<<7,J=J+de|0,P^=J,P=P>>>24|P<<8,f=f+P|0,de^=f,de=de>>>25|de<<7,k=k+B|0,y^=k,y=y>>>24|y<<8,m=m+y|0,B^=m,B=B>>>25|B<<7,X=X+M|0,u^=X,u=u>>>24|u<<8,U=U+u|0,M^=U,M=M>>>25|M<<7,X=X+B|0,P^=X,P=P>>>16|P<<16,g=g+P|0,B^=g,B=B>>>20|B<<12,k=k+ae|0,u^=k,u=u>>>16|u<<16,f=f+u|0,ae^=f,ae=ae>>>20|ae<<12,W=W+de|0,y^=W,y=y>>>16|y<<16,U=U+y|0,de^=U,de=de>>>20|de<<12,J=J+M|0,A^=J,A=A>>>16|A<<16,m=m+A|0,M^=m,M=M>>>20|M<<12,W=W+de|0,y^=W,y=y>>>24|y<<8,U=U+y|0,de^=U,de=de>>>25|de<<7,J=J+M|0,A^=J,A=A>>>24|A<<8,m=m+A|0,M^=m,M=M>>>25|M<<7,k=k+ae|0,u^=k,u=u>>>24|u<<8,f=f+u|0,ae^=f,ae=ae>>>25|ae<<7,X=X+B|0,P^=X,P=P>>>24|P<<8,g=g+P|0,B^=g,B=B>>>25|B<<7;Lr.writeUint32LE(X+i|0,r,0),Lr.writeUint32LE(k+n|0,r,4),Lr.writeUint32LE(W+a|0,r,8),Lr.writeUint32LE(J+c|0,r,12),Lr.writeUint32LE(M+h|0,r,16),Lr.writeUint32LE(B+d|0,r,20),Lr.writeUint32LE(ae+p|0,r,24),Lr.writeUint32LE(de+b|0,r,28),Lr.writeUint32LE(U+w|0,r,32),Lr.writeUint32LE(m+R|0,r,36),Lr.writeUint32LE(g+O|0,r,40),Lr.writeUint32LE(f+C|0,r,44),Lr.writeUint32LE(u+q|0,r,48),Lr.writeUint32LE(y+V|0,r,52),Lr.writeUint32LE(A+Y|0,r,56),Lr.writeUint32LE(P+H|0,r,60)}function jg(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var a,c;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");a=new Uint8Array(16),c=a.length-e.length,a.set(e,c)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");a=e,c=n}for(var h=new Uint8Array(64),d=0;d<t.length;d+=64){W7(h,a,r);for(var p=d;p<d+64&&p<t.length;p++)i[p]=t[p]^h[p-d];G7(a,0,c)}return Ml.wipe(h),n===0&&Ml.wipe(a),i}Qc.streamXOR=jg;function V7(r,e,t,i){return i===void 0&&(i=0),Ml.wipe(t),jg(r,e,t,t,i)}Qc.stream=V7;function G7(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var Wg={},ms={};Object.defineProperty(ms,"__esModule",{value:!0});function J7(r,e,t){return~(r-1)&e|r-1&t}ms.select=J7;function Y7(r,e){return(r|0)-(e|0)-1>>>31&1}ms.lessOrEqual=Y7;function Vg(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}ms.compare=Vg;function X7(r,e){return r.length===0||e.length===0?!1:Vg(r,e)!==0}ms.equal=X7;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ms,t=bi;r.DIGEST_LENGTH=16;var i=function(){function c(h){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var d=h[0]|h[1]<<8;this._r[0]=d&8191;var p=h[2]|h[3]<<8;this._r[1]=(d>>>13|p<<3)&8191;var b=h[4]|h[5]<<8;this._r[2]=(p>>>10|b<<6)&7939;var w=h[6]|h[7]<<8;this._r[3]=(b>>>7|w<<9)&8191;var R=h[8]|h[9]<<8;this._r[4]=(w>>>4|R<<12)&255,this._r[5]=R>>>1&8190;var O=h[10]|h[11]<<8;this._r[6]=(R>>>14|O<<2)&8191;var C=h[12]|h[13]<<8;this._r[7]=(O>>>11|C<<5)&8065;var q=h[14]|h[15]<<8;this._r[8]=(C>>>8|q<<8)&8191,this._r[9]=q>>>5&127,this._pad[0]=h[16]|h[17]<<8,this._pad[1]=h[18]|h[19]<<8,this._pad[2]=h[20]|h[21]<<8,this._pad[3]=h[22]|h[23]<<8,this._pad[4]=h[24]|h[25]<<8,this._pad[5]=h[26]|h[27]<<8,this._pad[6]=h[28]|h[29]<<8,this._pad[7]=h[30]|h[31]<<8}return c.prototype._blocks=function(h,d,p){for(var b=this._fin?0:2048,w=this._h[0],R=this._h[1],O=this._h[2],C=this._h[3],q=this._h[4],V=this._h[5],Y=this._h[6],H=this._h[7],X=this._h[8],k=this._h[9],W=this._r[0],J=this._r[1],M=this._r[2],B=this._r[3],ae=this._r[4],de=this._r[5],U=this._r[6],m=this._r[7],g=this._r[8],f=this._r[9];p>=16;){var u=h[d+0]|h[d+1]<<8;w+=u&8191;var y=h[d+2]|h[d+3]<<8;R+=(u>>>13|y<<3)&8191;var A=h[d+4]|h[d+5]<<8;O+=(y>>>10|A<<6)&8191;var P=h[d+6]|h[d+7]<<8;C+=(A>>>7|P<<9)&8191;var S=h[d+8]|h[d+9]<<8;q+=(P>>>4|S<<12)&8191,V+=S>>>1&8191;var v=h[d+10]|h[d+11]<<8;Y+=(S>>>14|v<<2)&8191;var E=h[d+12]|h[d+13]<<8;H+=(v>>>11|E<<5)&8191;var x=h[d+14]|h[d+15]<<8;X+=(E>>>8|x<<8)&8191,k+=x>>>5|b;var T=0,ne=T;ne+=w*W,ne+=R*(5*f),ne+=O*(5*g),ne+=C*(5*m),ne+=q*(5*U),T=ne>>>13,ne&=8191,ne+=V*(5*de),ne+=Y*(5*ae),ne+=H*(5*B),ne+=X*(5*M),ne+=k*(5*J),T+=ne>>>13,ne&=8191;var fe=T;fe+=w*J,fe+=R*W,fe+=O*(5*f),fe+=C*(5*g),fe+=q*(5*m),T=fe>>>13,fe&=8191,fe+=V*(5*U),fe+=Y*(5*de),fe+=H*(5*ae),fe+=X*(5*B),fe+=k*(5*M),T+=fe>>>13,fe&=8191;var D=T;D+=w*M,D+=R*J,D+=O*W,D+=C*(5*f),D+=q*(5*g),T=D>>>13,D&=8191,D+=V*(5*m),D+=Y*(5*U),D+=H*(5*de),D+=X*(5*ae),D+=k*(5*B),T+=D>>>13,D&=8191;var F=T;F+=w*B,F+=R*M,F+=O*J,F+=C*W,F+=q*(5*f),T=F>>>13,F&=8191,F+=V*(5*g),F+=Y*(5*m),F+=H*(5*U),F+=X*(5*de),F+=k*(5*ae),T+=F>>>13,F&=8191;var j=T;j+=w*ae,j+=R*B,j+=O*M,j+=C*J,j+=q*W,T=j>>>13,j&=8191,j+=V*(5*f),j+=Y*(5*g),j+=H*(5*m),j+=X*(5*U),j+=k*(5*de),T+=j>>>13,j&=8191;var L=T;L+=w*de,L+=R*ae,L+=O*B,L+=C*M,L+=q*J,T=L>>>13,L&=8191,L+=V*W,L+=Y*(5*f),L+=H*(5*g),L+=X*(5*m),L+=k*(5*U),T+=L>>>13,L&=8191;var _=T;_+=w*U,_+=R*de,_+=O*ae,_+=C*B,_+=q*M,T=_>>>13,_&=8191,_+=V*J,_+=Y*W,_+=H*(5*f),_+=X*(5*g),_+=k*(5*m),T+=_>>>13,_&=8191;var K=T;K+=w*m,K+=R*U,K+=O*de,K+=C*ae,K+=q*B,T=K>>>13,K&=8191,K+=V*M,K+=Y*J,K+=H*W,K+=X*(5*f),K+=k*(5*g),T+=K>>>13,K&=8191;var re=T;re+=w*g,re+=R*m,re+=O*U,re+=C*de,re+=q*ae,T=re>>>13,re&=8191,re+=V*B,re+=Y*M,re+=H*J,re+=X*W,re+=k*(5*f),T+=re>>>13,re&=8191;var se=T;se+=w*f,se+=R*g,se+=O*m,se+=C*U,se+=q*de,T=se>>>13,se&=8191,se+=V*ae,se+=Y*B,se+=H*M,se+=X*J,se+=k*W,T+=se>>>13,se&=8191,T=(T<<2)+T|0,T=T+ne|0,ne=T&8191,T=T>>>13,fe+=T,w=ne,R=fe,O=D,C=F,q=j,V=L,Y=_,H=K,X=re,k=se,d+=16,p-=16}this._h[0]=w,this._h[1]=R,this._h[2]=O,this._h[3]=C,this._h[4]=q,this._h[5]=V,this._h[6]=Y,this._h[7]=H,this._h[8]=X,this._h[9]=k},c.prototype.finish=function(h,d){d===void 0&&(d=0);var p=new Uint16Array(10),b,w,R,O;if(this._leftover){for(O=this._leftover,this._buffer[O++]=1;O<16;O++)this._buffer[O]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(b=this._h[1]>>>13,this._h[1]&=8191,O=2;O<10;O++)this._h[O]+=b,b=this._h[O]>>>13,this._h[O]&=8191;for(this._h[0]+=b*5,b=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=b,b=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=b,p[0]=this._h[0]+5,b=p[0]>>>13,p[0]&=8191,O=1;O<10;O++)p[O]=this._h[O]+b,b=p[O]>>>13,p[O]&=8191;for(p[9]-=8192,w=(b^1)-1,O=0;O<10;O++)p[O]&=w;for(w=~w,O=0;O<10;O++)this._h[O]=this._h[O]&w|p[O];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,R=this._h[0]+this._pad[0],this._h[0]=R&65535,O=1;O<8;O++)R=(this._h[O]+this._pad[O]|0)+(R>>>16)|0,this._h[O]=R&65535;return h[d+0]=this._h[0]>>>0,h[d+1]=this._h[0]>>>8,h[d+2]=this._h[1]>>>0,h[d+3]=this._h[1]>>>8,h[d+4]=this._h[2]>>>0,h[d+5]=this._h[2]>>>8,h[d+6]=this._h[3]>>>0,h[d+7]=this._h[3]>>>8,h[d+8]=this._h[4]>>>0,h[d+9]=this._h[4]>>>8,h[d+10]=this._h[5]>>>0,h[d+11]=this._h[5]>>>8,h[d+12]=this._h[6]>>>0,h[d+13]=this._h[6]>>>8,h[d+14]=this._h[7]>>>0,h[d+15]=this._h[7]>>>8,this._finished=!0,this},c.prototype.update=function(h){var d=0,p=h.length,b;if(this._leftover){b=16-this._leftover,b>p&&(b=p);for(var w=0;w<b;w++)this._buffer[this._leftover+w]=h[d+w];if(p-=b,d+=b,this._leftover+=b,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(b=p-p%16,this._blocks(h,d,b),d+=b,p-=b),p){for(var w=0;w<p;w++)this._buffer[this._leftover+w]=h[d+w];this._leftover+=p}return this},c.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var h=new Uint8Array(16);return this.finish(h),h},c.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},c}();r.Poly1305=i;function n(c,h){var d=new i(c);d.update(h);var p=d.digest();return d.clean(),p}r.oneTimeAuth=n;function a(c,h){return c.length!==r.DIGEST_LENGTH||h.length!==r.DIGEST_LENGTH?!1:e.equal(c,h)}r.equal=a})(Wg);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Qc,t=Wg,i=bi,n=wt,a=ms;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var c=new Uint8Array(16),h=function(){function d(p){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,p.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return d.prototype.seal=function(p,b,w,R){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var O=new Uint8Array(16);O.set(p,O.length-p.length);var C=new Uint8Array(32);e.stream(this._key,O,C,4);var q=b.length+this.tagLength,V;if(R){if(R.length!==q)throw new Error("ChaCha20Poly1305: incorrect destination length");V=R}else V=new Uint8Array(q);return e.streamXOR(this._key,O,b,V,4),this._authenticate(V.subarray(V.length-this.tagLength,V.length),C,V.subarray(0,V.length-this.tagLength),w),i.wipe(O),V},d.prototype.open=function(p,b,w,R){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(b.length<this.tagLength)return null;var O=new Uint8Array(16);O.set(p,O.length-p.length);var C=new Uint8Array(32);e.stream(this._key,O,C,4);var q=new Uint8Array(this.tagLength);if(this._authenticate(q,C,b.subarray(0,b.length-this.tagLength),w),!a.equal(q,b.subarray(b.length-this.tagLength,b.length)))return null;var V=b.length-this.tagLength,Y;if(R){if(R.length!==V)throw new Error("ChaCha20Poly1305: incorrect destination length");Y=R}else Y=new Uint8Array(V);return e.streamXOR(this._key,O,b.subarray(0,b.length-this.tagLength),Y,4),i.wipe(O),Y},d.prototype.clean=function(){return i.wipe(this._key),this},d.prototype._authenticate=function(p,b,w,R){var O=new t.Poly1305(b);R&&(O.update(R),R.length%16>0&&O.update(c.subarray(R.length%16))),O.update(w),w.length%16>0&&O.update(c.subarray(w.length%16));var C=new Uint8Array(8);R&&n.writeUint64LE(R.length,C),O.update(C),n.writeUint64LE(w.length,C),O.update(C);for(var q=O.digest(),V=0;V<q.length;V++)p[V]=q[V];O.clean(),i.wipe(q),i.wipe(C)},d}();r.ChaCha20Poly1305=h})(Zl);var Gg={},Vo={},Ql={};Object.defineProperty(Ql,"__esModule",{value:!0});function Z7(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}Ql.isSerializableHash=Z7;Object.defineProperty(Vo,"__esModule",{value:!0});var ln=Ql,Q7=ms,e9=bi,Jg=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),ln.isSerializableHash(this._inner)&&ln.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),e9.wipe(i)}return r.prototype.reset=function(){if(!ln.isSerializableHash(this._inner)||!ln.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){ln.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ln.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!ln.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!ln.isSerializableHash(this._inner)||!ln.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!ln.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();Vo.HMAC=Jg;function t9(r,e,t){var i=new Jg(r,e);i.update(t);var n=i.digest();return i.clean(),n}Vo.hmac=t9;Vo.equal=Q7.equal;Object.defineProperty(Gg,"__esModule",{value:!0});var rv=Vo,iv=bi,r9=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var a=rv.hmac(this._hash,i,t);this._hmac=new rv.HMAC(e,a),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),iv.wipe(this._buffer),iv.wipe(this._counter),this._bufpos=0},r}(),i9=Gg.HKDF=r9,ys={},eh={},th={};Object.defineProperty(th,"__esModule",{value:!0});th.BrowserRandomSource=void 0;const nv=65536;class n9{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let i=0;i<t.length;i+=nv)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,nv)));return t}}th.BrowserRandomSource=n9;function s9(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var rh={};Object.defineProperty(rh,"__esModule",{value:!0});rh.NodeRandomSource=void 0;const a9=bi;class o9{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof s9<"u"){const e=Gc;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=t[n];return(0,a9.wipe)(t),i}}rh.NodeRandomSource=o9;Object.defineProperty(eh,"__esModule",{value:!0});eh.SystemRandomSource=void 0;const f9=th,c9=rh;class h9{constructor(){if(this.isAvailable=!1,this.name="",this._source=new f9.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new c9.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}eh.SystemRandomSource=h9;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=eh,t=wt,i=bi;r.defaultRandomSource=new e.SystemRandomSource;function n(p,b=r.defaultRandomSource){return b.randomBytes(p)}r.randomBytes=n;function a(p=r.defaultRandomSource){const b=n(4,p),w=(0,t.readUint32LE)(b);return(0,i.wipe)(b),w}r.randomUint32=a;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function h(p,b=c,w=r.defaultRandomSource){if(b.length<2)throw new Error("randomString charset is too short");if(b.length>256)throw new Error("randomString charset is too long");let R="";const O=b.length,C=256-256%O;for(;p>0;){const q=n(Math.ceil(p*256/C),w);for(let V=0;V<q.length&&p>0;V++){const Y=q[V];Y<C&&(R+=b.charAt(Y%O),p--)}(0,i.wipe)(q)}return R}r.randomString=h;function d(p,b=c,w=r.defaultRandomSource){const R=Math.ceil(p/(Math.log(b.length)/Math.LN2));return h(R,b,w)}r.randomStringForEntropy=d})(ys);var Go={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=wt,t=bi;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var i=function(){function h(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return h.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},h.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},h.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},h.prototype.update=function(d,p){if(p===void 0&&(p=d.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var b=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=d[b++],p--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(b=a(this._temp,this._state,d,b,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=d[b++],p--;return this},h.prototype.finish=function(d){if(!this._finished){var p=this._bytesHashed,b=this._bufferLength,w=p/536870912|0,R=p<<3,O=p%64<56?64:128;this._buffer[b]=128;for(var C=b+1;C<O-8;C++)this._buffer[C]=0;e.writeUint32BE(w,this._buffer,O-8),e.writeUint32BE(R,this._buffer,O-4),a(this._temp,this._state,this._buffer,0,O),this._finished=!0}for(var C=0;C<this.digestLength/4;C++)e.writeUint32BE(this._state[C],d,C*4);return this},h.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},h.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},h.prototype.restoreState=function(d){return this._state.set(d.state),this._bufferLength=d.bufferLength,d.buffer&&this._buffer.set(d.buffer),this._bytesHashed=d.bytesHashed,this._finished=!1,this},h.prototype.cleanSavedState=function(d){t.wipe(d.state),d.buffer&&t.wipe(d.buffer),d.bufferLength=0,d.bytesHashed=0},h}();r.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(h,d,p,b,w){for(;w>=64;){for(var R=d[0],O=d[1],C=d[2],q=d[3],V=d[4],Y=d[5],H=d[6],X=d[7],k=0;k<16;k++){var W=b+k*4;h[k]=e.readUint32BE(p,W)}for(var k=16;k<64;k++){var J=h[k-2],M=(J>>>17|J<<15)^(J>>>19|J<<13)^J>>>10;J=h[k-15];var B=(J>>>7|J<<25)^(J>>>18|J<<14)^J>>>3;h[k]=(M+h[k-7]|0)+(B+h[k-16]|0)}for(var k=0;k<64;k++){var M=(((V>>>6|V<<26)^(V>>>11|V<<21)^(V>>>25|V<<7))+(V&Y^~V&H)|0)+(X+(n[k]+h[k]|0)|0)|0,B=((R>>>2|R<<30)^(R>>>13|R<<19)^(R>>>22|R<<10))+(R&O^R&C^O&C)|0;X=H,H=Y,Y=V,V=q+M|0,q=C,C=O,O=R,R=M+B|0}d[0]+=R,d[1]+=O,d[2]+=C,d[3]+=q,d[4]+=V,d[5]+=Y,d[6]+=H,d[7]+=X,b+=64,w-=64}return b}function c(h){var d=new i;d.update(h);var p=d.digest();return d.clean(),p}r.hash=c})(Go);var ed={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=ys,t=bi;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function i(k){const W=new Float64Array(16);if(k)for(let J=0;J<k.length;J++)W[J]=k[J];return W}const n=new Uint8Array(32);n[0]=9;const a=i([56129,1]);function c(k){let W=1;for(let J=0;J<16;J++){let M=k[J]+W+65535;W=Math.floor(M/65536),k[J]=M-W*65536}k[0]+=W-1+37*(W-1)}function h(k,W,J){const M=~(J-1);for(let B=0;B<16;B++){const ae=M&(k[B]^W[B]);k[B]^=ae,W[B]^=ae}}function d(k,W){const J=i(),M=i();for(let B=0;B<16;B++)M[B]=W[B];c(M),c(M),c(M);for(let B=0;B<2;B++){J[0]=M[0]-65517;for(let de=1;de<15;de++)J[de]=M[de]-65535-(J[de-1]>>16&1),J[de-1]&=65535;J[15]=M[15]-32767-(J[14]>>16&1);const ae=J[15]>>16&1;J[14]&=65535,h(M,J,1-ae)}for(let B=0;B<16;B++)k[2*B]=M[B]&255,k[2*B+1]=M[B]>>8}function p(k,W){for(let J=0;J<16;J++)k[J]=W[2*J]+(W[2*J+1]<<8);k[15]&=32767}function b(k,W,J){for(let M=0;M<16;M++)k[M]=W[M]+J[M]}function w(k,W,J){for(let M=0;M<16;M++)k[M]=W[M]-J[M]}function R(k,W,J){let M,B,ae=0,de=0,U=0,m=0,g=0,f=0,u=0,y=0,A=0,P=0,S=0,v=0,E=0,x=0,T=0,ne=0,fe=0,D=0,F=0,j=0,L=0,_=0,K=0,re=0,se=0,we=0,ce=0,me=0,Ke=0,Me=0,Je=0,Fe=J[0],ye=J[1],Ie=J[2],Ce=J[3],ge=J[4],$e=J[5],Ae=J[6],be=J[7],Oe=J[8],Ne=J[9],_e=J[10],De=J[11],ke=J[12],xe=J[13],je=J[14],We=J[15];M=W[0],ae+=M*Fe,de+=M*ye,U+=M*Ie,m+=M*Ce,g+=M*ge,f+=M*$e,u+=M*Ae,y+=M*be,A+=M*Oe,P+=M*Ne,S+=M*_e,v+=M*De,E+=M*ke,x+=M*xe,T+=M*je,ne+=M*We,M=W[1],de+=M*Fe,U+=M*ye,m+=M*Ie,g+=M*Ce,f+=M*ge,u+=M*$e,y+=M*Ae,A+=M*be,P+=M*Oe,S+=M*Ne,v+=M*_e,E+=M*De,x+=M*ke,T+=M*xe,ne+=M*je,fe+=M*We,M=W[2],U+=M*Fe,m+=M*ye,g+=M*Ie,f+=M*Ce,u+=M*ge,y+=M*$e,A+=M*Ae,P+=M*be,S+=M*Oe,v+=M*Ne,E+=M*_e,x+=M*De,T+=M*ke,ne+=M*xe,fe+=M*je,D+=M*We,M=W[3],m+=M*Fe,g+=M*ye,f+=M*Ie,u+=M*Ce,y+=M*ge,A+=M*$e,P+=M*Ae,S+=M*be,v+=M*Oe,E+=M*Ne,x+=M*_e,T+=M*De,ne+=M*ke,fe+=M*xe,D+=M*je,F+=M*We,M=W[4],g+=M*Fe,f+=M*ye,u+=M*Ie,y+=M*Ce,A+=M*ge,P+=M*$e,S+=M*Ae,v+=M*be,E+=M*Oe,x+=M*Ne,T+=M*_e,ne+=M*De,fe+=M*ke,D+=M*xe,F+=M*je,j+=M*We,M=W[5],f+=M*Fe,u+=M*ye,y+=M*Ie,A+=M*Ce,P+=M*ge,S+=M*$e,v+=M*Ae,E+=M*be,x+=M*Oe,T+=M*Ne,ne+=M*_e,fe+=M*De,D+=M*ke,F+=M*xe,j+=M*je,L+=M*We,M=W[6],u+=M*Fe,y+=M*ye,A+=M*Ie,P+=M*Ce,S+=M*ge,v+=M*$e,E+=M*Ae,x+=M*be,T+=M*Oe,ne+=M*Ne,fe+=M*_e,D+=M*De,F+=M*ke,j+=M*xe,L+=M*je,_+=M*We,M=W[7],y+=M*Fe,A+=M*ye,P+=M*Ie,S+=M*Ce,v+=M*ge,E+=M*$e,x+=M*Ae,T+=M*be,ne+=M*Oe,fe+=M*Ne,D+=M*_e,F+=M*De,j+=M*ke,L+=M*xe,_+=M*je,K+=M*We,M=W[8],A+=M*Fe,P+=M*ye,S+=M*Ie,v+=M*Ce,E+=M*ge,x+=M*$e,T+=M*Ae,ne+=M*be,fe+=M*Oe,D+=M*Ne,F+=M*_e,j+=M*De,L+=M*ke,_+=M*xe,K+=M*je,re+=M*We,M=W[9],P+=M*Fe,S+=M*ye,v+=M*Ie,E+=M*Ce,x+=M*ge,T+=M*$e,ne+=M*Ae,fe+=M*be,D+=M*Oe,F+=M*Ne,j+=M*_e,L+=M*De,_+=M*ke,K+=M*xe,re+=M*je,se+=M*We,M=W[10],S+=M*Fe,v+=M*ye,E+=M*Ie,x+=M*Ce,T+=M*ge,ne+=M*$e,fe+=M*Ae,D+=M*be,F+=M*Oe,j+=M*Ne,L+=M*_e,_+=M*De,K+=M*ke,re+=M*xe,se+=M*je,we+=M*We,M=W[11],v+=M*Fe,E+=M*ye,x+=M*Ie,T+=M*Ce,ne+=M*ge,fe+=M*$e,D+=M*Ae,F+=M*be,j+=M*Oe,L+=M*Ne,_+=M*_e,K+=M*De,re+=M*ke,se+=M*xe,we+=M*je,ce+=M*We,M=W[12],E+=M*Fe,x+=M*ye,T+=M*Ie,ne+=M*Ce,fe+=M*ge,D+=M*$e,F+=M*Ae,j+=M*be,L+=M*Oe,_+=M*Ne,K+=M*_e,re+=M*De,se+=M*ke,we+=M*xe,ce+=M*je,me+=M*We,M=W[13],x+=M*Fe,T+=M*ye,ne+=M*Ie,fe+=M*Ce,D+=M*ge,F+=M*$e,j+=M*Ae,L+=M*be,_+=M*Oe,K+=M*Ne,re+=M*_e,se+=M*De,we+=M*ke,ce+=M*xe,me+=M*je,Ke+=M*We,M=W[14],T+=M*Fe,ne+=M*ye,fe+=M*Ie,D+=M*Ce,F+=M*ge,j+=M*$e,L+=M*Ae,_+=M*be,K+=M*Oe,re+=M*Ne,se+=M*_e,we+=M*De,ce+=M*ke,me+=M*xe,Ke+=M*je,Me+=M*We,M=W[15],ne+=M*Fe,fe+=M*ye,D+=M*Ie,F+=M*Ce,j+=M*ge,L+=M*$e,_+=M*Ae,K+=M*be,re+=M*Oe,se+=M*Ne,we+=M*_e,ce+=M*De,me+=M*ke,Ke+=M*xe,Me+=M*je,Je+=M*We,ae+=38*fe,de+=38*D,U+=38*F,m+=38*j,g+=38*L,f+=38*_,u+=38*K,y+=38*re,A+=38*se,P+=38*we,S+=38*ce,v+=38*me,E+=38*Ke,x+=38*Me,T+=38*Je,B=1,M=ae+B+65535,B=Math.floor(M/65536),ae=M-B*65536,M=de+B+65535,B=Math.floor(M/65536),de=M-B*65536,M=U+B+65535,B=Math.floor(M/65536),U=M-B*65536,M=m+B+65535,B=Math.floor(M/65536),m=M-B*65536,M=g+B+65535,B=Math.floor(M/65536),g=M-B*65536,M=f+B+65535,B=Math.floor(M/65536),f=M-B*65536,M=u+B+65535,B=Math.floor(M/65536),u=M-B*65536,M=y+B+65535,B=Math.floor(M/65536),y=M-B*65536,M=A+B+65535,B=Math.floor(M/65536),A=M-B*65536,M=P+B+65535,B=Math.floor(M/65536),P=M-B*65536,M=S+B+65535,B=Math.floor(M/65536),S=M-B*65536,M=v+B+65535,B=Math.floor(M/65536),v=M-B*65536,M=E+B+65535,B=Math.floor(M/65536),E=M-B*65536,M=x+B+65535,B=Math.floor(M/65536),x=M-B*65536,M=T+B+65535,B=Math.floor(M/65536),T=M-B*65536,M=ne+B+65535,B=Math.floor(M/65536),ne=M-B*65536,ae+=B-1+37*(B-1),B=1,M=ae+B+65535,B=Math.floor(M/65536),ae=M-B*65536,M=de+B+65535,B=Math.floor(M/65536),de=M-B*65536,M=U+B+65535,B=Math.floor(M/65536),U=M-B*65536,M=m+B+65535,B=Math.floor(M/65536),m=M-B*65536,M=g+B+65535,B=Math.floor(M/65536),g=M-B*65536,M=f+B+65535,B=Math.floor(M/65536),f=M-B*65536,M=u+B+65535,B=Math.floor(M/65536),u=M-B*65536,M=y+B+65535,B=Math.floor(M/65536),y=M-B*65536,M=A+B+65535,B=Math.floor(M/65536),A=M-B*65536,M=P+B+65535,B=Math.floor(M/65536),P=M-B*65536,M=S+B+65535,B=Math.floor(M/65536),S=M-B*65536,M=v+B+65535,B=Math.floor(M/65536),v=M-B*65536,M=E+B+65535,B=Math.floor(M/65536),E=M-B*65536,M=x+B+65535,B=Math.floor(M/65536),x=M-B*65536,M=T+B+65535,B=Math.floor(M/65536),T=M-B*65536,M=ne+B+65535,B=Math.floor(M/65536),ne=M-B*65536,ae+=B-1+37*(B-1),k[0]=ae,k[1]=de,k[2]=U,k[3]=m,k[4]=g,k[5]=f,k[6]=u,k[7]=y,k[8]=A,k[9]=P,k[10]=S,k[11]=v,k[12]=E,k[13]=x,k[14]=T,k[15]=ne}function O(k,W){R(k,W,W)}function C(k,W){const J=i();for(let M=0;M<16;M++)J[M]=W[M];for(let M=253;M>=0;M--)O(J,J),M!==2&&M!==4&&R(J,J,W);for(let M=0;M<16;M++)k[M]=J[M]}function q(k,W){const J=new Uint8Array(32),M=new Float64Array(80),B=i(),ae=i(),de=i(),U=i(),m=i(),g=i();for(let A=0;A<31;A++)J[A]=k[A];J[31]=k[31]&127|64,J[0]&=248,p(M,W);for(let A=0;A<16;A++)ae[A]=M[A];B[0]=U[0]=1;for(let A=254;A>=0;--A){const P=J[A>>>3]>>>(A&7)&1;h(B,ae,P),h(de,U,P),b(m,B,de),w(B,B,de),b(de,ae,U),w(ae,ae,U),O(U,m),O(g,B),R(B,de,B),R(de,ae,m),b(m,B,de),w(B,B,de),O(ae,B),w(de,U,g),R(B,de,a),b(B,B,U),R(de,de,B),R(B,U,g),R(U,ae,M),O(ae,m),h(B,ae,P),h(de,U,P)}for(let A=0;A<16;A++)M[A+16]=B[A],M[A+32]=de[A],M[A+48]=ae[A],M[A+64]=U[A];const f=M.subarray(32),u=M.subarray(16);C(f,f),R(u,u,f);const y=new Uint8Array(32);return d(y,u),y}r.scalarMult=q;function V(k){return q(k,n)}r.scalarMultBase=V;function Y(k){if(k.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const W=new Uint8Array(k);return{publicKey:V(W),secretKey:W}}r.generateKeyPairFromSeed=Y;function H(k){const W=(0,e.randomBytes)(32,k),J=Y(W);return(0,t.wipe)(W),J}r.generateKeyPair=H;function X(k,W,J=!1){if(k.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(W.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const M=q(k,W);if(J){let B=0;for(let ae=0;ae<M.length;ae++)B|=M[ae];if(B===0)throw new Error("X25519: invalid shared key")}return M}r.sharedKey=X})(ed);function Yg(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Hu(r,e){e||(e=r.reduce((n,a)=>n+a.length,0));const t=Yg(e);let i=0;for(const n of r)t.set(n,i),i+=n.length;return t}function u9(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var a=r.charAt(n),c=a.charCodeAt(0);if(t[c]!==255)throw new TypeError(a+" is ambiguous");t[c]=n}var h=r.length,d=r.charAt(0),p=Math.log(h)/Math.log(256),b=Math.log(256)/Math.log(h);function w(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var q=0,V=0,Y=0,H=C.length;Y!==H&&C[Y]===0;)Y++,q++;for(var X=(H-Y)*b+1>>>0,k=new Uint8Array(X);Y!==H;){for(var W=C[Y],J=0,M=X-1;(W!==0||J<V)&&M!==-1;M--,J++)W+=256*k[M]>>>0,k[M]=W%h>>>0,W=W/h>>>0;if(W!==0)throw new Error("Non-zero carry");V=J,Y++}for(var B=X-V;B!==X&&k[B]===0;)B++;for(var ae=d.repeat(q);B<X;++B)ae+=r.charAt(k[B]);return ae}function R(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var q=0;if(C[q]!==" "){for(var V=0,Y=0;C[q]===d;)V++,q++;for(var H=(C.length-q)*p+1>>>0,X=new Uint8Array(H);C[q];){var k=t[C.charCodeAt(q)];if(k===255)return;for(var W=0,J=H-1;(k!==0||W<Y)&&J!==-1;J--,W++)k+=h*X[J]>>>0,X[J]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");Y=W,q++}if(C[q]!==" "){for(var M=H-Y;M!==H&&X[M]===0;)M++;for(var B=new Uint8Array(V+(H-M)),ae=V;M!==H;)B[ae++]=X[M++];return B}}}function O(C){var q=R(C);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:R,decode:O}}var l9=u9,d9=l9;const p9=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},v9=r=>new TextEncoder().encode(r),g9=r=>new TextDecoder().decode(r);class b9{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class m9{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Xg(this,e)}}class y9{constructor(e){this.decoders=e}or(e){return Xg(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Xg=(r,e)=>new y9({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class w9{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new b9(e,t,i),this.decoder=new m9(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ih=({name:r,prefix:e,encode:t,decode:i})=>new w9(r,e,t,i),Jo=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:n}=d9(t,e);return ih({prefix:r,name:e,encode:i,decode:a=>p9(n(a))})},_9=(r,e,t,i)=>{const n={};for(let b=0;b<e.length;++b)n[e[b]]=b;let a=r.length;for(;r[a-1]==="=";)--a;const c=new Uint8Array(a*t/8|0);let h=0,d=0,p=0;for(let b=0;b<a;++b){const w=n[r[b]];if(w===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<t|w,h+=t,h>=8&&(h-=8,c[p++]=255&d>>h)}if(h>=t||255&d<<8-h)throw new SyntaxError("Unexpected end of data");return c},x9=(r,e,t)=>{const i=e[e.length-1]==="=",n=(1<<t)-1;let a="",c=0,h=0;for(let d=0;d<r.length;++d)for(h=h<<8|r[d],c+=8;c>t;)c-=t,a+=e[n&h>>c];if(c&&(a+=e[n&h<<t-c]),i)for(;a.length*t&7;)a+="=";return a},Ir=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>ih({prefix:e,name:r,encode(n){return x9(n,i,t)},decode(n){return _9(n,i,t,r)}}),E9=ih({prefix:"\0",name:"identity",encode:r=>g9(r),decode:r=>v9(r)}),S9=Object.freeze(Object.defineProperty({__proto__:null,identity:E9},Symbol.toStringTag,{value:"Module"})),M9=Ir({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),I9=Object.freeze(Object.defineProperty({__proto__:null,base2:M9},Symbol.toStringTag,{value:"Module"})),A9=Ir({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),P9=Object.freeze(Object.defineProperty({__proto__:null,base8:A9},Symbol.toStringTag,{value:"Module"})),D9=Jo({prefix:"9",name:"base10",alphabet:"0123456789"}),O9=Object.freeze(Object.defineProperty({__proto__:null,base10:D9},Symbol.toStringTag,{value:"Module"})),R9=Ir({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),C9=Ir({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),N9=Object.freeze(Object.defineProperty({__proto__:null,base16:R9,base16upper:C9},Symbol.toStringTag,{value:"Module"})),T9=Ir({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$9=Ir({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),L9=Ir({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),q9=Ir({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),U9=Ir({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),B9=Ir({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),z9=Ir({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),F9=Ir({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),k9=Ir({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),H9=Object.freeze(Object.defineProperty({__proto__:null,base32:T9,base32hex:U9,base32hexpad:z9,base32hexpadupper:F9,base32hexupper:B9,base32pad:L9,base32padupper:q9,base32upper:$9,base32z:k9},Symbol.toStringTag,{value:"Module"})),K9=Jo({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),j9=Jo({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),W9=Object.freeze(Object.defineProperty({__proto__:null,base36:K9,base36upper:j9},Symbol.toStringTag,{value:"Module"})),V9=Jo({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),G9=Jo({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),J9=Object.freeze(Object.defineProperty({__proto__:null,base58btc:V9,base58flickr:G9},Symbol.toStringTag,{value:"Module"})),Y9=Ir({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),X9=Ir({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Z9=Ir({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Q9=Ir({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ex=Object.freeze(Object.defineProperty({__proto__:null,base64:Y9,base64pad:X9,base64url:Z9,base64urlpad:Q9},Symbol.toStringTag,{value:"Module"})),Zg=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),tx=Zg.reduce((r,e,t)=>(r[t]=e,r),[]),rx=Zg.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function ix(r){return r.reduce((e,t)=>(e+=tx[t],e),"")}function nx(r){const e=[];for(const t of r){const i=rx[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const sx=ih({prefix:"🚀",name:"base256emoji",encode:ix,decode:nx}),ax=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:sx},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Cc={...S9,...I9,...P9,...O9,...N9,...H9,...W9,...J9,...ex,...ax};function Qg(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const sv=Qg("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ku=Qg("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Yg(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),eb={utf8:sv,"utf-8":sv,hex:Cc.base16,latin1:Ku,ascii:Ku,binary:Ku,...Cc};function Ci(r,e="utf8"){const t=eb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function ii(r,e="utf8"){const t=eb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var tb={};const ox="elliptic",fx="6.5.7",cx="EC cryptography",hx="lib/elliptic.js",ux=["lib"],lx={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},dx={type:"git",url:"git@github.com:indutny/elliptic"},px=["EC","Elliptic","curve","Cryptography"],vx="Fedor Indutny <fedor@indutny.com>",gx="MIT",bx={url:"https://github.com/indutny/elliptic/issues"},mx="https://github.com/indutny/elliptic",yx={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},wx={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},_x={name:ox,version:fx,description:cx,main:hx,files:ux,scripts:lx,repository:dx,keywords:px,author:vx,license:gx,bugs:bx,homepage:mx,devDependencies:yx,dependencies:wx};var mi={},td={exports:{}};td.exports;(function(r){(function(e,t){function i(U,m){if(!U)throw new Error(m||"Assertion failed")}function n(U,m){U.super_=m;var g=function(){};g.prototype=m.prototype,U.prototype=new g,U.prototype.constructor=U}function a(U,m,g){if(a.isBN(U))return U;this.negative=0,this.words=null,this.length=0,this.red=null,U!==null&&((m==="le"||m==="be")&&(g=m,m=10),this._init(U||0,m||10,g||"be"))}typeof e=="object"?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=Gc.Buffer}catch{}a.isBN=function(m){return m instanceof a?!0:m!==null&&typeof m=="object"&&m.constructor.wordSize===a.wordSize&&Array.isArray(m.words)},a.max=function(m,g){return m.cmp(g)>0?m:g},a.min=function(m,g){return m.cmp(g)<0?m:g},a.prototype._init=function(m,g,f){if(typeof m=="number")return this._initNumber(m,g,f);if(typeof m=="object")return this._initArray(m,g,f);g==="hex"&&(g=16),i(g===(g|0)&&g>=2&&g<=36),m=m.toString().replace(/\s+/g,"");var u=0;m[0]==="-"&&(u++,this.negative=1),u<m.length&&(g===16?this._parseHex(m,u,f):(this._parseBase(m,g,u),f==="le"&&this._initArray(this.toArray(),g,f)))},a.prototype._initNumber=function(m,g,f){m<0&&(this.negative=1,m=-m),m<67108864?(this.words=[m&67108863],this.length=1):m<4503599627370496?(this.words=[m&67108863,m/67108864&67108863],this.length=2):(i(m<9007199254740992),this.words=[m&67108863,m/67108864&67108863,1],this.length=3),f==="le"&&this._initArray(this.toArray(),g,f)},a.prototype._initArray=function(m,g,f){if(i(typeof m.length=="number"),m.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(m.length/3),this.words=new Array(this.length);for(var u=0;u<this.length;u++)this.words[u]=0;var y,A,P=0;if(f==="be")for(u=m.length-1,y=0;u>=0;u-=3)A=m[u]|m[u-1]<<8|m[u-2]<<16,this.words[y]|=A<<P&67108863,this.words[y+1]=A>>>26-P&67108863,P+=24,P>=26&&(P-=26,y++);else if(f==="le")for(u=0,y=0;u<m.length;u+=3)A=m[u]|m[u+1]<<8|m[u+2]<<16,this.words[y]|=A<<P&67108863,this.words[y+1]=A>>>26-P&67108863,P+=24,P>=26&&(P-=26,y++);return this.strip()};function h(U,m){var g=U.charCodeAt(m);return g>=65&&g<=70?g-55:g>=97&&g<=102?g-87:g-48&15}function d(U,m,g){var f=h(U,g);return g-1>=m&&(f|=h(U,g-1)<<4),f}a.prototype._parseHex=function(m,g,f){this.length=Math.ceil((m.length-g)/6),this.words=new Array(this.length);for(var u=0;u<this.length;u++)this.words[u]=0;var y=0,A=0,P;if(f==="be")for(u=m.length-1;u>=g;u-=2)P=d(m,g,u)<<y,this.words[A]|=P&67108863,y>=18?(y-=18,A+=1,this.words[A]|=P>>>26):y+=8;else{var S=m.length-g;for(u=S%2===0?g+1:g;u<m.length;u+=2)P=d(m,g,u)<<y,this.words[A]|=P&67108863,y>=18?(y-=18,A+=1,this.words[A]|=P>>>26):y+=8}this.strip()};function p(U,m,g,f){for(var u=0,y=Math.min(U.length,g),A=m;A<y;A++){var P=U.charCodeAt(A)-48;u*=f,P>=49?u+=P-49+10:P>=17?u+=P-17+10:u+=P}return u}a.prototype._parseBase=function(m,g,f){this.words=[0],this.length=1;for(var u=0,y=1;y<=67108863;y*=g)u++;u--,y=y/g|0;for(var A=m.length-f,P=A%u,S=Math.min(A,A-P)+f,v=0,E=f;E<S;E+=u)v=p(m,E,E+u,g),this.imuln(y),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v);if(P!==0){var x=1;for(v=p(m,E,m.length,g),E=0;E<P;E++)x*=g;this.imuln(x),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v)}this.strip()},a.prototype.copy=function(m){m.words=new Array(this.length);for(var g=0;g<this.length;g++)m.words[g]=this.words[g];m.length=this.length,m.negative=this.negative,m.red=this.red},a.prototype.clone=function(){var m=new a(null);return this.copy(m),m},a.prototype._expand=function(m){for(;this.length<m;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var b=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],w=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],R=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(m,g){m=m||10,g=g|0||1;var f;if(m===16||m==="hex"){f="";for(var u=0,y=0,A=0;A<this.length;A++){var P=this.words[A],S=((P<<u|y)&16777215).toString(16);y=P>>>24-u&16777215,y!==0||A!==this.length-1?f=b[6-S.length]+S+f:f=S+f,u+=2,u>=26&&(u-=26,A--)}for(y!==0&&(f=y.toString(16)+f);f.length%g!==0;)f="0"+f;return this.negative!==0&&(f="-"+f),f}if(m===(m|0)&&m>=2&&m<=36){var v=w[m],E=R[m];f="";var x=this.clone();for(x.negative=0;!x.isZero();){var T=x.modn(E).toString(m);x=x.idivn(E),x.isZero()?f=T+f:f=b[v-T.length]+T+f}for(this.isZero()&&(f="0"+f);f.length%g!==0;)f="0"+f;return this.negative!==0&&(f="-"+f),f}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var m=this.words[0];return this.length===2?m+=this.words[1]*67108864:this.length===3&&this.words[2]===1?m+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-m:m},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(m,g){return i(typeof c<"u"),this.toArrayLike(c,m,g)},a.prototype.toArray=function(m,g){return this.toArrayLike(Array,m,g)},a.prototype.toArrayLike=function(m,g,f){var u=this.byteLength(),y=f||Math.max(1,u);i(u<=y,"byte array longer than desired length"),i(y>0,"Requested array length <= 0"),this.strip();var A=g==="le",P=new m(y),S,v,E=this.clone();if(A){for(v=0;!E.isZero();v++)S=E.andln(255),E.iushrn(8),P[v]=S;for(;v<y;v++)P[v]=0}else{for(v=0;v<y-u;v++)P[v]=0;for(v=0;!E.isZero();v++)S=E.andln(255),E.iushrn(8),P[y-v-1]=S}return P},Math.clz32?a.prototype._countBits=function(m){return 32-Math.clz32(m)}:a.prototype._countBits=function(m){var g=m,f=0;return g>=4096&&(f+=13,g>>>=13),g>=64&&(f+=7,g>>>=7),g>=8&&(f+=4,g>>>=4),g>=2&&(f+=2,g>>>=2),f+g},a.prototype._zeroBits=function(m){if(m===0)return 26;var g=m,f=0;return g&8191||(f+=13,g>>>=13),g&127||(f+=7,g>>>=7),g&15||(f+=4,g>>>=4),g&3||(f+=2,g>>>=2),g&1||f++,f},a.prototype.bitLength=function(){var m=this.words[this.length-1],g=this._countBits(m);return(this.length-1)*26+g};function O(U){for(var m=new Array(U.bitLength()),g=0;g<m.length;g++){var f=g/26|0,u=g%26;m[g]=(U.words[f]&1<<u)>>>u}return m}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var m=0,g=0;g<this.length;g++){var f=this._zeroBits(this.words[g]);if(m+=f,f!==26)break}return m},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(m){return this.negative!==0?this.abs().inotn(m).iaddn(1):this.clone()},a.prototype.fromTwos=function(m){return this.testn(m-1)?this.notn(m).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(m){for(;this.length<m.length;)this.words[this.length++]=0;for(var g=0;g<m.length;g++)this.words[g]=this.words[g]|m.words[g];return this.strip()},a.prototype.ior=function(m){return i((this.negative|m.negative)===0),this.iuor(m)},a.prototype.or=function(m){return this.length>m.length?this.clone().ior(m):m.clone().ior(this)},a.prototype.uor=function(m){return this.length>m.length?this.clone().iuor(m):m.clone().iuor(this)},a.prototype.iuand=function(m){var g;this.length>m.length?g=m:g=this;for(var f=0;f<g.length;f++)this.words[f]=this.words[f]&m.words[f];return this.length=g.length,this.strip()},a.prototype.iand=function(m){return i((this.negative|m.negative)===0),this.iuand(m)},a.prototype.and=function(m){return this.length>m.length?this.clone().iand(m):m.clone().iand(this)},a.prototype.uand=function(m){return this.length>m.length?this.clone().iuand(m):m.clone().iuand(this)},a.prototype.iuxor=function(m){var g,f;this.length>m.length?(g=this,f=m):(g=m,f=this);for(var u=0;u<f.length;u++)this.words[u]=g.words[u]^f.words[u];if(this!==g)for(;u<g.length;u++)this.words[u]=g.words[u];return this.length=g.length,this.strip()},a.prototype.ixor=function(m){return i((this.negative|m.negative)===0),this.iuxor(m)},a.prototype.xor=function(m){return this.length>m.length?this.clone().ixor(m):m.clone().ixor(this)},a.prototype.uxor=function(m){return this.length>m.length?this.clone().iuxor(m):m.clone().iuxor(this)},a.prototype.inotn=function(m){i(typeof m=="number"&&m>=0);var g=Math.ceil(m/26)|0,f=m%26;this._expand(g),f>0&&g--;for(var u=0;u<g;u++)this.words[u]=~this.words[u]&67108863;return f>0&&(this.words[u]=~this.words[u]&67108863>>26-f),this.strip()},a.prototype.notn=function(m){return this.clone().inotn(m)},a.prototype.setn=function(m,g){i(typeof m=="number"&&m>=0);var f=m/26|0,u=m%26;return this._expand(f+1),g?this.words[f]=this.words[f]|1<<u:this.words[f]=this.words[f]&~(1<<u),this.strip()},a.prototype.iadd=function(m){var g;if(this.negative!==0&&m.negative===0)return this.negative=0,g=this.isub(m),this.negative^=1,this._normSign();if(this.negative===0&&m.negative!==0)return m.negative=0,g=this.isub(m),m.negative=1,g._normSign();var f,u;this.length>m.length?(f=this,u=m):(f=m,u=this);for(var y=0,A=0;A<u.length;A++)g=(f.words[A]|0)+(u.words[A]|0)+y,this.words[A]=g&67108863,y=g>>>26;for(;y!==0&&A<f.length;A++)g=(f.words[A]|0)+y,this.words[A]=g&67108863,y=g>>>26;if(this.length=f.length,y!==0)this.words[this.length]=y,this.length++;else if(f!==this)for(;A<f.length;A++)this.words[A]=f.words[A];return this},a.prototype.add=function(m){var g;return m.negative!==0&&this.negative===0?(m.negative=0,g=this.sub(m),m.negative^=1,g):m.negative===0&&this.negative!==0?(this.negative=0,g=m.sub(this),this.negative=1,g):this.length>m.length?this.clone().iadd(m):m.clone().iadd(this)},a.prototype.isub=function(m){if(m.negative!==0){m.negative=0;var g=this.iadd(m);return m.negative=1,g._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(m),this.negative=1,this._normSign();var f=this.cmp(m);if(f===0)return this.negative=0,this.length=1,this.words[0]=0,this;var u,y;f>0?(u=this,y=m):(u=m,y=this);for(var A=0,P=0;P<y.length;P++)g=(u.words[P]|0)-(y.words[P]|0)+A,A=g>>26,this.words[P]=g&67108863;for(;A!==0&&P<u.length;P++)g=(u.words[P]|0)+A,A=g>>26,this.words[P]=g&67108863;if(A===0&&P<u.length&&u!==this)for(;P<u.length;P++)this.words[P]=u.words[P];return this.length=Math.max(this.length,P),u!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(m){return this.clone().isub(m)};function C(U,m,g){g.negative=m.negative^U.negative;var f=U.length+m.length|0;g.length=f,f=f-1|0;var u=U.words[0]|0,y=m.words[0]|0,A=u*y,P=A&67108863,S=A/67108864|0;g.words[0]=P;for(var v=1;v<f;v++){for(var E=S>>>26,x=S&67108863,T=Math.min(v,m.length-1),ne=Math.max(0,v-U.length+1);ne<=T;ne++){var fe=v-ne|0;u=U.words[fe]|0,y=m.words[ne]|0,A=u*y+x,E+=A/67108864|0,x=A&67108863}g.words[v]=x|0,S=E|0}return S!==0?g.words[v]=S|0:g.length--,g.strip()}var q=function(m,g,f){var u=m.words,y=g.words,A=f.words,P=0,S,v,E,x=u[0]|0,T=x&8191,ne=x>>>13,fe=u[1]|0,D=fe&8191,F=fe>>>13,j=u[2]|0,L=j&8191,_=j>>>13,K=u[3]|0,re=K&8191,se=K>>>13,we=u[4]|0,ce=we&8191,me=we>>>13,Ke=u[5]|0,Me=Ke&8191,Je=Ke>>>13,Fe=u[6]|0,ye=Fe&8191,Ie=Fe>>>13,Ce=u[7]|0,ge=Ce&8191,$e=Ce>>>13,Ae=u[8]|0,be=Ae&8191,Oe=Ae>>>13,Ne=u[9]|0,_e=Ne&8191,De=Ne>>>13,ke=y[0]|0,xe=ke&8191,je=ke>>>13,We=y[1]|0,He=We&8191,dt=We>>>13,mt=y[2]|0,Ge=mt&8191,pt=mt>>>13,St=y[3]|0,Ye=St&8191,nt=St>>>13,Ze=y[4]|0,Te=Ze&8191,Qe=Ze>>>13,et=y[5]|0,Le=et&8191,Xe=et>>>13,ct=y[6]|0,Be=ct&8191,tt=ct>>>13,ht=y[7]|0,qe=ht&8191,st=ht>>>13,rt=y[8]|0,Re=rt&8191,ut=rt>>>13,Ct=y[9]|0,at=Ct&8191,Nt=Ct>>>13;f.negative=m.negative^g.negative,f.length=19,S=Math.imul(T,xe),v=Math.imul(T,je),v=v+Math.imul(ne,xe)|0,E=Math.imul(ne,je);var Rt=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,S=Math.imul(D,xe),v=Math.imul(D,je),v=v+Math.imul(F,xe)|0,E=Math.imul(F,je),S=S+Math.imul(T,He)|0,v=v+Math.imul(T,dt)|0,v=v+Math.imul(ne,He)|0,E=E+Math.imul(ne,dt)|0;var yt=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(yt>>>26)|0,yt&=67108863,S=Math.imul(L,xe),v=Math.imul(L,je),v=v+Math.imul(_,xe)|0,E=Math.imul(_,je),S=S+Math.imul(D,He)|0,v=v+Math.imul(D,dt)|0,v=v+Math.imul(F,He)|0,E=E+Math.imul(F,dt)|0,S=S+Math.imul(T,Ge)|0,v=v+Math.imul(T,pt)|0,v=v+Math.imul(ne,Ge)|0,E=E+Math.imul(ne,pt)|0;var Dr=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Dr>>>26)|0,Dr&=67108863,S=Math.imul(re,xe),v=Math.imul(re,je),v=v+Math.imul(se,xe)|0,E=Math.imul(se,je),S=S+Math.imul(L,He)|0,v=v+Math.imul(L,dt)|0,v=v+Math.imul(_,He)|0,E=E+Math.imul(_,dt)|0,S=S+Math.imul(D,Ge)|0,v=v+Math.imul(D,pt)|0,v=v+Math.imul(F,Ge)|0,E=E+Math.imul(F,pt)|0,S=S+Math.imul(T,Ye)|0,v=v+Math.imul(T,nt)|0,v=v+Math.imul(ne,Ye)|0,E=E+Math.imul(ne,nt)|0;var Or=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Or>>>26)|0,Or&=67108863,S=Math.imul(ce,xe),v=Math.imul(ce,je),v=v+Math.imul(me,xe)|0,E=Math.imul(me,je),S=S+Math.imul(re,He)|0,v=v+Math.imul(re,dt)|0,v=v+Math.imul(se,He)|0,E=E+Math.imul(se,dt)|0,S=S+Math.imul(L,Ge)|0,v=v+Math.imul(L,pt)|0,v=v+Math.imul(_,Ge)|0,E=E+Math.imul(_,pt)|0,S=S+Math.imul(D,Ye)|0,v=v+Math.imul(D,nt)|0,v=v+Math.imul(F,Ye)|0,E=E+Math.imul(F,nt)|0,S=S+Math.imul(T,Te)|0,v=v+Math.imul(T,Qe)|0,v=v+Math.imul(ne,Te)|0,E=E+Math.imul(ne,Qe)|0;var Rr=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Rr>>>26)|0,Rr&=67108863,S=Math.imul(Me,xe),v=Math.imul(Me,je),v=v+Math.imul(Je,xe)|0,E=Math.imul(Je,je),S=S+Math.imul(ce,He)|0,v=v+Math.imul(ce,dt)|0,v=v+Math.imul(me,He)|0,E=E+Math.imul(me,dt)|0,S=S+Math.imul(re,Ge)|0,v=v+Math.imul(re,pt)|0,v=v+Math.imul(se,Ge)|0,E=E+Math.imul(se,pt)|0,S=S+Math.imul(L,Ye)|0,v=v+Math.imul(L,nt)|0,v=v+Math.imul(_,Ye)|0,E=E+Math.imul(_,nt)|0,S=S+Math.imul(D,Te)|0,v=v+Math.imul(D,Qe)|0,v=v+Math.imul(F,Te)|0,E=E+Math.imul(F,Qe)|0,S=S+Math.imul(T,Le)|0,v=v+Math.imul(T,Xe)|0,v=v+Math.imul(ne,Le)|0,E=E+Math.imul(ne,Xe)|0;var Cr=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Cr>>>26)|0,Cr&=67108863,S=Math.imul(ye,xe),v=Math.imul(ye,je),v=v+Math.imul(Ie,xe)|0,E=Math.imul(Ie,je),S=S+Math.imul(Me,He)|0,v=v+Math.imul(Me,dt)|0,v=v+Math.imul(Je,He)|0,E=E+Math.imul(Je,dt)|0,S=S+Math.imul(ce,Ge)|0,v=v+Math.imul(ce,pt)|0,v=v+Math.imul(me,Ge)|0,E=E+Math.imul(me,pt)|0,S=S+Math.imul(re,Ye)|0,v=v+Math.imul(re,nt)|0,v=v+Math.imul(se,Ye)|0,E=E+Math.imul(se,nt)|0,S=S+Math.imul(L,Te)|0,v=v+Math.imul(L,Qe)|0,v=v+Math.imul(_,Te)|0,E=E+Math.imul(_,Qe)|0,S=S+Math.imul(D,Le)|0,v=v+Math.imul(D,Xe)|0,v=v+Math.imul(F,Le)|0,E=E+Math.imul(F,Xe)|0,S=S+Math.imul(T,Be)|0,v=v+Math.imul(T,tt)|0,v=v+Math.imul(ne,Be)|0,E=E+Math.imul(ne,tt)|0;var Nr=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,S=Math.imul(ge,xe),v=Math.imul(ge,je),v=v+Math.imul($e,xe)|0,E=Math.imul($e,je),S=S+Math.imul(ye,He)|0,v=v+Math.imul(ye,dt)|0,v=v+Math.imul(Ie,He)|0,E=E+Math.imul(Ie,dt)|0,S=S+Math.imul(Me,Ge)|0,v=v+Math.imul(Me,pt)|0,v=v+Math.imul(Je,Ge)|0,E=E+Math.imul(Je,pt)|0,S=S+Math.imul(ce,Ye)|0,v=v+Math.imul(ce,nt)|0,v=v+Math.imul(me,Ye)|0,E=E+Math.imul(me,nt)|0,S=S+Math.imul(re,Te)|0,v=v+Math.imul(re,Qe)|0,v=v+Math.imul(se,Te)|0,E=E+Math.imul(se,Qe)|0,S=S+Math.imul(L,Le)|0,v=v+Math.imul(L,Xe)|0,v=v+Math.imul(_,Le)|0,E=E+Math.imul(_,Xe)|0,S=S+Math.imul(D,Be)|0,v=v+Math.imul(D,tt)|0,v=v+Math.imul(F,Be)|0,E=E+Math.imul(F,tt)|0,S=S+Math.imul(T,qe)|0,v=v+Math.imul(T,st)|0,v=v+Math.imul(ne,qe)|0,E=E+Math.imul(ne,st)|0;var Qt=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,S=Math.imul(be,xe),v=Math.imul(be,je),v=v+Math.imul(Oe,xe)|0,E=Math.imul(Oe,je),S=S+Math.imul(ge,He)|0,v=v+Math.imul(ge,dt)|0,v=v+Math.imul($e,He)|0,E=E+Math.imul($e,dt)|0,S=S+Math.imul(ye,Ge)|0,v=v+Math.imul(ye,pt)|0,v=v+Math.imul(Ie,Ge)|0,E=E+Math.imul(Ie,pt)|0,S=S+Math.imul(Me,Ye)|0,v=v+Math.imul(Me,nt)|0,v=v+Math.imul(Je,Ye)|0,E=E+Math.imul(Je,nt)|0,S=S+Math.imul(ce,Te)|0,v=v+Math.imul(ce,Qe)|0,v=v+Math.imul(me,Te)|0,E=E+Math.imul(me,Qe)|0,S=S+Math.imul(re,Le)|0,v=v+Math.imul(re,Xe)|0,v=v+Math.imul(se,Le)|0,E=E+Math.imul(se,Xe)|0,S=S+Math.imul(L,Be)|0,v=v+Math.imul(L,tt)|0,v=v+Math.imul(_,Be)|0,E=E+Math.imul(_,tt)|0,S=S+Math.imul(D,qe)|0,v=v+Math.imul(D,st)|0,v=v+Math.imul(F,qe)|0,E=E+Math.imul(F,st)|0,S=S+Math.imul(T,Re)|0,v=v+Math.imul(T,ut)|0,v=v+Math.imul(ne,Re)|0,E=E+Math.imul(ne,ut)|0;var Wr=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Wr>>>26)|0,Wr&=67108863,S=Math.imul(_e,xe),v=Math.imul(_e,je),v=v+Math.imul(De,xe)|0,E=Math.imul(De,je),S=S+Math.imul(be,He)|0,v=v+Math.imul(be,dt)|0,v=v+Math.imul(Oe,He)|0,E=E+Math.imul(Oe,dt)|0,S=S+Math.imul(ge,Ge)|0,v=v+Math.imul(ge,pt)|0,v=v+Math.imul($e,Ge)|0,E=E+Math.imul($e,pt)|0,S=S+Math.imul(ye,Ye)|0,v=v+Math.imul(ye,nt)|0,v=v+Math.imul(Ie,Ye)|0,E=E+Math.imul(Ie,nt)|0,S=S+Math.imul(Me,Te)|0,v=v+Math.imul(Me,Qe)|0,v=v+Math.imul(Je,Te)|0,E=E+Math.imul(Je,Qe)|0,S=S+Math.imul(ce,Le)|0,v=v+Math.imul(ce,Xe)|0,v=v+Math.imul(me,Le)|0,E=E+Math.imul(me,Xe)|0,S=S+Math.imul(re,Be)|0,v=v+Math.imul(re,tt)|0,v=v+Math.imul(se,Be)|0,E=E+Math.imul(se,tt)|0,S=S+Math.imul(L,qe)|0,v=v+Math.imul(L,st)|0,v=v+Math.imul(_,qe)|0,E=E+Math.imul(_,st)|0,S=S+Math.imul(D,Re)|0,v=v+Math.imul(D,ut)|0,v=v+Math.imul(F,Re)|0,E=E+Math.imul(F,ut)|0,S=S+Math.imul(T,at)|0,v=v+Math.imul(T,Nt)|0,v=v+Math.imul(ne,at)|0,E=E+Math.imul(ne,Nt)|0;var Bi=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Bi>>>26)|0,Bi&=67108863,S=Math.imul(_e,He),v=Math.imul(_e,dt),v=v+Math.imul(De,He)|0,E=Math.imul(De,dt),S=S+Math.imul(be,Ge)|0,v=v+Math.imul(be,pt)|0,v=v+Math.imul(Oe,Ge)|0,E=E+Math.imul(Oe,pt)|0,S=S+Math.imul(ge,Ye)|0,v=v+Math.imul(ge,nt)|0,v=v+Math.imul($e,Ye)|0,E=E+Math.imul($e,nt)|0,S=S+Math.imul(ye,Te)|0,v=v+Math.imul(ye,Qe)|0,v=v+Math.imul(Ie,Te)|0,E=E+Math.imul(Ie,Qe)|0,S=S+Math.imul(Me,Le)|0,v=v+Math.imul(Me,Xe)|0,v=v+Math.imul(Je,Le)|0,E=E+Math.imul(Je,Xe)|0,S=S+Math.imul(ce,Be)|0,v=v+Math.imul(ce,tt)|0,v=v+Math.imul(me,Be)|0,E=E+Math.imul(me,tt)|0,S=S+Math.imul(re,qe)|0,v=v+Math.imul(re,st)|0,v=v+Math.imul(se,qe)|0,E=E+Math.imul(se,st)|0,S=S+Math.imul(L,Re)|0,v=v+Math.imul(L,ut)|0,v=v+Math.imul(_,Re)|0,E=E+Math.imul(_,ut)|0,S=S+Math.imul(D,at)|0,v=v+Math.imul(D,Nt)|0,v=v+Math.imul(F,at)|0,E=E+Math.imul(F,Nt)|0;var Vr=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Vr>>>26)|0,Vr&=67108863,S=Math.imul(_e,Ge),v=Math.imul(_e,pt),v=v+Math.imul(De,Ge)|0,E=Math.imul(De,pt),S=S+Math.imul(be,Ye)|0,v=v+Math.imul(be,nt)|0,v=v+Math.imul(Oe,Ye)|0,E=E+Math.imul(Oe,nt)|0,S=S+Math.imul(ge,Te)|0,v=v+Math.imul(ge,Qe)|0,v=v+Math.imul($e,Te)|0,E=E+Math.imul($e,Qe)|0,S=S+Math.imul(ye,Le)|0,v=v+Math.imul(ye,Xe)|0,v=v+Math.imul(Ie,Le)|0,E=E+Math.imul(Ie,Xe)|0,S=S+Math.imul(Me,Be)|0,v=v+Math.imul(Me,tt)|0,v=v+Math.imul(Je,Be)|0,E=E+Math.imul(Je,tt)|0,S=S+Math.imul(ce,qe)|0,v=v+Math.imul(ce,st)|0,v=v+Math.imul(me,qe)|0,E=E+Math.imul(me,st)|0,S=S+Math.imul(re,Re)|0,v=v+Math.imul(re,ut)|0,v=v+Math.imul(se,Re)|0,E=E+Math.imul(se,ut)|0,S=S+Math.imul(L,at)|0,v=v+Math.imul(L,Nt)|0,v=v+Math.imul(_,at)|0,E=E+Math.imul(_,Nt)|0;var zi=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(zi>>>26)|0,zi&=67108863,S=Math.imul(_e,Ye),v=Math.imul(_e,nt),v=v+Math.imul(De,Ye)|0,E=Math.imul(De,nt),S=S+Math.imul(be,Te)|0,v=v+Math.imul(be,Qe)|0,v=v+Math.imul(Oe,Te)|0,E=E+Math.imul(Oe,Qe)|0,S=S+Math.imul(ge,Le)|0,v=v+Math.imul(ge,Xe)|0,v=v+Math.imul($e,Le)|0,E=E+Math.imul($e,Xe)|0,S=S+Math.imul(ye,Be)|0,v=v+Math.imul(ye,tt)|0,v=v+Math.imul(Ie,Be)|0,E=E+Math.imul(Ie,tt)|0,S=S+Math.imul(Me,qe)|0,v=v+Math.imul(Me,st)|0,v=v+Math.imul(Je,qe)|0,E=E+Math.imul(Je,st)|0,S=S+Math.imul(ce,Re)|0,v=v+Math.imul(ce,ut)|0,v=v+Math.imul(me,Re)|0,E=E+Math.imul(me,ut)|0,S=S+Math.imul(re,at)|0,v=v+Math.imul(re,Nt)|0,v=v+Math.imul(se,at)|0,E=E+Math.imul(se,Nt)|0;var Fi=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Fi>>>26)|0,Fi&=67108863,S=Math.imul(_e,Te),v=Math.imul(_e,Qe),v=v+Math.imul(De,Te)|0,E=Math.imul(De,Qe),S=S+Math.imul(be,Le)|0,v=v+Math.imul(be,Xe)|0,v=v+Math.imul(Oe,Le)|0,E=E+Math.imul(Oe,Xe)|0,S=S+Math.imul(ge,Be)|0,v=v+Math.imul(ge,tt)|0,v=v+Math.imul($e,Be)|0,E=E+Math.imul($e,tt)|0,S=S+Math.imul(ye,qe)|0,v=v+Math.imul(ye,st)|0,v=v+Math.imul(Ie,qe)|0,E=E+Math.imul(Ie,st)|0,S=S+Math.imul(Me,Re)|0,v=v+Math.imul(Me,ut)|0,v=v+Math.imul(Je,Re)|0,E=E+Math.imul(Je,ut)|0,S=S+Math.imul(ce,at)|0,v=v+Math.imul(ce,Nt)|0,v=v+Math.imul(me,at)|0,E=E+Math.imul(me,Nt)|0;var Gr=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(Gr>>>26)|0,Gr&=67108863,S=Math.imul(_e,Le),v=Math.imul(_e,Xe),v=v+Math.imul(De,Le)|0,E=Math.imul(De,Xe),S=S+Math.imul(be,Be)|0,v=v+Math.imul(be,tt)|0,v=v+Math.imul(Oe,Be)|0,E=E+Math.imul(Oe,tt)|0,S=S+Math.imul(ge,qe)|0,v=v+Math.imul(ge,st)|0,v=v+Math.imul($e,qe)|0,E=E+Math.imul($e,st)|0,S=S+Math.imul(ye,Re)|0,v=v+Math.imul(ye,ut)|0,v=v+Math.imul(Ie,Re)|0,E=E+Math.imul(Ie,ut)|0,S=S+Math.imul(Me,at)|0,v=v+Math.imul(Me,Nt)|0,v=v+Math.imul(Je,at)|0,E=E+Math.imul(Je,Nt)|0;var yi=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(yi>>>26)|0,yi&=67108863,S=Math.imul(_e,Be),v=Math.imul(_e,tt),v=v+Math.imul(De,Be)|0,E=Math.imul(De,tt),S=S+Math.imul(be,qe)|0,v=v+Math.imul(be,st)|0,v=v+Math.imul(Oe,qe)|0,E=E+Math.imul(Oe,st)|0,S=S+Math.imul(ge,Re)|0,v=v+Math.imul(ge,ut)|0,v=v+Math.imul($e,Re)|0,E=E+Math.imul($e,ut)|0,S=S+Math.imul(ye,at)|0,v=v+Math.imul(ye,Nt)|0,v=v+Math.imul(Ie,at)|0,E=E+Math.imul(Ie,Nt)|0;var wi=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(wi>>>26)|0,wi&=67108863,S=Math.imul(_e,qe),v=Math.imul(_e,st),v=v+Math.imul(De,qe)|0,E=Math.imul(De,st),S=S+Math.imul(be,Re)|0,v=v+Math.imul(be,ut)|0,v=v+Math.imul(Oe,Re)|0,E=E+Math.imul(Oe,ut)|0,S=S+Math.imul(ge,at)|0,v=v+Math.imul(ge,Nt)|0,v=v+Math.imul($e,at)|0,E=E+Math.imul($e,Nt)|0;var lr=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(lr>>>26)|0,lr&=67108863,S=Math.imul(_e,Re),v=Math.imul(_e,ut),v=v+Math.imul(De,Re)|0,E=Math.imul(De,ut),S=S+Math.imul(be,at)|0,v=v+Math.imul(be,Nt)|0,v=v+Math.imul(Oe,at)|0,E=E+Math.imul(Oe,Nt)|0;var ki=(P+S|0)+((v&8191)<<13)|0;P=(E+(v>>>13)|0)+(ki>>>26)|0,ki&=67108863,S=Math.imul(_e,at),v=Math.imul(_e,Nt),v=v+Math.imul(De,at)|0,E=Math.imul(De,Nt);var Hi=(P+S|0)+((v&8191)<<13)|0;return P=(E+(v>>>13)|0)+(Hi>>>26)|0,Hi&=67108863,A[0]=Rt,A[1]=yt,A[2]=Dr,A[3]=Or,A[4]=Rr,A[5]=Cr,A[6]=Nr,A[7]=Qt,A[8]=Wr,A[9]=Bi,A[10]=Vr,A[11]=zi,A[12]=Fi,A[13]=Gr,A[14]=yi,A[15]=wi,A[16]=lr,A[17]=ki,A[18]=Hi,P!==0&&(A[19]=P,f.length++),f};Math.imul||(q=C);function V(U,m,g){g.negative=m.negative^U.negative,g.length=U.length+m.length;for(var f=0,u=0,y=0;y<g.length-1;y++){var A=u;u=0;for(var P=f&67108863,S=Math.min(y,m.length-1),v=Math.max(0,y-U.length+1);v<=S;v++){var E=y-v,x=U.words[E]|0,T=m.words[v]|0,ne=x*T,fe=ne&67108863;A=A+(ne/67108864|0)|0,fe=fe+P|0,P=fe&67108863,A=A+(fe>>>26)|0,u+=A>>>26,A&=67108863}g.words[y]=P,f=A,A=u}return f!==0?g.words[y]=f:g.length--,g.strip()}function Y(U,m,g){var f=new H;return f.mulp(U,m,g)}a.prototype.mulTo=function(m,g){var f,u=this.length+m.length;return this.length===10&&m.length===10?f=q(this,m,g):u<63?f=C(this,m,g):u<1024?f=V(this,m,g):f=Y(this,m,g),f};function H(U,m){this.x=U,this.y=m}H.prototype.makeRBT=function(m){for(var g=new Array(m),f=a.prototype._countBits(m)-1,u=0;u<m;u++)g[u]=this.revBin(u,f,m);return g},H.prototype.revBin=function(m,g,f){if(m===0||m===f-1)return m;for(var u=0,y=0;y<g;y++)u|=(m&1)<<g-y-1,m>>=1;return u},H.prototype.permute=function(m,g,f,u,y,A){for(var P=0;P<A;P++)u[P]=g[m[P]],y[P]=f[m[P]]},H.prototype.transform=function(m,g,f,u,y,A){this.permute(A,m,g,f,u,y);for(var P=1;P<y;P<<=1)for(var S=P<<1,v=Math.cos(2*Math.PI/S),E=Math.sin(2*Math.PI/S),x=0;x<y;x+=S)for(var T=v,ne=E,fe=0;fe<P;fe++){var D=f[x+fe],F=u[x+fe],j=f[x+fe+P],L=u[x+fe+P],_=T*j-ne*L;L=T*L+ne*j,j=_,f[x+fe]=D+j,u[x+fe]=F+L,f[x+fe+P]=D-j,u[x+fe+P]=F-L,fe!==S&&(_=v*T-E*ne,ne=v*ne+E*T,T=_)}},H.prototype.guessLen13b=function(m,g){var f=Math.max(g,m)|1,u=f&1,y=0;for(f=f/2|0;f;f=f>>>1)y++;return 1<<y+1+u},H.prototype.conjugate=function(m,g,f){if(!(f<=1))for(var u=0;u<f/2;u++){var y=m[u];m[u]=m[f-u-1],m[f-u-1]=y,y=g[u],g[u]=-g[f-u-1],g[f-u-1]=-y}},H.prototype.normalize13b=function(m,g){for(var f=0,u=0;u<g/2;u++){var y=Math.round(m[2*u+1]/g)*8192+Math.round(m[2*u]/g)+f;m[u]=y&67108863,y<67108864?f=0:f=y/67108864|0}return m},H.prototype.convert13b=function(m,g,f,u){for(var y=0,A=0;A<g;A++)y=y+(m[A]|0),f[2*A]=y&8191,y=y>>>13,f[2*A+1]=y&8191,y=y>>>13;for(A=2*g;A<u;++A)f[A]=0;i(y===0),i((y&-8192)===0)},H.prototype.stub=function(m){for(var g=new Array(m),f=0;f<m;f++)g[f]=0;return g},H.prototype.mulp=function(m,g,f){var u=2*this.guessLen13b(m.length,g.length),y=this.makeRBT(u),A=this.stub(u),P=new Array(u),S=new Array(u),v=new Array(u),E=new Array(u),x=new Array(u),T=new Array(u),ne=f.words;ne.length=u,this.convert13b(m.words,m.length,P,u),this.convert13b(g.words,g.length,E,u),this.transform(P,A,S,v,u,y),this.transform(E,A,x,T,u,y);for(var fe=0;fe<u;fe++){var D=S[fe]*x[fe]-v[fe]*T[fe];v[fe]=S[fe]*T[fe]+v[fe]*x[fe],S[fe]=D}return this.conjugate(S,v,u),this.transform(S,v,ne,A,u,y),this.conjugate(ne,A,u),this.normalize13b(ne,u),f.negative=m.negative^g.negative,f.length=m.length+g.length,f.strip()},a.prototype.mul=function(m){var g=new a(null);return g.words=new Array(this.length+m.length),this.mulTo(m,g)},a.prototype.mulf=function(m){var g=new a(null);return g.words=new Array(this.length+m.length),Y(this,m,g)},a.prototype.imul=function(m){return this.clone().mulTo(m,this)},a.prototype.imuln=function(m){i(typeof m=="number"),i(m<67108864);for(var g=0,f=0;f<this.length;f++){var u=(this.words[f]|0)*m,y=(u&67108863)+(g&67108863);g>>=26,g+=u/67108864|0,g+=y>>>26,this.words[f]=y&67108863}return g!==0&&(this.words[f]=g,this.length++),this},a.prototype.muln=function(m){return this.clone().imuln(m)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(m){var g=O(m);if(g.length===0)return new a(1);for(var f=this,u=0;u<g.length&&g[u]===0;u++,f=f.sqr());if(++u<g.length)for(var y=f.sqr();u<g.length;u++,y=y.sqr())g[u]!==0&&(f=f.mul(y));return f},a.prototype.iushln=function(m){i(typeof m=="number"&&m>=0);var g=m%26,f=(m-g)/26,u=67108863>>>26-g<<26-g,y;if(g!==0){var A=0;for(y=0;y<this.length;y++){var P=this.words[y]&u,S=(this.words[y]|0)-P<<g;this.words[y]=S|A,A=P>>>26-g}A&&(this.words[y]=A,this.length++)}if(f!==0){for(y=this.length-1;y>=0;y--)this.words[y+f]=this.words[y];for(y=0;y<f;y++)this.words[y]=0;this.length+=f}return this.strip()},a.prototype.ishln=function(m){return i(this.negative===0),this.iushln(m)},a.prototype.iushrn=function(m,g,f){i(typeof m=="number"&&m>=0);var u;g?u=(g-g%26)/26:u=0;var y=m%26,A=Math.min((m-y)/26,this.length),P=67108863^67108863>>>y<<y,S=f;if(u-=A,u=Math.max(0,u),S){for(var v=0;v<A;v++)S.words[v]=this.words[v];S.length=A}if(A!==0)if(this.length>A)for(this.length-=A,v=0;v<this.length;v++)this.words[v]=this.words[v+A];else this.words[0]=0,this.length=1;var E=0;for(v=this.length-1;v>=0&&(E!==0||v>=u);v--){var x=this.words[v]|0;this.words[v]=E<<26-y|x>>>y,E=x&P}return S&&E!==0&&(S.words[S.length++]=E),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(m,g,f){return i(this.negative===0),this.iushrn(m,g,f)},a.prototype.shln=function(m){return this.clone().ishln(m)},a.prototype.ushln=function(m){return this.clone().iushln(m)},a.prototype.shrn=function(m){return this.clone().ishrn(m)},a.prototype.ushrn=function(m){return this.clone().iushrn(m)},a.prototype.testn=function(m){i(typeof m=="number"&&m>=0);var g=m%26,f=(m-g)/26,u=1<<g;if(this.length<=f)return!1;var y=this.words[f];return!!(y&u)},a.prototype.imaskn=function(m){i(typeof m=="number"&&m>=0);var g=m%26,f=(m-g)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=f)return this;if(g!==0&&f++,this.length=Math.min(f,this.length),g!==0){var u=67108863^67108863>>>g<<g;this.words[this.length-1]&=u}return this.strip()},a.prototype.maskn=function(m){return this.clone().imaskn(m)},a.prototype.iaddn=function(m){return i(typeof m=="number"),i(m<67108864),m<0?this.isubn(-m):this.negative!==0?this.length===1&&(this.words[0]|0)<m?(this.words[0]=m-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(m),this.negative=1,this):this._iaddn(m)},a.prototype._iaddn=function(m){this.words[0]+=m;for(var g=0;g<this.length&&this.words[g]>=67108864;g++)this.words[g]-=67108864,g===this.length-1?this.words[g+1]=1:this.words[g+1]++;return this.length=Math.max(this.length,g+1),this},a.prototype.isubn=function(m){if(i(typeof m=="number"),i(m<67108864),m<0)return this.iaddn(-m);if(this.negative!==0)return this.negative=0,this.iaddn(m),this.negative=1,this;if(this.words[0]-=m,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var g=0;g<this.length&&this.words[g]<0;g++)this.words[g]+=67108864,this.words[g+1]-=1;return this.strip()},a.prototype.addn=function(m){return this.clone().iaddn(m)},a.prototype.subn=function(m){return this.clone().isubn(m)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(m,g,f){var u=m.length+f,y;this._expand(u);var A,P=0;for(y=0;y<m.length;y++){A=(this.words[y+f]|0)+P;var S=(m.words[y]|0)*g;A-=S&67108863,P=(A>>26)-(S/67108864|0),this.words[y+f]=A&67108863}for(;y<this.length-f;y++)A=(this.words[y+f]|0)+P,P=A>>26,this.words[y+f]=A&67108863;if(P===0)return this.strip();for(i(P===-1),P=0,y=0;y<this.length;y++)A=-(this.words[y]|0)+P,P=A>>26,this.words[y]=A&67108863;return this.negative=1,this.strip()},a.prototype._wordDiv=function(m,g){var f=this.length-m.length,u=this.clone(),y=m,A=y.words[y.length-1]|0,P=this._countBits(A);f=26-P,f!==0&&(y=y.ushln(f),u.iushln(f),A=y.words[y.length-1]|0);var S=u.length-y.length,v;if(g!=="mod"){v=new a(null),v.length=S+1,v.words=new Array(v.length);for(var E=0;E<v.length;E++)v.words[E]=0}var x=u.clone()._ishlnsubmul(y,1,S);x.negative===0&&(u=x,v&&(v.words[S]=1));for(var T=S-1;T>=0;T--){var ne=(u.words[y.length+T]|0)*67108864+(u.words[y.length+T-1]|0);for(ne=Math.min(ne/A|0,67108863),u._ishlnsubmul(y,ne,T);u.negative!==0;)ne--,u.negative=0,u._ishlnsubmul(y,1,T),u.isZero()||(u.negative^=1);v&&(v.words[T]=ne)}return v&&v.strip(),u.strip(),g!=="div"&&f!==0&&u.iushrn(f),{div:v||null,mod:u}},a.prototype.divmod=function(m,g,f){if(i(!m.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var u,y,A;return this.negative!==0&&m.negative===0?(A=this.neg().divmod(m,g),g!=="mod"&&(u=A.div.neg()),g!=="div"&&(y=A.mod.neg(),f&&y.negative!==0&&y.iadd(m)),{div:u,mod:y}):this.negative===0&&m.negative!==0?(A=this.divmod(m.neg(),g),g!=="mod"&&(u=A.div.neg()),{div:u,mod:A.mod}):this.negative&m.negative?(A=this.neg().divmod(m.neg(),g),g!=="div"&&(y=A.mod.neg(),f&&y.negative!==0&&y.isub(m)),{div:A.div,mod:y}):m.length>this.length||this.cmp(m)<0?{div:new a(0),mod:this}:m.length===1?g==="div"?{div:this.divn(m.words[0]),mod:null}:g==="mod"?{div:null,mod:new a(this.modn(m.words[0]))}:{div:this.divn(m.words[0]),mod:new a(this.modn(m.words[0]))}:this._wordDiv(m,g)},a.prototype.div=function(m){return this.divmod(m,"div",!1).div},a.prototype.mod=function(m){return this.divmod(m,"mod",!1).mod},a.prototype.umod=function(m){return this.divmod(m,"mod",!0).mod},a.prototype.divRound=function(m){var g=this.divmod(m);if(g.mod.isZero())return g.div;var f=g.div.negative!==0?g.mod.isub(m):g.mod,u=m.ushrn(1),y=m.andln(1),A=f.cmp(u);return A<0||y===1&&A===0?g.div:g.div.negative!==0?g.div.isubn(1):g.div.iaddn(1)},a.prototype.modn=function(m){i(m<=67108863);for(var g=(1<<26)%m,f=0,u=this.length-1;u>=0;u--)f=(g*f+(this.words[u]|0))%m;return f},a.prototype.idivn=function(m){i(m<=67108863);for(var g=0,f=this.length-1;f>=0;f--){var u=(this.words[f]|0)+g*67108864;this.words[f]=u/m|0,g=u%m}return this.strip()},a.prototype.divn=function(m){return this.clone().idivn(m)},a.prototype.egcd=function(m){i(m.negative===0),i(!m.isZero());var g=this,f=m.clone();g.negative!==0?g=g.umod(m):g=g.clone();for(var u=new a(1),y=new a(0),A=new a(0),P=new a(1),S=0;g.isEven()&&f.isEven();)g.iushrn(1),f.iushrn(1),++S;for(var v=f.clone(),E=g.clone();!g.isZero();){for(var x=0,T=1;!(g.words[0]&T)&&x<26;++x,T<<=1);if(x>0)for(g.iushrn(x);x-- >0;)(u.isOdd()||y.isOdd())&&(u.iadd(v),y.isub(E)),u.iushrn(1),y.iushrn(1);for(var ne=0,fe=1;!(f.words[0]&fe)&&ne<26;++ne,fe<<=1);if(ne>0)for(f.iushrn(ne);ne-- >0;)(A.isOdd()||P.isOdd())&&(A.iadd(v),P.isub(E)),A.iushrn(1),P.iushrn(1);g.cmp(f)>=0?(g.isub(f),u.isub(A),y.isub(P)):(f.isub(g),A.isub(u),P.isub(y))}return{a:A,b:P,gcd:f.iushln(S)}},a.prototype._invmp=function(m){i(m.negative===0),i(!m.isZero());var g=this,f=m.clone();g.negative!==0?g=g.umod(m):g=g.clone();for(var u=new a(1),y=new a(0),A=f.clone();g.cmpn(1)>0&&f.cmpn(1)>0;){for(var P=0,S=1;!(g.words[0]&S)&&P<26;++P,S<<=1);if(P>0)for(g.iushrn(P);P-- >0;)u.isOdd()&&u.iadd(A),u.iushrn(1);for(var v=0,E=1;!(f.words[0]&E)&&v<26;++v,E<<=1);if(v>0)for(f.iushrn(v);v-- >0;)y.isOdd()&&y.iadd(A),y.iushrn(1);g.cmp(f)>=0?(g.isub(f),u.isub(y)):(f.isub(g),y.isub(u))}var x;return g.cmpn(1)===0?x=u:x=y,x.cmpn(0)<0&&x.iadd(m),x},a.prototype.gcd=function(m){if(this.isZero())return m.abs();if(m.isZero())return this.abs();var g=this.clone(),f=m.clone();g.negative=0,f.negative=0;for(var u=0;g.isEven()&&f.isEven();u++)g.iushrn(1),f.iushrn(1);do{for(;g.isEven();)g.iushrn(1);for(;f.isEven();)f.iushrn(1);var y=g.cmp(f);if(y<0){var A=g;g=f,f=A}else if(y===0||f.cmpn(1)===0)break;g.isub(f)}while(!0);return f.iushln(u)},a.prototype.invm=function(m){return this.egcd(m).a.umod(m)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(m){return this.words[0]&m},a.prototype.bincn=function(m){i(typeof m=="number");var g=m%26,f=(m-g)/26,u=1<<g;if(this.length<=f)return this._expand(f+1),this.words[f]|=u,this;for(var y=u,A=f;y!==0&&A<this.length;A++){var P=this.words[A]|0;P+=y,y=P>>>26,P&=67108863,this.words[A]=P}return y!==0&&(this.words[A]=y,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(m){var g=m<0;if(this.negative!==0&&!g)return-1;if(this.negative===0&&g)return 1;this.strip();var f;if(this.length>1)f=1;else{g&&(m=-m),i(m<=67108863,"Number is too big");var u=this.words[0]|0;f=u===m?0:u<m?-1:1}return this.negative!==0?-f|0:f},a.prototype.cmp=function(m){if(this.negative!==0&&m.negative===0)return-1;if(this.negative===0&&m.negative!==0)return 1;var g=this.ucmp(m);return this.negative!==0?-g|0:g},a.prototype.ucmp=function(m){if(this.length>m.length)return 1;if(this.length<m.length)return-1;for(var g=0,f=this.length-1;f>=0;f--){var u=this.words[f]|0,y=m.words[f]|0;if(u!==y){u<y?g=-1:u>y&&(g=1);break}}return g},a.prototype.gtn=function(m){return this.cmpn(m)===1},a.prototype.gt=function(m){return this.cmp(m)===1},a.prototype.gten=function(m){return this.cmpn(m)>=0},a.prototype.gte=function(m){return this.cmp(m)>=0},a.prototype.ltn=function(m){return this.cmpn(m)===-1},a.prototype.lt=function(m){return this.cmp(m)===-1},a.prototype.lten=function(m){return this.cmpn(m)<=0},a.prototype.lte=function(m){return this.cmp(m)<=0},a.prototype.eqn=function(m){return this.cmpn(m)===0},a.prototype.eq=function(m){return this.cmp(m)===0},a.red=function(m){return new ae(m)},a.prototype.toRed=function(m){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),m.convertTo(this)._forceRed(m)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(m){return this.red=m,this},a.prototype.forceRed=function(m){return i(!this.red,"Already a number in reduction context"),this._forceRed(m)},a.prototype.redAdd=function(m){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,m)},a.prototype.redIAdd=function(m){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,m)},a.prototype.redSub=function(m){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,m)},a.prototype.redISub=function(m){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,m)},a.prototype.redShl=function(m){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,m)},a.prototype.redMul=function(m){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,m),this.red.mul(this,m)},a.prototype.redIMul=function(m){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,m),this.red.imul(this,m)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(m){return i(this.red&&!m.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,m)};var X={k256:null,p224:null,p192:null,p25519:null};function k(U,m){this.name=U,this.p=new a(m,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}k.prototype._tmp=function(){var m=new a(null);return m.words=new Array(Math.ceil(this.n/13)),m},k.prototype.ireduce=function(m){var g=m,f;do this.split(g,this.tmp),g=this.imulK(g),g=g.iadd(this.tmp),f=g.bitLength();while(f>this.n);var u=f<this.n?-1:g.ucmp(this.p);return u===0?(g.words[0]=0,g.length=1):u>0?g.isub(this.p):g.strip!==void 0?g.strip():g._strip(),g},k.prototype.split=function(m,g){m.iushrn(this.n,0,g)},k.prototype.imulK=function(m){return m.imul(this.k)};function W(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(W,k),W.prototype.split=function(m,g){for(var f=4194303,u=Math.min(m.length,9),y=0;y<u;y++)g.words[y]=m.words[y];if(g.length=u,m.length<=9){m.words[0]=0,m.length=1;return}var A=m.words[9];for(g.words[g.length++]=A&f,y=10;y<m.length;y++){var P=m.words[y]|0;m.words[y-10]=(P&f)<<4|A>>>22,A=P}A>>>=22,m.words[y-10]=A,A===0&&m.length>10?m.length-=10:m.length-=9},W.prototype.imulK=function(m){m.words[m.length]=0,m.words[m.length+1]=0,m.length+=2;for(var g=0,f=0;f<m.length;f++){var u=m.words[f]|0;g+=u*977,m.words[f]=g&67108863,g=u*64+(g/67108864|0)}return m.words[m.length-1]===0&&(m.length--,m.words[m.length-1]===0&&m.length--),m};function J(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(J,k);function M(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(M,k);function B(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(B,k),B.prototype.imulK=function(m){for(var g=0,f=0;f<m.length;f++){var u=(m.words[f]|0)*19+g,y=u&67108863;u>>>=26,m.words[f]=y,g=u}return g!==0&&(m.words[m.length++]=g),m},a._prime=function(m){if(X[m])return X[m];var g;if(m==="k256")g=new W;else if(m==="p224")g=new J;else if(m==="p192")g=new M;else if(m==="p25519")g=new B;else throw new Error("Unknown prime "+m);return X[m]=g,g};function ae(U){if(typeof U=="string"){var m=a._prime(U);this.m=m.p,this.prime=m}else i(U.gtn(1),"modulus must be greater than 1"),this.m=U,this.prime=null}ae.prototype._verify1=function(m){i(m.negative===0,"red works only with positives"),i(m.red,"red works only with red numbers")},ae.prototype._verify2=function(m,g){i((m.negative|g.negative)===0,"red works only with positives"),i(m.red&&m.red===g.red,"red works only with red numbers")},ae.prototype.imod=function(m){return this.prime?this.prime.ireduce(m)._forceRed(this):m.umod(this.m)._forceRed(this)},ae.prototype.neg=function(m){return m.isZero()?m.clone():this.m.sub(m)._forceRed(this)},ae.prototype.add=function(m,g){this._verify2(m,g);var f=m.add(g);return f.cmp(this.m)>=0&&f.isub(this.m),f._forceRed(this)},ae.prototype.iadd=function(m,g){this._verify2(m,g);var f=m.iadd(g);return f.cmp(this.m)>=0&&f.isub(this.m),f},ae.prototype.sub=function(m,g){this._verify2(m,g);var f=m.sub(g);return f.cmpn(0)<0&&f.iadd(this.m),f._forceRed(this)},ae.prototype.isub=function(m,g){this._verify2(m,g);var f=m.isub(g);return f.cmpn(0)<0&&f.iadd(this.m),f},ae.prototype.shl=function(m,g){return this._verify1(m),this.imod(m.ushln(g))},ae.prototype.imul=function(m,g){return this._verify2(m,g),this.imod(m.imul(g))},ae.prototype.mul=function(m,g){return this._verify2(m,g),this.imod(m.mul(g))},ae.prototype.isqr=function(m){return this.imul(m,m.clone())},ae.prototype.sqr=function(m){return this.mul(m,m)},ae.prototype.sqrt=function(m){if(m.isZero())return m.clone();var g=this.m.andln(3);if(i(g%2===1),g===3){var f=this.m.add(new a(1)).iushrn(2);return this.pow(m,f)}for(var u=this.m.subn(1),y=0;!u.isZero()&&u.andln(1)===0;)y++,u.iushrn(1);i(!u.isZero());var A=new a(1).toRed(this),P=A.redNeg(),S=this.m.subn(1).iushrn(1),v=this.m.bitLength();for(v=new a(2*v*v).toRed(this);this.pow(v,S).cmp(P)!==0;)v.redIAdd(P);for(var E=this.pow(v,u),x=this.pow(m,u.addn(1).iushrn(1)),T=this.pow(m,u),ne=y;T.cmp(A)!==0;){for(var fe=T,D=0;fe.cmp(A)!==0;D++)fe=fe.redSqr();i(D<ne);var F=this.pow(E,new a(1).iushln(ne-D-1));x=x.redMul(F),E=F.redSqr(),T=T.redMul(E),ne=D}return x},ae.prototype.invm=function(m){var g=m._invmp(this.m);return g.negative!==0?(g.negative=0,this.imod(g).redNeg()):this.imod(g)},ae.prototype.pow=function(m,g){if(g.isZero())return new a(1).toRed(this);if(g.cmpn(1)===0)return m.clone();var f=4,u=new Array(1<<f);u[0]=new a(1).toRed(this),u[1]=m;for(var y=2;y<u.length;y++)u[y]=this.mul(u[y-1],m);var A=u[0],P=0,S=0,v=g.bitLength()%26;for(v===0&&(v=26),y=g.length-1;y>=0;y--){for(var E=g.words[y],x=v-1;x>=0;x--){var T=E>>x&1;if(A!==u[0]&&(A=this.sqr(A)),T===0&&P===0){S=0;continue}P<<=1,P|=T,S++,!(S!==f&&(y!==0||x!==0))&&(A=this.mul(A,u[P]),S=0,P=0)}v=26}return A},ae.prototype.convertTo=function(m){var g=m.umod(this.m);return g===m?g.clone():g},ae.prototype.convertFrom=function(m){var g=m.clone();return g.red=null,g},a.mont=function(m){return new de(m)};function de(U){ae.call(this,U),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(de,ae),de.prototype.convertTo=function(m){return this.imod(m.ushln(this.shift))},de.prototype.convertFrom=function(m){var g=this.imod(m.mul(this.rinv));return g.red=null,g},de.prototype.imul=function(m,g){if(m.isZero()||g.isZero())return m.words[0]=0,m.length=1,m;var f=m.imul(g),u=f.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=f.isub(u).iushrn(this.shift),A=y;return y.cmp(this.m)>=0?A=y.isub(this.m):y.cmpn(0)<0&&(A=y.iadd(this.m)),A._forceRed(this)},de.prototype.mul=function(m,g){if(m.isZero()||g.isZero())return new a(0)._forceRed(this);var f=m.mul(g),u=f.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=f.isub(u).iushrn(this.shift),A=y;return y.cmp(this.m)>=0?A=y.isub(this.m):y.cmpn(0)<0&&(A=y.iadd(this.m)),A._forceRed(this)},de.prototype.invm=function(m){var g=this.imod(m._invmp(this.m).mul(this.r2));return g._forceRed(this)}})(r,Wc)})(td);var Yn=td.exports,rd={};(function(r){var e=r;function t(a,c){if(Array.isArray(a))return a.slice();if(!a)return[];var h=[];if(typeof a!="string"){for(var d=0;d<a.length;d++)h[d]=a[d]|0;return h}if(c==="hex"){a=a.replace(/[^a-z0-9]+/ig,""),a.length%2!==0&&(a="0"+a);for(var d=0;d<a.length;d+=2)h.push(parseInt(a[d]+a[d+1],16))}else for(var d=0;d<a.length;d++){var p=a.charCodeAt(d),b=p>>8,w=p&255;b?h.push(b,w):h.push(w)}return h}e.toArray=t;function i(a){return a.length===1?"0"+a:a}e.zero2=i;function n(a){for(var c="",h=0;h<a.length;h++)c+=i(a[h].toString(16));return c}e.toHex=n,e.encode=function(c,h){return h==="hex"?n(c):c}})(rd);(function(r){var e=r,t=Yn,i=Zs,n=rd;e.assert=i,e.toArray=n.toArray,e.zero2=n.zero2,e.toHex=n.toHex,e.encode=n.encode;function a(b,w,R){var O=new Array(Math.max(b.bitLength(),R)+1),C;for(C=0;C<O.length;C+=1)O[C]=0;var q=1<<w+1,V=b.clone();for(C=0;C<O.length;C++){var Y,H=V.andln(q-1);V.isOdd()?(H>(q>>1)-1?Y=(q>>1)-H:Y=H,V.isubn(Y)):Y=0,O[C]=Y,V.iushrn(1)}return O}e.getNAF=a;function c(b,w){var R=[[],[]];b=b.clone(),w=w.clone();for(var O=0,C=0,q;b.cmpn(-O)>0||w.cmpn(-C)>0;){var V=b.andln(3)+O&3,Y=w.andln(3)+C&3;V===3&&(V=-1),Y===3&&(Y=-1);var H;V&1?(q=b.andln(7)+O&7,(q===3||q===5)&&Y===2?H=-V:H=V):H=0,R[0].push(H);var X;Y&1?(q=w.andln(7)+C&7,(q===3||q===5)&&V===2?X=-Y:X=Y):X=0,R[1].push(X),2*O===H+1&&(O=1-O),2*C===X+1&&(C=1-C),b.iushrn(1),w.iushrn(1)}return R}e.getJSF=c;function h(b,w,R){var O="_"+w;b.prototype[w]=function(){return this[O]!==void 0?this[O]:this[O]=R.call(this)}}e.cachedProperty=h;function d(b){return typeof b=="string"?e.toArray(b,"hex"):b}e.parseBytes=d;function p(b){return new t(b,"hex","le")}e.intFromLE=p})(mi);var id={exports:{}},ju;id.exports=function(e){return ju||(ju=new us(null)),ju.generate(e)};function us(r){this.rand=r}id.exports.Rand=us;us.prototype.generate=function(e){return this._rand(e)};us.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?us.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?us.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:typeof window=="object"&&(us.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var av=Gc;if(typeof av.randomBytes!="function")throw new Error("Not supported");us.prototype._rand=function(e){return av.randomBytes(e)}}catch{}var rb=id.exports,nd={},Us=Yn,Yo=mi,Nc=Yo.getNAF,xx=Yo.getJSF,Tc=Yo.assert;function ws(r,e){this.type=r,this.p=new Us(e.p,16),this.red=e.prime?Us.red(e.prime):Us.mont(this.p),this.zero=new Us(0).toRed(this.red),this.one=new Us(1).toRed(this.red),this.two=new Us(2).toRed(this.red),this.n=e.n&&new Us(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var nh=ws;ws.prototype.point=function(){throw new Error("Not implemented")};ws.prototype.validate=function(){throw new Error("Not implemented")};ws.prototype._fixedNafMul=function(e,t){Tc(e.precomputed);var i=e._getDoubles(),n=Nc(t,1,this._bitLength),a=(1<<i.step+1)-(i.step%2===0?2:1);a/=3;var c=[],h,d;for(h=0;h<n.length;h+=i.step){d=0;for(var p=h+i.step-1;p>=h;p--)d=(d<<1)+n[p];c.push(d)}for(var b=this.jpoint(null,null,null),w=this.jpoint(null,null,null),R=a;R>0;R--){for(h=0;h<c.length;h++)d=c[h],d===R?w=w.mixedAdd(i.points[h]):d===-R&&(w=w.mixedAdd(i.points[h].neg()));b=b.add(w)}return b.toP()};ws.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var a=n.points,c=Nc(t,i,this._bitLength),h=this.jpoint(null,null,null),d=c.length-1;d>=0;d--){for(var p=0;d>=0&&c[d]===0;d--)p++;if(d>=0&&p++,h=h.dblp(p),d<0)break;var b=c[d];Tc(b!==0),e.type==="affine"?b>0?h=h.mixedAdd(a[b-1>>1]):h=h.mixedAdd(a[-b-1>>1].neg()):b>0?h=h.add(a[b-1>>1]):h=h.add(a[-b-1>>1].neg())}return e.type==="affine"?h.toP():h};ws.prototype._wnafMulAdd=function(e,t,i,n,a){var c=this._wnafT1,h=this._wnafT2,d=this._wnafT3,p=0,b,w,R;for(b=0;b<n;b++){R=t[b];var O=R._getNAFPoints(e);c[b]=O.wnd,h[b]=O.points}for(b=n-1;b>=1;b-=2){var C=b-1,q=b;if(c[C]!==1||c[q]!==1){d[C]=Nc(i[C],c[C],this._bitLength),d[q]=Nc(i[q],c[q],this._bitLength),p=Math.max(d[C].length,p),p=Math.max(d[q].length,p);continue}var V=[t[C],null,null,t[q]];t[C].y.cmp(t[q].y)===0?(V[1]=t[C].add(t[q]),V[2]=t[C].toJ().mixedAdd(t[q].neg())):t[C].y.cmp(t[q].y.redNeg())===0?(V[1]=t[C].toJ().mixedAdd(t[q]),V[2]=t[C].add(t[q].neg())):(V[1]=t[C].toJ().mixedAdd(t[q]),V[2]=t[C].toJ().mixedAdd(t[q].neg()));var Y=[-3,-1,-5,-7,0,7,5,1,3],H=xx(i[C],i[q]);for(p=Math.max(H[0].length,p),d[C]=new Array(p),d[q]=new Array(p),w=0;w<p;w++){var X=H[0][w]|0,k=H[1][w]|0;d[C][w]=Y[(X+1)*3+(k+1)],d[q][w]=0,h[C]=V}}var W=this.jpoint(null,null,null),J=this._wnafT4;for(b=p;b>=0;b--){for(var M=0;b>=0;){var B=!0;for(w=0;w<n;w++)J[w]=d[w][b]|0,J[w]!==0&&(B=!1);if(!B)break;M++,b--}if(b>=0&&M++,W=W.dblp(M),b<0)break;for(w=0;w<n;w++){var ae=J[w];ae!==0&&(ae>0?R=h[w][ae-1>>1]:ae<0&&(R=h[w][-ae-1>>1].neg()),R.type==="affine"?W=W.mixedAdd(R):W=W.add(R))}}for(b=0;b<n;b++)h[b]=null;return a?W:W.toP()};function qi(r,e){this.curve=r,this.type=e,this.precomputed=null}ws.BasePoint=qi;qi.prototype.eq=function(){throw new Error("Not implemented")};qi.prototype.validate=function(){return this.curve.validate(this)};ws.prototype.decodePoint=function(e,t){e=Yo.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?Tc(e[e.length-1]%2===0):e[0]===7&&Tc(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};qi.prototype.encodeCompressed=function(e){return this.encode(e,!0)};qi.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};qi.prototype.encode=function(e,t){return Yo.encode(this._encode(t),e)};qi.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};qi.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};qi.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,a=0;a<t;a+=e){for(var c=0;c<e;c++)n=n.dbl();i.push(n)}return{step:e,points:i}};qi.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),a=1;a<i;a++)t[a]=t[a-1].add(n);return{wnd:e,points:t}};qi.prototype._getBeta=function(){return null};qi.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t};var Ex=mi,ir=Yn,sd=Jc,ja=nh,Sx=Ex.assert;function Ui(r){ja.call(this,"short",r),this.a=new ir(r.a,16).toRed(this.red),this.b=new ir(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}sd(Ui,ja);var Mx=Ui;Ui.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new ir(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(e.lambda)i=new ir(e.lambda,16);else{var a=this._getEndoRoots(this.n);this.g.mul(a[0]).x.cmp(this.g.x.redMul(t))===0?i=a[0]:(i=a[1],Sx(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var c;return e.basis?c=e.basis.map(function(h){return{a:new ir(h.a,16),b:new ir(h.b,16)}}):c=this._getEndoBasis(i),{beta:t,lambda:i,basis:c}}};Ui.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:ir.mont(e),i=new ir(2).toRed(t).redInvm(),n=i.redNeg(),a=new ir(3).toRed(t).redNeg().redSqrt().redMul(i),c=n.redAdd(a).fromRed(),h=n.redSub(a).fromRed();return[c,h]};Ui.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),a=new ir(1),c=new ir(0),h=new ir(0),d=new ir(1),p,b,w,R,O,C,q,V=0,Y,H;i.cmpn(0)!==0;){var X=n.div(i);Y=n.sub(X.mul(i)),H=h.sub(X.mul(a));var k=d.sub(X.mul(c));if(!w&&Y.cmp(t)<0)p=q.neg(),b=a,w=Y.neg(),R=H;else if(w&&++V===2)break;q=Y,n=i,i=Y,h=a,a=H,d=c,c=k}O=Y.neg(),C=H;var W=w.sqr().add(R.sqr()),J=O.sqr().add(C.sqr());return J.cmp(W)>=0&&(O=p,C=b),w.negative&&(w=w.neg(),R=R.neg()),O.negative&&(O=O.neg(),C=C.neg()),[{a:w,b:R},{a:O,b:C}]};Ui.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],a=n.b.mul(e).divRound(this.n),c=i.b.neg().mul(e).divRound(this.n),h=a.mul(i.a),d=c.mul(n.a),p=a.mul(i.b),b=c.mul(n.b),w=e.sub(h).sub(d),R=p.add(b).neg();return{k1:w,k2:R}};Ui.prototype.pointFromX=function(e,t){e=new ir(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var a=n.fromRed().isOdd();return(t&&!a||!t&&a)&&(n=n.redNeg()),this.point(e,n)};Ui.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),a=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(a).cmpn(0)===0};Ui.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,a=this._endoWnafT2,c=0;c<e.length;c++){var h=this._endoSplit(t[c]),d=e[c],p=d._getBeta();h.k1.negative&&(h.k1.ineg(),d=d.neg(!0)),h.k2.negative&&(h.k2.ineg(),p=p.neg(!0)),n[c*2]=d,n[c*2+1]=p,a[c*2]=h.k1,a[c*2+1]=h.k2}for(var b=this._wnafMulAdd(1,n,a,c*2,i),w=0;w<c*2;w++)n[w]=null,a[w]=null;return b};function Er(r,e,t,i){ja.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new ir(e,16),this.y=new ir(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}sd(Er,ja.BasePoint);Ui.prototype.point=function(e,t,i){return new Er(this,e,t,i)};Ui.prototype.pointFromJSON=function(e,t){return Er.fromJSON(this,e,t)};Er.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(a){return i.point(a.x.redMul(i.endo.beta),a.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}};Er.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Er.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function a(h){return e.point(h[0],h[1],i)}var c=t[2];return n.precomputed={beta:null,doubles:c.doubles&&{step:c.doubles.step,points:[n].concat(c.doubles.points.map(a))},naf:c.naf&&{wnd:c.naf.wnd,points:[n].concat(c.naf.points.map(a))}},n};Er.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Er.prototype.isInfinity=function(){return this.inf};Er.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};Er.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),a=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),c=a.redSqr().redISub(this.x.redAdd(this.x)),h=a.redMul(this.x.redSub(c)).redISub(this.y);return this.curve.point(c,h)};Er.prototype.getX=function(){return this.x.fromRed()};Er.prototype.getY=function(){return this.y.fromRed()};Er.prototype.mul=function(e){return e=new ir(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Er.prototype.mulAdd=function(e,t,i){var n=[this,t],a=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,a):this.curve._wnafMulAdd(1,n,a,2)};Er.prototype.jmulAdd=function(e,t,i){var n=[this,t],a=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,a,!0):this.curve._wnafMulAdd(1,n,a,2,!0)};Er.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Er.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(a){return a.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t};Er.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Ar(r,e,t,i){ja.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new ir(0)):(this.x=new ir(e,16),this.y=new ir(t,16),this.z=new ir(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}sd(Ar,ja.BasePoint);Ui.prototype.jpoint=function(e,t,i){return new Ar(this,e,t,i)};Ar.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)};Ar.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Ar.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),a=e.x.redMul(i),c=this.y.redMul(t.redMul(e.z)),h=e.y.redMul(i.redMul(this.z)),d=n.redSub(a),p=c.redSub(h);if(d.cmpn(0)===0)return p.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=d.redSqr(),w=b.redMul(d),R=n.redMul(b),O=p.redSqr().redIAdd(w).redISub(R).redISub(R),C=p.redMul(R.redISub(O)).redISub(c.redMul(w)),q=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(O,C,q)};Ar.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),a=this.y,c=e.y.redMul(t).redMul(this.z),h=i.redSub(n),d=a.redSub(c);if(h.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var p=h.redSqr(),b=p.redMul(h),w=i.redMul(p),R=d.redSqr().redIAdd(b).redISub(w).redISub(w),O=d.redMul(w.redISub(R)).redISub(a.redMul(b)),C=this.z.redMul(h);return this.curve.jpoint(R,O,C)};Ar.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,a=this.curve.tinv,c=this.x,h=this.y,d=this.z,p=d.redSqr().redSqr(),b=h.redAdd(h);for(t=0;t<e;t++){var w=c.redSqr(),R=b.redSqr(),O=R.redSqr(),C=w.redAdd(w).redIAdd(w).redIAdd(n.redMul(p)),q=c.redMul(R),V=C.redSqr().redISub(q.redAdd(q)),Y=q.redISub(V),H=C.redMul(Y);H=H.redIAdd(H).redISub(O);var X=b.redMul(d);t+1<e&&(p=p.redMul(O)),c=V,d=X,b=H}return this.curve.jpoint(c,b.redMul(a),d)};Ar.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Ar.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),a=this.y.redSqr(),c=a.redSqr(),h=this.x.redAdd(a).redSqr().redISub(n).redISub(c);h=h.redIAdd(h);var d=n.redAdd(n).redIAdd(n),p=d.redSqr().redISub(h).redISub(h),b=c.redIAdd(c);b=b.redIAdd(b),b=b.redIAdd(b),e=p,t=d.redMul(h.redISub(p)).redISub(b),i=this.y.redAdd(this.y)}else{var w=this.x.redSqr(),R=this.y.redSqr(),O=R.redSqr(),C=this.x.redAdd(R).redSqr().redISub(w).redISub(O);C=C.redIAdd(C);var q=w.redAdd(w).redIAdd(w),V=q.redSqr(),Y=O.redIAdd(O);Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),e=V.redISub(C).redISub(C),t=q.redMul(C.redISub(e)).redISub(Y),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};Ar.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),a=this.y.redSqr(),c=a.redSqr(),h=this.x.redAdd(a).redSqr().redISub(n).redISub(c);h=h.redIAdd(h);var d=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),p=d.redSqr().redISub(h).redISub(h);e=p;var b=c.redIAdd(c);b=b.redIAdd(b),b=b.redIAdd(b),t=d.redMul(h.redISub(p)).redISub(b),i=this.y.redAdd(this.y)}else{var w=this.z.redSqr(),R=this.y.redSqr(),O=this.x.redMul(R),C=this.x.redSub(w).redMul(this.x.redAdd(w));C=C.redAdd(C).redIAdd(C);var q=O.redIAdd(O);q=q.redIAdd(q);var V=q.redAdd(q);e=C.redSqr().redISub(V),i=this.y.redAdd(this.z).redSqr().redISub(R).redISub(w);var Y=R.redSqr();Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),Y=Y.redIAdd(Y),t=C.redMul(q.redISub(e)).redISub(Y)}return this.curve.jpoint(e,t,i)};Ar.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,a=n.redSqr().redSqr(),c=t.redSqr(),h=i.redSqr(),d=c.redAdd(c).redIAdd(c).redIAdd(e.redMul(a)),p=t.redAdd(t);p=p.redIAdd(p);var b=p.redMul(h),w=d.redSqr().redISub(b.redAdd(b)),R=b.redISub(w),O=h.redSqr();O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O);var C=d.redMul(R).redISub(O),q=i.redAdd(i).redMul(n);return this.curve.jpoint(w,C,q)};Ar.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),a=e.redAdd(e).redIAdd(e),c=a.redSqr(),h=this.x.redAdd(t).redSqr().redISub(e).redISub(n);h=h.redIAdd(h),h=h.redAdd(h).redIAdd(h),h=h.redISub(c);var d=h.redSqr(),p=n.redIAdd(n);p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var b=a.redIAdd(h).redSqr().redISub(c).redISub(d).redISub(p),w=t.redMul(b);w=w.redIAdd(w),w=w.redIAdd(w);var R=this.x.redMul(d).redISub(w);R=R.redIAdd(R),R=R.redIAdd(R);var O=this.y.redMul(b.redMul(p.redISub(b)).redISub(h.redMul(d)));O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O);var C=this.z.redAdd(h).redSqr().redISub(i).redISub(d);return this.curve.jpoint(R,O,C)};Ar.prototype.mul=function(e,t){return e=new ir(e,t),this.curve._wnafMul(this,e)};Ar.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),a=i.redMul(e.z);return this.y.redMul(a).redISub(e.y.redMul(n)).cmpn(0)===0};Ar.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),a=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(a),this.x.cmp(i)===0)return!0}};Ar.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Ar.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Oa=Yn,ib=Jc,sh=nh,Ix=mi;function Wa(r){sh.call(this,"mont",r),this.a=new Oa(r.a,16).toRed(this.red),this.b=new Oa(r.b,16).toRed(this.red),this.i4=new Oa(4).toRed(this.red).redInvm(),this.two=new Oa(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}ib(Wa,sh);var Ax=Wa;Wa.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),n=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t),a=n.redSqrt();return a.redSqr().cmp(n)===0};function _r(r,e,t){sh.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Oa(e,16),this.z=new Oa(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}ib(_r,sh.BasePoint);Wa.prototype.decodePoint=function(e,t){return this.point(Ix.toArray(e,t),1)};Wa.prototype.point=function(e,t){return new _r(this,e,t)};Wa.prototype.pointFromJSON=function(e){return _r.fromJSON(this,e)};_r.prototype.precompute=function(){};_r.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};_r.fromJSON=function(e,t){return new _r(e,t[0],t[1]||e.one)};_r.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};_r.prototype.isInfinity=function(){return this.z.cmpn(0)===0};_r.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),a=t.redSub(n),c=t.redMul(n),h=a.redMul(n.redAdd(this.curve.a24.redMul(a)));return this.curve.point(c,h)};_r.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};_r.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),a=e.x.redAdd(e.z),c=e.x.redSub(e.z),h=c.redMul(i),d=a.redMul(n),p=t.z.redMul(h.redAdd(d).redSqr()),b=t.x.redMul(h.redISub(d).redSqr());return this.curve.point(p,b)};_r.prototype.mul=function(e){for(var t=e.clone(),i=this,n=this.curve.point(null,null),a=this,c=[];t.cmpn(0)!==0;t.iushrn(1))c.push(t.andln(1));for(var h=c.length-1;h>=0;h--)c[h]===0?(i=i.diffAdd(n,a),n=n.dbl()):(n=i.diffAdd(n,a),i=i.dbl());return n};_r.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};_r.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};_r.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};_r.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};_r.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var Px=mi,jn=Yn,nb=Jc,ah=nh,Dx=Px.assert;function Pn(r){this.twisted=(r.a|0)!==1,this.mOneA=this.twisted&&(r.a|0)===-1,this.extended=this.mOneA,ah.call(this,"edwards",r),this.a=new jn(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new jn(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new jn(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Dx(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)===1}nb(Pn,ah);var Ox=Pn;Pn.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Pn.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Pn.prototype.jpoint=function(e,t,i,n){return this.point(e,t,i,n)};Pn.prototype.pointFromX=function(e,t){e=new jn(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),a=this.one.redSub(this.c2.redMul(this.d).redMul(i)),c=n.redMul(a.redInvm()),h=c.redSqrt();if(h.redSqr().redSub(c).cmp(this.zero)!==0)throw new Error("invalid point");var d=h.fromRed().isOdd();return(t&&!d||!t&&d)&&(h=h.redNeg()),this.point(e,h)};Pn.prototype.pointFromY=function(e,t){e=new jn(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),a=i.redMul(this.d).redMul(this.c2).redSub(this.a),c=n.redMul(a.redInvm());if(c.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var h=c.redSqrt();if(h.redSqr().redSub(c).cmp(this.zero)!==0)throw new Error("invalid point");return h.fromRed().isOdd()!==t&&(h=h.redNeg()),this.point(h,e)};Pn.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),n=t.redMul(this.a).redAdd(i),a=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return n.cmp(a)===0};function Vt(r,e,t,i,n){ah.BasePoint.call(this,r,"projective"),e===null&&t===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new jn(e,16),this.y=new jn(t,16),this.z=i?new jn(i,16):this.curve.one,this.t=n&&new jn(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}nb(Vt,ah.BasePoint);Pn.prototype.pointFromJSON=function(e){return Vt.fromJSON(this,e)};Pn.prototype.point=function(e,t,i,n){return new Vt(this,e,t,i,n)};Vt.fromJSON=function(e,t){return new Vt(e,t[0],t[1],t[2])};Vt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Vt.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Vt.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),a=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),c=n.redAdd(t),h=c.redSub(i),d=n.redSub(t),p=a.redMul(h),b=c.redMul(d),w=a.redMul(d),R=h.redMul(c);return this.curve.point(p,b,R,w)};Vt.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),i=this.y.redSqr(),n,a,c,h,d,p;if(this.curve.twisted){h=this.curve._mulA(t);var b=h.redAdd(i);this.zOne?(n=e.redSub(t).redSub(i).redMul(b.redSub(this.curve.two)),a=b.redMul(h.redSub(i)),c=b.redSqr().redSub(b).redSub(b)):(d=this.z.redSqr(),p=b.redSub(d).redISub(d),n=e.redSub(t).redISub(i).redMul(p),a=b.redMul(h.redSub(i)),c=b.redMul(p))}else h=t.redAdd(i),d=this.curve._mulC(this.z).redSqr(),p=h.redSub(d).redSub(d),n=this.curve._mulC(e.redISub(h)).redMul(p),a=this.curve._mulC(h).redMul(t.redISub(i)),c=h.redMul(p);return this.curve.point(n,a,c)};Vt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Vt.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),a=this.z.redMul(e.z.redAdd(e.z)),c=i.redSub(t),h=a.redSub(n),d=a.redAdd(n),p=i.redAdd(t),b=c.redMul(h),w=d.redMul(p),R=c.redMul(p),O=h.redMul(d);return this.curve.point(b,w,O,R)};Vt.prototype._projAdd=function(e){var t=this.z.redMul(e.z),i=t.redSqr(),n=this.x.redMul(e.x),a=this.y.redMul(e.y),c=this.curve.d.redMul(n).redMul(a),h=i.redSub(c),d=i.redAdd(c),p=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(a),b=t.redMul(h).redMul(p),w,R;return this.curve.twisted?(w=t.redMul(d).redMul(a.redSub(this.curve._mulA(n))),R=h.redMul(d)):(w=t.redMul(d).redMul(a.redSub(n)),R=this.curve._mulC(h).redMul(d)),this.curve.point(b,w,R)};Vt.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};Vt.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};Vt.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)};Vt.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)};Vt.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};Vt.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Vt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Vt.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Vt.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};Vt.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),this.x.cmp(t)===0)return!0}};Vt.prototype.toP=Vt.prototype.normalize;Vt.prototype.mixedAdd=Vt.prototype.add;(function(r){var e=r;e.base=nh,e.short=Mx,e.mont=Ax,e.edwards=Ox})(nd);var oh={},Wu,ov;function Rx(){return ov||(ov=1,Wu={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),Wu}(function(r){var e=r,t=Wo,i=nd,n=mi,a=n.assert;function c(p){p.type==="short"?this.curve=new i.short(p):p.type==="edwards"?this.curve=new i.edwards(p):this.curve=new i.mont(p),this.g=this.curve.g,this.n=this.curve.n,this.hash=p.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=c;function h(p,b){Object.defineProperty(e,p,{configurable:!0,enumerable:!0,get:function(){var w=new c(b);return Object.defineProperty(e,p,{configurable:!0,enumerable:!0,value:w}),w}})}h("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:t.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),h("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:t.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),h("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:t.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),h("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:t.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),h("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:t.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),h("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:t.sha256,gRed:!1,g:["9"]}),h("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:t.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var d;try{d=Rx()}catch{d=void 0}h("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:t.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",d]})})(oh);var Cx=Wo,js=rd,sb=Zs;function vs(r){if(!(this instanceof vs))return new vs(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=js.toArray(r.entropy,r.entropyEnc||"hex"),t=js.toArray(r.nonce,r.nonceEnc||"hex"),i=js.toArray(r.pers,r.persEnc||"hex");sb(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}var Nx=vs;vs.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var a=0;a<this.V.length;a++)this.K[a]=0,this.V[a]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};vs.prototype._hmac=function(){return new Cx.hmac(this.hash,this.K)};vs.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};vs.prototype.reseed=function(e,t,i,n){typeof t!="string"&&(n=i,i=t,t=null),e=js.toArray(e,t),i=js.toArray(i,n),sb(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};vs.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=i,i=t,t=null),i&&(i=js.toArray(i,n||"hex"),this._update(i));for(var a=[];a.length<e;)this.V=this._hmac().update(this.V).digest(),a=a.concat(this.V);var c=a.slice(0,e);return this._update(i),this._reseed++,js.encode(c,t)};var Tx=Yn,$x=mi,Il=$x.assert;function Ur(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var Lx=Ur;Ur.fromPublic=function(e,t,i){return t instanceof Ur?t:new Ur(e,{pub:t,pubEnc:i})};Ur.fromPrivate=function(e,t,i){return t instanceof Ur?t:new Ur(e,{priv:t,privEnc:i})};Ur.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Ur.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};Ur.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};Ur.prototype._importPrivate=function(e,t){this.priv=new Tx(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};Ur.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?Il(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Il(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};Ur.prototype.derive=function(e){return e.validate()||Il(e.validate(),"public point not validated"),e.mul(this.priv).getX()};Ur.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};Ur.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};Ur.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var $c=Yn,ad=mi,qx=ad.assert;function fh(r,e){if(r instanceof fh)return r;this._importDER(r,e)||(qx(r.r&&r.s,"Signature without r or s"),this.r=new $c(r.r,16),this.s=new $c(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var Ux=fh;function Bx(){this.place=0}function Vu(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4||r[e.place]===0)return!1;for(var n=0,a=0,c=e.place;a<i;a++,c++)n<<=8,n|=r[c],n>>>=0;return n<=127?!1:(e.place=c,n)}function fv(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}fh.prototype._importDER=function(e,t){e=ad.toArray(e,t);var i=new Bx;if(e[i.place++]!==48)return!1;var n=Vu(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var a=Vu(e,i);if(a===!1||e[i.place]&128)return!1;var c=e.slice(i.place,a+i.place);if(i.place+=a,e[i.place++]!==2)return!1;var h=Vu(e,i);if(h===!1||e.length!==h+i.place||e[i.place]&128)return!1;var d=e.slice(i.place,h+i.place);if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;if(d[0]===0)if(d[1]&128)d=d.slice(1);else return!1;return this.r=new $c(c),this.s=new $c(d),this.recoveryParam=null,!0};function Gu(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}fh.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=fv(t),i=fv(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];Gu(n,t.length),n=n.concat(t),n.push(2),Gu(n,i.length);var a=n.concat(i),c=[48];return Gu(c,a.length),c=c.concat(a),ad.encode(c,e)};var Ws=Yn,ab=Nx,zx=mi,Ju=oh,Fx=rb,ob=zx.assert,od=Lx,ch=Ux;function Ti(r){if(!(this instanceof Ti))return new Ti(r);typeof r=="string"&&(ob(Object.prototype.hasOwnProperty.call(Ju,r),"Unknown curve "+r),r=Ju[r]),r instanceof Ju.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var kx=Ti;Ti.prototype.keyPair=function(e){return new od(this,e)};Ti.prototype.keyFromPrivate=function(e,t){return od.fromPrivate(this,e,t)};Ti.prototype.keyFromPublic=function(e,t){return od.fromPublic(this,e,t)};Ti.prototype.genKeyPair=function(e){e||(e={});for(var t=new ab({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Fx(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new Ws(2));;){var a=new Ws(t.generate(i));if(!(a.cmp(n)>0))return a.iaddn(1),this.keyFromPrivate(a)}};Ti.prototype._truncateToN=function(e,t){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};Ti.prototype.sign=function(e,t,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new Ws(e,16));for(var a=this.n.byteLength(),c=t.getPrivate().toArray("be",a),h=e.toArray("be",a),d=new ab({hash:this.hash,entropy:c,nonce:h,pers:n.pers,persEnc:n.persEnc||"utf8"}),p=this.n.sub(new Ws(1)),b=0;;b++){var w=n.k?n.k(b):new Ws(d.generate(this.n.byteLength()));if(w=this._truncateToN(w,!0),!(w.cmpn(1)<=0||w.cmp(p)>=0)){var R=this.g.mul(w);if(!R.isInfinity()){var O=R.getX(),C=O.umod(this.n);if(C.cmpn(0)!==0){var q=w.invm(this.n).mul(C.mul(t.getPrivate()).iadd(e));if(q=q.umod(this.n),q.cmpn(0)!==0){var V=(R.getY().isOdd()?1:0)|(O.cmp(C)!==0?2:0);return n.canonical&&q.cmp(this.nh)>0&&(q=this.n.sub(q),V^=1),new ch({r:C,s:q,recoveryParam:V})}}}}}};Ti.prototype.verify=function(e,t,i,n){e=this._truncateToN(new Ws(e,16)),i=this.keyFromPublic(i,n),t=new ch(t,"hex");var a=t.r,c=t.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0||c.cmpn(1)<0||c.cmp(this.n)>=0)return!1;var h=c.invm(this.n),d=h.mul(e).umod(this.n),p=h.mul(a).umod(this.n),b;return this.curve._maxwellTrick?(b=this.g.jmulAdd(d,i.getPublic(),p),b.isInfinity()?!1:b.eqXToP(a)):(b=this.g.mulAdd(d,i.getPublic(),p),b.isInfinity()?!1:b.getX().umod(this.n).cmp(a)===0)};Ti.prototype.recoverPubKey=function(r,e,t,i){ob((3&t)===t,"The recovery param is more than two bits"),e=new ch(e,i);var n=this.n,a=new Ws(r),c=e.r,h=e.s,d=t&1,p=t>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&p)throw new Error("Unable to find sencond key candinate");p?c=this.curve.pointFromX(c.add(this.curve.n),d):c=this.curve.pointFromX(c,d);var b=e.r.invm(n),w=n.sub(a).mul(b).umod(n),R=h.mul(b).umod(n);return this.g.mulAdd(w,c,R)};Ti.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new ch(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var a;try{a=this.recoverPubKey(r,e,n)}catch{continue}if(a.eq(t))return n}throw new Error("Unable to find valid recovery factor")};var Xo=mi,fb=Xo.assert,cv=Xo.parseBytes,Va=Xo.cachedProperty;function wr(r,e){this.eddsa=r,this._secret=cv(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=cv(e.pub)}wr.fromPublic=function(e,t){return t instanceof wr?t:new wr(e,{pub:t})};wr.fromSecret=function(e,t){return t instanceof wr?t:new wr(e,{secret:t})};wr.prototype.secret=function(){return this._secret};Va(wr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});Va(wr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});Va(wr,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});Va(wr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});Va(wr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});Va(wr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});wr.prototype.sign=function(e){return fb(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};wr.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};wr.prototype.getSecret=function(e){return fb(this._secret,"KeyPair is public only"),Xo.encode(this.secret(),e)};wr.prototype.getPublic=function(e){return Xo.encode(this.pubBytes(),e)};var Hx=wr,Kx=Yn,hh=mi,hv=hh.assert,uh=hh.cachedProperty,jx=hh.parseBytes;function ea(r,e){this.eddsa=r,typeof e!="object"&&(e=jx(e)),Array.isArray(e)&&(hv(e.length===r.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),hv(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof Kx&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}uh(ea,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});uh(ea,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});uh(ea,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});uh(ea,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});ea.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};ea.prototype.toHex=function(){return hh.encode(this.toBytes(),"hex").toUpperCase()};var Wx=ea,Vx=Wo,Gx=oh,Ba=mi,Jx=Ba.assert,cb=Ba.parseBytes,hb=Hx,uv=Wx;function si(r){if(Jx(r==="ed25519","only tested with ed25519 so far"),!(this instanceof si))return new si(r);r=Gx[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=Vx.sha512}var Yx=si;si.prototype.sign=function(e,t){e=cb(e);var i=this.keyFromSecret(t),n=this.hashInt(i.messagePrefix(),e),a=this.g.mul(n),c=this.encodePoint(a),h=this.hashInt(c,i.pubBytes(),e).mul(i.priv()),d=n.add(h).umod(this.curve.n);return this.makeSignature({R:a,S:d,Rencoded:c})};si.prototype.verify=function(e,t,i){if(e=cb(e),t=this.makeSignature(t),t.S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var n=this.keyFromPublic(i),a=this.hashInt(t.Rencoded(),n.pubBytes(),e),c=this.g.mul(t.S()),h=t.R().add(n.pub().mul(a));return h.eq(c)};si.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return Ba.intFromLE(e.digest()).umod(this.curve.n)};si.prototype.keyFromPublic=function(e){return hb.fromPublic(this,e)};si.prototype.keyFromSecret=function(e){return hb.fromSecret(this,e)};si.prototype.makeSignature=function(e){return e instanceof uv?e:new uv(this,e)};si.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};si.prototype.decodePoint=function(e){e=Ba.parseBytes(e);var t=e.length-1,i=e.slice(0,t).concat(e[t]&-129),n=(e[t]&128)!==0,a=Ba.intFromLE(i);return this.curve.pointFromY(a,n)};si.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};si.prototype.decodeInt=function(e){return Ba.intFromLE(e)};si.prototype.isPoint=function(e){return e instanceof this.pointClass};(function(r){var e=r;e.version=_x.version,e.utils=mi,e.rand=rb,e.curve=nd,e.curves=oh,e.ec=kx,e.eddsa=Yx})(tb);var fd={},ub={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=wt,t=bi;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var i=function(){function h(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return h.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},h.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},h.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},h.prototype.update=function(d,p){if(p===void 0&&(p=d.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=d[b++],p--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(b=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,d,b,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=d[b++],p--;return this},h.prototype.finish=function(d){if(!this._finished){var p=this._bytesHashed,b=this._bufferLength,w=p/536870912|0,R=p<<3,O=p%128<112?128:256;this._buffer[b]=128;for(var C=b+1;C<O-8;C++)this._buffer[C]=0;e.writeUint32BE(w,this._buffer,O-8),e.writeUint32BE(R,this._buffer,O-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,O),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)e.writeUint32BE(this._stateHi[C],d,C*8),e.writeUint32BE(this._stateLo[C],d,C*8+4);return this},h.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},h.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},h.prototype.restoreState=function(d){return this._stateHi.set(d.stateHi),this._stateLo.set(d.stateLo),this._bufferLength=d.bufferLength,d.buffer&&this._buffer.set(d.buffer),this._bytesHashed=d.bytesHashed,this._finished=!1,this},h.prototype.cleanSavedState=function(d){t.wipe(d.stateHi),t.wipe(d.stateLo),d.buffer&&t.wipe(d.buffer),d.bufferLength=0,d.bytesHashed=0},h}();r.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(h,d,p,b,w,R,O){for(var C=p[0],q=p[1],V=p[2],Y=p[3],H=p[4],X=p[5],k=p[6],W=p[7],J=b[0],M=b[1],B=b[2],ae=b[3],de=b[4],U=b[5],m=b[6],g=b[7],f,u,y,A,P,S,v,E;O>=128;){for(var x=0;x<16;x++){var T=8*x+R;h[x]=e.readUint32BE(w,T),d[x]=e.readUint32BE(w,T+4)}for(var x=0;x<80;x++){var ne=C,fe=q,D=V,F=Y,j=H,L=X,_=k,K=W,re=J,se=M,we=B,ce=ae,me=de,Ke=U,Me=m,Je=g;if(f=W,u=g,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=(H>>>14|de<<18)^(H>>>18|de<<14)^(de>>>9|H<<23),u=(de>>>14|H<<18)^(de>>>18|H<<14)^(H>>>9|de<<23),P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,f=H&X^~H&k,u=de&U^~de&m,P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,f=n[x*2],u=n[x*2+1],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,f=h[x%16],u=d[x%16],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,y=v&65535|E<<16,A=P&65535|S<<16,f=y,u=A,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=(C>>>28|J<<4)^(J>>>2|C<<30)^(J>>>7|C<<25),u=(J>>>28|C<<4)^(C>>>2|J<<30)^(C>>>7|J<<25),P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,f=C&q^C&V^q&V,u=J&M^J&B^M&B,P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,K=v&65535|E<<16,Je=P&65535|S<<16,f=F,u=ce,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=y,u=A,P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,F=v&65535|E<<16,ce=P&65535|S<<16,q=ne,V=fe,Y=D,H=F,X=j,k=L,W=_,C=K,M=re,B=se,ae=we,de=ce,U=me,m=Ke,g=Me,J=Je,x%16===15)for(var T=0;T<16;T++)f=h[T],u=d[T],P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=h[(T+9)%16],u=d[(T+9)%16],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,y=h[(T+1)%16],A=d[(T+1)%16],f=(y>>>1|A<<31)^(y>>>8|A<<24)^y>>>7,u=(A>>>1|y<<31)^(A>>>8|y<<24)^(A>>>7|y<<25),P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,y=h[(T+14)%16],A=d[(T+14)%16],f=(y>>>19|A<<13)^(A>>>29|y<<3)^y>>>6,u=(A>>>19|y<<13)^(y>>>29|A<<3)^(A>>>6|y<<26),P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,h[T]=v&65535|E<<16,d[T]=P&65535|S<<16}f=C,u=J,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=p[0],u=b[0],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,p[0]=C=v&65535|E<<16,b[0]=J=P&65535|S<<16,f=q,u=M,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=p[1],u=b[1],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,p[1]=q=v&65535|E<<16,b[1]=M=P&65535|S<<16,f=V,u=B,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=p[2],u=b[2],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,p[2]=V=v&65535|E<<16,b[2]=B=P&65535|S<<16,f=Y,u=ae,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=p[3],u=b[3],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,p[3]=Y=v&65535|E<<16,b[3]=ae=P&65535|S<<16,f=H,u=de,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=p[4],u=b[4],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,p[4]=H=v&65535|E<<16,b[4]=de=P&65535|S<<16,f=X,u=U,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=p[5],u=b[5],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,p[5]=X=v&65535|E<<16,b[5]=U=P&65535|S<<16,f=k,u=m,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=p[6],u=b[6],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,p[6]=k=v&65535|E<<16,b[6]=m=P&65535|S<<16,f=W,u=g,P=u&65535,S=u>>>16,v=f&65535,E=f>>>16,f=p[7],u=b[7],P+=u&65535,S+=u>>>16,v+=f&65535,E+=f>>>16,S+=P>>>16,v+=S>>>16,E+=v>>>16,p[7]=W=v&65535|E<<16,b[7]=g=P&65535|S<<16,R+=128,O-=128}return R}function c(h){var d=new i;d.update(h);var p=d.digest();return d.clean(),p}r.hash=c})(ub);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=ys,t=ub,i=bi;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function n(F){const j=new Float64Array(16);if(F)for(let L=0;L<F.length;L++)j[L]=F[L];return j}const a=new Uint8Array(32);a[0]=9;const c=n(),h=n([1]),d=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),R=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function O(F,j){for(let L=0;L<16;L++)F[L]=j[L]|0}function C(F){let j=1;for(let L=0;L<16;L++){let _=F[L]+j+65535;j=Math.floor(_/65536),F[L]=_-j*65536}F[0]+=j-1+37*(j-1)}function q(F,j,L){const _=~(L-1);for(let K=0;K<16;K++){const re=_&(F[K]^j[K]);F[K]^=re,j[K]^=re}}function V(F,j){const L=n(),_=n();for(let K=0;K<16;K++)_[K]=j[K];C(_),C(_),C(_);for(let K=0;K<2;K++){L[0]=_[0]-65517;for(let se=1;se<15;se++)L[se]=_[se]-65535-(L[se-1]>>16&1),L[se-1]&=65535;L[15]=_[15]-32767-(L[14]>>16&1);const re=L[15]>>16&1;L[14]&=65535,q(_,L,1-re)}for(let K=0;K<16;K++)F[2*K]=_[K]&255,F[2*K+1]=_[K]>>8}function Y(F,j){let L=0;for(let _=0;_<32;_++)L|=F[_]^j[_];return(1&L-1>>>8)-1}function H(F,j){const L=new Uint8Array(32),_=new Uint8Array(32);return V(L,F),V(_,j),Y(L,_)}function X(F){const j=new Uint8Array(32);return V(j,F),j[0]&1}function k(F,j){for(let L=0;L<16;L++)F[L]=j[2*L]+(j[2*L+1]<<8);F[15]&=32767}function W(F,j,L){for(let _=0;_<16;_++)F[_]=j[_]+L[_]}function J(F,j,L){for(let _=0;_<16;_++)F[_]=j[_]-L[_]}function M(F,j,L){let _,K,re=0,se=0,we=0,ce=0,me=0,Ke=0,Me=0,Je=0,Fe=0,ye=0,Ie=0,Ce=0,ge=0,$e=0,Ae=0,be=0,Oe=0,Ne=0,_e=0,De=0,ke=0,xe=0,je=0,We=0,He=0,dt=0,mt=0,Ge=0,pt=0,St=0,Ye=0,nt=L[0],Ze=L[1],Te=L[2],Qe=L[3],et=L[4],Le=L[5],Xe=L[6],ct=L[7],Be=L[8],tt=L[9],ht=L[10],qe=L[11],st=L[12],rt=L[13],Re=L[14],ut=L[15];_=j[0],re+=_*nt,se+=_*Ze,we+=_*Te,ce+=_*Qe,me+=_*et,Ke+=_*Le,Me+=_*Xe,Je+=_*ct,Fe+=_*Be,ye+=_*tt,Ie+=_*ht,Ce+=_*qe,ge+=_*st,$e+=_*rt,Ae+=_*Re,be+=_*ut,_=j[1],se+=_*nt,we+=_*Ze,ce+=_*Te,me+=_*Qe,Ke+=_*et,Me+=_*Le,Je+=_*Xe,Fe+=_*ct,ye+=_*Be,Ie+=_*tt,Ce+=_*ht,ge+=_*qe,$e+=_*st,Ae+=_*rt,be+=_*Re,Oe+=_*ut,_=j[2],we+=_*nt,ce+=_*Ze,me+=_*Te,Ke+=_*Qe,Me+=_*et,Je+=_*Le,Fe+=_*Xe,ye+=_*ct,Ie+=_*Be,Ce+=_*tt,ge+=_*ht,$e+=_*qe,Ae+=_*st,be+=_*rt,Oe+=_*Re,Ne+=_*ut,_=j[3],ce+=_*nt,me+=_*Ze,Ke+=_*Te,Me+=_*Qe,Je+=_*et,Fe+=_*Le,ye+=_*Xe,Ie+=_*ct,Ce+=_*Be,ge+=_*tt,$e+=_*ht,Ae+=_*qe,be+=_*st,Oe+=_*rt,Ne+=_*Re,_e+=_*ut,_=j[4],me+=_*nt,Ke+=_*Ze,Me+=_*Te,Je+=_*Qe,Fe+=_*et,ye+=_*Le,Ie+=_*Xe,Ce+=_*ct,ge+=_*Be,$e+=_*tt,Ae+=_*ht,be+=_*qe,Oe+=_*st,Ne+=_*rt,_e+=_*Re,De+=_*ut,_=j[5],Ke+=_*nt,Me+=_*Ze,Je+=_*Te,Fe+=_*Qe,ye+=_*et,Ie+=_*Le,Ce+=_*Xe,ge+=_*ct,$e+=_*Be,Ae+=_*tt,be+=_*ht,Oe+=_*qe,Ne+=_*st,_e+=_*rt,De+=_*Re,ke+=_*ut,_=j[6],Me+=_*nt,Je+=_*Ze,Fe+=_*Te,ye+=_*Qe,Ie+=_*et,Ce+=_*Le,ge+=_*Xe,$e+=_*ct,Ae+=_*Be,be+=_*tt,Oe+=_*ht,Ne+=_*qe,_e+=_*st,De+=_*rt,ke+=_*Re,xe+=_*ut,_=j[7],Je+=_*nt,Fe+=_*Ze,ye+=_*Te,Ie+=_*Qe,Ce+=_*et,ge+=_*Le,$e+=_*Xe,Ae+=_*ct,be+=_*Be,Oe+=_*tt,Ne+=_*ht,_e+=_*qe,De+=_*st,ke+=_*rt,xe+=_*Re,je+=_*ut,_=j[8],Fe+=_*nt,ye+=_*Ze,Ie+=_*Te,Ce+=_*Qe,ge+=_*et,$e+=_*Le,Ae+=_*Xe,be+=_*ct,Oe+=_*Be,Ne+=_*tt,_e+=_*ht,De+=_*qe,ke+=_*st,xe+=_*rt,je+=_*Re,We+=_*ut,_=j[9],ye+=_*nt,Ie+=_*Ze,Ce+=_*Te,ge+=_*Qe,$e+=_*et,Ae+=_*Le,be+=_*Xe,Oe+=_*ct,Ne+=_*Be,_e+=_*tt,De+=_*ht,ke+=_*qe,xe+=_*st,je+=_*rt,We+=_*Re,He+=_*ut,_=j[10],Ie+=_*nt,Ce+=_*Ze,ge+=_*Te,$e+=_*Qe,Ae+=_*et,be+=_*Le,Oe+=_*Xe,Ne+=_*ct,_e+=_*Be,De+=_*tt,ke+=_*ht,xe+=_*qe,je+=_*st,We+=_*rt,He+=_*Re,dt+=_*ut,_=j[11],Ce+=_*nt,ge+=_*Ze,$e+=_*Te,Ae+=_*Qe,be+=_*et,Oe+=_*Le,Ne+=_*Xe,_e+=_*ct,De+=_*Be,ke+=_*tt,xe+=_*ht,je+=_*qe,We+=_*st,He+=_*rt,dt+=_*Re,mt+=_*ut,_=j[12],ge+=_*nt,$e+=_*Ze,Ae+=_*Te,be+=_*Qe,Oe+=_*et,Ne+=_*Le,_e+=_*Xe,De+=_*ct,ke+=_*Be,xe+=_*tt,je+=_*ht,We+=_*qe,He+=_*st,dt+=_*rt,mt+=_*Re,Ge+=_*ut,_=j[13],$e+=_*nt,Ae+=_*Ze,be+=_*Te,Oe+=_*Qe,Ne+=_*et,_e+=_*Le,De+=_*Xe,ke+=_*ct,xe+=_*Be,je+=_*tt,We+=_*ht,He+=_*qe,dt+=_*st,mt+=_*rt,Ge+=_*Re,pt+=_*ut,_=j[14],Ae+=_*nt,be+=_*Ze,Oe+=_*Te,Ne+=_*Qe,_e+=_*et,De+=_*Le,ke+=_*Xe,xe+=_*ct,je+=_*Be,We+=_*tt,He+=_*ht,dt+=_*qe,mt+=_*st,Ge+=_*rt,pt+=_*Re,St+=_*ut,_=j[15],be+=_*nt,Oe+=_*Ze,Ne+=_*Te,_e+=_*Qe,De+=_*et,ke+=_*Le,xe+=_*Xe,je+=_*ct,We+=_*Be,He+=_*tt,dt+=_*ht,mt+=_*qe,Ge+=_*st,pt+=_*rt,St+=_*Re,Ye+=_*ut,re+=38*Oe,se+=38*Ne,we+=38*_e,ce+=38*De,me+=38*ke,Ke+=38*xe,Me+=38*je,Je+=38*We,Fe+=38*He,ye+=38*dt,Ie+=38*mt,Ce+=38*Ge,ge+=38*pt,$e+=38*St,Ae+=38*Ye,K=1,_=re+K+65535,K=Math.floor(_/65536),re=_-K*65536,_=se+K+65535,K=Math.floor(_/65536),se=_-K*65536,_=we+K+65535,K=Math.floor(_/65536),we=_-K*65536,_=ce+K+65535,K=Math.floor(_/65536),ce=_-K*65536,_=me+K+65535,K=Math.floor(_/65536),me=_-K*65536,_=Ke+K+65535,K=Math.floor(_/65536),Ke=_-K*65536,_=Me+K+65535,K=Math.floor(_/65536),Me=_-K*65536,_=Je+K+65535,K=Math.floor(_/65536),Je=_-K*65536,_=Fe+K+65535,K=Math.floor(_/65536),Fe=_-K*65536,_=ye+K+65535,K=Math.floor(_/65536),ye=_-K*65536,_=Ie+K+65535,K=Math.floor(_/65536),Ie=_-K*65536,_=Ce+K+65535,K=Math.floor(_/65536),Ce=_-K*65536,_=ge+K+65535,K=Math.floor(_/65536),ge=_-K*65536,_=$e+K+65535,K=Math.floor(_/65536),$e=_-K*65536,_=Ae+K+65535,K=Math.floor(_/65536),Ae=_-K*65536,_=be+K+65535,K=Math.floor(_/65536),be=_-K*65536,re+=K-1+37*(K-1),K=1,_=re+K+65535,K=Math.floor(_/65536),re=_-K*65536,_=se+K+65535,K=Math.floor(_/65536),se=_-K*65536,_=we+K+65535,K=Math.floor(_/65536),we=_-K*65536,_=ce+K+65535,K=Math.floor(_/65536),ce=_-K*65536,_=me+K+65535,K=Math.floor(_/65536),me=_-K*65536,_=Ke+K+65535,K=Math.floor(_/65536),Ke=_-K*65536,_=Me+K+65535,K=Math.floor(_/65536),Me=_-K*65536,_=Je+K+65535,K=Math.floor(_/65536),Je=_-K*65536,_=Fe+K+65535,K=Math.floor(_/65536),Fe=_-K*65536,_=ye+K+65535,K=Math.floor(_/65536),ye=_-K*65536,_=Ie+K+65535,K=Math.floor(_/65536),Ie=_-K*65536,_=Ce+K+65535,K=Math.floor(_/65536),Ce=_-K*65536,_=ge+K+65535,K=Math.floor(_/65536),ge=_-K*65536,_=$e+K+65535,K=Math.floor(_/65536),$e=_-K*65536,_=Ae+K+65535,K=Math.floor(_/65536),Ae=_-K*65536,_=be+K+65535,K=Math.floor(_/65536),be=_-K*65536,re+=K-1+37*(K-1),F[0]=re,F[1]=se,F[2]=we,F[3]=ce,F[4]=me,F[5]=Ke,F[6]=Me,F[7]=Je,F[8]=Fe,F[9]=ye,F[10]=Ie,F[11]=Ce,F[12]=ge,F[13]=$e,F[14]=Ae,F[15]=be}function B(F,j){M(F,j,j)}function ae(F,j){const L=n();let _;for(_=0;_<16;_++)L[_]=j[_];for(_=253;_>=0;_--)B(L,L),_!==2&&_!==4&&M(L,L,j);for(_=0;_<16;_++)F[_]=L[_]}function de(F,j){const L=n();let _;for(_=0;_<16;_++)L[_]=j[_];for(_=250;_>=0;_--)B(L,L),_!==1&&M(L,L,j);for(_=0;_<16;_++)F[_]=L[_]}function U(F,j){const L=n(),_=n(),K=n(),re=n(),se=n(),we=n(),ce=n(),me=n(),Ke=n();J(L,F[1],F[0]),J(Ke,j[1],j[0]),M(L,L,Ke),W(_,F[0],F[1]),W(Ke,j[0],j[1]),M(_,_,Ke),M(K,F[3],j[3]),M(K,K,p),M(re,F[2],j[2]),W(re,re,re),J(se,_,L),J(we,re,K),W(ce,re,K),W(me,_,L),M(F[0],se,we),M(F[1],me,ce),M(F[2],ce,we),M(F[3],se,me)}function m(F,j,L){for(let _=0;_<4;_++)q(F[_],j[_],L)}function g(F,j){const L=n(),_=n(),K=n();ae(K,j[2]),M(L,j[0],K),M(_,j[1],K),V(F,_),F[31]^=X(L)<<7}function f(F,j,L){O(F[0],c),O(F[1],h),O(F[2],h),O(F[3],c);for(let _=255;_>=0;--_){const K=L[_/8|0]>>(_&7)&1;m(F,j,K),U(j,F),U(F,F),m(F,j,K)}}function u(F,j){const L=[n(),n(),n(),n()];O(L[0],b),O(L[1],w),O(L[2],h),M(L[3],b,w),f(F,L,j)}function y(F){if(F.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const j=(0,t.hash)(F);j[0]&=248,j[31]&=127,j[31]|=64;const L=new Uint8Array(32),_=[n(),n(),n(),n()];u(_,j),g(L,_);const K=new Uint8Array(64);return K.set(F),K.set(L,32),{publicKey:L,secretKey:K}}r.generateKeyPairFromSeed=y;function A(F){const j=(0,e.randomBytes)(32,F),L=y(j);return(0,i.wipe)(j),L}r.generateKeyPair=A;function P(F){if(F.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(F.subarray(32))}r.extractPublicKeyFromSecretKey=P;const S=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function v(F,j){let L,_,K,re;for(_=63;_>=32;--_){for(L=0,K=_-32,re=_-12;K<re;++K)j[K]+=L-16*j[_]*S[K-(_-32)],L=Math.floor((j[K]+128)/256),j[K]-=L*256;j[K]+=L,j[_]=0}for(L=0,K=0;K<32;K++)j[K]+=L-(j[31]>>4)*S[K],L=j[K]>>8,j[K]&=255;for(K=0;K<32;K++)j[K]-=L*S[K];for(_=0;_<32;_++)j[_+1]+=j[_]>>8,F[_]=j[_]&255}function E(F){const j=new Float64Array(64);for(let L=0;L<64;L++)j[L]=F[L];for(let L=0;L<64;L++)F[L]=0;v(F,j)}function x(F,j){const L=new Float64Array(64),_=[n(),n(),n(),n()],K=(0,t.hash)(F.subarray(0,32));K[0]&=248,K[31]&=127,K[31]|=64;const re=new Uint8Array(64);re.set(K.subarray(32),32);const se=new t.SHA512;se.update(re.subarray(32)),se.update(j);const we=se.digest();se.clean(),E(we),u(_,we),g(re,_),se.reset(),se.update(re.subarray(0,32)),se.update(F.subarray(32)),se.update(j);const ce=se.digest();E(ce);for(let me=0;me<32;me++)L[me]=we[me];for(let me=0;me<32;me++)for(let Ke=0;Ke<32;Ke++)L[me+Ke]+=ce[me]*K[Ke];return v(re.subarray(32),L),re}r.sign=x;function T(F,j){const L=n(),_=n(),K=n(),re=n(),se=n(),we=n(),ce=n();return O(F[2],h),k(F[1],j),B(K,F[1]),M(re,K,d),J(K,K,F[2]),W(re,F[2],re),B(se,re),B(we,se),M(ce,we,se),M(L,ce,K),M(L,L,re),de(L,L),M(L,L,K),M(L,L,re),M(L,L,re),M(F[0],L,re),B(_,F[0]),M(_,_,re),H(_,K)&&M(F[0],F[0],R),B(_,F[0]),M(_,_,re),H(_,K)?-1:(X(F[0])===j[31]>>7&&J(F[0],c,F[0]),M(F[3],F[0],F[1]),0)}function ne(F,j,L){const _=new Uint8Array(32),K=[n(),n(),n(),n()],re=[n(),n(),n(),n()];if(L.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(T(re,F))return!1;const se=new t.SHA512;se.update(L.subarray(0,32)),se.update(F),se.update(j);const we=se.digest();return E(we),f(K,re,we),u(re,L.subarray(32)),U(K,re),g(_,K),!Y(L,_)}r.verify=ne;function fe(F){let j=[n(),n(),n(),n()];if(T(j,F))throw new Error("Ed25519: invalid public key");let L=n(),_=n(),K=j[1];W(L,h,K),J(_,h,K),ae(_,_),M(L,L,_);let re=new Uint8Array(32);return V(re,L),re}r.convertPublicKeyToX25519=fe;function D(F){const j=(0,t.hash)(F.subarray(0,32));j[0]&=248,j[31]&=127,j[31]|=64;const L=new Uint8Array(j.subarray(0,32));return(0,i.wipe)(j),L}r.convertSecretKeyToX25519=D})(fd);const Xx="EdDSA",Zx="JWT",Lc=".",lh="base64url",lb="utf8",db="utf8",Qx=":",eE="did",tE="key",lv="base58btc",rE="z",iE="K36",nE=32;function cd(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function pb(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?cd(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function sE(r,e){e||(e=r.reduce((n,a)=>n+a.length,0));const t=pb(e);let i=0;for(const n of r)t.set(n,i),i+=n.length;return cd(t)}function vb(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const dv=vb("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Yu=vb("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=pb(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),gb={utf8:dv,"utf-8":dv,hex:Cc.base16,latin1:Yu,ascii:Yu,binary:Yu,...Cc};function dh(r,e="utf8"){const t=gb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function Ga(r,e="utf8"){const t=gb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?cd(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}const aE=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),oE=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Gs(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return oE(r)}catch{return r}}function Jn(r){return typeof r=="string"?r:aE(r)||""}function pv(r){return Gs(dh(Ga(r,lh),lb))}function qc(r){return dh(Ga(Jn(r),lb),lh)}function bb(r){const e=Ga(iE,lv),t=rE+dh(sE([e,r]),lv);return[eE,tE,t].join(Qx)}function fE(r){return dh(r,lh)}function cE(r){return Ga(r,lh)}function hE(r){return Ga([qc(r.header),qc(r.payload)].join(Lc),db)}function uE(r){return[qc(r.header),qc(r.payload),fE(r.signature)].join(Lc)}function Al(r){const e=r.split(Lc),t=pv(e[0]),i=pv(e[1]),n=cE(e[2]),a=Ga(e.slice(0,2).join(Lc),db);return{header:t,payload:i,signature:n,data:a}}function vv(r=ys.randomBytes(nE)){return fd.generateKeyPairFromSeed(r)}async function lE(r,e,t,i,n=Se.fromMiliseconds(Date.now())){const a={alg:Xx,typ:Zx},c=bb(i.publicKey),h=n+t,d={iss:c,sub:r,aud:e,iat:n,exp:h},p=hE({header:a,payload:d}),b=fd.sign(i.secretKey,p);return uE({header:a,payload:d,signature:b})}const dE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var rr={},pE={};const vE=":";function Ta(r){const[e,t]=r.split(vE);return{namespace:e,reference:t}}function gv(r,e=[]){const t=[];return Object.keys(r).forEach(i=>{if(e.length&&!e.includes(i))return;const n=r[i];t.push(...n.accounts)}),t}function mb(r,e){return r.includes(":")?[r]:e.chains||[]}var gE=Object.defineProperty,bv=Object.getOwnPropertySymbols,bE=Object.prototype.hasOwnProperty,mE=Object.prototype.propertyIsEnumerable,mv=(r,e,t)=>e in r?gE(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yv=(r,e)=>{for(var t in e||(e={}))bE.call(e,t)&&mv(r,t,e[t]);if(bv)for(var t of bv(e))mE.call(e,t)&&mv(r,t,e[t]);return r};const yE="ReactNative",pi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},wE="js";function Uc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ja(){return!jo()&&!!Hl()&&navigator.product===yE}function Zo(){return!Uc()&&!!Hl()&&!!jo()}function Qo(){return Ja()?pi.reactNative:Uc()?pi.node:Zo()?pi.browser:pi.unknown}function _E(){var r;try{return Ja()&&typeof rr<"u"&&typeof(rr==null?void 0:rr.Application)<"u"?(r=rr.Application)==null?void 0:r.applicationId:void 0}catch{return}}function xE(r,e){let t=Uo.parse(r);return t=yv(yv({},t),e),r=Uo.stringify(t),r}function yb(){return ug()||{name:"",description:"",url:"",icons:[""]}}function EE(){if(Qo()===pi.reactNative&&typeof rr<"u"&&typeof(rr==null?void 0:rr.Platform)<"u"){const{OS:t,Version:i}=rr.Platform;return[t,i].join("-")}const r=m5();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function SE(){var r;const e=Qo();return e===pi.browser?[e,((r=hg())==null?void 0:r.host)||"unknown"].join(":"):e}function wb(r,e,t){const i=EE(),n=SE();return[[r,e].join("-"),[wE,t].join("-"),i,n].join("/")}function ME({protocol:r,version:e,relayUrl:t,sdkVersion:i,auth:n,projectId:a,useOnCloseEvent:c,bundleId:h}){const d=t.split("?"),p=wb(r,e,i),b={auth:n,ua:p,projectId:a,useOnCloseEvent:c||void 0,origin:h||void 0},w=xE(d[1]||"",b);return d[0]+"?"+w}function Hs(r,e){return r.filter(t=>e.includes(t)).length===r.length}function _b(r){return Object.fromEntries(r.entries())}function xb(r){return new Map(Object.entries(r))}function Fs(r=Se.FIVE_MINUTES,e){const t=Se.toMiliseconds(r||Se.FIVE_MINUTES);let i,n,a;return{resolve:c=>{a&&i&&(clearTimeout(a),i(c))},reject:c=>{a&&n&&(clearTimeout(a),n(c))},done:()=>new Promise((c,h)=>{a=setTimeout(()=>{h(new Error(e))},t),i=c,n=h})}}function $a(r,e,t){return new Promise(async(i,n)=>{const a=setTimeout(()=>n(new Error(t)),e);try{const c=await r;i(c)}catch(c){n(c)}clearTimeout(a)})}function Eb(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function IE(r){return Eb("topic",r)}function AE(r){return Eb("id",r)}function Sb(r){const[e,t]=r.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")i.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))i.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return i}function vr(r,e){return Se.fromMiliseconds(Date.now()+Se.toMiliseconds(r))}function cs(r){return Date.now()>=Se.toMiliseconds(r)}function It(r,e){return`${r}${e?`:${e}`:""}`}function _c(r=[],e=[]){return[...new Set([...r,...e])]}async function PE({id:r,topic:e,wcDeepLink:t}){var i;try{if(!t)return;const n=typeof t=="string"?JSON.parse(t):t,a=n==null?void 0:n.href;if(typeof a!="string")return;const c=DE(a,r,e),h=Qo();if(h===pi.browser){if(!((i=jo())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}c.startsWith("https://")||c.startsWith("http://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,RE()?"_blank":"_self","noreferrer noopener")}else h===pi.reactNative&&typeof(rr==null?void 0:rr.Linking)<"u"&&await rr.Linking.openURL(c)}catch(n){console.error(n)}}function DE(r,e,t){const i=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let n=`${r}`;if(r.startsWith("https://t.me")){const a=r.includes("?")?"&startapp=":"?startapp=";n=`${n}${a}${CE(i,!0)}`}else n=`${n}/wc?${i}`;return n}async function OE(r,e){let t="";try{if(Zo()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(i){console.error(i)}return t}function wv(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),i=t.indexOf(e);return t[i+2]}function _v(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function hd(){return typeof process<"u"&&pE.IS_VITEST==="true"}function RE(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function CE(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function Mb(r){return Buffer.from(r,"base64").toString("utf-8")}const NE="https://rpc.walletconnect.org/v1";async function TE(r,e,t,i,n,a){switch(t.t){case"eip191":return $E(r,e,t.s);case"eip1271":return await LE(r,e,t.s,i,n,a);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}function $E(r,e,t){return E7(gg(e),t).toLowerCase()===r.toLowerCase()}async function LE(r,e,t,i,n,a){const c=Ta(i);if(!c.namespace||!c.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{const h="0x1626ba7e",d="0000000000000000000000000000000000000000000000000000000000000040",p="0000000000000000000000000000000000000000000000000000000000000041",b=t.substring(2),w=gg(e).substring(2),R=h+w+d+p+b,O=await fetch(`${a||NE}/?chainId=${i}&projectId=${n}`,{method:"POST",body:JSON.stringify({id:qE(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:R},"latest"]})}),{result:C}=await O.json();return C?C.slice(0,h.length).toLowerCase()===h.toLowerCase():!1}catch(h){return console.error("isValidEip1271Signature: ",h),!1}}function qE(){return Date.now()+Math.floor(Math.random()*1e3)}var UE=Object.defineProperty,BE=Object.defineProperties,zE=Object.getOwnPropertyDescriptors,xv=Object.getOwnPropertySymbols,FE=Object.prototype.hasOwnProperty,kE=Object.prototype.propertyIsEnumerable,Ev=(r,e,t)=>e in r?UE(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,HE=(r,e)=>{for(var t in e||(e={}))FE.call(e,t)&&Ev(r,t,e[t]);if(xv)for(var t of xv(e))kE.call(e,t)&&Ev(r,t,e[t]);return r},KE=(r,e)=>BE(r,zE(e));const jE="did:pkh:",ud=r=>r==null?void 0:r.split(":"),WE=r=>{const e=r&&ud(r);if(e)return r.includes(jE)?e[3]:e[1]},Pl=r=>{const e=r&&ud(r);if(e)return e[2]+":"+e[3]},Bc=r=>{const e=r&&ud(r);if(e)return e.pop()};async function Sv(r){const{cacao:e,projectId:t}=r,{s:i,p:n}=e,a=Ib(n,n.iss),c=Bc(n.iss);return await TE(c,a,i,Pl(n.iss),t)}const Ib=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,i=Bc(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let n=r.statement||void 0;const a=`URI: ${r.aud||r.uri}`,c=`Version: ${r.version}`,h=`Chain ID: ${WE(e)}`,d=`Nonce: ${r.nonce}`,p=`Issued At: ${r.iat}`,b=r.exp?`Expiration Time: ${r.exp}`:void 0,w=r.nbf?`Not Before: ${r.nbf}`:void 0,R=r.requestId?`Request ID: ${r.requestId}`:void 0,O=r.resources?`Resources:${r.resources.map(q=>`
- ${q}`).join("")}`:void 0,C=xc(r.resources);if(C){const q=Bo(C);n=tS(n,q)}return[t,i,"",n,"",a,c,h,d,p,b,w,R,O].filter(q=>q!=null).join(`
`)};function VE(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function GE(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function Js(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const i=r.att[t];if(Array.isArray(i))throw new Error(`Resource must be an object: ${t}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(i).forEach(n=>{const a=i[n];if(!Array.isArray(a))throw new Error(`Ability limits ${n} must be an array of objects, found: ${a}`);if(!a.length)throw new Error(`Value of ${n} is empty array, must be an array with objects`);a.forEach(c=>{if(typeof c!="object")throw new Error(`Ability limits (${n}) must be an array of objects, found: ${c}`)})})})}function JE(r,e,t,i={}){return t==null||t.sort((n,a)=>n.localeCompare(a)),{att:{[r]:YE(e,t,i)}}}function YE(r,e,t={}){e=e==null?void 0:e.sort((n,a)=>n.localeCompare(a));const i=e.map(n=>({[`${r}/${n}`]:[t]}));return Object.assign({},...i)}function Ab(r){return Js(r),`urn:recap:${VE(r).replace(/=/g,"")}`}function Bo(r){const e=GE(r.replace("urn:recap:",""));return Js(e),e}function XE(r,e,t){const i=JE(r,e,t);return Ab(i)}function ZE(r){return r&&r.includes("urn:recap:")}function QE(r,e){const t=Bo(r),i=Bo(e),n=eS(t,i);return Ab(n)}function eS(r,e){Js(r),Js(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((n,a)=>n.localeCompare(a)),i={att:{}};return t.forEach(n=>{var a,c;Object.keys(((a=r.att)==null?void 0:a[n])||{}).concat(Object.keys(((c=e.att)==null?void 0:c[n])||{})).sort((h,d)=>h.localeCompare(d)).forEach(h=>{var d,p;i.att[n]=KE(HE({},i.att[n]),{[h]:((d=r.att[n])==null?void 0:d[h])||((p=e.att[n])==null?void 0:p[h])})})}),i}function tS(r="",e){Js(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const i=[];let n=0;Object.keys(e.att).forEach(h=>{const d=Object.keys(e.att[h]).map(w=>({ability:w.split("/")[0],action:w.split("/")[1]}));d.sort((w,R)=>w.action.localeCompare(R.action));const p={};d.forEach(w=>{p[w.ability]||(p[w.ability]=[]),p[w.ability].push(w.action)});const b=Object.keys(p).map(w=>(n++,`(${n}) '${w}': '${p[w].join("', '")}' for '${h}'.`));i.push(b.join(", ").replace(".,","."))});const a=i.join(" "),c=`${t}${a}`;return`${r?r+" ":""}${c}`}function Mv(r){var e;const t=Bo(r);Js(t);const i=(e=t.att)==null?void 0:e.eip155;return i?Object.keys(i).map(n=>n.split("/")[1]):[]}function Iv(r){const e=Bo(r);Js(e);const t=[];return Object.values(e.att).forEach(i=>{Object.values(i).forEach(n=>{var a;(a=n==null?void 0:n[0])!=null&&a.chains&&t.push(n[0].chains)})}),[...new Set(t.flat())]}function xc(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return ZE(e)?e:void 0}const Pb="base10",Kr="base16",ls="base64pad",Eo="base64url",ef="utf8",Db=0,Wn=1,tf=2,rS=0,Av=1,No=12,ld=32;function iS(){const r=ed.generateKeyPair();return{privateKey:ii(r.secretKey,Kr),publicKey:ii(r.publicKey,Kr)}}function Dl(){const r=ys.randomBytes(ld);return ii(r,Kr)}function nS(r,e){const t=ed.sharedKey(Ci(r,Kr),Ci(e,Kr),!0),i=new i9(Go.SHA256,t).expand(ld);return ii(i,Kr)}function Ec(r){const e=Go.hash(Ci(r,Kr));return ii(e,Kr)}function Kn(r){const e=Go.hash(Ci(r,ef));return ii(e,Kr)}function Ob(r){return Ci(`${r}`,Pb)}function Ys(r){return Number(ii(r,Pb))}function sS(r){const e=Ob(typeof r.type<"u"?r.type:Db);if(Ys(e)===Wn&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?Ci(r.senderPublicKey,Kr):void 0,i=typeof r.iv<"u"?Ci(r.iv,Kr):ys.randomBytes(No),n=new Zl.ChaCha20Poly1305(Ci(r.symKey,Kr)).seal(i,Ci(r.message,ef));return Rb({type:e,sealed:n,iv:i,senderPublicKey:t,encoding:r.encoding})}function aS(r,e){const t=Ob(tf),i=ys.randomBytes(No),n=Ci(r,ef);return Rb({type:t,sealed:n,iv:i,encoding:e})}function oS(r){const e=new Zl.ChaCha20Poly1305(Ci(r.symKey,Kr)),{sealed:t,iv:i}=zo({encoded:r.encoded,encoding:r==null?void 0:r.encoding}),n=e.open(i,t);if(n===null)throw new Error("Failed to decrypt");return ii(n,ef)}function fS(r,e){const{sealed:t}=zo({encoded:r,encoding:e});return ii(t,ef)}function Rb(r){const{encoding:e=ls}=r;if(Ys(r.type)===tf)return ii(Hu([r.type,r.sealed]),e);if(Ys(r.type)===Wn){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ii(Hu([r.type,r.senderPublicKey,r.iv,r.sealed]),e)}return ii(Hu([r.type,r.iv,r.sealed]),e)}function zo(r){const{encoded:e,encoding:t=ls}=r,i=Ci(e,t),n=i.slice(rS,Av),a=Av;if(Ys(n)===Wn){const p=a+ld,b=p+No,w=i.slice(a,p),R=i.slice(p,b),O=i.slice(b);return{type:n,sealed:O,iv:R,senderPublicKey:w}}if(Ys(n)===tf){const p=i.slice(a),b=ys.randomBytes(No);return{type:n,sealed:p,iv:b}}const c=a+No,h=i.slice(a,c),d=i.slice(c);return{type:n,sealed:d,iv:h}}function cS(r,e){const t=zo({encoded:r,encoding:e==null?void 0:e.encoding});return Cb({type:Ys(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?ii(t.senderPublicKey,Kr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Cb(r){const e=(r==null?void 0:r.type)||Db;if(e===Wn){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function Pv(r){return r.type===Wn&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function Dv(r){return r.type===tf}function hS(r){return new tb.ec("p256").keyFromPublic({x:Buffer.from(r.x,"base64").toString("hex"),y:Buffer.from(r.y,"base64").toString("hex")},"hex")}function uS(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");const t=e.length%4;return t>0&&(e+="=".repeat(4-t)),e}function lS(r){return Buffer.from(uS(r),"base64")}function dS(r,e){const[t,i,n]=r.split("."),a=lS(n);if(a.length!==64)throw new Error("Invalid signature length");const c=a.slice(0,32).toString("hex"),h=a.slice(32,64).toString("hex"),d=`${t}.${i}`,p=new Go.SHA256().update(Buffer.from(d)).digest(),b=hS(e),w=Buffer.from(p).toString("hex");if(!b.verify(w,{r:c,s:h}))throw new Error("Invalid signature");return Al(r).payload}const pS="irn";function Ol(r){return(r==null?void 0:r.relay)||{protocol:pS}}function Oo(r){const e=dE[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var vS=Object.defineProperty,gS=Object.defineProperties,bS=Object.getOwnPropertyDescriptors,Ov=Object.getOwnPropertySymbols,mS=Object.prototype.hasOwnProperty,yS=Object.prototype.propertyIsEnumerable,Rv=(r,e,t)=>e in r?vS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Cv=(r,e)=>{for(var t in e||(e={}))mS.call(e,t)&&Rv(r,t,e[t]);if(Ov)for(var t of Ov(e))yS.call(e,t)&&Rv(r,t,e[t]);return r},wS=(r,e)=>gS(r,bS(e));function _S(r,e="-"){const t={},i="relay"+e;return Object.keys(r).forEach(n=>{if(n.startsWith(i)){const a=n.replace(i,""),c=r[n];t[a]=c}}),t}function Nv(r){if(!r.includes("wc:")){const d=Mb(r);d!=null&&d.includes("wc:")&&(r=d)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,i=r.substring(0,e),n=r.substring(e+1,t).split("@"),a=typeof t<"u"?r.substring(t):"",c=Uo.parse(a),h=typeof c.methods=="string"?c.methods.split(","):void 0;return{protocol:i,topic:xS(n[0]),version:parseInt(n[1],10),symKey:c.symKey,relay:_S(c),methods:h,expiryTimestamp:c.expiryTimestamp?parseInt(c.expiryTimestamp,10):void 0}}function xS(r){return r.startsWith("//")?r.substring(2):r}function ES(r,e="-"){const t="relay",i={};return Object.keys(r).forEach(n=>{const a=t+e+n;r[n]&&(i[a]=r[n])}),i}function Tv(r){return`${r.protocol}:${r.topic}@${r.version}?`+Uo.stringify(Cv(wS(Cv({symKey:r.symKey},ES(r.relay)),{expiryTimestamp:r.expiryTimestamp}),r.methods?{methods:r.methods.join(",")}:{}))}function hc(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function Ya(r){const e=[];return r.forEach(t=>{const[i,n]=t.split(":");e.push(`${i}:${n}`)}),e}function SS(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Ya(t.accounts))}),e}function MS(r,e){const t=[];return Object.values(r).forEach(i=>{Ya(i.accounts).includes(e)&&t.push(...i.methods)}),t}function IS(r,e){const t=[];return Object.values(r).forEach(i=>{Ya(i.accounts).includes(e)&&t.push(...i.events)}),t}function dd(r){return r.includes(":")}function Ro(r){return dd(r)?r.split(":")[0]:r}function AS(r){const e={};return r==null||r.forEach(t=>{const[i,n]=t.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[]}),e[i].accounts.push(t),e[i].chains.push(`${i}:${n}`)}),e}function $v(r,e){e=e.map(i=>i.replace("did:pkh:",""));const t=AS(e);for(const[i,n]of Object.entries(t))n.methods?n.methods=_c(n.methods,r):n.methods=r,n.events=["chainChanged","accountsChanged"];return t}const PS={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},DS={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Ee(r,e){const{message:t,code:i}=DS[r];return{message:e?`${t} ${e}`:t,code:i}}function Ut(r,e){const{message:t,code:i}=PS[r];return{message:e?`${t} ${e}`:t,code:i}}function Mn(r,e){return!!Array.isArray(r)}function Fo(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function ri(r){return typeof r>"u"}function fr(r,e){return e&&ri(r)?!0:typeof r=="string"&&!!r.trim().length}function pd(r,e){return typeof r=="number"&&!isNaN(r)}function OS(r,e){const{requiredNamespaces:t}=e,i=Object.keys(r.namespaces),n=Object.keys(t);let a=!0;return Hs(n,i)?(i.forEach(c=>{const{accounts:h,methods:d,events:p}=r.namespaces[c],b=Ya(h),w=t[c];(!Hs(mb(c,w),b)||!Hs(w.methods,d)||!Hs(w.events,p))&&(a=!1)}),a):!1}function zc(r){return fr(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function RS(r){if(fr(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&zc(t)}}return!1}function CS(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(fr(r,!1)){if(e(r))return!0;const t=Mb(r);return e(t)}}catch{}return!1}function NS(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function TS(r){return r==null?void 0:r.topic}function $S(r,e){let t=null;return fr(r==null?void 0:r.publicKey,!1)||(t=Ee("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Lv(r){let e=!0;return Mn(r)?r.length&&(e=r.every(t=>fr(t,!1))):e=!1,e}function LS(r,e,t){let i=null;return Mn(e)&&e.length?e.forEach(n=>{i||zc(n)||(i=Ut("UNSUPPORTED_CHAINS",`${t}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):zc(r)||(i=Ut("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function qS(r,e,t){let i=null;return Object.entries(r).forEach(([n,a])=>{if(i)return;const c=LS(n,mb(n,a),`${e} ${t}`);c&&(i=c)}),i}function US(r,e){let t=null;return Mn(r)?r.forEach(i=>{t||RS(i)||(t=Ut("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):t=Ut("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function BS(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const n=US(i==null?void 0:i.accounts,`${e} namespace`);n&&(t=n)}),t}function zS(r,e){let t=null;return Lv(r==null?void 0:r.methods)?Lv(r==null?void 0:r.events)||(t=Ut("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ut("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Nb(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const n=zS(i,`${e}, namespace`);n&&(t=n)}),t}function FS(r,e,t){let i=null;if(r&&Fo(r)){const n=Nb(r,e);n&&(i=n);const a=qS(r,e,t);a&&(i=a)}else i=Ee("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return i}function Xu(r,e){let t=null;if(r&&Fo(r)){const i=Nb(r,e);i&&(t=i);const n=BS(r,e);n&&(t=n)}else t=Ee("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Tb(r){return fr(r.protocol,!0)}function kS(r,e){let t=!1;return r?r&&Mn(r)&&r.length&&r.forEach(i=>{t=Tb(i)}):t=!0,t}function HS(r){return typeof r=="number"}function ti(r){return typeof r<"u"&&typeof r!==null}function KS(r){return!(!r||typeof r!="object"||!r.code||!pd(r.code)||!r.message||!fr(r.message,!1))}function jS(r){return!(ri(r)||!fr(r.method,!1))}function WS(r){return!(ri(r)||ri(r.result)&&ri(r.error)||!pd(r.id)||!fr(r.jsonrpc,!1))}function VS(r){return!(ri(r)||!fr(r.name,!1))}function qv(r,e){return!(!zc(e)||!SS(r).includes(e))}function GS(r,e,t){return fr(t,!1)?MS(r,e).includes(t):!1}function JS(r,e,t){return fr(t,!1)?IS(r,e).includes(t):!1}function Uv(r,e,t){let i=null;const n=YS(r),a=XS(e),c=Object.keys(n),h=Object.keys(a),d=Bv(Object.keys(r)),p=Bv(Object.keys(e)),b=d.filter(w=>!p.includes(w));return b.length&&(i=Ee("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${b.toString()}
      Received: ${Object.keys(e).toString()}`)),Hs(c,h)||(i=Ee("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${c.toString()}
      Approved: ${h.toString()}`)),Object.keys(e).forEach(w=>{if(!w.includes(":")||i)return;const R=Ya(e[w].accounts);R.includes(w)||(i=Ee("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${w}
        Required: ${w}
        Approved: ${R.toString()}`))}),c.forEach(w=>{i||(Hs(n[w].methods,a[w].methods)?Hs(n[w].events,a[w].events)||(i=Ee("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${w}`)):i=Ee("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${w}`))}),i}function YS(r){const e={};return Object.keys(r).forEach(t=>{var i;t.includes(":")?e[t]=r[t]:(i=r[t].chains)==null||i.forEach(n=>{e[n]={methods:r[t].methods,events:r[t].events}})}),e}function Bv(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function XS(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const i=Ya(r[t].accounts);i==null||i.forEach(n=>{e[n]={accounts:r[t].accounts.filter(a=>a.includes(`${n}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function ZS(r,e){return pd(r)&&r<=e.max&&r>=e.min}function zv(){const r=Qo();return new Promise(e=>{switch(r){case pi.browser:e(QS());break;case pi.reactNative:e(eM());break;case pi.node:e(tM());break;default:e(!0)}})}function QS(){return Zo()&&(navigator==null?void 0:navigator.onLine)}async function eM(){if(Ja()&&typeof rr<"u"&&rr!=null&&rr.NetInfo){const r=await(rr==null?void 0:rr.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function tM(){return!0}function rM(r){switch(Qo()){case pi.browser:iM(r);break;case pi.reactNative:nM(r);break}}function iM(r){!Ja()&&Zo()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function nM(r){Ja()&&typeof rr<"u"&&rr!=null&&rr.NetInfo&&(rr==null||rr.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}const Zu={};class So{static get(e){return Zu[e]}static set(e,t){Zu[e]=t}static delete(e){delete Zu[e]}}class ta{}let sM=class extends ta{constructor(e){super()}};const Fv=Se.FIVE_SECONDS,Xa={pulse:"heartbeat_pulse"};let aM=class $b extends sM{constructor(e){super(e),this.events=new vi.EventEmitter,this.interval=Fv,this.interval=(e==null?void 0:e.interval)||Fv}static async init(e){const t=new $b(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Se.toMiliseconds(this.interval))}pulse(){this.events.emit(Xa.pulse)}};const oM=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,fM=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,cM=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function hM(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){uM(r);return}return e}function uM(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function uc(r,e={}){if(typeof r!="string")return r;const t=r.trim();if(r[0]==='"'&&r.endsWith('"')&&!r.includes("\\"))return t.slice(1,-1);if(t.length<=9){const i=t.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!cM.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(oM.test(r)||fM.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,hM)}return JSON.parse(r)}catch(i){if(e.strict)throw i;return r}}function lM(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function yr(r,...e){try{return lM(r(...e))}catch(t){return Promise.reject(t)}}function dM(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function pM(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Sc(r){if(dM(r))return String(r);if(pM(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Sc(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Lb(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Rl="base64:";function vM(r){if(typeof r=="string")return r;Lb();const e=Buffer.from(r).toString("base64");return Rl+e}function gM(r){return typeof r!="string"||!r.startsWith(Rl)?r:(Lb(),Buffer.from(r.slice(Rl.length),"base64"))}function ei(r){return r?r.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function bM(...r){return ei(r.join(":"))}function lc(r){return r=ei(r),r?r+":":""}const mM="memory",yM=()=>{const r=new Map;return{name:mM,options:{},hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return Array.from(r.keys())},clear(){r.clear()},dispose(){r.clear()}}};function wM(r={}){const e={mounts:{"":r.driver||yM()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=p=>{for(const b of e.mountpoints)if(p.startsWith(b))return{base:b,relativeKey:p.slice(b.length),driver:e.mounts[b]};return{base:"",relativeKey:p,driver:e.mounts[""]}},i=(p,b)=>e.mountpoints.filter(w=>w.startsWith(p)||b&&p.startsWith(w)).map(w=>({relativeBase:p.length>w.length?p.slice(w.length):void 0,mountpoint:w,driver:e.mounts[w]})),n=(p,b)=>{if(e.watching){b=ei(b);for(const w of e.watchListeners)w(p,b)}},a=async()=>{if(!e.watching){e.watching=!0;for(const p in e.mounts)e.unwatch[p]=await kv(e.mounts[p],n,p)}},c=async()=>{if(e.watching){for(const p in e.unwatch)await e.unwatch[p]();e.unwatch={},e.watching=!1}},h=(p,b,w)=>{const R=new Map,O=C=>{let q=R.get(C.base);return q||(q={driver:C.driver,base:C.base,items:[]},R.set(C.base,q)),q};for(const C of p){const q=typeof C=="string",V=ei(q?C:C.key),Y=q?void 0:C.value,H=q||!C.options?b:{...b,...C.options},X=t(V);O(X).items.push({key:V,value:Y,relativeKey:X.relativeKey,options:H})}return Promise.all([...R.values()].map(C=>w(C))).then(C=>C.flat())},d={hasItem(p,b={}){p=ei(p);const{relativeKey:w,driver:R}=t(p);return yr(R.hasItem,w,b)},getItem(p,b={}){p=ei(p);const{relativeKey:w,driver:R}=t(p);return yr(R.getItem,w,b).then(O=>uc(O))},getItems(p,b){return h(p,b,w=>w.driver.getItems?yr(w.driver.getItems,w.items.map(R=>({key:R.relativeKey,options:R.options})),b).then(R=>R.map(O=>({key:bM(w.base,O.key),value:uc(O.value)}))):Promise.all(w.items.map(R=>yr(w.driver.getItem,R.relativeKey,R.options).then(O=>({key:R.key,value:uc(O)})))))},getItemRaw(p,b={}){p=ei(p);const{relativeKey:w,driver:R}=t(p);return R.getItemRaw?yr(R.getItemRaw,w,b):yr(R.getItem,w,b).then(O=>gM(O))},async setItem(p,b,w={}){if(b===void 0)return d.removeItem(p);p=ei(p);const{relativeKey:R,driver:O}=t(p);O.setItem&&(await yr(O.setItem,R,Sc(b),w),O.watch||n("update",p))},async setItems(p,b){await h(p,b,async w=>{if(w.driver.setItems)return yr(w.driver.setItems,w.items.map(R=>({key:R.relativeKey,value:Sc(R.value),options:R.options})),b);w.driver.setItem&&await Promise.all(w.items.map(R=>yr(w.driver.setItem,R.relativeKey,Sc(R.value),R.options)))})},async setItemRaw(p,b,w={}){if(b===void 0)return d.removeItem(p,w);p=ei(p);const{relativeKey:R,driver:O}=t(p);if(O.setItemRaw)await yr(O.setItemRaw,R,b,w);else if(O.setItem)await yr(O.setItem,R,vM(b),w);else return;O.watch||n("update",p)},async removeItem(p,b={}){typeof b=="boolean"&&(b={removeMeta:b}),p=ei(p);const{relativeKey:w,driver:R}=t(p);R.removeItem&&(await yr(R.removeItem,w,b),(b.removeMeta||b.removeMata)&&await yr(R.removeItem,w+"$",b),R.watch||n("remove",p))},async getMeta(p,b={}){typeof b=="boolean"&&(b={nativeOnly:b}),p=ei(p);const{relativeKey:w,driver:R}=t(p),O=Object.create(null);if(R.getMeta&&Object.assign(O,await yr(R.getMeta,w,b)),!b.nativeOnly){const C=await yr(R.getItem,w+"$",b).then(q=>uc(q));C&&typeof C=="object"&&(typeof C.atime=="string"&&(C.atime=new Date(C.atime)),typeof C.mtime=="string"&&(C.mtime=new Date(C.mtime)),Object.assign(O,C))}return O},setMeta(p,b,w={}){return this.setItem(p+"$",b,w)},removeMeta(p,b={}){return this.removeItem(p+"$",b)},async getKeys(p,b={}){p=lc(p);const w=i(p,!0);let R=[];const O=[];for(const C of w){const V=(await yr(C.driver.getKeys,C.relativeBase,b)).map(Y=>C.mountpoint+ei(Y)).filter(Y=>!R.some(H=>Y.startsWith(H)));O.push(...V),R=[C.mountpoint,...R.filter(Y=>!Y.startsWith(C.mountpoint))]}return p?O.filter(C=>C.startsWith(p)&&!C.endsWith("$")):O.filter(C=>!C.endsWith("$"))},async clear(p,b={}){p=lc(p),await Promise.all(i(p,!1).map(async w=>{if(w.driver.clear)return yr(w.driver.clear,w.relativeBase,b);if(w.driver.removeItem){const R=await w.driver.getKeys(w.relativeBase||"",b);return Promise.all(R.map(O=>w.driver.removeItem(O,b)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(p=>Hv(p)))},async watch(p){return await a(),e.watchListeners.push(p),async()=>{e.watchListeners=e.watchListeners.filter(b=>b!==p),e.watchListeners.length===0&&await c()}},async unwatch(){e.watchListeners=[],await c()},mount(p,b){if(p=lc(p),p&&e.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(e.mountpoints.push(p),e.mountpoints.sort((w,R)=>R.length-w.length)),e.mounts[p]=b,e.watching&&Promise.resolve(kv(b,n,p)).then(w=>{e.unwatch[p]=w}).catch(console.error),d},async unmount(p,b=!0){p=lc(p),!(!p||!e.mounts[p])&&(e.watching&&p in e.unwatch&&(e.unwatch[p](),delete e.unwatch[p]),b&&await Hv(e.mounts[p]),e.mountpoints=e.mountpoints.filter(w=>w!==p),delete e.mounts[p])},getMount(p=""){p=ei(p)+":";const b=t(p);return{driver:b.driver,base:b.base}},getMounts(p="",b={}){return p=ei(p),i(p,b.parents).map(R=>({driver:R.driver,base:R.mountpoint}))}};return d}function kv(r,e,t){return r.watch?r.watch((i,n)=>e(i,t+n)):()=>{}}async function Hv(r){typeof r.dispose=="function"&&await yr(r.dispose)}function ra(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function qb(r,e){const t=indexedDB.open(r);t.onupgradeneeded=()=>t.result.createObjectStore(e);const i=ra(t);return(n,a)=>i.then(c=>a(c.transaction(e,n).objectStore(e)))}let Qu;function rf(){return Qu||(Qu=qb("keyval-store","keyval")),Qu}function Kv(r,e=rf()){return e("readonly",t=>ra(t.get(r)))}function _M(r,e,t=rf()){return t("readwrite",i=>(i.put(e,r),ra(i.transaction)))}function xM(r,e=rf()){return e("readwrite",t=>(t.delete(r),ra(t.transaction)))}function EM(r=rf()){return r("readwrite",e=>(e.clear(),ra(e.transaction)))}function SM(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},ra(r.transaction)}function MM(r=rf()){return r("readonly",e=>{if(e.getAllKeys)return ra(e.getAllKeys());const t=[];return SM(e,i=>t.push(i.key)).then(()=>t)})}var jv={};const IM="idb-keyval";var AM=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=n=>e+n;let i;return r.dbName&&r.storeName&&(i=qb(r.dbName,r.storeName)),{name:IM,options:r,async hasItem(n){return!(typeof await Kv(t(n),i)>"u")},async getItem(n){return await Kv(t(n),i)??null},setItem(n,a){return _M(t(n),a,i)},removeItem(n){return xM(t(n),i)},getKeys(){return MM(i)},clear(){return EM(i)}}};const PM="WALLET_CONNECT_V2_INDEXED_DB",DM="keyvaluestorage";let OM=class{constructor(){this.indexedDb=wM({driver:AM({dbName:PM,storeName:DM})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Jn(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var el=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof jv<"u"?jv:typeof self<"u"?self:{},Mc={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,i){this[t]=String(i)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(i){t[i]=void 0,delete t[i]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof el<"u"&&el.localStorage?Mc.exports=el.localStorage:typeof window<"u"&&window.localStorage?Mc.exports=window.localStorage:Mc.exports=new e})();function RM(r){var e;return[r[0],Gs((e=r[1])!=null?e:"")]}let CM=class{constructor(){this.localStorage=Mc.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(RM)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Gs(t)}async setItem(e,t){this.localStorage.setItem(e,Jn(t))}async removeItem(e){this.localStorage.removeItem(e)}};const NM="wc_storage_version",Wv=1,TM=async(r,e,t)=>{const i=NM,n=await e.getItem(i);if(n&&n>=Wv){t(e);return}const a=await r.getKeys();if(!a.length){t(e);return}const c=[];for(;a.length;){const h=a.shift();if(!h)continue;const d=h.toLowerCase();if(d.includes("wc@")||d.includes("walletconnect")||d.includes("wc_")||d.includes("wallet_connect")){const p=await r.getItem(h);await e.setItem(h,p),c.push(h)}}await e.setItem(i,Wv),t(e),$M(r,c)},$M=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let LM=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new CM;this.storage=e;try{const t=new OM;TM(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};function qM(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var UM=BM;function BM(r,e,t){var i=t&&t.stringify||qM,n=1;if(typeof r=="object"&&r!==null){var a=e.length+n;if(a===1)return r;var c=new Array(a);c[0]=i(r);for(var h=1;h<a;h++)c[h]=i(e[h]);return c.join(" ")}if(typeof r!="string")return r;var d=e.length;if(d===0)return r;for(var p="",b=1-n,w=-1,R=r&&r.length||0,O=0;O<R;){if(r.charCodeAt(O)===37&&O+1<R){switch(w=w>-1?w:0,r.charCodeAt(O+1)){case 100:case 102:if(b>=d||e[b]==null)break;w<O&&(p+=r.slice(w,O)),p+=Number(e[b]),w=O+2,O++;break;case 105:if(b>=d||e[b]==null)break;w<O&&(p+=r.slice(w,O)),p+=Math.floor(Number(e[b])),w=O+2,O++;break;case 79:case 111:case 106:if(b>=d||e[b]===void 0)break;w<O&&(p+=r.slice(w,O));var C=typeof e[b];if(C==="string"){p+="'"+e[b]+"'",w=O+2,O++;break}if(C==="function"){p+=e[b].name||"<anonymous>",w=O+2,O++;break}p+=i(e[b]),w=O+2,O++;break;case 115:if(b>=d)break;w<O&&(p+=r.slice(w,O)),p+=String(e[b]),w=O+2,O++;break;case 37:w<O&&(p+=r.slice(w,O)),p+="%",w=O+2,O++,b--;break}++b}++O}return w===-1?r:(w<R&&(p+=r.slice(w)),p)}const Vv=UM;var Ia=_n;const ko=JM().console||{},zM={mapHttpRequest:dc,mapHttpResponse:dc,wrapRequestSerializer:tl,wrapResponseSerializer:tl,wrapErrorSerializer:tl,req:dc,res:dc,err:jM};function FM(r,e){return Array.isArray(r)?r.filter(function(i){return i!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function _n(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||ko;r.browser.write&&(r.browser.asObject=!0);const i=r.serializers||{},n=FM(r.browser.serialize,i);let a=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);const c=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const h=r.level||"info",d=Object.create(t);d.log||(d.log=Ho),Object.defineProperty(d,"levelVal",{get:b}),Object.defineProperty(d,"level",{get:w,set:R});const p={transmit:e,serialize:n,asObject:r.browser.asObject,levels:c,timestamp:WM(r)};d.levels=_n.levels,d.level=h,d.setMaxListeners=d.getMaxListeners=d.emit=d.addListener=d.on=d.prependListener=d.once=d.prependOnceListener=d.removeListener=d.removeAllListeners=d.listeners=d.listenerCount=d.eventNames=d.write=d.flush=Ho,d.serializers=i,d._serialize=n,d._stdErrSerialize=a,d.child=O,e&&(d._logEvent=Cl());function b(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function R(C){if(C!=="silent"&&!this.levels.values[C])throw Error("unknown level "+C);this._level=C,Ea(p,d,"error","log"),Ea(p,d,"fatal","error"),Ea(p,d,"warn","error"),Ea(p,d,"info","log"),Ea(p,d,"debug","log"),Ea(p,d,"trace","log")}function O(C,q){if(!C)throw new Error("missing bindings for child Pino");q=q||{},n&&C.serializers&&(q.serializers=C.serializers);const V=q.serializers;if(n&&V){var Y=Object.assign({},i,V),H=r.browser.serialize===!0?Object.keys(Y):n;delete C.serializers,ph([C],H,Y,this._stdErrSerialize)}function X(k){this._childLevel=(k._childLevel|0)+1,this.error=Sa(k,C,"error"),this.fatal=Sa(k,C,"fatal"),this.warn=Sa(k,C,"warn"),this.info=Sa(k,C,"info"),this.debug=Sa(k,C,"debug"),this.trace=Sa(k,C,"trace"),Y&&(this.serializers=Y,this._serialize=H),e&&(this._logEvent=Cl([].concat(k._logEvent.bindings,C)))}return X.prototype=this,new X(this)}return d}_n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};_n.stdSerializers=zM;_n.stdTimeFunctions=Object.assign({},{nullTime:Ub,epochTime:Bb,unixTime:VM,isoTime:GM});function Ea(r,e,t,i){const n=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?Ho:n[t]?n[t]:ko[t]||ko[i]||Ho,kM(r,e,t)}function kM(r,e,t){!r.transmit&&e[t]===Ho||(e[t]=function(i){return function(){const a=r.timestamp(),c=new Array(arguments.length),h=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ko?ko:this;for(var d=0;d<c.length;d++)c[d]=arguments[d];if(r.serialize&&!r.asObject&&ph(c,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?i.call(h,HM(this,t,c,a)):i.apply(h,c),r.transmit){const p=r.transmit.level||e.level,b=_n.levels.values[p],w=_n.levels.values[t];if(w<b)return;KM(this,{ts:a,methodLevel:t,methodValue:w,transmitLevel:p,transmitValue:_n.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},c)}}}(e[t]))}function HM(r,e,t,i){r._serialize&&ph(t,r._serialize,r.serializers,r._stdErrSerialize);const n=t.slice();let a=n[0];const c={};i&&(c.time=i),c.level=_n.levels.values[e];let h=(r._childLevel|0)+1;if(h<1&&(h=1),a!==null&&typeof a=="object"){for(;h--&&typeof n[0]=="object";)Object.assign(c,n.shift());a=n.length?Vv(n.shift(),n):void 0}else typeof a=="string"&&(a=Vv(n.shift(),n));return a!==void 0&&(c.msg=a),c}function ph(r,e,t,i){for(const n in r)if(i&&r[n]instanceof Error)r[n]=_n.stdSerializers.err(r[n]);else if(typeof r[n]=="object"&&!Array.isArray(r[n]))for(const a in r[n])e&&e.indexOf(a)>-1&&a in t&&(r[n][a]=t[a](r[n][a]))}function Sa(r,e,t){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return r[t].apply(this,i)}}function KM(r,e,t){const i=e.send,n=e.ts,a=e.methodLevel,c=e.methodValue,h=e.val,d=r._logEvent.bindings;ph(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=n,r._logEvent.messages=t.filter(function(p){return d.indexOf(p)===-1}),r._logEvent.level.label=a,r._logEvent.level.value=c,i(a,r._logEvent,h),r._logEvent=Cl(d)}function Cl(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function jM(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function WM(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?Ub:Bb}function dc(){return{}}function tl(r){return r}function Ho(){}function Ub(){return!1}function Bb(){return Date.now()}function VM(){return Math.round(Date.now()/1e3)}function GM(){return new Date(Date.now()).toISOString()}function JM(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}const nf=gs(Ia),YM={level:"info"},sf="custom_context",vd=1e3*1024;let XM=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Gv=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new XM(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},zb=class{constructor(e,t=vd){this.level=e??"error",this.levelValue=Ia.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new Gv(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Ia.levels.values.error?console.error(e):t===Ia.levels.values.warn?console.warn(e):t===Ia.levels.values.debug?console.debug(e):t===Ia.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Jn({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new Gv(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(Jn({extraMetadata:e})),new Blob(t,{type:"application/json"})}},ZM=class{constructor(e,t=vd){this.baseChunkLogger=new zb(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),i=document.createElement("a");i.href=t,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t)}},QM=class{constructor(e,t=vd){this.baseChunkLogger=new zb(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var eI=Object.defineProperty,tI=Object.defineProperties,rI=Object.getOwnPropertyDescriptors,Jv=Object.getOwnPropertySymbols,iI=Object.prototype.hasOwnProperty,nI=Object.prototype.propertyIsEnumerable,Yv=(r,e,t)=>e in r?eI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Fc=(r,e)=>{for(var t in e||(e={}))iI.call(e,t)&&Yv(r,t,e[t]);if(Jv)for(var t of Jv(e))nI.call(e,t)&&Yv(r,t,e[t]);return r},kc=(r,e)=>tI(r,rI(e));function vh(r){return kc(Fc({},r),{level:(r==null?void 0:r.level)||YM.level})}function sI(r,e=sf){return r[e]||""}function aI(r,e,t=sf){return r[t]=e,r}function ai(r,e=sf){let t="";return typeof r.bindings>"u"?t=sI(r,e):t=r.bindings().context||"",t}function oI(r,e,t=sf){const i=ai(r,t);return i.trim()?`${i}/${e}`:e}function jr(r,e,t=sf){const i=oI(r,e,t),n=r.child({context:i});return aI(n,i,t)}function fI(r){var e,t;const i=new ZM((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:nf(kc(Fc({},r.opts),{level:"trace",browser:kc(Fc({},(t=r.opts)==null?void 0:t.browser),{write:n=>i.write(n)})})),chunkLoggerController:i}}function cI(r){var e;const t=new QM((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:nf(kc(Fc({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function hI(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?fI(r):cI(r)}let uI=class extends ta{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}},lI=class extends ta{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},dI=class{constructor(e,t){this.logger=e,this.core=t}},pI=class extends ta{constructor(e,t){super(),this.relayer=e,this.logger=t}},vI=class extends ta{constructor(e){super()}},gI=class{constructor(e,t,i,n){this.core=e,this.logger=t,this.name=i}},bI=class extends ta{constructor(e,t){super(),this.relayer=e,this.logger=t}},mI=class extends ta{constructor(e,t){super(),this.core=e,this.logger=t}},yI=class{constructor(e,t,i){this.core=e,this.logger=t,this.store=i}},wI=class{constructor(e,t){this.projectId=e,this.logger=t}},_I=class{constructor(e,t,i){this.core=e,this.logger=t,this.telemetryEnabled=i}},xI=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},EI=class{constructor(e){this.client=e}};const SI="PARSE_ERROR",MI="INVALID_REQUEST",II="METHOD_NOT_FOUND",AI="INVALID_PARAMS",Fb="INTERNAL_ERROR",gd="SERVER_ERROR",PI=[-32700,-32600,-32601,-32602,-32603],To={[SI]:{code:-32700,message:"Parse error"},[MI]:{code:-32600,message:"Invalid Request"},[II]:{code:-32601,message:"Method not found"},[AI]:{code:-32602,message:"Invalid params"},[Fb]:{code:-32603,message:"Internal error"},[gd]:{code:-32e3,message:"Server error"}},kb=gd;function DI(r){return PI.includes(r)}function Xv(r){return Object.keys(To).includes(r)?To[r]:To[kb]}function OI(r){const e=Object.values(To).find(t=>t.code===r);return e||To[kb]}function Hb(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var Kb={},zn={},Zv;function RI(){if(Zv)return zn;Zv=1;var r={};Object.defineProperty(zn,"__esModule",{value:!0}),zn.isBrowserCryptoAvailable=zn.getSubtleCrypto=zn.getBrowerCrypto=void 0;function e(){return(r==null?void 0:r.crypto)||(r==null?void 0:r.msCrypto)||{}}zn.getBrowerCrypto=e;function t(){const n=e();return n.subtle||n.webkitSubtle}zn.getSubtleCrypto=t;function i(){return!!e()&&!!t()}return zn.isBrowserCryptoAvailable=i,zn}var Fn={},Qv;function CI(){if(Qv)return Fn;Qv=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.isBrowser=Fn.isNode=Fn.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Fn.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Fn.isNode=e;function t(){return!r()&&!e()}return Fn.isBrowser=t,Fn}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ko;e.__exportStar(RI(),r),e.__exportStar(CI(),r)})(Kb);function hs(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function Ks(r=6){return BigInt(hs(r))}function ds(r,e,t){return{id:t||hs(),jsonrpc:"2.0",method:r,params:e}}function gh(r,e){return{id:r,jsonrpc:"2.0",result:e}}function bh(r,e,t){return{id:r,jsonrpc:"2.0",error:NI(e)}}function NI(r,e){return typeof r>"u"?Xv(Fb):(typeof r=="string"&&(r=Object.assign(Object.assign({},Xv(gd)),{message:r})),DI(r.code)&&(r=OI(r.code)),r)}class TI{}class $I extends TI{constructor(){super()}}class LI extends $I{constructor(e){super()}}const qI="^https?:",UI="^wss?:";function BI(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function jb(r,e){const t=BI(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function e1(r){return jb(r,qI)}function t1(r){return jb(r,UI)}function zI(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Wb(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function bd(r){return Wb(r)&&"method"in r}function mh(r){return Wb(r)&&(vn(r)||Ri(r))}function vn(r){return"result"in r}function Ri(r){return"error"in r}let sn=class extends LI{constructor(e){super(e),this.events=new vi.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(ds(e.method,e.params||[],e.id||Ks().toString()),t)}async requestStrict(e,t){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(a){n(a)}this.events.on(`${e.id}`,a=>{Ri(a)?n(a.error):i(a.result)});try{await this.connection.send(e,t)}catch(a){n(a)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),mh(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};var $o={};const FI=()=>typeof WebSocket<"u"?WebSocket:typeof $o<"u"&&typeof $o.WebSocket<"u"?$o.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),kI=()=>typeof WebSocket<"u"||typeof $o<"u"&&typeof $o.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",r1=r=>r.split("?")[0],i1=10,HI=FI();let KI=class{constructor(e){if(this.url=e,this.events=new vi.EventEmitter,this.registering=!1,!t1(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Jn(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!t1(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,n)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),n(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,i)=>{const n=new URLSearchParams(e).get("origin"),a=Kb.isReactNative()?{headers:{origin:n}}:{rejectUnauthorized:!zI(e)},c=new HI(e,[],a);kI()?c.onerror=h=>{const d=h;i(this.emitError(d.error))}:c.on("error",h=>{i(this.emitError(h))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Gs(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),n=i.message||i.toString(),a=bh(e,n);this.events.emit("payload",a)}parseError(e,t=this.url){return Hb(e,r1(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>i1&&this.events.setMaxListeners(i1)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${r1(this.url)}`));return this.events.emit("register_error",t),t}};var Hc={exports:{}};Hc.exports;(function(r,e){var t={},i=200,n="__lodash_hash_undefined__",a=1,c=2,h=9007199254740991,d="[object Arguments]",p="[object Array]",b="[object AsyncFunction]",w="[object Boolean]",R="[object Date]",O="[object Error]",C="[object Function]",q="[object GeneratorFunction]",V="[object Map]",Y="[object Number]",H="[object Null]",X="[object Object]",k="[object Promise]",W="[object Proxy]",J="[object RegExp]",M="[object Set]",B="[object String]",ae="[object Symbol]",de="[object Undefined]",U="[object WeakMap]",m="[object ArrayBuffer]",g="[object DataView]",f="[object Float32Array]",u="[object Float64Array]",y="[object Int8Array]",A="[object Int16Array]",P="[object Int32Array]",S="[object Uint8Array]",v="[object Uint8ClampedArray]",E="[object Uint16Array]",x="[object Uint32Array]",T=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,fe=/^(?:0|[1-9]\d*)$/,D={};D[f]=D[u]=D[y]=D[A]=D[P]=D[S]=D[v]=D[E]=D[x]=!0,D[d]=D[p]=D[m]=D[w]=D[g]=D[R]=D[O]=D[C]=D[V]=D[Y]=D[X]=D[J]=D[M]=D[B]=D[U]=!1;var F=typeof t=="object"&&t&&t.Object===Object&&t,j=typeof self=="object"&&self&&self.Object===Object&&self,L=F||j||Function("return this")(),_=e&&!e.nodeType&&e,K=_&&!0&&r&&!r.nodeType&&r,re=K&&K.exports===_,se=re&&F.process,we=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),ce=we&&we.isTypedArray;function me(G,te){for(var pe=-1,Ue=G==null?0:G.length,kt=0,vt=[];++pe<Ue;){var Gt=G[pe];te(Gt,pe,G)&&(vt[kt++]=Gt)}return vt}function Ke(G,te){for(var pe=-1,Ue=te.length,kt=G.length;++pe<Ue;)G[kt+pe]=te[pe];return G}function Me(G,te){for(var pe=-1,Ue=G==null?0:G.length;++pe<Ue;)if(te(G[pe],pe,G))return!0;return!1}function Je(G,te){for(var pe=-1,Ue=Array(G);++pe<G;)Ue[pe]=te(pe);return Ue}function Fe(G){return function(te){return G(te)}}function ye(G,te){return G.has(te)}function Ie(G,te){return G==null?void 0:G[te]}function Ce(G){var te=-1,pe=Array(G.size);return G.forEach(function(Ue,kt){pe[++te]=[kt,Ue]}),pe}function ge(G,te){return function(pe){return G(te(pe))}}function $e(G){var te=-1,pe=Array(G.size);return G.forEach(function(Ue){pe[++te]=Ue}),pe}var Ae=Array.prototype,be=Function.prototype,Oe=Object.prototype,Ne=L["__core-js_shared__"],_e=be.toString,De=Oe.hasOwnProperty,ke=function(){var G=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return G?"Symbol(src)_1."+G:""}(),xe=Oe.toString,je=RegExp("^"+_e.call(De).replace(T,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),We=re?L.Buffer:void 0,He=L.Symbol,dt=L.Uint8Array,mt=Oe.propertyIsEnumerable,Ge=Ae.splice,pt=He?He.toStringTag:void 0,St=Object.getOwnPropertySymbols,Ye=We?We.isBuffer:void 0,nt=ge(Object.keys,Object),Ze=oi(L,"DataView"),Te=oi(L,"Map"),Qe=oi(L,"Promise"),et=oi(L,"Set"),Le=oi(L,"WeakMap"),Xe=oi(Object,"create"),ct=On(Ze),Be=On(Te),tt=On(Qe),ht=On(et),qe=On(Le),st=He?He.prototype:void 0,rt=st?st.valueOf:void 0;function Re(G){var te=-1,pe=G==null?0:G.length;for(this.clear();++te<pe;){var Ue=G[te];this.set(Ue[0],Ue[1])}}function ut(){this.__data__=Xe?Xe(null):{},this.size=0}function Ct(G){var te=this.has(G)&&delete this.__data__[G];return this.size-=te?1:0,te}function at(G){var te=this.__data__;if(Xe){var pe=te[G];return pe===n?void 0:pe}return De.call(te,G)?te[G]:void 0}function Nt(G){var te=this.__data__;return Xe?te[G]!==void 0:De.call(te,G)}function Rt(G,te){var pe=this.__data__;return this.size+=this.has(G)?0:1,pe[G]=Xe&&te===void 0?n:te,this}Re.prototype.clear=ut,Re.prototype.delete=Ct,Re.prototype.get=at,Re.prototype.has=Nt,Re.prototype.set=Rt;function yt(G){var te=-1,pe=G==null?0:G.length;for(this.clear();++te<pe;){var Ue=G[te];this.set(Ue[0],Ue[1])}}function Dr(){this.__data__=[],this.size=0}function Or(G){var te=this.__data__,pe=Es(te,G);if(pe<0)return!1;var Ue=te.length-1;return pe==Ue?te.pop():Ge.call(te,pe,1),--this.size,!0}function Rr(G){var te=this.__data__,pe=Es(te,G);return pe<0?void 0:te[pe][1]}function Cr(G){return Es(this.__data__,G)>-1}function Nr(G,te){var pe=this.__data__,Ue=Es(pe,G);return Ue<0?(++this.size,pe.push([G,te])):pe[Ue][1]=te,this}yt.prototype.clear=Dr,yt.prototype.delete=Or,yt.prototype.get=Rr,yt.prototype.has=Cr,yt.prototype.set=Nr;function Qt(G){var te=-1,pe=G==null?0:G.length;for(this.clear();++te<pe;){var Ue=G[te];this.set(Ue[0],Ue[1])}}function Wr(){this.size=0,this.__data__={hash:new Re,map:new(Te||yt),string:new Re}}function Bi(G){var te=Xn(this,G).delete(G);return this.size-=te?1:0,te}function Vr(G){return Xn(this,G).get(G)}function zi(G){return Xn(this,G).has(G)}function Fi(G,te){var pe=Xn(this,G),Ue=pe.size;return pe.set(G,te),this.size+=pe.size==Ue?0:1,this}Qt.prototype.clear=Wr,Qt.prototype.delete=Bi,Qt.prototype.get=Vr,Qt.prototype.has=zi,Qt.prototype.set=Fi;function Gr(G){var te=-1,pe=G==null?0:G.length;for(this.__data__=new Qt;++te<pe;)this.add(G[te])}function yi(G){return this.__data__.set(G,n),this}function wi(G){return this.__data__.has(G)}Gr.prototype.add=Gr.prototype.push=yi,Gr.prototype.has=wi;function lr(G){var te=this.__data__=new yt(G);this.size=te.size}function ki(){this.__data__=new yt,this.size=0}function Hi(G){var te=this.__data__,pe=te.delete(G);return this.size=te.size,pe}function _s(G){return this.__data__.get(G)}function xs(G){return this.__data__.has(G)}function of(G,te){var pe=this.__data__;if(pe instanceof yt){var Ue=pe.__data__;if(!Te||Ue.length<i-1)return Ue.push([G,te]),this.size=++pe.size,this;pe=this.__data__=new Qt(Ue)}return pe.set(G,te),this.size=pe.size,this}lr.prototype.clear=ki,lr.prototype.delete=Hi,lr.prototype.get=_s,lr.prototype.has=xs,lr.prototype.set=of;function ff(G,te){var pe=oa(G),Ue=!pe&&wf(G),kt=!pe&&!Ue&&eo(G),vt=!pe&&!Ue&&!kt&&Ef(G),Gt=pe||Ue||kt||vt,cr=Gt?Je(G.length,String):[],Dt=cr.length;for(var Ht in G)De.call(G,Ht)&&!(Gt&&(Ht=="length"||kt&&(Ht=="offset"||Ht=="parent")||vt&&(Ht=="buffer"||Ht=="byteLength"||Ht=="byteOffset")||vf(Ht,Dt)))&&cr.push(Ht);return cr}function Es(G,te){for(var pe=G.length;pe--;)if(yf(G[pe][0],te))return pe;return-1}function Za(G,te,pe){var Ue=te(G);return oa(G)?Ue:Ke(Ue,pe(G))}function Ss(G){return G==null?G===void 0?de:H:pt&&pt in Object(G)?df(G):Eh(G)}function Qa(G){return Is(G)&&Ss(G)==d}function Ms(G,te,pe,Ue,kt){return G===te?!0:G==null||te==null||!Is(G)&&!Is(te)?G!==G&&te!==te:cf(G,te,pe,Ue,Ms,kt)}function cf(G,te,pe,Ue,kt,vt){var Gt=oa(G),cr=oa(te),Dt=Gt?p:on(G),Ht=cr?p:on(te);Dt=Dt==d?X:Dt,Ht=Ht==d?X:Ht;var nr=Dt==X,Jr=Ht==X,hr=Dt==Ht;if(hr&&eo(G)){if(!eo(te))return!1;Gt=!0,nr=!1}if(hr&&!nr)return vt||(vt=new lr),Gt||Ef(G)?sa(G,te,pe,Ue,kt,vt):xh(G,te,Dt,pe,Ue,kt,vt);if(!(pe&a)){var Jt=nr&&De.call(G,"__wrapped__"),Br=Jr&&De.call(te,"__wrapped__");if(Jt||Br){var Ki=Jt?G.value():G,_i=Br?te.value():te;return vt||(vt=new lr),kt(Ki,_i,pe,Ue,vt)}}return hr?(vt||(vt=new lr),lf(G,te,pe,Ue,kt,vt)):!1}function _h(G){if(!xf(G)||bf(G))return!1;var te=fa(G)?je:ne;return te.test(On(G))}function hf(G){return Is(G)&&_f(G.length)&&!!D[Ss(G)]}function uf(G){if(!mf(G))return nt(G);var te=[];for(var pe in Object(G))De.call(G,pe)&&pe!="constructor"&&te.push(pe);return te}function sa(G,te,pe,Ue,kt,vt){var Gt=pe&a,cr=G.length,Dt=te.length;if(cr!=Dt&&!(Gt&&Dt>cr))return!1;var Ht=vt.get(G);if(Ht&&vt.get(te))return Ht==te;var nr=-1,Jr=!0,hr=pe&c?new Gr:void 0;for(vt.set(G,te),vt.set(te,G);++nr<cr;){var Jt=G[nr],Br=te[nr];if(Ue)var Ki=Gt?Ue(Br,Jt,nr,te,G,vt):Ue(Jt,Br,nr,G,te,vt);if(Ki!==void 0){if(Ki)continue;Jr=!1;break}if(hr){if(!Me(te,function(_i,fn){if(!ye(hr,fn)&&(Jt===_i||kt(Jt,_i,pe,Ue,vt)))return hr.push(fn)})){Jr=!1;break}}else if(!(Jt===Br||kt(Jt,Br,pe,Ue,vt))){Jr=!1;break}}return vt.delete(G),vt.delete(te),Jr}function xh(G,te,pe,Ue,kt,vt,Gt){switch(pe){case g:if(G.byteLength!=te.byteLength||G.byteOffset!=te.byteOffset)return!1;G=G.buffer,te=te.buffer;case m:return!(G.byteLength!=te.byteLength||!vt(new dt(G),new dt(te)));case w:case R:case Y:return yf(+G,+te);case O:return G.name==te.name&&G.message==te.message;case J:case B:return G==te+"";case V:var cr=Ce;case M:var Dt=Ue&a;if(cr||(cr=$e),G.size!=te.size&&!Dt)return!1;var Ht=Gt.get(G);if(Ht)return Ht==te;Ue|=c,Gt.set(G,te);var nr=sa(cr(G),cr(te),Ue,kt,vt,Gt);return Gt.delete(G),nr;case ae:if(rt)return rt.call(G)==rt.call(te)}return!1}function lf(G,te,pe,Ue,kt,vt){var Gt=pe&a,cr=aa(G),Dt=cr.length,Ht=aa(te),nr=Ht.length;if(Dt!=nr&&!Gt)return!1;for(var Jr=Dt;Jr--;){var hr=cr[Jr];if(!(Gt?hr in te:De.call(te,hr)))return!1}var Jt=vt.get(G);if(Jt&&vt.get(te))return Jt==te;var Br=!0;vt.set(G,te),vt.set(te,G);for(var Ki=Gt;++Jr<Dt;){hr=cr[Jr];var _i=G[hr],fn=te[hr];if(Ue)var to=Gt?Ue(fn,_i,hr,te,G,vt):Ue(_i,fn,hr,G,te,vt);if(!(to===void 0?_i===fn||kt(_i,fn,pe,Ue,vt):to)){Br=!1;break}Ki||(Ki=hr=="constructor")}if(Br&&!Ki){var As=G.constructor,gr=te.constructor;As!=gr&&"constructor"in G&&"constructor"in te&&!(typeof As=="function"&&As instanceof As&&typeof gr=="function"&&gr instanceof gr)&&(Br=!1)}return vt.delete(G),vt.delete(te),Br}function aa(G){return Za(G,Ih,pf)}function Xn(G,te){var pe=G.__data__;return gf(te)?pe[typeof te=="string"?"string":"hash"]:pe.map}function oi(G,te){var pe=Ie(G,te);return _h(pe)?pe:void 0}function df(G){var te=De.call(G,pt),pe=G[pt];try{G[pt]=void 0;var Ue=!0}catch{}var kt=xe.call(G);return Ue&&(te?G[pt]=pe:delete G[pt]),kt}var pf=St?function(G){return G==null?[]:(G=Object(G),me(St(G),function(te){return mt.call(G,te)}))}:Ft,on=Ss;(Ze&&on(new Ze(new ArrayBuffer(1)))!=g||Te&&on(new Te)!=V||Qe&&on(Qe.resolve())!=k||et&&on(new et)!=M||Le&&on(new Le)!=U)&&(on=function(G){var te=Ss(G),pe=te==X?G.constructor:void 0,Ue=pe?On(pe):"";if(Ue)switch(Ue){case ct:return g;case Be:return V;case tt:return k;case ht:return M;case qe:return U}return te});function vf(G,te){return te=te??h,!!te&&(typeof G=="number"||fe.test(G))&&G>-1&&G%1==0&&G<te}function gf(G){var te=typeof G;return te=="string"||te=="number"||te=="symbol"||te=="boolean"?G!=="__proto__":G===null}function bf(G){return!!ke&&ke in G}function mf(G){var te=G&&G.constructor,pe=typeof te=="function"&&te.prototype||Oe;return G===pe}function Eh(G){return xe.call(G)}function On(G){if(G!=null){try{return _e.call(G)}catch{}try{return G+""}catch{}}return""}function yf(G,te){return G===te||G!==G&&te!==te}var wf=Qa(function(){return arguments}())?Qa:function(G){return Is(G)&&De.call(G,"callee")&&!mt.call(G,"callee")},oa=Array.isArray;function Sh(G){return G!=null&&_f(G.length)&&!fa(G)}var eo=Ye||Bt;function Mh(G,te){return Ms(G,te)}function fa(G){if(!xf(G))return!1;var te=Ss(G);return te==C||te==q||te==b||te==W}function _f(G){return typeof G=="number"&&G>-1&&G%1==0&&G<=h}function xf(G){var te=typeof G;return G!=null&&(te=="object"||te=="function")}function Is(G){return G!=null&&typeof G=="object"}var Ef=ce?Fe(ce):hf;function Ih(G){return Sh(G)?ff(G):uf(G)}function Ft(){return[]}function Bt(){return!1}r.exports=Mh})(Hc,Hc.exports);var jI=Hc.exports;const WI=gs(jI),Vb="wc",Gb=2,md="core",In=`${Vb}@2:${md}:`,VI={name:md,logger:"error"},GI={database:":memory:"},JI="crypto",n1="client_ed25519_seed",YI=Se.ONE_DAY,XI="keychain",ZI="0.3",QI="messages",eA="0.3",tA=Se.SIX_HOURS,rA="publisher",Jb="irn",iA="error",Yb="wss://relay.walletconnect.org",nA="relayer",Hr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},sA="_subscription",Di={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},aA=.1,Nl="2.17.1",jt={link_mode:"link_mode",relay:"relay"},oA="0.3",fA="WALLETCONNECT_CLIENT_ID",s1="WALLETCONNECT_LINK_MODE_APPS",gn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},cA="subscription",hA="0.3",uA=Se.FIVE_SECONDS*1e3,lA="pairing",dA="0.3",Mo={wc_pairingDelete:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:0},res:{ttl:Se.ONE_DAY,prompt:!1,tag:0}}},ks={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Yi={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},pA="history",vA="0.3",gA="expirer",Oi={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},bA="0.3",mA="verify-api",yA="https://verify.walletconnect.com",Xb="https://verify.walletconnect.org",Lo=Xb,wA=`${Lo}/v3`,_A=[yA,Xb],xA="echo",EA="https://echo.walletconnect.com",pn={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Hn={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Xi={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Bs={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},zs={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Io={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},SA=.1,MA="event-client",IA=86400,AA="https://pulse.walletconnect.org/batch";function PA(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var a=r.charAt(n),c=a.charCodeAt(0);if(t[c]!==255)throw new TypeError(a+" is ambiguous");t[c]=n}var h=r.length,d=r.charAt(0),p=Math.log(h)/Math.log(256),b=Math.log(256)/Math.log(h);function w(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var q=0,V=0,Y=0,H=C.length;Y!==H&&C[Y]===0;)Y++,q++;for(var X=(H-Y)*b+1>>>0,k=new Uint8Array(X);Y!==H;){for(var W=C[Y],J=0,M=X-1;(W!==0||J<V)&&M!==-1;M--,J++)W+=256*k[M]>>>0,k[M]=W%h>>>0,W=W/h>>>0;if(W!==0)throw new Error("Non-zero carry");V=J,Y++}for(var B=X-V;B!==X&&k[B]===0;)B++;for(var ae=d.repeat(q);B<X;++B)ae+=r.charAt(k[B]);return ae}function R(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var q=0;if(C[q]!==" "){for(var V=0,Y=0;C[q]===d;)V++,q++;for(var H=(C.length-q)*p+1>>>0,X=new Uint8Array(H);C[q];){var k=t[C.charCodeAt(q)];if(k===255)return;for(var W=0,J=H-1;(k!==0||W<Y)&&J!==-1;J--,W++)k+=h*X[J]>>>0,X[J]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");Y=W,q++}if(C[q]!==" "){for(var M=H-Y;M!==H&&X[M]===0;)M++;for(var B=new Uint8Array(V+(H-M)),ae=V;M!==H;)B[ae++]=X[M++];return B}}}function O(C){var q=R(C);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:R,decode:O}}var DA=PA,OA=DA;const Zb=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},RA=r=>new TextEncoder().encode(r),CA=r=>new TextDecoder().decode(r);class NA{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class TA{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Qb(this,e)}}class $A{constructor(e){this.decoders=e}or(e){return Qb(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Qb=(r,e)=>new $A({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class LA{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new NA(e,t,i),this.decoder=new TA(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const yh=({name:r,prefix:e,encode:t,decode:i})=>new LA(r,e,t,i),af=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:n}=OA(t,e);return yh({prefix:r,name:e,encode:i,decode:a=>Zb(n(a))})},qA=(r,e,t,i)=>{const n={};for(let b=0;b<e.length;++b)n[e[b]]=b;let a=r.length;for(;r[a-1]==="=";)--a;const c=new Uint8Array(a*t/8|0);let h=0,d=0,p=0;for(let b=0;b<a;++b){const w=n[r[b]];if(w===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<t|w,h+=t,h>=8&&(h-=8,c[p++]=255&d>>h)}if(h>=t||255&d<<8-h)throw new SyntaxError("Unexpected end of data");return c},UA=(r,e,t)=>{const i=e[e.length-1]==="=",n=(1<<t)-1;let a="",c=0,h=0;for(let d=0;d<r.length;++d)for(h=h<<8|r[d],c+=8;c>t;)c-=t,a+=e[n&h>>c];if(c&&(a+=e[n&h<<t-c]),i)for(;a.length*t&7;)a+="=";return a},Pr=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>yh({prefix:e,name:r,encode(n){return UA(n,i,t)},decode(n){return qA(n,i,t,r)}}),BA=yh({prefix:"\0",name:"identity",encode:r=>CA(r),decode:r=>RA(r)});var zA=Object.freeze({__proto__:null,identity:BA});const FA=Pr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var kA=Object.freeze({__proto__:null,base2:FA});const HA=Pr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var KA=Object.freeze({__proto__:null,base8:HA});const jA=af({prefix:"9",name:"base10",alphabet:"0123456789"});var WA=Object.freeze({__proto__:null,base10:jA});const VA=Pr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),GA=Pr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var JA=Object.freeze({__proto__:null,base16:VA,base16upper:GA});const YA=Pr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),XA=Pr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ZA=Pr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),QA=Pr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),eP=Pr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),tP=Pr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rP=Pr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),iP=Pr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),nP=Pr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var sP=Object.freeze({__proto__:null,base32:YA,base32upper:XA,base32pad:ZA,base32padupper:QA,base32hex:eP,base32hexupper:tP,base32hexpad:rP,base32hexpadupper:iP,base32z:nP});const aP=af({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),oP=af({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var fP=Object.freeze({__proto__:null,base36:aP,base36upper:oP});const cP=af({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),hP=af({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var uP=Object.freeze({__proto__:null,base58btc:cP,base58flickr:hP});const lP=Pr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),dP=Pr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),pP=Pr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vP=Pr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var gP=Object.freeze({__proto__:null,base64:lP,base64pad:dP,base64url:pP,base64urlpad:vP});const em=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),bP=em.reduce((r,e,t)=>(r[t]=e,r),[]),mP=em.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function yP(r){return r.reduce((e,t)=>(e+=bP[t],e),"")}function wP(r){const e=[];for(const t of r){const i=mP[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const _P=yh({prefix:"🚀",name:"base256emoji",encode:yP,decode:wP});var xP=Object.freeze({__proto__:null,base256emoji:_P}),EP=tm,a1=128,SP=127,MP=~SP,IP=Math.pow(2,31);function tm(r,e,t){e=e||[],t=t||0;for(var i=t;r>=IP;)e[t++]=r&255|a1,r/=128;for(;r&MP;)e[t++]=r&255|a1,r>>>=7;return e[t]=r|0,tm.bytes=t-i+1,e}var AP=Tl,PP=128,o1=127;function Tl(r,i){var t=0,i=i||0,n=0,a=i,c,h=r.length;do{if(a>=h)throw Tl.bytes=0,new RangeError("Could not decode varint");c=r[a++],t+=n<28?(c&o1)<<n:(c&o1)*Math.pow(2,n),n+=7}while(c>=PP);return Tl.bytes=a-i,t}var DP=Math.pow(2,7),OP=Math.pow(2,14),RP=Math.pow(2,21),CP=Math.pow(2,28),NP=Math.pow(2,35),TP=Math.pow(2,42),$P=Math.pow(2,49),LP=Math.pow(2,56),qP=Math.pow(2,63),UP=function(r){return r<DP?1:r<OP?2:r<RP?3:r<CP?4:r<NP?5:r<TP?6:r<$P?7:r<LP?8:r<qP?9:10},BP={encode:EP,decode:AP,encodingLength:UP},rm=BP;const f1=(r,e,t=0)=>(rm.encode(r,e,t),e),c1=r=>rm.encodingLength(r),$l=(r,e)=>{const t=e.byteLength,i=c1(r),n=i+c1(t),a=new Uint8Array(n+t);return f1(r,a,0),f1(t,a,i),a.set(e,n),new zP(r,t,e,a)};class zP{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}const im=({name:r,code:e,encode:t})=>new FP(r,e,t);class FP{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?$l(this.code,t):t.then(i=>$l(this.code,i))}else throw Error("Unknown type, must be binary type")}}const nm=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),kP=im({name:"sha2-256",code:18,encode:nm("SHA-256")}),HP=im({name:"sha2-512",code:19,encode:nm("SHA-512")});var KP=Object.freeze({__proto__:null,sha256:kP,sha512:HP});const sm=0,jP="identity",am=Zb,WP=r=>$l(sm,am(r)),VP={code:sm,name:jP,encode:am,digest:WP};var GP=Object.freeze({__proto__:null,identity:VP});new TextEncoder,new TextDecoder;const h1={...zA,...kA,...KA,...WA,...JA,...sP,...fP,...uP,...gP,...xP};({...KP,...GP});function JP(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function om(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const u1=om("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),rl=om("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=JP(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),YP={utf8:u1,"utf-8":u1,hex:h1.base16,latin1:rl,ascii:rl,binary:rl,...h1};function XP(r,e="utf8"){const t=YP[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}class ZP{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=XI,this.version=ZI,this.initialized=!1,this.storagePrefix=In,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:a}=Ee("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(a)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=jr(t,this.name)}get context(){return ai(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,_b(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?xb(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}let QP=class{constructor(e,t,i){this.core=e,this.logger=t,this.name=JI,this.randomSessionIdentifier=Dl(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),a=vv(n);return bb(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=iS();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const a=await this.getClientSeed(),c=vv(a),h=this.randomSessionIdentifier;return await lE(h,n,YI,c)},this.generateSharedKey=(n,a,c)=>{this.isInitialized();const h=this.getPrivateKey(n),d=nS(h,a);return this.setSymKey(d,c)},this.setSymKey=async(n,a)=>{this.isInitialized();const c=a||Ec(n);return await this.keychain.set(c,n),c},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,a,c)=>{this.isInitialized();const h=Cb(c),d=Jn(a);if(Dv(h))return aS(d,c==null?void 0:c.encoding);if(Pv(h)){const R=h.senderPublicKey,O=h.receiverPublicKey;n=await this.generateSharedKey(R,O)}const p=this.getSymKey(n),{type:b,senderPublicKey:w}=h;return sS({type:b,symKey:p,message:d,senderPublicKey:w,encoding:c==null?void 0:c.encoding})},this.decode=async(n,a,c)=>{this.isInitialized();const h=cS(a,c);if(Dv(h)){const d=fS(a,c==null?void 0:c.encoding);return Gs(d)}if(Pv(h)){const d=h.receiverPublicKey,p=h.senderPublicKey;n=await this.generateSharedKey(d,p)}try{const d=this.getSymKey(n),p=oS({symKey:d,encoded:a,encoding:c==null?void 0:c.encoding});return Gs(p)}catch(d){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(d)}},this.getPayloadType=(n,a=ls)=>{const c=zo({encoded:n,encoding:a});return Ys(c.type)},this.getPayloadSenderPublicKey=(n,a=ls)=>{const c=zo({encoded:n,encoding:a});return c.senderPublicKey?ii(c.senderPublicKey,Kr):void 0},this.core=e,this.logger=jr(t,this.name),this.keychain=i||new ZP(this.core,this.logger)}get context(){return ai(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(n1)}catch{e=Dl(),await this.keychain.set(n1,e)}return XP(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}};class eD extends dI{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=QI,this.version=eA,this.initialized=!1,this.storagePrefix=In,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const a=Kn(n);let c=this.messages.get(i);return typeof c>"u"&&(c={}),typeof c[a]<"u"||(c[a]=n,this.messages.set(i,c),await this.persist()),a},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const a=this.get(i),c=Kn(n);return typeof a[c]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=jr(e,this.name),this.core=t}get context(){return ai(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,_b(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?xb(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class tD extends pI{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new vi.EventEmitter,this.name=rA,this.queue=new Map,this.publishTimeout=Se.toMiliseconds(Se.ONE_MINUTE),this.failedPublishTimeout=Se.toMiliseconds(Se.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(i,n,a)=>{var c;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:a}});const h=(a==null?void 0:a.ttl)||tA,d=Ol(a),p=(a==null?void 0:a.prompt)||!1,b=(a==null?void 0:a.tag)||0,w=(a==null?void 0:a.id)||Ks().toString(),R={topic:i,message:n,opts:{ttl:h,relay:d,prompt:p,tag:b,id:w,attestation:a==null?void 0:a.attestation}},O=`Failed to publish payload, please try again. id:${w} tag:${b}`,C=Date.now();let q,V=1;try{for(;q===void 0;){if(Date.now()-C>this.publishTimeout)throw new Error(O);this.logger.trace({id:w,attempts:V},`publisher.publish - attempt ${V}`),q=await await $a(this.rpcPublish(i,n,h,d,p,b,w,a==null?void 0:a.attestation).catch(Y=>this.logger.warn(Y)),this.publishTimeout,O),V++,q||await new Promise(Y=>setTimeout(Y,this.failedPublishTimeout))}this.relayer.events.emit(Hr.publish,R),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:w,topic:i,message:n,opts:a}})}catch(Y){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(Y),(c=a==null?void 0:a.internal)!=null&&c.throwOnFailedPublish)throw Y;this.queue.set(w,R)}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=jr(t,this.name),this.registerEventListeners()}get context(){return ai(this.logger)}rpcPublish(e,t,i,n,a,c,h,d){var p,b,w,R;const O={method:Oo(n.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:a,tag:c,attestation:d},id:h};return ri((p=O.params)==null?void 0:p.prompt)&&((b=O.params)==null||delete b.prompt),ri((w=O.params)==null?void 0:w.tag)&&((R=O.params)==null||delete R.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:O}),this.relayer.request(O)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:i,opts:n}=e;await this.publish(t,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Xa.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Hr.connection_stalled);return}this.checkQueue()}),this.relayer.on(Hr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class rD{constructor(){this.map=new Map,this.set=(e,t)=>{const i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,t))return;const n=i.filter(a=>a!==t);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var iD=Object.defineProperty,nD=Object.defineProperties,sD=Object.getOwnPropertyDescriptors,l1=Object.getOwnPropertySymbols,aD=Object.prototype.hasOwnProperty,oD=Object.prototype.propertyIsEnumerable,d1=(r,e,t)=>e in r?iD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ao=(r,e)=>{for(var t in e||(e={}))aD.call(e,t)&&d1(r,t,e[t]);if(l1)for(var t of l1(e))oD.call(e,t)&&d1(r,t,e[t]);return r},il=(r,e)=>nD(r,sD(e));class fD extends bI{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new rD,this.events=new vi.EventEmitter,this.name=cA,this.version=hA,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=In,this.subscribeTimeout=Se.toMiliseconds(Se.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const a=Ol(n),c={topic:i,relay:a,transportType:n==null?void 0:n.transportType};this.pending.set(i,c);const h=await this.rpcSubscribe(i,a,n);return typeof h=="string"&&(this.onSubscribe(h,c),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}})),h}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof(n==null?void 0:n.id)<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>{if(this.topics.includes(i))return!0;const n=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((a,c)=>{const h=new Se.Watch;h.start(n);const d=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(d),h.stop(n),a(!0)),h.elapsed(n)>=uA&&(clearInterval(d),h.stop(n),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=jr(t,this.name),this.clientId=""}get context(){return ai(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{const n=Ol(i);await this.rpcUnsubscribe(e,t,n);const a=Ut("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,t,i){var n;(i==null?void 0:i.transportType)===jt.relay&&await this.restartToComplete();const a={method:Oo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(n=i==null?void 0:i.internal)==null?void 0:n.throwOnFailedPublish;try{const h=Kn(e+this.clientId);if((i==null?void 0:i.transportType)===jt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(p=>this.logger.warn(p))},Se.toMiliseconds(Se.ONE_SECOND)),h;const d=await $a(this.relayer.request(a).catch(p=>this.logger.warn(p)),this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!d&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return d?h:null}catch(h){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Hr.connection_stalled),c)throw h}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,i={method:Oo(t.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await $a(this.relayer.request(i).catch(n=>this.logger.warn(n)),this.subscribeTimeout)}catch{this.relayer.events.emit(Hr.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,i={method:Oo(t.protocol).batchFetchMessages,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await $a(this.relayer.request(i).catch(a=>this.logger.warn(a)),this.subscribeTimeout)}catch{this.relayer.events.emit(Hr.connection_stalled)}return n}rpcUnsubscribe(e,t,i){const n={method:Oo(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,t){this.setSubscription(e,il(Ao({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Ao({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Ao({},t)),this.topicMap.set(t.topic,e),this.events.emit(gn.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:i}=Ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(gn.deleted,il(Ao({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(gn.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(i),await this.batchSubscribe(i)}}this.events.emit(gn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=Ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);Mn(t)&&this.onBatchSubscribe(t.map((i,n)=>il(Ao({},e[n]),{id:i})))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(t.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(Xa.pulse,async()=>{await this.checkPending()}),this.events.on(gn.created,async e=>{const t=gn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(gn.deleted,async e=>{const t=gn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen(),this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var cD=Object.defineProperty,p1=Object.getOwnPropertySymbols,hD=Object.prototype.hasOwnProperty,uD=Object.prototype.propertyIsEnumerable,v1=(r,e,t)=>e in r?cD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,g1=(r,e)=>{for(var t in e||(e={}))hD.call(e,t)&&v1(r,t,e[t]);if(p1)for(var t of p1(e))uD.call(e,t)&&v1(r,t,e[t]);return r};class lD extends vI{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new vi.EventEmitter,this.name=nA,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=Se.toMiliseconds(Se.THIRTY_SECONDS+Se.ONE_SECOND),this.request=async t=>{var i,n;this.logger.debug("Publishing Request Payload");const a=t.id||Ks().toString();await this.toEstablishConnection();try{const c=this.provider.request(t);this.requestsInFlight.set(a,{promise:c,request:t}),this.logger.trace({id:a,method:t.method,topic:(i=t.params)==null?void 0:i.topic},"relayer.request - attempt to publish...");const h=await new Promise(async(d,p)=>{const b=()=>{p(new Error(`relayer.request - publish interrupted, id: ${a}`))};this.provider.on(Di.disconnect,b);const w=await c;this.provider.off(Di.disconnect,b),d(w)});return this.logger.trace({id:a,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - published"),h}catch(c){throw this.logger.debug(`Failed to Publish Request: ${a}`),c}finally{this.requestsInFlight.delete(a)}},this.resetPingTimeout=()=>{if(Uc())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,i,n;(n=(i=(t=this.provider)==null?void 0:t.connection)==null?void 0:i.socket)==null||n.terminate()},this.heartBeatTimeout)}catch(t){this.logger.warn(t)}},this.onPayloadHandler=t=>{this.onProviderPayload(t),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.trace("relayer connected"),this.startPingTimeout(),this.events.emit(Hr.connect)},this.onDisconnectHandler=()=>{this.logger.trace("relayer disconnected"),this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Hr.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Di.payload,this.onPayloadHandler),this.provider.on(Di.connect,this.onConnectHandler),this.provider.on(Di.disconnect,this.onDisconnectHandler),this.provider.on(Di.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?jr(e.logger,this.name):nf(vh({level:e.logger||iA})),this.messages=new eD(this.logger,e.core),this.subscriber=new fD(this,this.logger),this.publisher=new tD(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Yb,this.projectId=e.projectId,this.bundleId=_E(),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e)}}get context(){return ai(this.logger)}get connected(){var e,t,i;return((i=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:i.readyState)===1}get connecting(){var e,t,i;return((i=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:i.readyState)===0}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:jt.relay})}async subscribe(e,t){var i,n,a;this.isInitialized(),(t==null?void 0:t.transportType)==="relay"&&await this.toEstablishConnection();const c=typeof((i=t==null?void 0:t.internal)==null?void 0:i.throwOnFailedPublish)>"u"?!0:(n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish;let h=((a=this.subscriber.topicMap.get(e))==null?void 0:a[0])||"",d;const p=b=>{b.topic===e&&(this.subscriber.off(gn.created,p),d())};return await Promise.all([new Promise(b=>{d=b,this.subscriber.on(gn.created,p)}),new Promise(async(b,w)=>{h=await this.subscriber.subscribe(e,g1({internal:{throwOnFailedPublish:c}},t)).catch(R=>{c&&w(R)})||h,b()})]),h}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(e=>e.promise))}catch(e){this.logger.warn(e)}this.hasExperiencedNetworkDisruption||this.connected?await $a(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(t,i)=>{const n=()=>{this.provider.off(Di.disconnect,n),i(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(Di.disconnect,n),await $a(this.provider.connect(),Se.toMiliseconds(Se.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{i(a)}).finally(()=>{clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),this.subscriber.start().catch(a=>{this.logger.error(a),this.onDisconnectHandler()}),this.hasExperiencedNetworkDisruption=!1,t()})}catch(t){this.logger.error(t);const i=t;if(this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(i.message))throw t}finally{this.connectionAttemptInProgress=!1}}async restartTransport(e){this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await zv())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((i,n)=>i.publishedAt-n.publishedAt);this.logger.trace(`Batch of ${t.length} message events sorted`);for(const i of t)try{await this.onMessageEvent(i)}catch(n){this.logger.warn(n)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:i}=e;if(!t.sessionExists){const n=vr(Se.FIVE_MINUTES),a={topic:i,expiry:n,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,a)}this.events.emit(Hr.message,e),await this.recordMessageEvent(e)}startPingTimeout(){var e,t,i,n,a;if(Uc())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((a=(n=(i=this.provider)==null?void 0:i.connection)==null?void 0:n.socket)==null||a.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(c){this.logger.warn(c)}}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new sn(new KI(ME({sdkVersion:Nl,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){const{topic:t,message:i}=e;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const n=this.messages.has(t,i);return n&&this.logger.debug(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),bd(e)){if(!e.method.endsWith(sA))return;const t=e.params,{topic:i,message:n,publishedAt:a,attestation:c}=t.data,h={topic:i,message:n,publishedAt:a,transportType:jt.relay,attestation:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(g1({type:"event",event:t.id},h)),this.events.emit(t.id,h),await this.acknowledgePayload(e),await this.onMessageEvent(h)}else mh(e)&&this.events.emit(Hr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Hr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=gh(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Di.payload,this.onPayloadHandler),this.provider.off(Di.connect,this.onConnectHandler),this.provider.off(Di.disconnect,this.onDisconnectHandler),this.provider.off(Di.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await zv();rM(async t=>{e!==t&&(e=t,t?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit(Hr.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e))},Se.toMiliseconds(aA))))}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var dD=Object.defineProperty,b1=Object.getOwnPropertySymbols,pD=Object.prototype.hasOwnProperty,vD=Object.prototype.propertyIsEnumerable,m1=(r,e,t)=>e in r?dD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,y1=(r,e)=>{for(var t in e||(e={}))pD.call(e,t)&&m1(r,t,e[t]);if(b1)for(var t of b1(e))vD.call(e,t)&&m1(r,t,e[t]);return r};class ia extends gI{constructor(e,t,i,n=In,a=void 0){super(e,t,i,n),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=oA,this.cached=[],this.initialized=!1,this.storagePrefix=In,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(c=>{this.getKey&&c!==null&&!ri(c)?this.map.set(this.getKey(c),c):NS(c)?this.map.set(c.id,c):TS(c)&&this.map.set(c.topic,c)}),this.cached=[],this.initialized=!0)},this.set=async(c,h)=>{this.isInitialized(),this.map.has(c)?await this.update(c,h):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:c,value:h}),this.map.set(c,h),await this.persist())},this.get=c=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:c}),this.getData(c)),this.getAll=c=>(this.isInitialized(),c?this.values.filter(h=>Object.keys(c).every(d=>WI(h[d],c[d]))):this.values),this.update=async(c,h)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:c,update:h});const d=y1(y1({},this.getData(c)),h);this.map.set(c,d),await this.persist()},this.delete=async(c,h)=>{this.isInitialized(),this.map.has(c)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:c,reason:h}),this.map.delete(c),this.addToRecentlyDeleted(c),await this.persist())},this.logger=jr(t,this.name),this.storagePrefix=n,this.getKey=a}get context(){return ai(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:n}=Ee("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}const{message:i}=Ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=Ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class gD{constructor(e,t){this.core=e,this.logger=t,this.name=lA,this.version=dA,this.events=new kl,this.initialized=!1,this.storagePrefix=In,this.ignoredPayloadTypes=[Wn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async i=>{this.isInitialized();const n=Dl(),a=await this.core.crypto.setSymKey(n),c=vr(Se.FIVE_MINUTES),h={protocol:Jb},d={topic:a,expiry:c,relay:h,active:!1,methods:i==null?void 0:i.methods},p=Tv({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:h,expiryTimestamp:c,methods:i==null?void 0:i.methods});return this.events.emit(ks.create,d),this.core.expirer.set(a,c),await this.pairings.set(a,d),await this.core.relayer.subscribe(a,{transportType:i==null?void 0:i.transportType}),{topic:a,uri:p}},this.pair=async i=>{this.isInitialized();const n=this.core.eventClient.createEvent({properties:{topic:i==null?void 0:i.uri,trace:[pn.pairing_started]}});this.isValidPair(i,n);const{topic:a,symKey:c,relay:h,expiryTimestamp:d,methods:p}=Nv(i.uri);n.props.properties.topic=a,n.addTrace(pn.pairing_uri_validation_success),n.addTrace(pn.pairing_uri_not_expired);let b;if(this.pairings.keys.includes(a)){if(b=this.pairings.get(a),n.addTrace(pn.existing_pairing),b.active)throw n.setError(Hn.active_pairing_already_exists),new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);n.addTrace(pn.pairing_not_expired)}const w=d||vr(Se.FIVE_MINUTES),R={topic:a,relay:h,expiry:w,active:!1,methods:p};this.core.expirer.set(a,w),await this.pairings.set(a,R),n.addTrace(pn.store_new_pairing),i.activatePairing&&await this.activate({topic:a}),this.events.emit(ks.create,R),n.addTrace(pn.emit_inactive_pairing),this.core.crypto.keychain.has(a)||await this.core.crypto.setSymKey(c,a),n.addTrace(pn.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{n.setError(Hn.no_internet_connection)}try{await this.core.relayer.subscribe(a,{relay:h})}catch(O){throw n.setError(Hn.subscribe_pairing_topic_failure),O}return n.addTrace(pn.subscribe_pairing_topic_success),R},this.activate=async({topic:i})=>{this.isInitialized();const n=vr(Se.THIRTY_DAYS);this.core.expirer.set(i,n),await this.pairings.update(i,{active:!0,expiry:n})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const a=await this.sendRequest(n,"wc_pairingPing",{}),{done:c,resolve:h,reject:d}=Fs();this.events.once(It("pairing_ping",a),({error:p})=>{p?d(p):h()}),await c()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Ut("USER_DISCONNECTED")),await this.deletePairing(n))},this.formatUriFromPairing=i=>{this.isInitialized();const{topic:n,relay:a,expiry:c,methods:h}=i,d=this.core.crypto.keychain.get(n);return Tv({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:d,relay:a,expiryTimestamp:c,methods:h})},this.sendRequest=async(i,n,a)=>{const c=ds(n,a),h=await this.core.crypto.encode(i,c),d=Mo[n].req;return this.core.history.set(i,c),this.core.relayer.publish(i,h,d),c.id},this.sendResult=async(i,n,a)=>{const c=gh(i,a),h=await this.core.crypto.encode(n,c),d=await this.core.history.get(n,i),p=Mo[d.request.method].res;await this.core.relayer.publish(n,h,p),await this.core.history.resolve(c)},this.sendError=async(i,n,a)=>{const c=bh(i,a),h=await this.core.crypto.encode(n,c),d=await this.core.history.get(n,i),p=Mo[d.request.method]?Mo[d.request.method].res:Mo.unregistered_method.res;await this.core.relayer.publish(n,h,p),await this.core.history.resolve(c)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ut("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>cs(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:a}=i;switch(a.method){case"wc_pairingPing":return this.onPairingPingRequest(n,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,a);default:return this.onUnknownRpcMethodRequest(n,a)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:a}=i,c=(await this.core.history.get(n,a.id)).request.method;switch(c){case"wc_pairingPing":return this.onPairingPingResponse(n,a);default:return this.onUnknownRpcMethodResponse(c)}},this.onPairingPingRequest=async(i,n)=>{const{id:a}=n;try{this.isValidPing({topic:i}),await this.sendResult(a,i,!0),this.events.emit(ks.ping,{id:a,topic:i})}catch(c){await this.sendError(a,i,c),this.logger.error(c)}},this.onPairingPingResponse=(i,n)=>{const{id:a}=n;setTimeout(()=>{vn(n)?this.events.emit(It("pairing_ping",a),{}):Ri(n)&&this.events.emit(It("pairing_ping",a),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(ks.delete,{id:a,topic:i})}catch(c){await this.sendError(a,i,c),this.logger.error(c)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:a,method:c}=n;try{if(this.registeredMethods.includes(c))return;const h=Ut("WC_METHOD_UNSUPPORTED",c);await this.sendError(a,i,h),this.logger.error(h)}catch(h){await this.sendError(a,i,h),this.logger.error(h)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ut("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=(i,n)=>{var a;if(!ti(i)){const{message:h}=Ee("MISSING_OR_INVALID",`pair() params: ${i}`);throw n.setError(Hn.malformed_pairing_uri),new Error(h)}if(!CS(i.uri)){const{message:h}=Ee("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw n.setError(Hn.malformed_pairing_uri),new Error(h)}const c=Nv(i==null?void 0:i.uri);if(!((a=c==null?void 0:c.relay)!=null&&a.protocol)){const{message:h}=Ee("MISSING_OR_INVALID","pair() uri#relay-protocol");throw n.setError(Hn.malformed_pairing_uri),new Error(h)}if(!(c!=null&&c.symKey)){const{message:h}=Ee("MISSING_OR_INVALID","pair() uri#symKey");throw n.setError(Hn.malformed_pairing_uri),new Error(h)}if(c!=null&&c.expiryTimestamp&&Se.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){n.setError(Hn.pairing_expired);const{message:h}=Ee("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(h)}},this.isValidPing=async i=>{if(!ti(i)){const{message:a}=Ee("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!ti(i)){const{message:a}=Ee("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!fr(i,!1)){const{message:n}=Ee("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=Ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(cs(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=Ee("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=jr(t,this.name),this.pairings=new ia(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ai(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Hr.message,async e=>{const{topic:t,message:i,transportType:n}=e;if(!this.pairings.keys.includes(t)||n===jt.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const a=await this.core.crypto.decode(t,i);try{bd(a)?(this.core.history.set(t,a),this.onRelayEventRequest({topic:t,payload:a})):mh(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a}),this.core.history.delete(t,a.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Oi.expired,async e=>{const{topic:t}=Sb(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(ks.expire,{topic:t}))})}}class bD extends lI{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new vi.EventEmitter,this.name=pA,this.version=vA,this.cached=[],this.initialized=!1,this.storagePrefix=In,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:a}),this.records.has(n.id))return;const c={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:a,expiry:vr(Se.THIRTY_DAYS)};this.records.set(c.id,c),this.persist(),this.events.emit(Yi.created,c)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Ri(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.persist(),this.events.emit(Yi.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(a=>{if(a.topic===i){if(typeof n<"u"&&a.id!==n)return;this.records.delete(a.id),this.events.emit(Yi.deleted,a)}}),this.persist()},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=jr(t,this.name)}get context(){return ai(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const i={topic:t.topic,request:ds(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:i}=Ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Yi.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=Ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Yi.created,e=>{const t=Yi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Yi.updated,e=>{const t=Yi.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Yi.deleted,e=>{const t=Yi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(Xa.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{Se.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Yi.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class mD extends mI{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new vi.EventEmitter,this.name=gA,this.version=bA,this.cached=[],this.initialized=!1,this.storagePrefix=In,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const a=this.formatTarget(i),c={target:a,expiry:n};this.expirations.set(a,c),this.checkExpiry(a,c),this.events.emit(Oi.created,{target:a,expiration:c})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),a=this.getExpiration(n);this.expirations.delete(n),this.events.emit(Oi.deleted,{target:n,expiration:a})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=jr(t,this.name)}get context(){return ai(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return IE(e);if(typeof e=="number")return AE(e);const{message:t}=Ee("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Oi.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=Ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:i}=Ee("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(i),new Error(i)}return t}checkExpiry(e,t){const{expiry:i}=t;Se.toMiliseconds(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Oi.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Xa.pulse,()=>this.checkExpirations()),this.events.on(Oi.created,e=>{const t=Oi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Oi.expired,e=>{const t=Oi.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Oi.deleted,e=>{const t=Oi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}}class yD extends yI{constructor(e,t,i){super(e,t,i),this.core=e,this.logger=t,this.store=i,this.name=mA,this.verifyUrlV3=wA,this.storagePrefix=In,this.version=Gb,this.init=async()=>{var n;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Se.toMiliseconds((n=this.publicKey)==null?void 0:n.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async n=>{if(!Zo()||this.isDevEnv)return;const a=window.location.origin,{id:c,decryptedId:h}=n,d=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${a}&id=${c}&decryptedId=${h}`;try{const p=jo(),b=this.startAbortTimer(Se.ONE_SECOND*5),w=await new Promise((R,O)=>{const C=()=>{window.removeEventListener("message",V),p.body.removeChild(q),O("attestation aborted")};this.abortController.signal.addEventListener("abort",C);const q=p.createElement("iframe");q.src=d,q.style.display="none",q.addEventListener("error",C,{signal:this.abortController.signal});const V=Y=>{if(Y.data&&typeof Y.data=="string")try{const H=JSON.parse(Y.data);if(H.type==="verify_attestation"){if(Al(H.attestation).payload.id!==c)return;clearInterval(b),p.body.removeChild(q),this.abortController.signal.removeEventListener("abort",C),window.removeEventListener("message",V),R(H.attestation===null?"":H.attestation)}}catch(H){this.logger.warn(H)}};p.body.appendChild(q),window.addEventListener("message",V,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",w),w}catch(p){this.logger.warn(p)}return""},this.resolve=async n=>{if(this.isDevEnv)return"";const{attestationId:a,hash:c,encryptedId:h}=n;if(a===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(a){if(Al(a).payload.id!==h)return;const p=await this.isValidJwtAttestation(a);if(p){if(!p.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return p}}if(!c)return;const d=this.getVerifyUrl(n==null?void 0:n.verifyUrl);return this.fetchAttestation(c,d)},this.fetchAttestation=async(n,a)=>{this.logger.debug(`resolving attestation: ${n} from url: ${a}`);const c=this.startAbortTimer(Se.ONE_SECOND*5),h=await fetch(`${a}/attestation/${n}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(c),h.status===200?await h.json():void 0},this.getVerifyUrl=n=>{let a=n||Lo;return _A.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${Lo}`),a=Lo),a},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const n=this.startAbortTimer(Se.FIVE_SECONDS),a=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(n),await a.json()}catch(n){this.logger.warn(n)}},this.persistPublicKey=async n=>{this.logger.debug("persisting public key to local storage",n),await this.store.setItem(this.storeKey,n),this.publicKey=n},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async n=>{const a=await this.getPublicKey();try{if(a)return this.validateAttestation(n,a)}catch(h){this.logger.error(h),this.logger.warn("error validating attestation")}const c=await this.fetchAndPersistPublicKey();try{if(c)return this.validateAttestation(n,c)}catch(h){this.logger.error(h),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async a=>{const c=await this.fetchPublicKey();c&&(await this.persistPublicKey(c),a(c))});const n=await this.fetchPromise;return this.fetchPromise=void 0,n},this.validateAttestation=(n,a)=>{const c=dS(n,a.publicKey),h={hasExpired:Se.toMiliseconds(c.exp)<Date.now(),payload:c};if(h.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:h.payload.origin,isScam:h.payload.isScam,isVerified:h.payload.isVerified}},this.logger=jr(t,this.name),this.abortController=new AbortController,this.isDevEnv=hd(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return ai(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Se.toMiliseconds(e))}}class wD extends wI{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=xA,this.registerDeviceToken=async i=>{const{clientId:n,token:a,notificationType:c,enableEncrypted:h=!1}=i,d=`${EA}/${this.projectId}/clients`;await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:c,token:a,always_raw:h})})},this.logger=jr(t,this.context)}}var _D=Object.defineProperty,w1=Object.getOwnPropertySymbols,xD=Object.prototype.hasOwnProperty,ED=Object.prototype.propertyIsEnumerable,_1=(r,e,t)=>e in r?_D(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Po=(r,e)=>{for(var t in e||(e={}))xD.call(e,t)&&_1(r,t,e[t]);if(w1)for(var t of w1(e))ED.call(e,t)&&_1(r,t,e[t]);return r};class SD extends _I{constructor(e,t,i=!0){super(e,t,i),this.core=e,this.logger=t,this.context=MA,this.storagePrefix=In,this.storageVersion=SA,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{if(!hd())try{const n={eventId:_v(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:wb(this.core.relayer.protocol,this.core.relayer.version,Nl)}}};await this.sendEvent([n])}catch(n){this.logger.warn(n)}},this.createEvent=n=>{const{event:a="ERROR",type:c="",properties:{topic:h,trace:d}}=n,p=_v(),b=this.core.projectId||"",w=Date.now(),R=Po({eventId:p,timestamp:w,props:{event:a,type:c,properties:{topic:h,trace:d}},bundleId:b,domain:this.getAppDomain()},this.setMethods(p));return this.telemetryEnabled&&(this.events.set(p,R),this.shouldPersist=!0),R},this.getEvent=n=>{const{eventId:a,topic:c}=n;if(a)return this.events.get(a);const h=Array.from(this.events.values()).find(d=>d.props.properties.topic===c);if(h)return Po(Po({},h),this.setMethods(h.eventId))},this.deleteEvent=n=>{const{eventId:a}=n;this.events.delete(a),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(Xa.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(n=>{Se.fromMiliseconds(Date.now())-Se.fromMiliseconds(n.timestamp)>IA&&(this.events.delete(n.eventId),this.shouldPersist=!0)})})},this.setMethods=n=>({addTrace:a=>this.addTrace(n,a),setError:a=>this.setError(n,a)}),this.addTrace=(n,a)=>{const c=this.events.get(n);c&&(c.props.properties.trace.push(a),this.events.set(n,c),this.shouldPersist=!0)},this.setError=(n,a)=>{const c=this.events.get(n);c&&(c.props.type=a,c.timestamp=Date.now(),this.events.set(n,c),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const n=await this.core.storage.getItem(this.storageKey)||[];if(!n.length)return;n.forEach(a=>{this.events.set(a.eventId,Po(Po({},a),this.setMethods(a.eventId)))})}catch(n){this.logger.warn(n)}},this.submit=async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const n=[];for(const[a,c]of this.events)c.props.type&&n.push(c);if(n.length!==0)try{if((await this.sendEvent(n)).ok)for(const a of n)this.events.delete(a.eventId),this.shouldPersist=!0}catch(a){this.logger.warn(a)}},this.sendEvent=async n=>{const a=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${AA}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Nl}${a}`,{method:"POST",body:JSON.stringify(n)})},this.getAppDomain=()=>yb().url,this.logger=jr(t,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var MD=Object.defineProperty,x1=Object.getOwnPropertySymbols,ID=Object.prototype.hasOwnProperty,AD=Object.prototype.propertyIsEnumerable,E1=(r,e,t)=>e in r?MD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,S1=(r,e)=>{for(var t in e||(e={}))ID.call(e,t)&&E1(r,t,e[t]);if(x1)for(var t of x1(e))AD.call(e,t)&&E1(r,t,e[t]);return r};class yd extends uI{constructor(e){var t;super(e),this.protocol=Vb,this.version=Gb,this.name=md,this.events=new vi.EventEmitter,this.initialized=!1,this.on=(c,h)=>this.events.on(c,h),this.once=(c,h)=>this.events.once(c,h),this.off=(c,h)=>this.events.off(c,h),this.removeListener=(c,h)=>this.events.removeListener(c,h),this.dispatchEnvelope=({topic:c,message:h,sessionExists:d})=>{if(!c||!h)return;const p={topic:c,message:h,publishedAt:Date.now(),transportType:jt.link_mode};this.relayer.onLinkMessageEvent(p,{sessionExists:d})},this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Yb,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=vh({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:VI.logger}),{logger:n,chunkLoggerController:a}=hI({opts:i,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=a,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var c,h;(c=this.logChunkController)!=null&&c.downloadLogsBlobInBrowser&&((h=this.logChunkController)==null||h.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=jr(n,this.name),this.heartbeat=new aM,this.crypto=new QP(this,this.logger,e==null?void 0:e.keychain),this.history=new bD(this,this.logger),this.expirer=new mD(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new LM(S1(S1({},GI),e==null?void 0:e.storageOptions)),this.relayer=new lD({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new gD(this,this.logger),this.verify=new yD(this,this.logger,this.storage),this.echoClient=new wD(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new SD(this,this.logger,e==null?void 0:e.telemetryEnabled)}static async init(e){const t=new yd(e);await t.initialize();const i=await t.crypto.getClientId();return await t.storage.setItem(fA,i),t}get context(){return ai(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(s1,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.eventClient.init(),this.linkModeSupportedApps=await this.storage.getItem(s1)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const PD=yd;var Zi={};const fm="wc",cm=2,hm="client",wd=`${fm}@${cm}:${hm}:`,nl={name:hm,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},M1="WALLETCONNECT_DEEPLINK_CHOICE",DD="proposal",um="Proposal expired",OD="session",Ma=Se.SEVEN_DAYS,RD="engine",mr={wc_sessionPropose:{req:{ttl:Se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Se.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Se.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Se.FIVE_MINUTES,prompt:!1,tag:1119}}},sl={min:Se.FIVE_MINUTES,max:Se.SEVEN_DAYS},dn={idle:"IDLE",active:"ACTIVE"},CD="request",ND=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],TD="wc",$D="auth",LD="authKeys",qD="pairingTopics",UD="requests",wh=`${TD}@${1.5}:${$D}:`,Ic=`${wh}:PUB_KEY`;var BD=Object.defineProperty,zD=Object.defineProperties,FD=Object.getOwnPropertyDescriptors,I1=Object.getOwnPropertySymbols,kD=Object.prototype.hasOwnProperty,HD=Object.prototype.propertyIsEnumerable,A1=(r,e,t)=>e in r?BD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,tr=(r,e)=>{for(var t in e||(e={}))kD.call(e,t)&&A1(r,t,e[t]);if(I1)for(var t of I1(e))HD.call(e,t)&&A1(r,t,e[t]);return r},Qi=(r,e)=>zD(r,FD(e));class KD extends EI{constructor(e){super(e),this.name=RD,this.events=new kl,this.initialized=!1,this.requestQueue={state:dn.idle,queue:[]},this.sessionRequestQueue={state:dn.idle,queue:[]},this.requestQueueDelay=Se.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(mr)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Se.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const i=Qi(tr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:c,sessionProperties:h,relays:d}=i;let p=n,b,w=!1;try{p&&(w=this.client.core.pairing.pairings.get(p).active)}catch(k){throw this.client.logger.error(`connect() -> pairing.get(${p}) failed`),k}if(!p||!w){const{topic:k,uri:W}=await this.client.core.pairing.create();p=k,b=W}if(!p){const{message:k}=Ee("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(k)}const R=await this.client.core.crypto.generateKeyPair(),O=mr.wc_sessionPropose.req.ttl||Se.FIVE_MINUTES,C=vr(O),q=tr({requiredNamespaces:a,optionalNamespaces:c,relays:d??[{protocol:Jb}],proposer:{publicKey:R,metadata:this.client.metadata},expiryTimestamp:C,pairingTopic:p},h&&{sessionProperties:h}),{reject:V,resolve:Y,done:H}=Fs(O,um);this.events.once(It("session_connect"),async({error:k,session:W})=>{if(k)V(k);else if(W){W.self.publicKey=R;const J=Qi(tr({},W),{pairingTopic:q.pairingTopic,requiredNamespaces:q.requiredNamespaces,optionalNamespaces:q.optionalNamespaces,transportType:jt.relay});await this.client.session.set(W.topic,J),await this.setExpiry(W.topic,W.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:W.peer.metadata}),this.cleanupDuplicatePairings(J),Y(J)}});const X=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:q,throwOnFailedPublish:!0});return await this.setProposal(X,tr({id:X},q)),{uri:b,approval:H}},this.pair=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(i){throw this.client.logger.error("pair() failed"),i}},this.approve=async t=>{var i,n,a;const c=this.client.core.eventClient.createEvent({properties:{topic:(i=t==null?void 0:t.id)==null?void 0:i.toString(),trace:[Xi.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(B){throw c.setError(Bs.no_internet_connection),B}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(B){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),c.setError(Bs.proposal_not_found),B}try{await this.isValidApprove(t)}catch(B){throw this.client.logger.error("approve() -> isValidApprove() failed"),c.setError(Bs.session_approve_namespace_validation_failure),B}const{id:h,relayProtocol:d,namespaces:p,sessionProperties:b,sessionConfig:w}=t,R=this.client.proposal.get(h);this.client.core.eventClient.deleteEvent({eventId:c.eventId});const{pairingTopic:O,proposer:C,requiredNamespaces:q,optionalNamespaces:V}=R;let Y=(n=this.client.core.eventClient)==null?void 0:n.getEvent({topic:O});Y||(Y=(a=this.client.core.eventClient)==null?void 0:a.createEvent({type:Xi.session_approve_started,properties:{topic:O,trace:[Xi.session_approve_started,Xi.session_namespaces_validation_success]}}));const H=await this.client.core.crypto.generateKeyPair(),X=C.publicKey,k=await this.client.core.crypto.generateSharedKey(H,X),W=tr(tr({relay:{protocol:d??"irn"},namespaces:p,controller:{publicKey:H,metadata:this.client.metadata},expiry:vr(Ma)},b&&{sessionProperties:b}),w&&{sessionConfig:w}),J=jt.relay;Y.addTrace(Xi.subscribing_session_topic);try{await this.client.core.relayer.subscribe(k,{transportType:J})}catch(B){throw Y.setError(Bs.subscribe_session_topic_failure),B}Y.addTrace(Xi.subscribe_session_topic_success);const M=Qi(tr({},W),{topic:k,requiredNamespaces:q,optionalNamespaces:V,pairingTopic:O,acknowledged:!1,self:W.controller,peer:{publicKey:C.publicKey,metadata:C.metadata},controller:H,transportType:jt.relay});await this.client.session.set(k,M),Y.addTrace(Xi.store_session);try{Y.addTrace(Xi.publishing_session_settle),await this.sendRequest({topic:k,method:"wc_sessionSettle",params:W,throwOnFailedPublish:!0}).catch(B=>{throw Y==null||Y.setError(Bs.session_settle_publish_failure),B}),Y.addTrace(Xi.session_settle_publish_success),Y.addTrace(Xi.publishing_session_approve),await this.sendResult({id:h,topic:O,result:{relay:{protocol:d??"irn"},responderPublicKey:H},throwOnFailedPublish:!0}).catch(B=>{throw Y==null||Y.setError(Bs.session_approve_publish_failure),B}),Y.addTrace(Xi.session_approve_publish_success)}catch(B){throw this.client.logger.error(B),this.client.session.delete(k,Ut("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(k),B}return this.client.core.eventClient.deleteEvent({eventId:Y.eventId}),await this.client.core.pairing.updateMetadata({topic:O,metadata:C.metadata}),await this.client.proposal.delete(h,Ut("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:O}),await this.setExpiry(k,vr(Ma)),{topic:k,acknowledged:()=>Promise.resolve(this.client.session.get(k))}},this.reject=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(c){throw this.client.logger.error("reject() -> isValidReject() failed"),c}const{id:i,reason:n}=t;let a;try{a=this.client.proposal.get(i).pairingTopic}catch(c){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),c}a&&(await this.sendError({id:i,topic:a,error:n,rpcOpts:mr.wc_sessionPropose.reject}),await this.client.proposal.delete(i,Ut("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(w){throw this.client.logger.error("update() -> isValidUpdate() failed"),w}const{topic:i,namespaces:n}=t,{done:a,resolve:c,reject:h}=Fs(),d=hs(),p=Ks().toString(),b=this.client.session.get(i).namespaces;return this.events.once(It("session_update",d),({error:w})=>{w?h(w):c()}),await this.client.session.update(i,{namespaces:n}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:d,relayRpcId:p}).catch(w=>{this.client.logger.error(w),this.client.session.update(i,{namespaces:b}),h(w)}),{acknowledged:a}},this.extend=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(d){throw this.client.logger.error("extend() -> isValidExtend() failed"),d}const{topic:i}=t,n=hs(),{done:a,resolve:c,reject:h}=Fs();return this.events.once(It("session_extend",n),({error:d})=>{d?h(d):c()}),await this.setExpiry(i,vr(Ma)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(d=>{h(d)}),{acknowledged:a}},this.request=async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(C){throw this.client.logger.error("request() -> isValidRequest() failed"),C}const{chainId:i,request:n,topic:a,expiry:c=mr.wc_sessionRequest.req.ttl}=t,h=this.client.session.get(a);(h==null?void 0:h.transportType)===jt.relay&&await this.confirmOnlineStateOrThrow();const d=hs(),p=Ks().toString(),{done:b,resolve:w,reject:R}=Fs(c,"Request expired. Please try again.");this.events.once(It("session_request",d),({error:C,result:q})=>{C?R(C):w(q)});const O=this.getAppLinkIfEnabled(h.peer.metadata,h.transportType);return O?(await this.sendRequest({clientRpcId:d,relayRpcId:p,topic:a,method:"wc_sessionRequest",params:{request:Qi(tr({},n),{expiryTimestamp:vr(c)}),chainId:i},expiry:c,throwOnFailedPublish:!0,appLink:O}).catch(C=>R(C)),this.client.events.emit("session_request_sent",{topic:a,request:n,chainId:i,id:d}),await b()):await Promise.all([new Promise(async C=>{await this.sendRequest({clientRpcId:d,relayRpcId:p,topic:a,method:"wc_sessionRequest",params:{request:Qi(tr({},n),{expiryTimestamp:vr(c)}),chainId:i},expiry:c,throwOnFailedPublish:!0}).catch(q=>R(q)),this.client.events.emit("session_request_sent",{topic:a,request:n,chainId:i,id:d}),C()}),new Promise(async C=>{var q;if(!((q=h.sessionConfig)!=null&&q.disableDeepLink)){const V=await OE(this.client.core.storage,M1);await PE({id:d,topic:a,wcDeepLink:V})}C()}),b()]).then(C=>C[2])},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:i,response:n}=t,{id:a}=n,c=this.client.session.get(i);c.transportType===jt.relay&&await this.confirmOnlineStateOrThrow();const h=this.getAppLinkIfEnabled(c.peer.metadata,c.transportType);vn(n)?await this.sendResult({id:a,topic:i,result:n.result,throwOnFailedPublish:!0,appLink:h}):Ri(n)&&await this.sendError({id:a,topic:i,error:n.error,appLink:h}),this.cleanupAfterResponse(t)},this.ping=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(n){throw this.client.logger.error("ping() -> isValidPing() failed"),n}const{topic:i}=t;if(this.client.session.keys.includes(i)){const n=hs(),a=Ks().toString(),{done:c,resolve:h,reject:d}=Fs();this.events.once(It("session_ping",n),({error:p})=>{p?d(p):h()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:a}),c()])}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:i,event:n,chainId:a}=t,c=Ks().toString();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:n,chainId:a},throwOnFailedPublish:!0,relayRpcId:c})},this.disconnect=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:i}=t;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:Ut("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:n}=Ee("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(n)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(i=>OS(i,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(t,i)=>{var n;this.isInitialized(),this.isValidAuthenticate(t);const a=i&&this.client.core.linkModeSupportedApps.includes(i)&&((n=this.client.metadata.redirect)==null?void 0:n.linkMode),c=a?jt.link_mode:jt.relay;c===jt.relay&&await this.confirmOnlineStateOrThrow();const{chains:h,statement:d="",uri:p,domain:b,nonce:w,type:R,exp:O,nbf:C,methods:q=[],expiry:V}=t,Y=[...t.resources||[]],{topic:H,uri:X}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:c});this.client.logger.info({message:"Generated new pairing",pairing:{topic:H,uri:X}});const k=await this.client.core.crypto.generateKeyPair(),W=Ec(k);if(await Promise.all([this.client.auth.authKeys.set(Ic,{responseTopic:W,publicKey:k}),this.client.auth.pairingTopics.set(W,{topic:W,pairingTopic:H})]),await this.client.core.relayer.subscribe(W,{transportType:c}),this.client.logger.info(`sending request to new pairing topic: ${H}`),q.length>0){const{namespace:P}=Ta(h[0]);let S=XE(P,"request",q);xc(Y)&&(S=QE(S,Y.pop())),Y.push(S)}const J=V&&V>mr.wc_sessionAuthenticate.req.ttl?V:mr.wc_sessionAuthenticate.req.ttl,M={authPayload:{type:R??"caip122",chains:h,statement:d,aud:p,domain:b,version:"1",nonce:w,iat:new Date().toISOString(),exp:O,nbf:C,resources:Y},requester:{publicKey:k,metadata:this.client.metadata},expiryTimestamp:vr(J)},B={eip155:{chains:h,methods:[...new Set(["personal_sign",...q])],events:["chainChanged","accountsChanged"]}},ae={requiredNamespaces:{},optionalNamespaces:B,relays:[{protocol:"irn"}],pairingTopic:H,proposer:{publicKey:k,metadata:this.client.metadata},expiryTimestamp:vr(mr.wc_sessionPropose.req.ttl)},{done:de,resolve:U,reject:m}=Fs(J,"Request expired"),g=async({error:P,session:S})=>{if(this.events.off(It("session_request",u),f),P)m(P);else if(S){S.self.publicKey=k,await this.client.session.set(S.topic,S),await this.setExpiry(S.topic,S.expiry),H&&await this.client.core.pairing.updateMetadata({topic:H,metadata:S.peer.metadata});const v=this.client.session.get(S.topic);await this.deleteProposal(y),U({session:v})}},f=async P=>{var S,v,E;if(await this.deletePendingAuthRequest(u,{message:"fulfilled",code:0}),P.error){const j=Ut("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return P.error.code===j.code?void 0:(this.events.off(It("session_connect"),g),m(P.error.message))}await this.deleteProposal(y),this.events.off(It("session_connect"),g);const{cacaos:x,responder:T}=P.result,ne=[],fe=[];for(const j of x){await Sv({cacao:j,projectId:this.client.core.projectId})||(this.client.logger.error(j,"Signature verification failed"),m(Ut("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:L}=j,_=xc(L.resources),K=[Pl(L.iss)],re=Bc(L.iss);if(_){const se=Mv(_),we=Iv(_);ne.push(...se),K.push(...we)}for(const se of K)fe.push(`${se}:${re}`)}const D=await this.client.core.crypto.generateSharedKey(k,T.publicKey);let F;ne.length>0&&(F={topic:D,acknowledged:!0,self:{publicKey:k,metadata:this.client.metadata},peer:T,controller:T.publicKey,expiry:vr(Ma),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:H,namespaces:$v([...new Set(ne)],[...new Set(fe)]),transportType:c},await this.client.core.relayer.subscribe(D,{transportType:c}),await this.client.session.set(D,F),H&&await this.client.core.pairing.updateMetadata({topic:H,metadata:T.metadata}),F=this.client.session.get(D)),(S=this.client.metadata.redirect)!=null&&S.linkMode&&(v=T.metadata.redirect)!=null&&v.linkMode&&(E=T.metadata.redirect)!=null&&E.universal&&i&&(this.client.core.addLinkModeSupportedApp(T.metadata.redirect.universal),this.client.session.update(D,{transportType:jt.link_mode})),U({auths:x,session:F})},u=hs(),y=hs();this.events.once(It("session_connect"),g),this.events.once(It("session_request",u),f);let A;try{if(a){const P=ds("wc_sessionAuthenticate",M,u);this.client.core.history.set(H,P);const S=await this.client.core.crypto.encode("",P,{type:tf,encoding:Eo});A=hc(i,H,S)}else await Promise.all([this.sendRequest({topic:H,method:"wc_sessionAuthenticate",params:M,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:u}),this.sendRequest({topic:H,method:"wc_sessionPropose",params:ae,expiry:mr.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:y})])}catch(P){throw this.events.off(It("session_connect"),g),this.events.off(It("session_request",u),f),P}return await this.setProposal(y,tr({id:y},ae)),await this.setAuthRequest(u,{request:Qi(tr({},M),{verifyContext:{}}),pairingTopic:H,transportType:c}),{uri:A??X,response:de}},this.approveSessionAuthenticate=async t=>{const{id:i,auths:n}=t,a=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[zs.authenticated_session_approve_started]}});try{this.isInitialized()}catch(V){throw a.setError(Io.no_internet_connection),V}const c=this.getPendingAuthRequest(i);if(!c)throw a.setError(Io.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const h=c.transportType||jt.relay;h===jt.relay&&await this.confirmOnlineStateOrThrow();const d=c.requester.publicKey,p=await this.client.core.crypto.generateKeyPair(),b=Ec(d),w={type:Wn,receiverPublicKey:d,senderPublicKey:p},R=[],O=[];for(const V of n){if(!await Sv({cacao:V,projectId:this.client.core.projectId})){a.setError(Io.invalid_cacao);const W=Ut("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:b,error:W,encodeOpts:w}),new Error(W.message)}a.addTrace(zs.cacaos_verified);const{p:Y}=V,H=xc(Y.resources),X=[Pl(Y.iss)],k=Bc(Y.iss);if(H){const W=Mv(H),J=Iv(H);R.push(...W),X.push(...J)}for(const W of X)O.push(`${W}:${k}`)}const C=await this.client.core.crypto.generateSharedKey(p,d);a.addTrace(zs.create_authenticated_session_topic);let q;if((R==null?void 0:R.length)>0){q={topic:C,acknowledged:!0,self:{publicKey:p,metadata:this.client.metadata},peer:{publicKey:d,metadata:c.requester.metadata},controller:d,expiry:vr(Ma),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:c.pairingTopic,namespaces:$v([...new Set(R)],[...new Set(O)]),transportType:h},a.addTrace(zs.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(C,{transportType:h})}catch(V){throw a.setError(Io.subscribe_authenticated_session_topic_failure),V}a.addTrace(zs.subscribe_authenticated_session_topic_success),await this.client.session.set(C,q),a.addTrace(zs.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:c.pairingTopic,metadata:c.requester.metadata})}a.addTrace(zs.publishing_authenticated_session_approve);try{await this.sendResult({topic:b,id:i,result:{cacaos:n,responder:{publicKey:p,metadata:this.client.metadata}},encodeOpts:w,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(c.requester.metadata,h)})}catch(V){throw a.setError(Io.authenticated_session_approve_publish_failure),V}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:c.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:a.eventId}),{session:q}},this.rejectSessionAuthenticate=async t=>{this.isInitialized();const{id:i,reason:n}=t,a=this.getPendingAuthRequest(i);if(!a)throw new Error(`Could not find pending auth request with id ${i}`);a.transportType===jt.relay&&await this.confirmOnlineStateOrThrow();const c=a.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),d=Ec(c),p={type:Wn,receiverPublicKey:c,senderPublicKey:h};await this.sendError({id:i,topic:d,error:n,encodeOpts:p,rpcOpts:mr.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(a.requester.metadata,a.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.client.proposal.delete(i,Ut("USER_DISCONNECTED"))},this.formatAuthMessage=t=>{this.isInitialized();const{request:i,iss:n}=t;return Ib(i,n)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)},this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const i=this.client.core.pairing.pairings.get(t.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(a=>{var c,h;return((c=a.peerMetadata)==null?void 0:c.url)&&((h=a.peerMetadata)==null?void 0:h.url)===t.peer.metadata.url&&a.topic&&a.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async t=>{var i;const{topic:n,expirerHasDeleted:a=!1,emitEvent:c=!0,id:h=0}=t,{self:d}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,Ut("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(d.publicKey)&&await this.client.core.crypto.deleteKeyPair(d.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),a||this.client.core.expirer.del(n),this.client.core.storage.removeItem(M1).catch(p=>this.client.logger.warn(p)),this.getPendingSessionRequests().forEach(p=>{p.topic===n&&this.deletePendingSessionRequest(p.id,Ut("USER_DISCONNECTED"))}),n===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=dn.idle),c&&this.client.events.emit("session_delete",{id:h,topic:n})},this.deleteProposal=async(t,i)=>{if(i)try{const n=this.client.proposal.get(t),a=this.client.core.eventClient.getEvent({topic:n.pairingTopic});a==null||a.setError(Bs.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,Ut("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")},this.deletePendingSessionRequest=async(t,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,i),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(a=>a.id!==t),n&&(this.sessionRequestQueue.state=dn.idle,this.client.events.emit("session_request_expire",{id:t}))},this.deletePendingAuthRequest=async(t,i,n=!1)=>{await Promise.all([this.client.auth.requests.delete(t,i),n?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,i)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,i),await this.client.session.update(t,{expiry:i}))},this.setProposal=async(t,i)=>{this.client.core.expirer.set(t,vr(mr.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,i)},this.setAuthRequest=async(t,i)=>{const{request:n,pairingTopic:a,transportType:c=jt.relay}=i;this.client.core.expirer.set(t,n.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:t,pairingTopic:a,verifyContext:n.verifyContext,transportType:c})},this.setPendingSessionRequest=async t=>{const{id:i,topic:n,params:a,verifyContext:c}=t,h=a.request.expiryTimestamp||vr(mr.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,h),await this.client.pendingRequest.set(i,{id:i,topic:n,params:a,verifyContext:c})},this.sendRequest=async t=>{const{topic:i,method:n,params:a,expiry:c,relayRpcId:h,clientRpcId:d,throwOnFailedPublish:p,appLink:b}=t,w=ds(n,a,d);let R;const O=!!b;try{const V=O?Eo:ls;R=await this.client.core.crypto.encode(i,w,{encoding:V})}catch(V){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),V}let C;if(ND.includes(n)){const V=Kn(JSON.stringify(w)),Y=Kn(R);C=await this.client.core.verify.register({id:Y,decryptedId:V})}const q=mr[n].req;if(q.attestation=C,c&&(q.ttl=c),h&&(q.id=h),this.client.core.history.set(i,w),O){const V=hc(b,i,R);await Zi.Linking.openURL(V,this.client.name)}else{const V=mr[n].req;c&&(V.ttl=c),h&&(V.id=h),p?(V.internal=Qi(tr({},V.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,R,V)):this.client.core.relayer.publish(i,R,V).catch(Y=>this.client.logger.error(Y))}return w.id},this.sendResult=async t=>{const{id:i,topic:n,result:a,throwOnFailedPublish:c,encodeOpts:h,appLink:d}=t,p=gh(i,a);let b;const w=d&&typeof(Zi==null?void 0:Zi.Linking)<"u";try{const O=w?Eo:ls;b=await this.client.core.crypto.encode(n,p,Qi(tr({},h||{}),{encoding:O}))}catch(O){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),O}let R;try{R=await this.client.core.history.get(n,i)}catch(O){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${i}) failed`),O}if(w){const O=hc(d,n,b);await Zi.Linking.openURL(O,this.client.name)}else{const O=mr[R.request.method].res;c?(O.internal=Qi(tr({},O.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,b,O)):this.client.core.relayer.publish(n,b,O).catch(C=>this.client.logger.error(C))}await this.client.core.history.resolve(p)},this.sendError=async t=>{const{id:i,topic:n,error:a,encodeOpts:c,rpcOpts:h,appLink:d}=t,p=bh(i,a);let b;const w=d&&typeof(Zi==null?void 0:Zi.Linking)<"u";try{const O=w?Eo:ls;b=await this.client.core.crypto.encode(n,p,Qi(tr({},c||{}),{encoding:O}))}catch(O){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),O}let R;try{R=await this.client.core.history.get(n,i)}catch(O){throw this.client.logger.error(`sendError() -> history.get(${n}, ${i}) failed`),O}if(w){const O=hc(d,n,b);await Zi.Linking.openURL(O,this.client.name)}else{const O=h||mr[R.request.method].res;this.client.core.relayer.publish(n,b,O)}await this.client.core.history.resolve(p)},this.cleanup=async()=>{const t=[],i=[];this.client.session.getAll().forEach(n=>{let a=!1;cs(n.expiry)&&(a=!0),this.client.core.crypto.keychain.has(n.topic)||(a=!0),a&&t.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{cs(n.expiryTimestamp)&&i.push(n.id)}),await Promise.all([...t.map(n=>this.deleteSession({topic:n})),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===dn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=dn.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=dn.idle},this.processRequest=async t=>{const{topic:i,payload:n,attestation:a,transportType:c,encryptedId:h}=t,d=n.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:d}))switch(d){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:n,attestation:a,encryptedId:h});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,n);case"wc_sessionPing":return await this.onSessionPingRequest(i,n);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:n,attestation:a,encryptedId:h,transportType:c});case"wc_sessionEvent":return await this.onSessionEventRequest(i,n);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:n,attestation:a,encryptedId:h,transportType:c});default:return this.client.logger.info(`Unsupported request method ${d}`)}},this.onRelayEventResponse=async t=>{const{topic:i,payload:n,transportType:a}=t,c=(await this.client.core.history.get(i,n.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:i}=t,{message:n}=Ee("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)},this.shouldIgnorePairingRequest=t=>{const{topic:i,requestMethod:n}=t,a=this.expectedPairingMethodMap.get(i);return!a||a.includes(n)?!1:!!(a.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async t=>{const{topic:i,payload:n,attestation:a,encryptedId:c}=t,{params:h,id:d}=n;try{const p=this.client.core.eventClient.getEvent({topic:i});this.isValidConnect(tr({},n.params));const b=h.expiryTimestamp||vr(mr.wc_sessionPropose.req.ttl),w=tr({id:d,pairingTopic:i,expiryTimestamp:b},h);await this.setProposal(d,w);const R=await this.getVerifyContext({attestationId:a,hash:Kn(JSON.stringify(n)),encryptedId:c,metadata:w.proposer.metadata});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),p==null||p.setError(Hn.proposal_listener_not_found)),p==null||p.addTrace(pn.emit_session_proposal),this.client.events.emit("session_proposal",{id:d,params:w,verifyContext:R})}catch(p){await this.sendError({id:d,topic:i,error:p,rpcOpts:mr.wc_sessionPropose.autoReject}),this.client.logger.error(p)}},this.onSessionProposeResponse=async(t,i,n)=>{const{id:a}=i;if(vn(i)){const{result:c}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const h=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const d=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const p=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:p});const b=await this.client.core.crypto.generateSharedKey(d,p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:b});const w=await this.client.core.relayer.subscribe(b,{transportType:n});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),await this.client.core.pairing.activate({topic:t})}else if(Ri(i)){await this.client.proposal.delete(a,Ut("USER_DISCONNECTED"));const c=It("session_connect");if(this.events.listenerCount(c)===0)throw new Error(`emitting ${c} without any listeners, 954`);this.events.emit(It("session_connect"),{error:i.error})}},this.onSessionSettleRequest=async(t,i)=>{const{id:n,params:a}=i;try{this.isValidSessionSettleRequest(a);const{relay:c,controller:h,expiry:d,namespaces:p,sessionProperties:b,sessionConfig:w}=i.params,R=Qi(tr(tr({topic:t,relay:c,expiry:d,namespaces:p,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:h.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:h.publicKey,metadata:h.metadata}},b&&{sessionProperties:b}),w&&{sessionConfig:w}),{transportType:jt.relay}),O=It("session_connect");if(this.events.listenerCount(O)===0)throw new Error(`emitting ${O} without any listeners 997`);this.events.emit(It("session_connect"),{session:R}),await this.sendResult({id:i.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(c){await this.sendError({id:n,topic:t,error:c}),this.client.logger.error(c)}},this.onSessionSettleResponse=async(t,i)=>{const{id:n}=i;vn(i)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(It("session_approve",n),{})):Ri(i)&&(await this.client.session.delete(t,Ut("USER_DISCONNECTED")),this.events.emit(It("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(t,i)=>{const{params:n,id:a}=i;try{const c=`${t}_session_update`,h=So.get(c);if(h&&this.isRequestOutOfSync(h,a)){this.client.logger.info(`Discarding out of sync request - ${a}`),this.sendError({id:a,topic:t,error:Ut("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(tr({topic:t},n));try{So.set(c,a),await this.client.session.update(t,{namespaces:n.namespaces}),await this.sendResult({id:a,topic:t,result:!0,throwOnFailedPublish:!0})}catch(d){throw So.delete(c),d}this.client.events.emit("session_update",{id:a,topic:t,params:n})}catch(c){await this.sendError({id:a,topic:t,error:c}),this.client.logger.error(c)}},this.isRequestOutOfSync=(t,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,i)=>{const{id:n}=i,a=It("session_update",n);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);vn(i)?this.events.emit(It("session_update",n),{}):Ri(i)&&this.events.emit(It("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(t,i)=>{const{id:n}=i;try{this.isValidExtend({topic:t}),await this.setExpiry(t,vr(Ma)),await this.sendResult({id:n,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:n,topic:t})}catch(a){await this.sendError({id:n,topic:t,error:a}),this.client.logger.error(a)}},this.onSessionExtendResponse=(t,i)=>{const{id:n}=i,a=It("session_extend",n);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);vn(i)?this.events.emit(It("session_extend",n),{}):Ri(i)&&this.events.emit(It("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(t,i)=>{const{id:n}=i;try{this.isValidPing({topic:t}),await this.sendResult({id:n,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:n,topic:t})}catch(a){await this.sendError({id:n,topic:t,error:a}),this.client.logger.error(a)}},this.onSessionPingResponse=(t,i)=>{const{id:n}=i,a=It("session_ping",n);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);setTimeout(()=>{vn(i)?this.events.emit(It("session_ping",n),{}):Ri(i)&&this.events.emit(It("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(t,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:t,reason:i.params}),Promise.all([new Promise(a=>{this.client.core.relayer.once(Hr.publish,async()=>{a(await this.deleteSession({topic:t,id:n}))})}),this.sendResult({id:n,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:Ut("USER_DISCONNECTED")})]).catch(a=>this.client.logger.error(a))}catch(a){this.client.logger.error(a)}},this.onSessionRequest=async t=>{var i,n,a;const{topic:c,payload:h,attestation:d,encryptedId:p,transportType:b}=t,{id:w,params:R}=h;try{await this.isValidRequest(tr({topic:c},R));const O=this.client.session.get(c),C=await this.getVerifyContext({attestationId:d,hash:Kn(JSON.stringify(ds("wc_sessionRequest",R,w))),encryptedId:p,metadata:O.peer.metadata,transportType:b}),q={id:w,topic:c,params:R,verifyContext:C};await this.setPendingSessionRequest(q),b===jt.link_mode&&(i=O.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((n=O.peer.metadata.redirect)==null?void 0:n.universal),(a=this.client.signConfig)!=null&&a.disableRequestQueue?this.emitSessionRequest(q):(this.addSessionRequestToSessionRequestQueue(q),this.processSessionRequestQueue())}catch(O){await this.sendError({id:w,topic:c,error:O}),this.client.logger.error(O)}},this.onSessionRequestResponse=(t,i)=>{const{id:n}=i,a=It("session_request",n);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);vn(i)?this.events.emit(It("session_request",n),{result:i.result}):Ri(i)&&this.events.emit(It("session_request",n),{error:i.error})},this.onSessionEventRequest=async(t,i)=>{const{id:n,params:a}=i;try{const c=`${t}_session_event_${a.event.name}`,h=So.get(c);if(h&&this.isRequestOutOfSync(h,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(tr({topic:t},a)),this.client.events.emit("session_event",{id:n,topic:t,params:a}),So.set(c,n)}catch(c){await this.sendError({id:n,topic:t,error:c}),this.client.logger.error(c)}},this.onSessionAuthenticateResponse=(t,i)=>{const{id:n}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:i}),vn(i)?this.events.emit(It("session_request",n),{result:i.result}):Ri(i)&&this.events.emit(It("session_request",n),{error:i.error})},this.onSessionAuthenticateRequest=async t=>{var i;const{topic:n,payload:a,attestation:c,encryptedId:h,transportType:d}=t;try{const{requester:p,authPayload:b,expiryTimestamp:w}=a.params,R=await this.getVerifyContext({attestationId:c,hash:Kn(JSON.stringify(a)),encryptedId:h,metadata:p.metadata,transportType:d}),O={requester:p,pairingTopic:n,id:a.id,authPayload:b,verifyContext:R,expiryTimestamp:w};await this.setAuthRequest(a.id,{request:O,pairingTopic:n,transportType:d}),d===jt.link_mode&&(i=p.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(p.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:n,params:a.params,id:a.id,verifyContext:R})}catch(p){this.client.logger.error(p);const b=a.params.requester.publicKey,w=await this.client.core.crypto.generateKeyPair(),R=this.getAppLinkIfEnabled(a.params.requester.metadata,d),O={type:Wn,receiverPublicKey:b,senderPublicKey:w};await this.sendError({id:a.id,topic:n,error:p,encodeOpts:O,rpcOpts:mr.wc_sessionAuthenticate.autoReject,appLink:R})}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=dn.idle,this.processSessionRequestQueue()},Se.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:i})=>{const n=this.client.core.history.pending;n.length>0&&n.filter(a=>a.topic===t&&a.request.method==="wc_sessionRequest").forEach(a=>{const c=a.request.id,h=It("session_request",c);if(this.events.listenerCount(h)===0)throw new Error(`emitting ${h} without any listeners`);this.events.emit(It("session_request",a.request.id),{error:i})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===dn.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=dn.active,this.emitSessionRequest(t)}catch(i){this.client.logger.error(i)}},this.emitSessionRequest=t=>{this.client.events.emit("session_request",t)},this.onPairingCreated=t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const i=this.client.proposal.getAll().find(n=>n.pairingTopic===t.topic);i&&this.onSessionProposeRequest({topic:t.topic,payload:ds("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id)})},this.isValidConnect=async t=>{if(!ti(t)){const{message:d}=Ee("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(d)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:a,sessionProperties:c,relays:h}=t;if(ri(i)||await this.isValidPairingTopic(i),!kS(h)){const{message:d}=Ee("MISSING_OR_INVALID",`connect() relays: ${h}`);throw new Error(d)}!ri(n)&&Fo(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!ri(a)&&Fo(a)!==0&&this.validateNamespaces(a,"optionalNamespaces"),ri(c)||this.validateSessionProps(c,"sessionProperties")},this.validateNamespaces=(t,i)=>{const n=FS(t,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async t=>{if(!ti(t))throw new Error(Ee("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:i,namespaces:n,relayProtocol:a,sessionProperties:c}=t;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const h=this.client.proposal.get(i),d=Xu(n,"approve()");if(d)throw new Error(d.message);const p=Uv(h.requiredNamespaces,n,"approve()");if(p)throw new Error(p.message);if(!fr(a,!0)){const{message:b}=Ee("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(b)}ri(c)||this.validateSessionProps(c,"sessionProperties")},this.isValidReject=async t=>{if(!ti(t)){const{message:a}=Ee("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(a)}const{id:i,reason:n}=t;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!KS(n)){const{message:a}=Ee("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(a)}},this.isValidSessionSettleRequest=t=>{if(!ti(t)){const{message:p}=Ee("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:i,controller:n,namespaces:a,expiry:c}=t;if(!Tb(i)){const{message:p}=Ee("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const h=$S(n,"onSessionSettleRequest()");if(h)throw new Error(h.message);const d=Xu(a,"onSessionSettleRequest()");if(d)throw new Error(d.message);if(cs(c)){const{message:p}=Ee("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!ti(t)){const{message:d}=Ee("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(d)}const{topic:i,namespaces:n}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const a=this.client.session.get(i),c=Xu(n,"update()");if(c)throw new Error(c.message);const h=Uv(a.requiredNamespaces,n,"update()");if(h)throw new Error(h.message)},this.isValidExtend=async t=>{if(!ti(t)){const{message:n}=Ee("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(n)}const{topic:i}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)},this.isValidRequest=async t=>{if(!ti(t)){const{message:d}=Ee("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(d)}const{topic:i,request:n,chainId:a,expiry:c}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:h}=this.client.session.get(i);if(!qv(h,a)){const{message:d}=Ee("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(d)}if(!jS(n)){const{message:d}=Ee("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(d)}if(!GS(h,a,n.method)){const{message:d}=Ee("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(d)}if(c&&!ZS(c,sl)){const{message:d}=Ee("MISSING_OR_INVALID",`request() expiry: ${c}. Expiry must be a number (in seconds) between ${sl.min} and ${sl.max}`);throw new Error(d)}},this.isValidRespond=async t=>{var i;if(!ti(t)){const{message:c}=Ee("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:n,response:a}=t;try{await this.isValidSessionTopic(n)}catch(c){throw(i=t==null?void 0:t.response)!=null&&i.id&&this.cleanupAfterResponse(t),c}if(!WS(a)){const{message:c}=Ee("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!ti(t)){const{message:n}=Ee("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async t=>{if(!ti(t)){const{message:h}=Ee("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(h)}const{topic:i,event:n,chainId:a}=t;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!qv(c,a)){const{message:h}=Ee("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(h)}if(!VS(n)){const{message:h}=Ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(h)}if(!JS(c,a,n.name)){const{message:h}=Ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(h)}},this.isValidDisconnect=async t=>{if(!ti(t)){const{message:n}=Ee("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidAuthenticate=t=>{const{chains:i,uri:n,domain:a,nonce:c}=t;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!fr(n,!1))throw new Error("uri is required parameter");if(!fr(a,!1))throw new Error("domain is required parameter");if(!fr(c,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(d=>Ta(d).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:h}=Ta(i[0]);if(h!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async t=>{const{attestationId:i,hash:n,encryptedId:a,metadata:c,transportType:h}=t,d={verified:{verifyUrl:c.verifyUrl||Lo,validation:"UNKNOWN",origin:c.url||""}};try{if(h===jt.link_mode){const b=this.getAppLinkIfEnabled(c,h);return d.verified.validation=b&&new URL(b).origin===new URL(c.url).origin?"VALID":"INVALID",d}const p=await this.client.core.verify.resolve({attestationId:i,hash:n,encryptedId:a,verifyUrl:c.verifyUrl});p&&(d.verified.origin=p.origin,d.verified.isScam=p.isScam,d.verified.validation=p.origin===new URL(c.url).origin?"VALID":"INVALID")}catch(p){this.client.logger.warn(p)}return this.client.logger.debug(`Verify context: ${JSON.stringify(d)}`),d},this.validateSessionProps=(t,i)=>{Object.values(t).forEach(n=>{if(!fr(n,!1)){const{message:a}=Ee("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(a)}})},this.getPendingAuthRequest=t=>{const i=this.client.auth.requests.get(t);return typeof i=="object"?i:void 0},this.addToRecentlyDeleted=(t,i)=>{if(this.recentlyDeletedMap.set(t,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let n=0;const a=this.recentlyDeletedLimit/2;for(const c of this.recentlyDeletedMap.keys()){if(n++>=a)break;this.recentlyDeletedMap.delete(c)}}},this.checkRecentlyDeleted=t=>{const i=this.recentlyDeletedMap.get(t);if(i){const{message:n}=Ee("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${t}`);throw new Error(n)}},this.isLinkModeEnabled=(t,i)=>{var n,a,c,h,d,p,b,w,R;return!t||i!==jt.link_mode?!1:((a=(n=this.client.metadata)==null?void 0:n.redirect)==null?void 0:a.linkMode)===!0&&((h=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:h.universal)!==void 0&&((p=(d=this.client.metadata)==null?void 0:d.redirect)==null?void 0:p.universal)!==""&&((b=t==null?void 0:t.redirect)==null?void 0:b.universal)!==void 0&&((w=t==null?void 0:t.redirect)==null?void 0:w.universal)!==""&&((R=t==null?void 0:t.redirect)==null?void 0:R.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(Zi==null?void 0:Zi.Linking)<"u"},this.getAppLinkIfEnabled=(t,i)=>{var n;return this.isLinkModeEnabled(t,i)?(n=t==null?void 0:t.redirect)==null?void 0:n.universal:void 0},this.handleLinkModeMessage=({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const i=wv(t,"topic")||"",n=decodeURIComponent(wv(t,"wc_ev")||""),a=this.client.session.keys.includes(i);a&&this.client.session.update(i,{transportType:jt.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:n,sessionExists:a})},this.registerLinkModeListeners=async()=>{var t;if(hd()||Ja()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const i=Zi==null?void 0:Zi.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const n=await i.getInitialURL();n&&setTimeout(()=>{this.handleLinkModeMessage({url:n})},50)}}}}isInitialized(){if(!this.initialized){const{message:e}=Ee("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Hr.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:t,message:i,attestation:n,transportType:a}=e,{publicKey:c}=this.client.auth.authKeys.keys.includes(Ic)?this.client.auth.authKeys.get(Ic):{responseTopic:void 0,publicKey:void 0},h=await this.client.core.crypto.decode(t,i,{receiverPublicKey:c,encoding:a===jt.link_mode?Eo:ls});try{bd(h)?(this.client.core.history.set(t,h),this.onRelayEventRequest({topic:t,payload:h,attestation:n,transportType:a,encryptedId:Kn(i)})):mh(h)?(await this.client.core.history.resolve(h),await this.onRelayEventResponse({topic:t,payload:h,transportType:a}),this.client.core.history.delete(t,h.id)):this.onRelayEventUnknownPayload({topic:t,payload:h,transportType:a})}catch(d){this.client.logger.error(d)}}registerExpirerEvents(){this.client.core.expirer.on(Oi.expired,async e=>{const{topic:t,id:i}=Sb(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,Ee("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,Ee("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(ks.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(ks.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!fr(e,!1)){const{message:t}=Ee("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=Ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(cs(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=Ee("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!fr(e,!1)){const{message:t}=Ee("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=Ee("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(cs(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=Ee("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=Ee("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(fr(e,!1)){const{message:t}=Ee("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=Ee("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!HS(e)){const{message:t}=Ee("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=Ee("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(cs(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=Ee("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class jD extends ia{constructor(e,t){super(e,t,DD,wd),this.core=e,this.logger=t}}let WD=class extends ia{constructor(e,t){super(e,t,OD,wd),this.core=e,this.logger=t}};class VD extends ia{constructor(e,t){super(e,t,CD,wd,i=>i.id),this.core=e,this.logger=t}}class GD extends ia{constructor(e,t){super(e,t,LD,wh,()=>Ic),this.core=e,this.logger=t}}class JD extends ia{constructor(e,t){super(e,t,qD,wh),this.core=e,this.logger=t}}class YD extends ia{constructor(e,t){super(e,t,UD,wh,i=>i.id),this.core=e,this.logger=t}}class XD{constructor(e,t){this.core=e,this.logger=t,this.authKeys=new GD(this.core,this.logger),this.pairingTopics=new JD(this.core,this.logger),this.requests=new YD(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class _d extends xI{constructor(e){super(e),this.protocol=fm,this.version=cm,this.name=nl.name,this.events=new vi.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.authenticate=async(i,n)=>{try{return await this.engine.authenticate(i,n)}catch(a){throw this.logger.error(a.message),a}},this.formatAuthMessage=i=>{try{return this.engine.formatAuthMessage(i)}catch(n){throw this.logger.error(n.message),n}},this.approveSessionAuthenticate=async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}},this.rejectSessionAuthenticate=async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}},this.name=(e==null?void 0:e.name)||nl.name,this.metadata=(e==null?void 0:e.metadata)||yb(),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:nf(vh({level:(e==null?void 0:e.logger)||nl.logger}));this.core=(e==null?void 0:e.core)||new PD(e),this.logger=jr(t,this.name),this.session=new WD(this.core,this.logger),this.proposal=new jD(this.core,this.logger),this.pendingRequest=new VD(this.core,this.logger),this.engine=new KD(this),this.auth=new XD(this.core,this.logger)}static async init(e){const t=new _d(e);return await t.initialize(),t}get context(){return ai(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),this.engine.processRelayMessageCache()}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var Kc={exports:{}};Kc.exports;(function(r,e){var t={};(function(){var i,n="4.17.21",a=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",d="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",b=500,w="__lodash_placeholder__",R=1,O=2,C=4,q=1,V=2,Y=1,H=2,X=4,k=8,W=16,J=32,M=64,B=128,ae=256,de=512,U=30,m="...",g=800,f=16,u=1,y=2,A=3,P=1/0,S=9007199254740991,v=17976931348623157e292,E=NaN,x=4294967295,T=x-1,ne=x>>>1,fe=[["ary",B],["bind",Y],["bindKey",H],["curry",k],["curryRight",W],["flip",de],["partial",J],["partialRight",M],["rearg",ae]],D="[object Arguments]",F="[object Array]",j="[object AsyncFunction]",L="[object Boolean]",_="[object Date]",K="[object DOMException]",re="[object Error]",se="[object Function]",we="[object GeneratorFunction]",ce="[object Map]",me="[object Number]",Ke="[object Null]",Me="[object Object]",Je="[object Promise]",Fe="[object Proxy]",ye="[object RegExp]",Ie="[object Set]",Ce="[object String]",ge="[object Symbol]",$e="[object Undefined]",Ae="[object WeakMap]",be="[object WeakSet]",Oe="[object ArrayBuffer]",Ne="[object DataView]",_e="[object Float32Array]",De="[object Float64Array]",ke="[object Int8Array]",xe="[object Int16Array]",je="[object Int32Array]",We="[object Uint8Array]",He="[object Uint8ClampedArray]",dt="[object Uint16Array]",mt="[object Uint32Array]",Ge=/\b__p \+= '';/g,pt=/\b(__p \+=) '' \+/g,St=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ye=/&(?:amp|lt|gt|quot|#39);/g,nt=/[&<>"']/g,Ze=RegExp(Ye.source),Te=RegExp(nt.source),Qe=/<%-([\s\S]+?)%>/g,et=/<%([\s\S]+?)%>/g,Le=/<%=([\s\S]+?)%>/g,Xe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ct=/^\w*$/,Be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/[\\^$.*+?()[\]{}|]/g,ht=RegExp(tt.source),qe=/^\s+/,st=/\s/,rt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Re=/\{\n\/\* \[wrapped with (.+)\] \*/,ut=/,? & /,Ct=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,at=/[()=,{}\[\]\/\s]/,Nt=/\\(\\)?/g,Rt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yt=/\w*$/,Dr=/^[-+]0x[0-9a-f]+$/i,Or=/^0b[01]+$/i,Rr=/^\[object .+?Constructor\]$/,Cr=/^0o[0-7]+$/i,Nr=/^(?:0|[1-9]\d*)$/,Qt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wr=/($^)/,Bi=/['\n\r\u2028\u2029\\]/g,Vr="\\ud800-\\udfff",zi="\\u0300-\\u036f",Fi="\\ufe20-\\ufe2f",Gr="\\u20d0-\\u20ff",yi=zi+Fi+Gr,wi="\\u2700-\\u27bf",lr="a-z\\xdf-\\xf6\\xf8-\\xff",ki="\\xac\\xb1\\xd7\\xf7",Hi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",_s="\\u2000-\\u206f",xs=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",of="A-Z\\xc0-\\xd6\\xd8-\\xde",ff="\\ufe0e\\ufe0f",Es=ki+Hi+_s+xs,Za="['’]",Ss="["+Vr+"]",Qa="["+Es+"]",Ms="["+yi+"]",cf="\\d+",_h="["+wi+"]",hf="["+lr+"]",uf="[^"+Vr+Es+cf+wi+lr+of+"]",sa="\\ud83c[\\udffb-\\udfff]",xh="(?:"+Ms+"|"+sa+")",lf="[^"+Vr+"]",aa="(?:\\ud83c[\\udde6-\\uddff]){2}",Xn="[\\ud800-\\udbff][\\udc00-\\udfff]",oi="["+of+"]",df="\\u200d",pf="(?:"+hf+"|"+uf+")",on="(?:"+oi+"|"+uf+")",vf="(?:"+Za+"(?:d|ll|m|re|s|t|ve))?",gf="(?:"+Za+"(?:D|LL|M|RE|S|T|VE))?",bf=xh+"?",mf="["+ff+"]?",Eh="(?:"+df+"(?:"+[lf,aa,Xn].join("|")+")"+mf+bf+")*",On="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",yf="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",wf=mf+bf+Eh,oa="(?:"+[_h,aa,Xn].join("|")+")"+wf,Sh="(?:"+[lf+Ms+"?",Ms,aa,Xn,Ss].join("|")+")",eo=RegExp(Za,"g"),Mh=RegExp(Ms,"g"),fa=RegExp(sa+"(?="+sa+")|"+Sh+wf,"g"),_f=RegExp([oi+"?"+hf+"+"+vf+"(?="+[Qa,oi,"$"].join("|")+")",on+"+"+gf+"(?="+[Qa,oi+pf,"$"].join("|")+")",oi+"?"+pf+"+"+vf,oi+"+"+gf,yf,On,cf,oa].join("|"),"g"),xf=RegExp("["+df+Vr+yi+ff+"]"),Is=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ef=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ih=-1,Ft={};Ft[_e]=Ft[De]=Ft[ke]=Ft[xe]=Ft[je]=Ft[We]=Ft[He]=Ft[dt]=Ft[mt]=!0,Ft[D]=Ft[F]=Ft[Oe]=Ft[L]=Ft[Ne]=Ft[_]=Ft[re]=Ft[se]=Ft[ce]=Ft[me]=Ft[Me]=Ft[ye]=Ft[Ie]=Ft[Ce]=Ft[Ae]=!1;var Bt={};Bt[D]=Bt[F]=Bt[Oe]=Bt[Ne]=Bt[L]=Bt[_]=Bt[_e]=Bt[De]=Bt[ke]=Bt[xe]=Bt[je]=Bt[ce]=Bt[me]=Bt[Me]=Bt[ye]=Bt[Ie]=Bt[Ce]=Bt[ge]=Bt[We]=Bt[He]=Bt[dt]=Bt[mt]=!0,Bt[re]=Bt[se]=Bt[Ae]=!1;var G={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},te={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},pe={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ue={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kt=parseFloat,vt=parseInt,Gt=typeof t=="object"&&t&&t.Object===Object&&t,cr=typeof self=="object"&&self&&self.Object===Object&&self,Dt=Gt||cr||Function("return this")(),Ht=e&&!e.nodeType&&e,nr=Ht&&!0&&r&&!r.nodeType&&r,Jr=nr&&nr.exports===Ht,hr=Jr&&Gt.process,Jt=function(){try{var ee=nr&&nr.require&&nr.require("util").types;return ee||hr&&hr.binding&&hr.binding("util")}catch{}}(),Br=Jt&&Jt.isArrayBuffer,Ki=Jt&&Jt.isDate,_i=Jt&&Jt.isMap,fn=Jt&&Jt.isRegExp,to=Jt&&Jt.isSet,As=Jt&&Jt.isTypedArray;function gr(ee,he,oe){switch(oe.length){case 0:return ee.call(he);case 1:return ee.call(he,oe[0]);case 2:return ee.call(he,oe[0],oe[1]);case 3:return ee.call(he,oe[0],oe[1],oe[2])}return ee.apply(he,oe)}function mm(ee,he,oe,ze){for(var lt=-1,Tt=ee==null?0:ee.length;++lt<Tt;){var dr=ee[lt];he(ze,dr,oe(dr),ee)}return ze}function xi(ee,he){for(var oe=-1,ze=ee==null?0:ee.length;++oe<ze&&he(ee[oe],oe,ee)!==!1;);return ee}function ym(ee,he){for(var oe=ee==null?0:ee.length;oe--&&he(ee[oe],oe,ee)!==!1;);return ee}function Ed(ee,he){for(var oe=-1,ze=ee==null?0:ee.length;++oe<ze;)if(!he(ee[oe],oe,ee))return!1;return!0}function Zn(ee,he){for(var oe=-1,ze=ee==null?0:ee.length,lt=0,Tt=[];++oe<ze;){var dr=ee[oe];he(dr,oe,ee)&&(Tt[lt++]=dr)}return Tt}function Sf(ee,he){var oe=ee==null?0:ee.length;return!!oe&&ca(ee,he,0)>-1}function Ah(ee,he,oe){for(var ze=-1,lt=ee==null?0:ee.length;++ze<lt;)if(oe(he,ee[ze]))return!0;return!1}function Xt(ee,he){for(var oe=-1,ze=ee==null?0:ee.length,lt=Array(ze);++oe<ze;)lt[oe]=he(ee[oe],oe,ee);return lt}function Qn(ee,he){for(var oe=-1,ze=he.length,lt=ee.length;++oe<ze;)ee[lt+oe]=he[oe];return ee}function Ph(ee,he,oe,ze){var lt=-1,Tt=ee==null?0:ee.length;for(ze&&Tt&&(oe=ee[++lt]);++lt<Tt;)oe=he(oe,ee[lt],lt,ee);return oe}function wm(ee,he,oe,ze){var lt=ee==null?0:ee.length;for(ze&&lt&&(oe=ee[--lt]);lt--;)oe=he(oe,ee[lt],lt,ee);return oe}function Dh(ee,he){for(var oe=-1,ze=ee==null?0:ee.length;++oe<ze;)if(he(ee[oe],oe,ee))return!0;return!1}var _m=Oh("length");function xm(ee){return ee.split("")}function Em(ee){return ee.match(Ct)||[]}function Sd(ee,he,oe){var ze;return oe(ee,function(lt,Tt,dr){if(he(lt,Tt,dr))return ze=Tt,!1}),ze}function Mf(ee,he,oe,ze){for(var lt=ee.length,Tt=oe+(ze?1:-1);ze?Tt--:++Tt<lt;)if(he(ee[Tt],Tt,ee))return Tt;return-1}function ca(ee,he,oe){return he===he?$m(ee,he,oe):Mf(ee,Md,oe)}function Sm(ee,he,oe,ze){for(var lt=oe-1,Tt=ee.length;++lt<Tt;)if(ze(ee[lt],he))return lt;return-1}function Md(ee){return ee!==ee}function Id(ee,he){var oe=ee==null?0:ee.length;return oe?Ch(ee,he)/oe:E}function Oh(ee){return function(he){return he==null?i:he[ee]}}function Rh(ee){return function(he){return ee==null?i:ee[he]}}function Ad(ee,he,oe,ze,lt){return lt(ee,function(Tt,dr,Kt){oe=ze?(ze=!1,Tt):he(oe,Tt,dr,Kt)}),oe}function Mm(ee,he){var oe=ee.length;for(ee.sort(he);oe--;)ee[oe]=ee[oe].value;return ee}function Ch(ee,he){for(var oe,ze=-1,lt=ee.length;++ze<lt;){var Tt=he(ee[ze]);Tt!==i&&(oe=oe===i?Tt:oe+Tt)}return oe}function Nh(ee,he){for(var oe=-1,ze=Array(ee);++oe<ee;)ze[oe]=he(oe);return ze}function Im(ee,he){return Xt(he,function(oe){return[oe,ee[oe]]})}function Pd(ee){return ee&&ee.slice(0,Cd(ee)+1).replace(qe,"")}function fi(ee){return function(he){return ee(he)}}function Th(ee,he){return Xt(he,function(oe){return ee[oe]})}function ro(ee,he){return ee.has(he)}function Dd(ee,he){for(var oe=-1,ze=ee.length;++oe<ze&&ca(he,ee[oe],0)>-1;);return oe}function Od(ee,he){for(var oe=ee.length;oe--&&ca(he,ee[oe],0)>-1;);return oe}function Am(ee,he){for(var oe=ee.length,ze=0;oe--;)ee[oe]===he&&++ze;return ze}var Pm=Rh(G),Dm=Rh(te);function Om(ee){return"\\"+Ue[ee]}function Rm(ee,he){return ee==null?i:ee[he]}function ha(ee){return xf.test(ee)}function Cm(ee){return Is.test(ee)}function Nm(ee){for(var he,oe=[];!(he=ee.next()).done;)oe.push(he.value);return oe}function $h(ee){var he=-1,oe=Array(ee.size);return ee.forEach(function(ze,lt){oe[++he]=[lt,ze]}),oe}function Rd(ee,he){return function(oe){return ee(he(oe))}}function es(ee,he){for(var oe=-1,ze=ee.length,lt=0,Tt=[];++oe<ze;){var dr=ee[oe];(dr===he||dr===w)&&(ee[oe]=w,Tt[lt++]=oe)}return Tt}function If(ee){var he=-1,oe=Array(ee.size);return ee.forEach(function(ze){oe[++he]=ze}),oe}function Tm(ee){var he=-1,oe=Array(ee.size);return ee.forEach(function(ze){oe[++he]=[ze,ze]}),oe}function $m(ee,he,oe){for(var ze=oe-1,lt=ee.length;++ze<lt;)if(ee[ze]===he)return ze;return-1}function Lm(ee,he,oe){for(var ze=oe+1;ze--;)if(ee[ze]===he)return ze;return ze}function ua(ee){return ha(ee)?Um(ee):_m(ee)}function ji(ee){return ha(ee)?Bm(ee):xm(ee)}function Cd(ee){for(var he=ee.length;he--&&st.test(ee.charAt(he)););return he}var qm=Rh(pe);function Um(ee){for(var he=fa.lastIndex=0;fa.test(ee);)++he;return he}function Bm(ee){return ee.match(fa)||[]}function zm(ee){return ee.match(_f)||[]}var Fm=function ee(he){he=he==null?Dt:la.defaults(Dt.Object(),he,la.pick(Dt,Ef));var oe=he.Array,ze=he.Date,lt=he.Error,Tt=he.Function,dr=he.Math,Kt=he.Object,Lh=he.RegExp,km=he.String,Ei=he.TypeError,Af=oe.prototype,Hm=Tt.prototype,da=Kt.prototype,Pf=he["__core-js_shared__"],Df=Hm.toString,qt=da.hasOwnProperty,Km=0,Nd=function(){var s=/[^.]+$/.exec(Pf&&Pf.keys&&Pf.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Of=da.toString,jm=Df.call(Kt),Wm=Dt._,Vm=Lh("^"+Df.call(qt).replace(tt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rf=Jr?he.Buffer:i,ts=he.Symbol,Cf=he.Uint8Array,Td=Rf?Rf.allocUnsafe:i,Nf=Rd(Kt.getPrototypeOf,Kt),$d=Kt.create,Ld=da.propertyIsEnumerable,Tf=Af.splice,qd=ts?ts.isConcatSpreadable:i,io=ts?ts.iterator:i,Ps=ts?ts.toStringTag:i,$f=function(){try{var s=Ns(Kt,"defineProperty");return s({},"",{}),s}catch{}}(),Gm=he.clearTimeout!==Dt.clearTimeout&&he.clearTimeout,Jm=ze&&ze.now!==Dt.Date.now&&ze.now,Ym=he.setTimeout!==Dt.setTimeout&&he.setTimeout,Lf=dr.ceil,qf=dr.floor,qh=Kt.getOwnPropertySymbols,Xm=Rf?Rf.isBuffer:i,Ud=he.isFinite,Zm=Af.join,Qm=Rd(Kt.keys,Kt),pr=dr.max,Tr=dr.min,ey=ze.now,ty=he.parseInt,Bd=dr.random,ry=Af.reverse,Uh=Ns(he,"DataView"),no=Ns(he,"Map"),Bh=Ns(he,"Promise"),pa=Ns(he,"Set"),so=Ns(he,"WeakMap"),ao=Ns(Kt,"create"),Uf=so&&new so,va={},iy=Ts(Uh),ny=Ts(no),sy=Ts(Bh),ay=Ts(pa),oy=Ts(so),Bf=ts?ts.prototype:i,oo=Bf?Bf.valueOf:i,zd=Bf?Bf.toString:i;function $(s){if(er(s)&&!gt(s)&&!(s instanceof At)){if(s instanceof Si)return s;if(qt.call(s,"__wrapped__"))return F0(s)}return new Si(s)}var ga=function(){function s(){}return function(o){if(!Zt(o))return{};if($d)return $d(o);s.prototype=o;var l=new s;return s.prototype=i,l}}();function zf(){}function Si(s,o){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=i}$.templateSettings={escape:Qe,evaluate:et,interpolate:Le,variable:"",imports:{_:$}},$.prototype=zf.prototype,$.prototype.constructor=$,Si.prototype=ga(zf.prototype),Si.prototype.constructor=Si;function At(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=x,this.__views__=[]}function fy(){var s=new At(this.__wrapped__);return s.__actions__=Yr(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=Yr(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=Yr(this.__views__),s}function cy(){if(this.__filtered__){var s=new At(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function hy(){var s=this.__wrapped__.value(),o=this.__dir__,l=gt(s),I=o<0,N=l?s.length:0,z=x2(0,N,this.__views__),Z=z.start,Q=z.end,ie=Q-Z,ue=I?Q:Z-1,le=this.__iteratees__,ve=le.length,Pe=0,Ve=Tr(ie,this.__takeCount__);if(!l||!I&&N==ie&&Ve==ie)return h0(s,this.__actions__);var ot=[];e:for(;ie--&&Pe<Ve;){ue+=o;for(var xt=-1,ft=s[ue];++xt<ve;){var Mt=le[xt],Ot=Mt.iteratee,ui=Mt.type,kr=Ot(ft);if(ui==y)ft=kr;else if(!kr){if(ui==u)continue e;break e}}ot[Pe++]=ft}return ot}At.prototype=ga(zf.prototype),At.prototype.constructor=At;function Ds(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var I=s[o];this.set(I[0],I[1])}}function uy(){this.__data__=ao?ao(null):{},this.size=0}function ly(s){var o=this.has(s)&&delete this.__data__[s];return this.size-=o?1:0,o}function dy(s){var o=this.__data__;if(ao){var l=o[s];return l===p?i:l}return qt.call(o,s)?o[s]:i}function py(s){var o=this.__data__;return ao?o[s]!==i:qt.call(o,s)}function vy(s,o){var l=this.__data__;return this.size+=this.has(s)?0:1,l[s]=ao&&o===i?p:o,this}Ds.prototype.clear=uy,Ds.prototype.delete=ly,Ds.prototype.get=dy,Ds.prototype.has=py,Ds.prototype.set=vy;function Rn(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var I=s[o];this.set(I[0],I[1])}}function gy(){this.__data__=[],this.size=0}function by(s){var o=this.__data__,l=Ff(o,s);if(l<0)return!1;var I=o.length-1;return l==I?o.pop():Tf.call(o,l,1),--this.size,!0}function my(s){var o=this.__data__,l=Ff(o,s);return l<0?i:o[l][1]}function yy(s){return Ff(this.__data__,s)>-1}function wy(s,o){var l=this.__data__,I=Ff(l,s);return I<0?(++this.size,l.push([s,o])):l[I][1]=o,this}Rn.prototype.clear=gy,Rn.prototype.delete=by,Rn.prototype.get=my,Rn.prototype.has=yy,Rn.prototype.set=wy;function Cn(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var I=s[o];this.set(I[0],I[1])}}function _y(){this.size=0,this.__data__={hash:new Ds,map:new(no||Rn),string:new Ds}}function xy(s){var o=Qf(this,s).delete(s);return this.size-=o?1:0,o}function Ey(s){return Qf(this,s).get(s)}function Sy(s){return Qf(this,s).has(s)}function My(s,o){var l=Qf(this,s),I=l.size;return l.set(s,o),this.size+=l.size==I?0:1,this}Cn.prototype.clear=_y,Cn.prototype.delete=xy,Cn.prototype.get=Ey,Cn.prototype.has=Sy,Cn.prototype.set=My;function Os(s){var o=-1,l=s==null?0:s.length;for(this.__data__=new Cn;++o<l;)this.add(s[o])}function Iy(s){return this.__data__.set(s,p),this}function Ay(s){return this.__data__.has(s)}Os.prototype.add=Os.prototype.push=Iy,Os.prototype.has=Ay;function Wi(s){var o=this.__data__=new Rn(s);this.size=o.size}function Py(){this.__data__=new Rn,this.size=0}function Dy(s){var o=this.__data__,l=o.delete(s);return this.size=o.size,l}function Oy(s){return this.__data__.get(s)}function Ry(s){return this.__data__.has(s)}function Cy(s,o){var l=this.__data__;if(l instanceof Rn){var I=l.__data__;if(!no||I.length<a-1)return I.push([s,o]),this.size=++l.size,this;l=this.__data__=new Cn(I)}return l.set(s,o),this.size=l.size,this}Wi.prototype.clear=Py,Wi.prototype.delete=Dy,Wi.prototype.get=Oy,Wi.prototype.has=Ry,Wi.prototype.set=Cy;function Fd(s,o){var l=gt(s),I=!l&&$s(s),N=!l&&!I&&as(s),z=!l&&!I&&!N&&wa(s),Z=l||I||N||z,Q=Z?Nh(s.length,km):[],ie=Q.length;for(var ue in s)(o||qt.call(s,ue))&&!(Z&&(ue=="length"||N&&(ue=="offset"||ue=="parent")||z&&(ue=="buffer"||ue=="byteLength"||ue=="byteOffset")||Ln(ue,ie)))&&Q.push(ue);return Q}function kd(s){var o=s.length;return o?s[Yh(0,o-1)]:i}function Ny(s,o){return ec(Yr(s),Rs(o,0,s.length))}function Ty(s){return ec(Yr(s))}function zh(s,o,l){(l!==i&&!Vi(s[o],l)||l===i&&!(o in s))&&Nn(s,o,l)}function fo(s,o,l){var I=s[o];(!(qt.call(s,o)&&Vi(I,l))||l===i&&!(o in s))&&Nn(s,o,l)}function Ff(s,o){for(var l=s.length;l--;)if(Vi(s[l][0],o))return l;return-1}function $y(s,o,l,I){return rs(s,function(N,z,Z){o(I,N,l(N),Z)}),I}function Hd(s,o){return s&&hn(o,br(o),s)}function Ly(s,o){return s&&hn(o,Zr(o),s)}function Nn(s,o,l){o=="__proto__"&&$f?$f(s,o,{configurable:!0,enumerable:!0,value:l,writable:!0}):s[o]=l}function Fh(s,o){for(var l=-1,I=o.length,N=oe(I),z=s==null;++l<I;)N[l]=z?i:_u(s,o[l]);return N}function Rs(s,o,l){return s===s&&(l!==i&&(s=s<=l?s:l),o!==i&&(s=s>=o?s:o)),s}function Mi(s,o,l,I,N,z){var Z,Q=o&R,ie=o&O,ue=o&C;if(l&&(Z=N?l(s,I,N,z):l(s)),Z!==i)return Z;if(!Zt(s))return s;var le=gt(s);if(le){if(Z=S2(s),!Q)return Yr(s,Z)}else{var ve=$r(s),Pe=ve==se||ve==we;if(as(s))return d0(s,Q);if(ve==Me||ve==D||Pe&&!N){if(Z=ie||Pe?{}:C0(s),!Q)return ie?d2(s,Ly(Z,s)):l2(s,Hd(Z,s))}else{if(!Bt[ve])return N?s:{};Z=M2(s,ve,Q)}}z||(z=new Wi);var Ve=z.get(s);if(Ve)return Ve;z.set(s,Z),op(s)?s.forEach(function(ft){Z.add(Mi(ft,o,l,ft,s,z))}):sp(s)&&s.forEach(function(ft,Mt){Z.set(Mt,Mi(ft,o,l,Mt,s,z))});var ot=ue?ie?ou:au:ie?Zr:br,xt=le?i:ot(s);return xi(xt||s,function(ft,Mt){xt&&(Mt=ft,ft=s[Mt]),fo(Z,Mt,Mi(ft,o,l,Mt,s,z))}),Z}function qy(s){var o=br(s);return function(l){return Kd(l,s,o)}}function Kd(s,o,l){var I=l.length;if(s==null)return!I;for(s=Kt(s);I--;){var N=l[I],z=o[N],Z=s[N];if(Z===i&&!(N in s)||!z(Z))return!1}return!0}function jd(s,o,l){if(typeof s!="function")throw new Ei(h);return go(function(){s.apply(i,l)},o)}function co(s,o,l,I){var N=-1,z=Sf,Z=!0,Q=s.length,ie=[],ue=o.length;if(!Q)return ie;l&&(o=Xt(o,fi(l))),I?(z=Ah,Z=!1):o.length>=a&&(z=ro,Z=!1,o=new Os(o));e:for(;++N<Q;){var le=s[N],ve=l==null?le:l(le);if(le=I||le!==0?le:0,Z&&ve===ve){for(var Pe=ue;Pe--;)if(o[Pe]===ve)continue e;ie.push(le)}else z(o,ve,I)||ie.push(le)}return ie}var rs=m0(cn),Wd=m0(Hh,!0);function Uy(s,o){var l=!0;return rs(s,function(I,N,z){return l=!!o(I,N,z),l}),l}function kf(s,o,l){for(var I=-1,N=s.length;++I<N;){var z=s[I],Z=o(z);if(Z!=null&&(Q===i?Z===Z&&!hi(Z):l(Z,Q)))var Q=Z,ie=z}return ie}function By(s,o,l,I){var N=s.length;for(l=_t(l),l<0&&(l=-l>N?0:N+l),I=I===i||I>N?N:_t(I),I<0&&(I+=N),I=l>I?0:cp(I);l<I;)s[l++]=o;return s}function Vd(s,o){var l=[];return rs(s,function(I,N,z){o(I,N,z)&&l.push(I)}),l}function Sr(s,o,l,I,N){var z=-1,Z=s.length;for(l||(l=A2),N||(N=[]);++z<Z;){var Q=s[z];o>0&&l(Q)?o>1?Sr(Q,o-1,l,I,N):Qn(N,Q):I||(N[N.length]=Q)}return N}var kh=y0(),Gd=y0(!0);function cn(s,o){return s&&kh(s,o,br)}function Hh(s,o){return s&&Gd(s,o,br)}function Hf(s,o){return Zn(o,function(l){return qn(s[l])})}function Cs(s,o){o=ns(o,s);for(var l=0,I=o.length;s!=null&&l<I;)s=s[un(o[l++])];return l&&l==I?s:i}function Jd(s,o,l){var I=o(s);return gt(s)?I:Qn(I,l(s))}function zr(s){return s==null?s===i?$e:Ke:Ps&&Ps in Kt(s)?_2(s):T2(s)}function Kh(s,o){return s>o}function zy(s,o){return s!=null&&qt.call(s,o)}function Fy(s,o){return s!=null&&o in Kt(s)}function ky(s,o,l){return s>=Tr(o,l)&&s<pr(o,l)}function jh(s,o,l){for(var I=l?Ah:Sf,N=s[0].length,z=s.length,Z=z,Q=oe(z),ie=1/0,ue=[];Z--;){var le=s[Z];Z&&o&&(le=Xt(le,fi(o))),ie=Tr(le.length,ie),Q[Z]=!l&&(o||N>=120&&le.length>=120)?new Os(Z&&le):i}le=s[0];var ve=-1,Pe=Q[0];e:for(;++ve<N&&ue.length<ie;){var Ve=le[ve],ot=o?o(Ve):Ve;if(Ve=l||Ve!==0?Ve:0,!(Pe?ro(Pe,ot):I(ue,ot,l))){for(Z=z;--Z;){var xt=Q[Z];if(!(xt?ro(xt,ot):I(s[Z],ot,l)))continue e}Pe&&Pe.push(ot),ue.push(Ve)}}return ue}function Hy(s,o,l,I){return cn(s,function(N,z,Z){o(I,l(N),z,Z)}),I}function ho(s,o,l){o=ns(o,s),s=L0(s,o);var I=s==null?s:s[un(Ai(o))];return I==null?i:gr(I,s,l)}function Yd(s){return er(s)&&zr(s)==D}function Ky(s){return er(s)&&zr(s)==Oe}function jy(s){return er(s)&&zr(s)==_}function uo(s,o,l,I,N){return s===o?!0:s==null||o==null||!er(s)&&!er(o)?s!==s&&o!==o:Wy(s,o,l,I,uo,N)}function Wy(s,o,l,I,N,z){var Z=gt(s),Q=gt(o),ie=Z?F:$r(s),ue=Q?F:$r(o);ie=ie==D?Me:ie,ue=ue==D?Me:ue;var le=ie==Me,ve=ue==Me,Pe=ie==ue;if(Pe&&as(s)){if(!as(o))return!1;Z=!0,le=!1}if(Pe&&!le)return z||(z=new Wi),Z||wa(s)?D0(s,o,l,I,N,z):y2(s,o,ie,l,I,N,z);if(!(l&q)){var Ve=le&&qt.call(s,"__wrapped__"),ot=ve&&qt.call(o,"__wrapped__");if(Ve||ot){var xt=Ve?s.value():s,ft=ot?o.value():o;return z||(z=new Wi),N(xt,ft,l,I,z)}}return Pe?(z||(z=new Wi),w2(s,o,l,I,N,z)):!1}function Vy(s){return er(s)&&$r(s)==ce}function Wh(s,o,l,I){var N=l.length,z=N,Z=!I;if(s==null)return!z;for(s=Kt(s);N--;){var Q=l[N];if(Z&&Q[2]?Q[1]!==s[Q[0]]:!(Q[0]in s))return!1}for(;++N<z;){Q=l[N];var ie=Q[0],ue=s[ie],le=Q[1];if(Z&&Q[2]){if(ue===i&&!(ie in s))return!1}else{var ve=new Wi;if(I)var Pe=I(ue,le,ie,s,o,ve);if(!(Pe===i?uo(le,ue,q|V,I,ve):Pe))return!1}}return!0}function Xd(s){if(!Zt(s)||D2(s))return!1;var o=qn(s)?Vm:Rr;return o.test(Ts(s))}function Gy(s){return er(s)&&zr(s)==ye}function Jy(s){return er(s)&&$r(s)==Ie}function Yy(s){return er(s)&&ac(s.length)&&!!Ft[zr(s)]}function Zd(s){return typeof s=="function"?s:s==null?Qr:typeof s=="object"?gt(s)?t0(s[0],s[1]):e0(s):wp(s)}function Vh(s){if(!vo(s))return Qm(s);var o=[];for(var l in Kt(s))qt.call(s,l)&&l!="constructor"&&o.push(l);return o}function Xy(s){if(!Zt(s))return N2(s);var o=vo(s),l=[];for(var I in s)I=="constructor"&&(o||!qt.call(s,I))||l.push(I);return l}function Gh(s,o){return s<o}function Qd(s,o){var l=-1,I=Xr(s)?oe(s.length):[];return rs(s,function(N,z,Z){I[++l]=o(N,z,Z)}),I}function e0(s){var o=cu(s);return o.length==1&&o[0][2]?T0(o[0][0],o[0][1]):function(l){return l===s||Wh(l,s,o)}}function t0(s,o){return uu(s)&&N0(o)?T0(un(s),o):function(l){var I=_u(l,s);return I===i&&I===o?xu(l,s):uo(o,I,q|V)}}function Kf(s,o,l,I,N){s!==o&&kh(o,function(z,Z){if(N||(N=new Wi),Zt(z))Zy(s,o,Z,l,Kf,I,N);else{var Q=I?I(du(s,Z),z,Z+"",s,o,N):i;Q===i&&(Q=z),zh(s,Z,Q)}},Zr)}function Zy(s,o,l,I,N,z,Z){var Q=du(s,l),ie=du(o,l),ue=Z.get(ie);if(ue){zh(s,l,ue);return}var le=z?z(Q,ie,l+"",s,o,Z):i,ve=le===i;if(ve){var Pe=gt(ie),Ve=!Pe&&as(ie),ot=!Pe&&!Ve&&wa(ie);le=ie,Pe||Ve||ot?gt(Q)?le=Q:sr(Q)?le=Yr(Q):Ve?(ve=!1,le=d0(ie,!0)):ot?(ve=!1,le=p0(ie,!0)):le=[]:bo(ie)||$s(ie)?(le=Q,$s(Q)?le=hp(Q):(!Zt(Q)||qn(Q))&&(le=C0(ie))):ve=!1}ve&&(Z.set(ie,le),N(le,ie,I,z,Z),Z.delete(ie)),zh(s,l,le)}function r0(s,o){var l=s.length;if(l)return o+=o<0?l:0,Ln(o,l)?s[o]:i}function i0(s,o,l){o.length?o=Xt(o,function(z){return gt(z)?function(Z){return Cs(Z,z.length===1?z[0]:z)}:z}):o=[Qr];var I=-1;o=Xt(o,fi(it()));var N=Qd(s,function(z,Z,Q){var ie=Xt(o,function(ue){return ue(z)});return{criteria:ie,index:++I,value:z}});return Mm(N,function(z,Z){return u2(z,Z,l)})}function Qy(s,o){return n0(s,o,function(l,I){return xu(s,I)})}function n0(s,o,l){for(var I=-1,N=o.length,z={};++I<N;){var Z=o[I],Q=Cs(s,Z);l(Q,Z)&&lo(z,ns(Z,s),Q)}return z}function e2(s){return function(o){return Cs(o,s)}}function Jh(s,o,l,I){var N=I?Sm:ca,z=-1,Z=o.length,Q=s;for(s===o&&(o=Yr(o)),l&&(Q=Xt(s,fi(l)));++z<Z;)for(var ie=0,ue=o[z],le=l?l(ue):ue;(ie=N(Q,le,ie,I))>-1;)Q!==s&&Tf.call(Q,ie,1),Tf.call(s,ie,1);return s}function s0(s,o){for(var l=s?o.length:0,I=l-1;l--;){var N=o[l];if(l==I||N!==z){var z=N;Ln(N)?Tf.call(s,N,1):Qh(s,N)}}return s}function Yh(s,o){return s+qf(Bd()*(o-s+1))}function t2(s,o,l,I){for(var N=-1,z=pr(Lf((o-s)/(l||1)),0),Z=oe(z);z--;)Z[I?z:++N]=s,s+=l;return Z}function Xh(s,o){var l="";if(!s||o<1||o>S)return l;do o%2&&(l+=s),o=qf(o/2),o&&(s+=s);while(o);return l}function Et(s,o){return pu($0(s,o,Qr),s+"")}function r2(s){return kd(_a(s))}function i2(s,o){var l=_a(s);return ec(l,Rs(o,0,l.length))}function lo(s,o,l,I){if(!Zt(s))return s;o=ns(o,s);for(var N=-1,z=o.length,Z=z-1,Q=s;Q!=null&&++N<z;){var ie=un(o[N]),ue=l;if(ie==="__proto__"||ie==="constructor"||ie==="prototype")return s;if(N!=Z){var le=Q[ie];ue=I?I(le,ie,Q):i,ue===i&&(ue=Zt(le)?le:Ln(o[N+1])?[]:{})}fo(Q,ie,ue),Q=Q[ie]}return s}var a0=Uf?function(s,o){return Uf.set(s,o),s}:Qr,n2=$f?function(s,o){return $f(s,"toString",{configurable:!0,enumerable:!1,value:Su(o),writable:!0})}:Qr;function s2(s){return ec(_a(s))}function Ii(s,o,l){var I=-1,N=s.length;o<0&&(o=-o>N?0:N+o),l=l>N?N:l,l<0&&(l+=N),N=o>l?0:l-o>>>0,o>>>=0;for(var z=oe(N);++I<N;)z[I]=s[I+o];return z}function a2(s,o){var l;return rs(s,function(I,N,z){return l=o(I,N,z),!l}),!!l}function jf(s,o,l){var I=0,N=s==null?I:s.length;if(typeof o=="number"&&o===o&&N<=ne){for(;I<N;){var z=I+N>>>1,Z=s[z];Z!==null&&!hi(Z)&&(l?Z<=o:Z<o)?I=z+1:N=z}return N}return Zh(s,o,Qr,l)}function Zh(s,o,l,I){var N=0,z=s==null?0:s.length;if(z===0)return 0;o=l(o);for(var Z=o!==o,Q=o===null,ie=hi(o),ue=o===i;N<z;){var le=qf((N+z)/2),ve=l(s[le]),Pe=ve!==i,Ve=ve===null,ot=ve===ve,xt=hi(ve);if(Z)var ft=I||ot;else ue?ft=ot&&(I||Pe):Q?ft=ot&&Pe&&(I||!Ve):ie?ft=ot&&Pe&&!Ve&&(I||!xt):Ve||xt?ft=!1:ft=I?ve<=o:ve<o;ft?N=le+1:z=le}return Tr(z,T)}function o0(s,o){for(var l=-1,I=s.length,N=0,z=[];++l<I;){var Z=s[l],Q=o?o(Z):Z;if(!l||!Vi(Q,ie)){var ie=Q;z[N++]=Z===0?0:Z}}return z}function f0(s){return typeof s=="number"?s:hi(s)?E:+s}function ci(s){if(typeof s=="string")return s;if(gt(s))return Xt(s,ci)+"";if(hi(s))return zd?zd.call(s):"";var o=s+"";return o=="0"&&1/s==-P?"-0":o}function is(s,o,l){var I=-1,N=Sf,z=s.length,Z=!0,Q=[],ie=Q;if(l)Z=!1,N=Ah;else if(z>=a){var ue=o?null:b2(s);if(ue)return If(ue);Z=!1,N=ro,ie=new Os}else ie=o?[]:Q;e:for(;++I<z;){var le=s[I],ve=o?o(le):le;if(le=l||le!==0?le:0,Z&&ve===ve){for(var Pe=ie.length;Pe--;)if(ie[Pe]===ve)continue e;o&&ie.push(ve),Q.push(le)}else N(ie,ve,l)||(ie!==Q&&ie.push(ve),Q.push(le))}return Q}function Qh(s,o){return o=ns(o,s),s=L0(s,o),s==null||delete s[un(Ai(o))]}function c0(s,o,l,I){return lo(s,o,l(Cs(s,o)),I)}function Wf(s,o,l,I){for(var N=s.length,z=I?N:-1;(I?z--:++z<N)&&o(s[z],z,s););return l?Ii(s,I?0:z,I?z+1:N):Ii(s,I?z+1:0,I?N:z)}function h0(s,o){var l=s;return l instanceof At&&(l=l.value()),Ph(o,function(I,N){return N.func.apply(N.thisArg,Qn([I],N.args))},l)}function eu(s,o,l){var I=s.length;if(I<2)return I?is(s[0]):[];for(var N=-1,z=oe(I);++N<I;)for(var Z=s[N],Q=-1;++Q<I;)Q!=N&&(z[N]=co(z[N]||Z,s[Q],o,l));return is(Sr(z,1),o,l)}function u0(s,o,l){for(var I=-1,N=s.length,z=o.length,Z={};++I<N;){var Q=I<z?o[I]:i;l(Z,s[I],Q)}return Z}function tu(s){return sr(s)?s:[]}function ru(s){return typeof s=="function"?s:Qr}function ns(s,o){return gt(s)?s:uu(s,o)?[s]:z0($t(s))}var o2=Et;function ss(s,o,l){var I=s.length;return l=l===i?I:l,!o&&l>=I?s:Ii(s,o,l)}var l0=Gm||function(s){return Dt.clearTimeout(s)};function d0(s,o){if(o)return s.slice();var l=s.length,I=Td?Td(l):new s.constructor(l);return s.copy(I),I}function iu(s){var o=new s.constructor(s.byteLength);return new Cf(o).set(new Cf(s)),o}function f2(s,o){var l=o?iu(s.buffer):s.buffer;return new s.constructor(l,s.byteOffset,s.byteLength)}function c2(s){var o=new s.constructor(s.source,yt.exec(s));return o.lastIndex=s.lastIndex,o}function h2(s){return oo?Kt(oo.call(s)):{}}function p0(s,o){var l=o?iu(s.buffer):s.buffer;return new s.constructor(l,s.byteOffset,s.length)}function v0(s,o){if(s!==o){var l=s!==i,I=s===null,N=s===s,z=hi(s),Z=o!==i,Q=o===null,ie=o===o,ue=hi(o);if(!Q&&!ue&&!z&&s>o||z&&Z&&ie&&!Q&&!ue||I&&Z&&ie||!l&&ie||!N)return 1;if(!I&&!z&&!ue&&s<o||ue&&l&&N&&!I&&!z||Q&&l&&N||!Z&&N||!ie)return-1}return 0}function u2(s,o,l){for(var I=-1,N=s.criteria,z=o.criteria,Z=N.length,Q=l.length;++I<Z;){var ie=v0(N[I],z[I]);if(ie){if(I>=Q)return ie;var ue=l[I];return ie*(ue=="desc"?-1:1)}}return s.index-o.index}function g0(s,o,l,I){for(var N=-1,z=s.length,Z=l.length,Q=-1,ie=o.length,ue=pr(z-Z,0),le=oe(ie+ue),ve=!I;++Q<ie;)le[Q]=o[Q];for(;++N<Z;)(ve||N<z)&&(le[l[N]]=s[N]);for(;ue--;)le[Q++]=s[N++];return le}function b0(s,o,l,I){for(var N=-1,z=s.length,Z=-1,Q=l.length,ie=-1,ue=o.length,le=pr(z-Q,0),ve=oe(le+ue),Pe=!I;++N<le;)ve[N]=s[N];for(var Ve=N;++ie<ue;)ve[Ve+ie]=o[ie];for(;++Z<Q;)(Pe||N<z)&&(ve[Ve+l[Z]]=s[N++]);return ve}function Yr(s,o){var l=-1,I=s.length;for(o||(o=oe(I));++l<I;)o[l]=s[l];return o}function hn(s,o,l,I){var N=!l;l||(l={});for(var z=-1,Z=o.length;++z<Z;){var Q=o[z],ie=I?I(l[Q],s[Q],Q,l,s):i;ie===i&&(ie=s[Q]),N?Nn(l,Q,ie):fo(l,Q,ie)}return l}function l2(s,o){return hn(s,hu(s),o)}function d2(s,o){return hn(s,O0(s),o)}function Vf(s,o){return function(l,I){var N=gt(l)?mm:$y,z=o?o():{};return N(l,s,it(I,2),z)}}function ba(s){return Et(function(o,l){var I=-1,N=l.length,z=N>1?l[N-1]:i,Z=N>2?l[2]:i;for(z=s.length>3&&typeof z=="function"?(N--,z):i,Z&&Fr(l[0],l[1],Z)&&(z=N<3?i:z,N=1),o=Kt(o);++I<N;){var Q=l[I];Q&&s(o,Q,I,z)}return o})}function m0(s,o){return function(l,I){if(l==null)return l;if(!Xr(l))return s(l,I);for(var N=l.length,z=o?N:-1,Z=Kt(l);(o?z--:++z<N)&&I(Z[z],z,Z)!==!1;);return l}}function y0(s){return function(o,l,I){for(var N=-1,z=Kt(o),Z=I(o),Q=Z.length;Q--;){var ie=Z[s?Q:++N];if(l(z[ie],ie,z)===!1)break}return o}}function p2(s,o,l){var I=o&Y,N=po(s);function z(){var Z=this&&this!==Dt&&this instanceof z?N:s;return Z.apply(I?l:this,arguments)}return z}function w0(s){return function(o){o=$t(o);var l=ha(o)?ji(o):i,I=l?l[0]:o.charAt(0),N=l?ss(l,1).join(""):o.slice(1);return I[s]()+N}}function ma(s){return function(o){return Ph(mp(bp(o).replace(eo,"")),s,"")}}function po(s){return function(){var o=arguments;switch(o.length){case 0:return new s;case 1:return new s(o[0]);case 2:return new s(o[0],o[1]);case 3:return new s(o[0],o[1],o[2]);case 4:return new s(o[0],o[1],o[2],o[3]);case 5:return new s(o[0],o[1],o[2],o[3],o[4]);case 6:return new s(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new s(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var l=ga(s.prototype),I=s.apply(l,o);return Zt(I)?I:l}}function v2(s,o,l){var I=po(s);function N(){for(var z=arguments.length,Z=oe(z),Q=z,ie=ya(N);Q--;)Z[Q]=arguments[Q];var ue=z<3&&Z[0]!==ie&&Z[z-1]!==ie?[]:es(Z,ie);if(z-=ue.length,z<l)return M0(s,o,Gf,N.placeholder,i,Z,ue,i,i,l-z);var le=this&&this!==Dt&&this instanceof N?I:s;return gr(le,this,Z)}return N}function _0(s){return function(o,l,I){var N=Kt(o);if(!Xr(o)){var z=it(l,3);o=br(o),l=function(Q){return z(N[Q],Q,N)}}var Z=s(o,l,I);return Z>-1?N[z?o[Z]:Z]:i}}function x0(s){return $n(function(o){var l=o.length,I=l,N=Si.prototype.thru;for(s&&o.reverse();I--;){var z=o[I];if(typeof z!="function")throw new Ei(h);if(N&&!Z&&Zf(z)=="wrapper")var Z=new Si([],!0)}for(I=Z?I:l;++I<l;){z=o[I];var Q=Zf(z),ie=Q=="wrapper"?fu(z):i;ie&&lu(ie[0])&&ie[1]==(B|k|J|ae)&&!ie[4].length&&ie[9]==1?Z=Z[Zf(ie[0])].apply(Z,ie[3]):Z=z.length==1&&lu(z)?Z[Q]():Z.thru(z)}return function(){var ue=arguments,le=ue[0];if(Z&&ue.length==1&&gt(le))return Z.plant(le).value();for(var ve=0,Pe=l?o[ve].apply(this,ue):le;++ve<l;)Pe=o[ve].call(this,Pe);return Pe}})}function Gf(s,o,l,I,N,z,Z,Q,ie,ue){var le=o&B,ve=o&Y,Pe=o&H,Ve=o&(k|W),ot=o&de,xt=Pe?i:po(s);function ft(){for(var Mt=arguments.length,Ot=oe(Mt),ui=Mt;ui--;)Ot[ui]=arguments[ui];if(Ve)var kr=ya(ft),li=Am(Ot,kr);if(I&&(Ot=g0(Ot,I,N,Ve)),z&&(Ot=b0(Ot,z,Z,Ve)),Mt-=li,Ve&&Mt<ue){var ar=es(Ot,kr);return M0(s,o,Gf,ft.placeholder,l,Ot,ar,Q,ie,ue-Mt)}var Gi=ve?l:this,Bn=Pe?Gi[s]:s;return Mt=Ot.length,Q?Ot=$2(Ot,Q):ot&&Mt>1&&Ot.reverse(),le&&ie<Mt&&(Ot.length=ie),this&&this!==Dt&&this instanceof ft&&(Bn=xt||po(Bn)),Bn.apply(Gi,Ot)}return ft}function E0(s,o){return function(l,I){return Hy(l,s,o(I),{})}}function Jf(s,o){return function(l,I){var N;if(l===i&&I===i)return o;if(l!==i&&(N=l),I!==i){if(N===i)return I;typeof l=="string"||typeof I=="string"?(l=ci(l),I=ci(I)):(l=f0(l),I=f0(I)),N=s(l,I)}return N}}function nu(s){return $n(function(o){return o=Xt(o,fi(it())),Et(function(l){var I=this;return s(o,function(N){return gr(N,I,l)})})})}function Yf(s,o){o=o===i?" ":ci(o);var l=o.length;if(l<2)return l?Xh(o,s):o;var I=Xh(o,Lf(s/ua(o)));return ha(o)?ss(ji(I),0,s).join(""):I.slice(0,s)}function g2(s,o,l,I){var N=o&Y,z=po(s);function Z(){for(var Q=-1,ie=arguments.length,ue=-1,le=I.length,ve=oe(le+ie),Pe=this&&this!==Dt&&this instanceof Z?z:s;++ue<le;)ve[ue]=I[ue];for(;ie--;)ve[ue++]=arguments[++Q];return gr(Pe,N?l:this,ve)}return Z}function S0(s){return function(o,l,I){return I&&typeof I!="number"&&Fr(o,l,I)&&(l=I=i),o=Un(o),l===i?(l=o,o=0):l=Un(l),I=I===i?o<l?1:-1:Un(I),t2(o,l,I,s)}}function Xf(s){return function(o,l){return typeof o=="string"&&typeof l=="string"||(o=Pi(o),l=Pi(l)),s(o,l)}}function M0(s,o,l,I,N,z,Z,Q,ie,ue){var le=o&k,ve=le?Z:i,Pe=le?i:Z,Ve=le?z:i,ot=le?i:z;o|=le?J:M,o&=~(le?M:J),o&X||(o&=~(Y|H));var xt=[s,o,N,Ve,ve,ot,Pe,Q,ie,ue],ft=l.apply(i,xt);return lu(s)&&q0(ft,xt),ft.placeholder=I,U0(ft,s,o)}function su(s){var o=dr[s];return function(l,I){if(l=Pi(l),I=I==null?0:Tr(_t(I),292),I&&Ud(l)){var N=($t(l)+"e").split("e"),z=o(N[0]+"e"+(+N[1]+I));return N=($t(z)+"e").split("e"),+(N[0]+"e"+(+N[1]-I))}return o(l)}}var b2=pa&&1/If(new pa([,-0]))[1]==P?function(s){return new pa(s)}:Au;function I0(s){return function(o){var l=$r(o);return l==ce?$h(o):l==Ie?Tm(o):Im(o,s(o))}}function Tn(s,o,l,I,N,z,Z,Q){var ie=o&H;if(!ie&&typeof s!="function")throw new Ei(h);var ue=I?I.length:0;if(ue||(o&=~(J|M),I=N=i),Z=Z===i?Z:pr(_t(Z),0),Q=Q===i?Q:_t(Q),ue-=N?N.length:0,o&M){var le=I,ve=N;I=N=i}var Pe=ie?i:fu(s),Ve=[s,o,l,I,N,le,ve,z,Z,Q];if(Pe&&C2(Ve,Pe),s=Ve[0],o=Ve[1],l=Ve[2],I=Ve[3],N=Ve[4],Q=Ve[9]=Ve[9]===i?ie?0:s.length:pr(Ve[9]-ue,0),!Q&&o&(k|W)&&(o&=~(k|W)),!o||o==Y)var ot=p2(s,o,l);else o==k||o==W?ot=v2(s,o,Q):(o==J||o==(Y|J))&&!N.length?ot=g2(s,o,l,I):ot=Gf.apply(i,Ve);var xt=Pe?a0:q0;return U0(xt(ot,Ve),s,o)}function A0(s,o,l,I){return s===i||Vi(s,da[l])&&!qt.call(I,l)?o:s}function P0(s,o,l,I,N,z){return Zt(s)&&Zt(o)&&(z.set(o,s),Kf(s,o,i,P0,z),z.delete(o)),s}function m2(s){return bo(s)?i:s}function D0(s,o,l,I,N,z){var Z=l&q,Q=s.length,ie=o.length;if(Q!=ie&&!(Z&&ie>Q))return!1;var ue=z.get(s),le=z.get(o);if(ue&&le)return ue==o&&le==s;var ve=-1,Pe=!0,Ve=l&V?new Os:i;for(z.set(s,o),z.set(o,s);++ve<Q;){var ot=s[ve],xt=o[ve];if(I)var ft=Z?I(xt,ot,ve,o,s,z):I(ot,xt,ve,s,o,z);if(ft!==i){if(ft)continue;Pe=!1;break}if(Ve){if(!Dh(o,function(Mt,Ot){if(!ro(Ve,Ot)&&(ot===Mt||N(ot,Mt,l,I,z)))return Ve.push(Ot)})){Pe=!1;break}}else if(!(ot===xt||N(ot,xt,l,I,z))){Pe=!1;break}}return z.delete(s),z.delete(o),Pe}function y2(s,o,l,I,N,z,Z){switch(l){case Ne:if(s.byteLength!=o.byteLength||s.byteOffset!=o.byteOffset)return!1;s=s.buffer,o=o.buffer;case Oe:return!(s.byteLength!=o.byteLength||!z(new Cf(s),new Cf(o)));case L:case _:case me:return Vi(+s,+o);case re:return s.name==o.name&&s.message==o.message;case ye:case Ce:return s==o+"";case ce:var Q=$h;case Ie:var ie=I&q;if(Q||(Q=If),s.size!=o.size&&!ie)return!1;var ue=Z.get(s);if(ue)return ue==o;I|=V,Z.set(s,o);var le=D0(Q(s),Q(o),I,N,z,Z);return Z.delete(s),le;case ge:if(oo)return oo.call(s)==oo.call(o)}return!1}function w2(s,o,l,I,N,z){var Z=l&q,Q=au(s),ie=Q.length,ue=au(o),le=ue.length;if(ie!=le&&!Z)return!1;for(var ve=ie;ve--;){var Pe=Q[ve];if(!(Z?Pe in o:qt.call(o,Pe)))return!1}var Ve=z.get(s),ot=z.get(o);if(Ve&&ot)return Ve==o&&ot==s;var xt=!0;z.set(s,o),z.set(o,s);for(var ft=Z;++ve<ie;){Pe=Q[ve];var Mt=s[Pe],Ot=o[Pe];if(I)var ui=Z?I(Ot,Mt,Pe,o,s,z):I(Mt,Ot,Pe,s,o,z);if(!(ui===i?Mt===Ot||N(Mt,Ot,l,I,z):ui)){xt=!1;break}ft||(ft=Pe=="constructor")}if(xt&&!ft){var kr=s.constructor,li=o.constructor;kr!=li&&"constructor"in s&&"constructor"in o&&!(typeof kr=="function"&&kr instanceof kr&&typeof li=="function"&&li instanceof li)&&(xt=!1)}return z.delete(s),z.delete(o),xt}function $n(s){return pu($0(s,i,K0),s+"")}function au(s){return Jd(s,br,hu)}function ou(s){return Jd(s,Zr,O0)}var fu=Uf?function(s){return Uf.get(s)}:Au;function Zf(s){for(var o=s.name+"",l=va[o],I=qt.call(va,o)?l.length:0;I--;){var N=l[I],z=N.func;if(z==null||z==s)return N.name}return o}function ya(s){var o=qt.call($,"placeholder")?$:s;return o.placeholder}function it(){var s=$.iteratee||Mu;return s=s===Mu?Zd:s,arguments.length?s(arguments[0],arguments[1]):s}function Qf(s,o){var l=s.__data__;return P2(o)?l[typeof o=="string"?"string":"hash"]:l.map}function cu(s){for(var o=br(s),l=o.length;l--;){var I=o[l],N=s[I];o[l]=[I,N,N0(N)]}return o}function Ns(s,o){var l=Rm(s,o);return Xd(l)?l:i}function _2(s){var o=qt.call(s,Ps),l=s[Ps];try{s[Ps]=i;var I=!0}catch{}var N=Of.call(s);return I&&(o?s[Ps]=l:delete s[Ps]),N}var hu=qh?function(s){return s==null?[]:(s=Kt(s),Zn(qh(s),function(o){return Ld.call(s,o)}))}:Pu,O0=qh?function(s){for(var o=[];s;)Qn(o,hu(s)),s=Nf(s);return o}:Pu,$r=zr;(Uh&&$r(new Uh(new ArrayBuffer(1)))!=Ne||no&&$r(new no)!=ce||Bh&&$r(Bh.resolve())!=Je||pa&&$r(new pa)!=Ie||so&&$r(new so)!=Ae)&&($r=function(s){var o=zr(s),l=o==Me?s.constructor:i,I=l?Ts(l):"";if(I)switch(I){case iy:return Ne;case ny:return ce;case sy:return Je;case ay:return Ie;case oy:return Ae}return o});function x2(s,o,l){for(var I=-1,N=l.length;++I<N;){var z=l[I],Z=z.size;switch(z.type){case"drop":s+=Z;break;case"dropRight":o-=Z;break;case"take":o=Tr(o,s+Z);break;case"takeRight":s=pr(s,o-Z);break}}return{start:s,end:o}}function E2(s){var o=s.match(Re);return o?o[1].split(ut):[]}function R0(s,o,l){o=ns(o,s);for(var I=-1,N=o.length,z=!1;++I<N;){var Z=un(o[I]);if(!(z=s!=null&&l(s,Z)))break;s=s[Z]}return z||++I!=N?z:(N=s==null?0:s.length,!!N&&ac(N)&&Ln(Z,N)&&(gt(s)||$s(s)))}function S2(s){var o=s.length,l=new s.constructor(o);return o&&typeof s[0]=="string"&&qt.call(s,"index")&&(l.index=s.index,l.input=s.input),l}function C0(s){return typeof s.constructor=="function"&&!vo(s)?ga(Nf(s)):{}}function M2(s,o,l){var I=s.constructor;switch(o){case Oe:return iu(s);case L:case _:return new I(+s);case Ne:return f2(s,l);case _e:case De:case ke:case xe:case je:case We:case He:case dt:case mt:return p0(s,l);case ce:return new I;case me:case Ce:return new I(s);case ye:return c2(s);case Ie:return new I;case ge:return h2(s)}}function I2(s,o){var l=o.length;if(!l)return s;var I=l-1;return o[I]=(l>1?"& ":"")+o[I],o=o.join(l>2?", ":" "),s.replace(rt,`{
/* [wrapped with `+o+`] */
`)}function A2(s){return gt(s)||$s(s)||!!(qd&&s&&s[qd])}function Ln(s,o){var l=typeof s;return o=o??S,!!o&&(l=="number"||l!="symbol"&&Nr.test(s))&&s>-1&&s%1==0&&s<o}function Fr(s,o,l){if(!Zt(l))return!1;var I=typeof o;return(I=="number"?Xr(l)&&Ln(o,l.length):I=="string"&&o in l)?Vi(l[o],s):!1}function uu(s,o){if(gt(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||hi(s)?!0:ct.test(s)||!Xe.test(s)||o!=null&&s in Kt(o)}function P2(s){var o=typeof s;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?s!=="__proto__":s===null}function lu(s){var o=Zf(s),l=$[o];if(typeof l!="function"||!(o in At.prototype))return!1;if(s===l)return!0;var I=fu(l);return!!I&&s===I[0]}function D2(s){return!!Nd&&Nd in s}var O2=Pf?qn:Du;function vo(s){var o=s&&s.constructor,l=typeof o=="function"&&o.prototype||da;return s===l}function N0(s){return s===s&&!Zt(s)}function T0(s,o){return function(l){return l==null?!1:l[s]===o&&(o!==i||s in Kt(l))}}function R2(s){var o=nc(s,function(I){return l.size===b&&l.clear(),I}),l=o.cache;return o}function C2(s,o){var l=s[1],I=o[1],N=l|I,z=N<(Y|H|B),Z=I==B&&l==k||I==B&&l==ae&&s[7].length<=o[8]||I==(B|ae)&&o[7].length<=o[8]&&l==k;if(!(z||Z))return s;I&Y&&(s[2]=o[2],N|=l&Y?0:X);var Q=o[3];if(Q){var ie=s[3];s[3]=ie?g0(ie,Q,o[4]):Q,s[4]=ie?es(s[3],w):o[4]}return Q=o[5],Q&&(ie=s[5],s[5]=ie?b0(ie,Q,o[6]):Q,s[6]=ie?es(s[5],w):o[6]),Q=o[7],Q&&(s[7]=Q),I&B&&(s[8]=s[8]==null?o[8]:Tr(s[8],o[8])),s[9]==null&&(s[9]=o[9]),s[0]=o[0],s[1]=N,s}function N2(s){var o=[];if(s!=null)for(var l in Kt(s))o.push(l);return o}function T2(s){return Of.call(s)}function $0(s,o,l){return o=pr(o===i?s.length-1:o,0),function(){for(var I=arguments,N=-1,z=pr(I.length-o,0),Z=oe(z);++N<z;)Z[N]=I[o+N];N=-1;for(var Q=oe(o+1);++N<o;)Q[N]=I[N];return Q[o]=l(Z),gr(s,this,Q)}}function L0(s,o){return o.length<2?s:Cs(s,Ii(o,0,-1))}function $2(s,o){for(var l=s.length,I=Tr(o.length,l),N=Yr(s);I--;){var z=o[I];s[I]=Ln(z,l)?N[z]:i}return s}function du(s,o){if(!(o==="constructor"&&typeof s[o]=="function")&&o!="__proto__")return s[o]}var q0=B0(a0),go=Ym||function(s,o){return Dt.setTimeout(s,o)},pu=B0(n2);function U0(s,o,l){var I=o+"";return pu(s,I2(I,L2(E2(I),l)))}function B0(s){var o=0,l=0;return function(){var I=ey(),N=f-(I-l);if(l=I,N>0){if(++o>=g)return arguments[0]}else o=0;return s.apply(i,arguments)}}function ec(s,o){var l=-1,I=s.length,N=I-1;for(o=o===i?I:o;++l<o;){var z=Yh(l,N),Z=s[z];s[z]=s[l],s[l]=Z}return s.length=o,s}var z0=R2(function(s){var o=[];return s.charCodeAt(0)===46&&o.push(""),s.replace(Be,function(l,I,N,z){o.push(N?z.replace(Nt,"$1"):I||l)}),o});function un(s){if(typeof s=="string"||hi(s))return s;var o=s+"";return o=="0"&&1/s==-P?"-0":o}function Ts(s){if(s!=null){try{return Df.call(s)}catch{}try{return s+""}catch{}}return""}function L2(s,o){return xi(fe,function(l){var I="_."+l[0];o&l[1]&&!Sf(s,I)&&s.push(I)}),s.sort()}function F0(s){if(s instanceof At)return s.clone();var o=new Si(s.__wrapped__,s.__chain__);return o.__actions__=Yr(s.__actions__),o.__index__=s.__index__,o.__values__=s.__values__,o}function q2(s,o,l){(l?Fr(s,o,l):o===i)?o=1:o=pr(_t(o),0);var I=s==null?0:s.length;if(!I||o<1)return[];for(var N=0,z=0,Z=oe(Lf(I/o));N<I;)Z[z++]=Ii(s,N,N+=o);return Z}function U2(s){for(var o=-1,l=s==null?0:s.length,I=0,N=[];++o<l;){var z=s[o];z&&(N[I++]=z)}return N}function B2(){var s=arguments.length;if(!s)return[];for(var o=oe(s-1),l=arguments[0],I=s;I--;)o[I-1]=arguments[I];return Qn(gt(l)?Yr(l):[l],Sr(o,1))}var z2=Et(function(s,o){return sr(s)?co(s,Sr(o,1,sr,!0)):[]}),F2=Et(function(s,o){var l=Ai(o);return sr(l)&&(l=i),sr(s)?co(s,Sr(o,1,sr,!0),it(l,2)):[]}),k2=Et(function(s,o){var l=Ai(o);return sr(l)&&(l=i),sr(s)?co(s,Sr(o,1,sr,!0),i,l):[]});function H2(s,o,l){var I=s==null?0:s.length;return I?(o=l||o===i?1:_t(o),Ii(s,o<0?0:o,I)):[]}function K2(s,o,l){var I=s==null?0:s.length;return I?(o=l||o===i?1:_t(o),o=I-o,Ii(s,0,o<0?0:o)):[]}function j2(s,o){return s&&s.length?Wf(s,it(o,3),!0,!0):[]}function W2(s,o){return s&&s.length?Wf(s,it(o,3),!0):[]}function V2(s,o,l,I){var N=s==null?0:s.length;return N?(l&&typeof l!="number"&&Fr(s,o,l)&&(l=0,I=N),By(s,o,l,I)):[]}function k0(s,o,l){var I=s==null?0:s.length;if(!I)return-1;var N=l==null?0:_t(l);return N<0&&(N=pr(I+N,0)),Mf(s,it(o,3),N)}function H0(s,o,l){var I=s==null?0:s.length;if(!I)return-1;var N=I-1;return l!==i&&(N=_t(l),N=l<0?pr(I+N,0):Tr(N,I-1)),Mf(s,it(o,3),N,!0)}function K0(s){var o=s==null?0:s.length;return o?Sr(s,1):[]}function G2(s){var o=s==null?0:s.length;return o?Sr(s,P):[]}function J2(s,o){var l=s==null?0:s.length;return l?(o=o===i?1:_t(o),Sr(s,o)):[]}function Y2(s){for(var o=-1,l=s==null?0:s.length,I={};++o<l;){var N=s[o];I[N[0]]=N[1]}return I}function j0(s){return s&&s.length?s[0]:i}function X2(s,o,l){var I=s==null?0:s.length;if(!I)return-1;var N=l==null?0:_t(l);return N<0&&(N=pr(I+N,0)),ca(s,o,N)}function Z2(s){var o=s==null?0:s.length;return o?Ii(s,0,-1):[]}var Q2=Et(function(s){var o=Xt(s,tu);return o.length&&o[0]===s[0]?jh(o):[]}),e3=Et(function(s){var o=Ai(s),l=Xt(s,tu);return o===Ai(l)?o=i:l.pop(),l.length&&l[0]===s[0]?jh(l,it(o,2)):[]}),t3=Et(function(s){var o=Ai(s),l=Xt(s,tu);return o=typeof o=="function"?o:i,o&&l.pop(),l.length&&l[0]===s[0]?jh(l,i,o):[]});function r3(s,o){return s==null?"":Zm.call(s,o)}function Ai(s){var o=s==null?0:s.length;return o?s[o-1]:i}function i3(s,o,l){var I=s==null?0:s.length;if(!I)return-1;var N=I;return l!==i&&(N=_t(l),N=N<0?pr(I+N,0):Tr(N,I-1)),o===o?Lm(s,o,N):Mf(s,Md,N,!0)}function n3(s,o){return s&&s.length?r0(s,_t(o)):i}var s3=Et(W0);function W0(s,o){return s&&s.length&&o&&o.length?Jh(s,o):s}function a3(s,o,l){return s&&s.length&&o&&o.length?Jh(s,o,it(l,2)):s}function o3(s,o,l){return s&&s.length&&o&&o.length?Jh(s,o,i,l):s}var f3=$n(function(s,o){var l=s==null?0:s.length,I=Fh(s,o);return s0(s,Xt(o,function(N){return Ln(N,l)?+N:N}).sort(v0)),I});function c3(s,o){var l=[];if(!(s&&s.length))return l;var I=-1,N=[],z=s.length;for(o=it(o,3);++I<z;){var Z=s[I];o(Z,I,s)&&(l.push(Z),N.push(I))}return s0(s,N),l}function vu(s){return s==null?s:ry.call(s)}function h3(s,o,l){var I=s==null?0:s.length;return I?(l&&typeof l!="number"&&Fr(s,o,l)?(o=0,l=I):(o=o==null?0:_t(o),l=l===i?I:_t(l)),Ii(s,o,l)):[]}function u3(s,o){return jf(s,o)}function l3(s,o,l){return Zh(s,o,it(l,2))}function d3(s,o){var l=s==null?0:s.length;if(l){var I=jf(s,o);if(I<l&&Vi(s[I],o))return I}return-1}function p3(s,o){return jf(s,o,!0)}function v3(s,o,l){return Zh(s,o,it(l,2),!0)}function g3(s,o){var l=s==null?0:s.length;if(l){var I=jf(s,o,!0)-1;if(Vi(s[I],o))return I}return-1}function b3(s){return s&&s.length?o0(s):[]}function m3(s,o){return s&&s.length?o0(s,it(o,2)):[]}function y3(s){var o=s==null?0:s.length;return o?Ii(s,1,o):[]}function w3(s,o,l){return s&&s.length?(o=l||o===i?1:_t(o),Ii(s,0,o<0?0:o)):[]}function _3(s,o,l){var I=s==null?0:s.length;return I?(o=l||o===i?1:_t(o),o=I-o,Ii(s,o<0?0:o,I)):[]}function x3(s,o){return s&&s.length?Wf(s,it(o,3),!1,!0):[]}function E3(s,o){return s&&s.length?Wf(s,it(o,3)):[]}var S3=Et(function(s){return is(Sr(s,1,sr,!0))}),M3=Et(function(s){var o=Ai(s);return sr(o)&&(o=i),is(Sr(s,1,sr,!0),it(o,2))}),I3=Et(function(s){var o=Ai(s);return o=typeof o=="function"?o:i,is(Sr(s,1,sr,!0),i,o)});function A3(s){return s&&s.length?is(s):[]}function P3(s,o){return s&&s.length?is(s,it(o,2)):[]}function D3(s,o){return o=typeof o=="function"?o:i,s&&s.length?is(s,i,o):[]}function gu(s){if(!(s&&s.length))return[];var o=0;return s=Zn(s,function(l){if(sr(l))return o=pr(l.length,o),!0}),Nh(o,function(l){return Xt(s,Oh(l))})}function V0(s,o){if(!(s&&s.length))return[];var l=gu(s);return o==null?l:Xt(l,function(I){return gr(o,i,I)})}var O3=Et(function(s,o){return sr(s)?co(s,o):[]}),R3=Et(function(s){return eu(Zn(s,sr))}),C3=Et(function(s){var o=Ai(s);return sr(o)&&(o=i),eu(Zn(s,sr),it(o,2))}),N3=Et(function(s){var o=Ai(s);return o=typeof o=="function"?o:i,eu(Zn(s,sr),i,o)}),T3=Et(gu);function $3(s,o){return u0(s||[],o||[],fo)}function L3(s,o){return u0(s||[],o||[],lo)}var q3=Et(function(s){var o=s.length,l=o>1?s[o-1]:i;return l=typeof l=="function"?(s.pop(),l):i,V0(s,l)});function G0(s){var o=$(s);return o.__chain__=!0,o}function U3(s,o){return o(s),s}function tc(s,o){return o(s)}var B3=$n(function(s){var o=s.length,l=o?s[0]:0,I=this.__wrapped__,N=function(z){return Fh(z,s)};return o>1||this.__actions__.length||!(I instanceof At)||!Ln(l)?this.thru(N):(I=I.slice(l,+l+(o?1:0)),I.__actions__.push({func:tc,args:[N],thisArg:i}),new Si(I,this.__chain__).thru(function(z){return o&&!z.length&&z.push(i),z}))});function z3(){return G0(this)}function F3(){return new Si(this.value(),this.__chain__)}function k3(){this.__values__===i&&(this.__values__=fp(this.value()));var s=this.__index__>=this.__values__.length,o=s?i:this.__values__[this.__index__++];return{done:s,value:o}}function H3(){return this}function K3(s){for(var o,l=this;l instanceof zf;){var I=F0(l);I.__index__=0,I.__values__=i,o?N.__wrapped__=I:o=I;var N=I;l=l.__wrapped__}return N.__wrapped__=s,o}function j3(){var s=this.__wrapped__;if(s instanceof At){var o=s;return this.__actions__.length&&(o=new At(this)),o=o.reverse(),o.__actions__.push({func:tc,args:[vu],thisArg:i}),new Si(o,this.__chain__)}return this.thru(vu)}function W3(){return h0(this.__wrapped__,this.__actions__)}var V3=Vf(function(s,o,l){qt.call(s,l)?++s[l]:Nn(s,l,1)});function G3(s,o,l){var I=gt(s)?Ed:Uy;return l&&Fr(s,o,l)&&(o=i),I(s,it(o,3))}function J3(s,o){var l=gt(s)?Zn:Vd;return l(s,it(o,3))}var Y3=_0(k0),X3=_0(H0);function Z3(s,o){return Sr(rc(s,o),1)}function Q3(s,o){return Sr(rc(s,o),P)}function ew(s,o,l){return l=l===i?1:_t(l),Sr(rc(s,o),l)}function J0(s,o){var l=gt(s)?xi:rs;return l(s,it(o,3))}function Y0(s,o){var l=gt(s)?ym:Wd;return l(s,it(o,3))}var tw=Vf(function(s,o,l){qt.call(s,l)?s[l].push(o):Nn(s,l,[o])});function rw(s,o,l,I){s=Xr(s)?s:_a(s),l=l&&!I?_t(l):0;var N=s.length;return l<0&&(l=pr(N+l,0)),oc(s)?l<=N&&s.indexOf(o,l)>-1:!!N&&ca(s,o,l)>-1}var iw=Et(function(s,o,l){var I=-1,N=typeof o=="function",z=Xr(s)?oe(s.length):[];return rs(s,function(Z){z[++I]=N?gr(o,Z,l):ho(Z,o,l)}),z}),nw=Vf(function(s,o,l){Nn(s,l,o)});function rc(s,o){var l=gt(s)?Xt:Qd;return l(s,it(o,3))}function sw(s,o,l,I){return s==null?[]:(gt(o)||(o=o==null?[]:[o]),l=I?i:l,gt(l)||(l=l==null?[]:[l]),i0(s,o,l))}var aw=Vf(function(s,o,l){s[l?0:1].push(o)},function(){return[[],[]]});function ow(s,o,l){var I=gt(s)?Ph:Ad,N=arguments.length<3;return I(s,it(o,4),l,N,rs)}function fw(s,o,l){var I=gt(s)?wm:Ad,N=arguments.length<3;return I(s,it(o,4),l,N,Wd)}function cw(s,o){var l=gt(s)?Zn:Vd;return l(s,sc(it(o,3)))}function hw(s){var o=gt(s)?kd:r2;return o(s)}function uw(s,o,l){(l?Fr(s,o,l):o===i)?o=1:o=_t(o);var I=gt(s)?Ny:i2;return I(s,o)}function lw(s){var o=gt(s)?Ty:s2;return o(s)}function dw(s){if(s==null)return 0;if(Xr(s))return oc(s)?ua(s):s.length;var o=$r(s);return o==ce||o==Ie?s.size:Vh(s).length}function pw(s,o,l){var I=gt(s)?Dh:a2;return l&&Fr(s,o,l)&&(o=i),I(s,it(o,3))}var vw=Et(function(s,o){if(s==null)return[];var l=o.length;return l>1&&Fr(s,o[0],o[1])?o=[]:l>2&&Fr(o[0],o[1],o[2])&&(o=[o[0]]),i0(s,Sr(o,1),[])}),ic=Jm||function(){return Dt.Date.now()};function gw(s,o){if(typeof o!="function")throw new Ei(h);return s=_t(s),function(){if(--s<1)return o.apply(this,arguments)}}function X0(s,o,l){return o=l?i:o,o=s&&o==null?s.length:o,Tn(s,B,i,i,i,i,o)}function Z0(s,o){var l;if(typeof o!="function")throw new Ei(h);return s=_t(s),function(){return--s>0&&(l=o.apply(this,arguments)),s<=1&&(o=i),l}}var bu=Et(function(s,o,l){var I=Y;if(l.length){var N=es(l,ya(bu));I|=J}return Tn(s,I,o,l,N)}),Q0=Et(function(s,o,l){var I=Y|H;if(l.length){var N=es(l,ya(Q0));I|=J}return Tn(o,I,s,l,N)});function ep(s,o,l){o=l?i:o;var I=Tn(s,k,i,i,i,i,i,o);return I.placeholder=ep.placeholder,I}function tp(s,o,l){o=l?i:o;var I=Tn(s,W,i,i,i,i,i,o);return I.placeholder=tp.placeholder,I}function rp(s,o,l){var I,N,z,Z,Q,ie,ue=0,le=!1,ve=!1,Pe=!0;if(typeof s!="function")throw new Ei(h);o=Pi(o)||0,Zt(l)&&(le=!!l.leading,ve="maxWait"in l,z=ve?pr(Pi(l.maxWait)||0,o):z,Pe="trailing"in l?!!l.trailing:Pe);function Ve(ar){var Gi=I,Bn=N;return I=N=i,ue=ar,Z=s.apply(Bn,Gi),Z}function ot(ar){return ue=ar,Q=go(Mt,o),le?Ve(ar):Z}function xt(ar){var Gi=ar-ie,Bn=ar-ue,_p=o-Gi;return ve?Tr(_p,z-Bn):_p}function ft(ar){var Gi=ar-ie,Bn=ar-ue;return ie===i||Gi>=o||Gi<0||ve&&Bn>=z}function Mt(){var ar=ic();if(ft(ar))return Ot(ar);Q=go(Mt,xt(ar))}function Ot(ar){return Q=i,Pe&&I?Ve(ar):(I=N=i,Z)}function ui(){Q!==i&&l0(Q),ue=0,I=ie=N=Q=i}function kr(){return Q===i?Z:Ot(ic())}function li(){var ar=ic(),Gi=ft(ar);if(I=arguments,N=this,ie=ar,Gi){if(Q===i)return ot(ie);if(ve)return l0(Q),Q=go(Mt,o),Ve(ie)}return Q===i&&(Q=go(Mt,o)),Z}return li.cancel=ui,li.flush=kr,li}var bw=Et(function(s,o){return jd(s,1,o)}),mw=Et(function(s,o,l){return jd(s,Pi(o)||0,l)});function yw(s){return Tn(s,de)}function nc(s,o){if(typeof s!="function"||o!=null&&typeof o!="function")throw new Ei(h);var l=function(){var I=arguments,N=o?o.apply(this,I):I[0],z=l.cache;if(z.has(N))return z.get(N);var Z=s.apply(this,I);return l.cache=z.set(N,Z)||z,Z};return l.cache=new(nc.Cache||Cn),l}nc.Cache=Cn;function sc(s){if(typeof s!="function")throw new Ei(h);return function(){var o=arguments;switch(o.length){case 0:return!s.call(this);case 1:return!s.call(this,o[0]);case 2:return!s.call(this,o[0],o[1]);case 3:return!s.call(this,o[0],o[1],o[2])}return!s.apply(this,o)}}function ww(s){return Z0(2,s)}var _w=o2(function(s,o){o=o.length==1&&gt(o[0])?Xt(o[0],fi(it())):Xt(Sr(o,1),fi(it()));var l=o.length;return Et(function(I){for(var N=-1,z=Tr(I.length,l);++N<z;)I[N]=o[N].call(this,I[N]);return gr(s,this,I)})}),mu=Et(function(s,o){var l=es(o,ya(mu));return Tn(s,J,i,o,l)}),ip=Et(function(s,o){var l=es(o,ya(ip));return Tn(s,M,i,o,l)}),xw=$n(function(s,o){return Tn(s,ae,i,i,i,o)});function Ew(s,o){if(typeof s!="function")throw new Ei(h);return o=o===i?o:_t(o),Et(s,o)}function Sw(s,o){if(typeof s!="function")throw new Ei(h);return o=o==null?0:pr(_t(o),0),Et(function(l){var I=l[o],N=ss(l,0,o);return I&&Qn(N,I),gr(s,this,N)})}function Mw(s,o,l){var I=!0,N=!0;if(typeof s!="function")throw new Ei(h);return Zt(l)&&(I="leading"in l?!!l.leading:I,N="trailing"in l?!!l.trailing:N),rp(s,o,{leading:I,maxWait:o,trailing:N})}function Iw(s){return X0(s,1)}function Aw(s,o){return mu(ru(o),s)}function Pw(){if(!arguments.length)return[];var s=arguments[0];return gt(s)?s:[s]}function Dw(s){return Mi(s,C)}function Ow(s,o){return o=typeof o=="function"?o:i,Mi(s,C,o)}function Rw(s){return Mi(s,R|C)}function Cw(s,o){return o=typeof o=="function"?o:i,Mi(s,R|C,o)}function Nw(s,o){return o==null||Kd(s,o,br(o))}function Vi(s,o){return s===o||s!==s&&o!==o}var Tw=Xf(Kh),$w=Xf(function(s,o){return s>=o}),$s=Yd(function(){return arguments}())?Yd:function(s){return er(s)&&qt.call(s,"callee")&&!Ld.call(s,"callee")},gt=oe.isArray,Lw=Br?fi(Br):Ky;function Xr(s){return s!=null&&ac(s.length)&&!qn(s)}function sr(s){return er(s)&&Xr(s)}function qw(s){return s===!0||s===!1||er(s)&&zr(s)==L}var as=Xm||Du,Uw=Ki?fi(Ki):jy;function Bw(s){return er(s)&&s.nodeType===1&&!bo(s)}function zw(s){if(s==null)return!0;if(Xr(s)&&(gt(s)||typeof s=="string"||typeof s.splice=="function"||as(s)||wa(s)||$s(s)))return!s.length;var o=$r(s);if(o==ce||o==Ie)return!s.size;if(vo(s))return!Vh(s).length;for(var l in s)if(qt.call(s,l))return!1;return!0}function Fw(s,o){return uo(s,o)}function kw(s,o,l){l=typeof l=="function"?l:i;var I=l?l(s,o):i;return I===i?uo(s,o,i,l):!!I}function yu(s){if(!er(s))return!1;var o=zr(s);return o==re||o==K||typeof s.message=="string"&&typeof s.name=="string"&&!bo(s)}function Hw(s){return typeof s=="number"&&Ud(s)}function qn(s){if(!Zt(s))return!1;var o=zr(s);return o==se||o==we||o==j||o==Fe}function np(s){return typeof s=="number"&&s==_t(s)}function ac(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=S}function Zt(s){var o=typeof s;return s!=null&&(o=="object"||o=="function")}function er(s){return s!=null&&typeof s=="object"}var sp=_i?fi(_i):Vy;function Kw(s,o){return s===o||Wh(s,o,cu(o))}function jw(s,o,l){return l=typeof l=="function"?l:i,Wh(s,o,cu(o),l)}function Ww(s){return ap(s)&&s!=+s}function Vw(s){if(O2(s))throw new lt(c);return Xd(s)}function Gw(s){return s===null}function Jw(s){return s==null}function ap(s){return typeof s=="number"||er(s)&&zr(s)==me}function bo(s){if(!er(s)||zr(s)!=Me)return!1;var o=Nf(s);if(o===null)return!0;var l=qt.call(o,"constructor")&&o.constructor;return typeof l=="function"&&l instanceof l&&Df.call(l)==jm}var wu=fn?fi(fn):Gy;function Yw(s){return np(s)&&s>=-S&&s<=S}var op=to?fi(to):Jy;function oc(s){return typeof s=="string"||!gt(s)&&er(s)&&zr(s)==Ce}function hi(s){return typeof s=="symbol"||er(s)&&zr(s)==ge}var wa=As?fi(As):Yy;function Xw(s){return s===i}function Zw(s){return er(s)&&$r(s)==Ae}function Qw(s){return er(s)&&zr(s)==be}var e6=Xf(Gh),t6=Xf(function(s,o){return s<=o});function fp(s){if(!s)return[];if(Xr(s))return oc(s)?ji(s):Yr(s);if(io&&s[io])return Nm(s[io]());var o=$r(s),l=o==ce?$h:o==Ie?If:_a;return l(s)}function Un(s){if(!s)return s===0?s:0;if(s=Pi(s),s===P||s===-P){var o=s<0?-1:1;return o*v}return s===s?s:0}function _t(s){var o=Un(s),l=o%1;return o===o?l?o-l:o:0}function cp(s){return s?Rs(_t(s),0,x):0}function Pi(s){if(typeof s=="number")return s;if(hi(s))return E;if(Zt(s)){var o=typeof s.valueOf=="function"?s.valueOf():s;s=Zt(o)?o+"":o}if(typeof s!="string")return s===0?s:+s;s=Pd(s);var l=Or.test(s);return l||Cr.test(s)?vt(s.slice(2),l?2:8):Dr.test(s)?E:+s}function hp(s){return hn(s,Zr(s))}function r6(s){return s?Rs(_t(s),-S,S):s===0?s:0}function $t(s){return s==null?"":ci(s)}var i6=ba(function(s,o){if(vo(o)||Xr(o)){hn(o,br(o),s);return}for(var l in o)qt.call(o,l)&&fo(s,l,o[l])}),up=ba(function(s,o){hn(o,Zr(o),s)}),fc=ba(function(s,o,l,I){hn(o,Zr(o),s,I)}),n6=ba(function(s,o,l,I){hn(o,br(o),s,I)}),s6=$n(Fh);function a6(s,o){var l=ga(s);return o==null?l:Hd(l,o)}var o6=Et(function(s,o){s=Kt(s);var l=-1,I=o.length,N=I>2?o[2]:i;for(N&&Fr(o[0],o[1],N)&&(I=1);++l<I;)for(var z=o[l],Z=Zr(z),Q=-1,ie=Z.length;++Q<ie;){var ue=Z[Q],le=s[ue];(le===i||Vi(le,da[ue])&&!qt.call(s,ue))&&(s[ue]=z[ue])}return s}),f6=Et(function(s){return s.push(i,P0),gr(lp,i,s)});function c6(s,o){return Sd(s,it(o,3),cn)}function h6(s,o){return Sd(s,it(o,3),Hh)}function u6(s,o){return s==null?s:kh(s,it(o,3),Zr)}function l6(s,o){return s==null?s:Gd(s,it(o,3),Zr)}function d6(s,o){return s&&cn(s,it(o,3))}function p6(s,o){return s&&Hh(s,it(o,3))}function v6(s){return s==null?[]:Hf(s,br(s))}function g6(s){return s==null?[]:Hf(s,Zr(s))}function _u(s,o,l){var I=s==null?i:Cs(s,o);return I===i?l:I}function b6(s,o){return s!=null&&R0(s,o,zy)}function xu(s,o){return s!=null&&R0(s,o,Fy)}var m6=E0(function(s,o,l){o!=null&&typeof o.toString!="function"&&(o=Of.call(o)),s[o]=l},Su(Qr)),y6=E0(function(s,o,l){o!=null&&typeof o.toString!="function"&&(o=Of.call(o)),qt.call(s,o)?s[o].push(l):s[o]=[l]},it),w6=Et(ho);function br(s){return Xr(s)?Fd(s):Vh(s)}function Zr(s){return Xr(s)?Fd(s,!0):Xy(s)}function _6(s,o){var l={};return o=it(o,3),cn(s,function(I,N,z){Nn(l,o(I,N,z),I)}),l}function x6(s,o){var l={};return o=it(o,3),cn(s,function(I,N,z){Nn(l,N,o(I,N,z))}),l}var E6=ba(function(s,o,l){Kf(s,o,l)}),lp=ba(function(s,o,l,I){Kf(s,o,l,I)}),S6=$n(function(s,o){var l={};if(s==null)return l;var I=!1;o=Xt(o,function(z){return z=ns(z,s),I||(I=z.length>1),z}),hn(s,ou(s),l),I&&(l=Mi(l,R|O|C,m2));for(var N=o.length;N--;)Qh(l,o[N]);return l});function M6(s,o){return dp(s,sc(it(o)))}var I6=$n(function(s,o){return s==null?{}:Qy(s,o)});function dp(s,o){if(s==null)return{};var l=Xt(ou(s),function(I){return[I]});return o=it(o),n0(s,l,function(I,N){return o(I,N[0])})}function A6(s,o,l){o=ns(o,s);var I=-1,N=o.length;for(N||(N=1,s=i);++I<N;){var z=s==null?i:s[un(o[I])];z===i&&(I=N,z=l),s=qn(z)?z.call(s):z}return s}function P6(s,o,l){return s==null?s:lo(s,o,l)}function D6(s,o,l,I){return I=typeof I=="function"?I:i,s==null?s:lo(s,o,l,I)}var pp=I0(br),vp=I0(Zr);function O6(s,o,l){var I=gt(s),N=I||as(s)||wa(s);if(o=it(o,4),l==null){var z=s&&s.constructor;N?l=I?new z:[]:Zt(s)?l=qn(z)?ga(Nf(s)):{}:l={}}return(N?xi:cn)(s,function(Z,Q,ie){return o(l,Z,Q,ie)}),l}function R6(s,o){return s==null?!0:Qh(s,o)}function C6(s,o,l){return s==null?s:c0(s,o,ru(l))}function N6(s,o,l,I){return I=typeof I=="function"?I:i,s==null?s:c0(s,o,ru(l),I)}function _a(s){return s==null?[]:Th(s,br(s))}function T6(s){return s==null?[]:Th(s,Zr(s))}function $6(s,o,l){return l===i&&(l=o,o=i),l!==i&&(l=Pi(l),l=l===l?l:0),o!==i&&(o=Pi(o),o=o===o?o:0),Rs(Pi(s),o,l)}function L6(s,o,l){return o=Un(o),l===i?(l=o,o=0):l=Un(l),s=Pi(s),ky(s,o,l)}function q6(s,o,l){if(l&&typeof l!="boolean"&&Fr(s,o,l)&&(o=l=i),l===i&&(typeof o=="boolean"?(l=o,o=i):typeof s=="boolean"&&(l=s,s=i)),s===i&&o===i?(s=0,o=1):(s=Un(s),o===i?(o=s,s=0):o=Un(o)),s>o){var I=s;s=o,o=I}if(l||s%1||o%1){var N=Bd();return Tr(s+N*(o-s+kt("1e-"+((N+"").length-1))),o)}return Yh(s,o)}var U6=ma(function(s,o,l){return o=o.toLowerCase(),s+(l?gp(o):o)});function gp(s){return Eu($t(s).toLowerCase())}function bp(s){return s=$t(s),s&&s.replace(Qt,Pm).replace(Mh,"")}function B6(s,o,l){s=$t(s),o=ci(o);var I=s.length;l=l===i?I:Rs(_t(l),0,I);var N=l;return l-=o.length,l>=0&&s.slice(l,N)==o}function z6(s){return s=$t(s),s&&Te.test(s)?s.replace(nt,Dm):s}function F6(s){return s=$t(s),s&&ht.test(s)?s.replace(tt,"\\$&"):s}var k6=ma(function(s,o,l){return s+(l?"-":"")+o.toLowerCase()}),H6=ma(function(s,o,l){return s+(l?" ":"")+o.toLowerCase()}),K6=w0("toLowerCase");function j6(s,o,l){s=$t(s),o=_t(o);var I=o?ua(s):0;if(!o||I>=o)return s;var N=(o-I)/2;return Yf(qf(N),l)+s+Yf(Lf(N),l)}function W6(s,o,l){s=$t(s),o=_t(o);var I=o?ua(s):0;return o&&I<o?s+Yf(o-I,l):s}function V6(s,o,l){s=$t(s),o=_t(o);var I=o?ua(s):0;return o&&I<o?Yf(o-I,l)+s:s}function G6(s,o,l){return l||o==null?o=0:o&&(o=+o),ty($t(s).replace(qe,""),o||0)}function J6(s,o,l){return(l?Fr(s,o,l):o===i)?o=1:o=_t(o),Xh($t(s),o)}function Y6(){var s=arguments,o=$t(s[0]);return s.length<3?o:o.replace(s[1],s[2])}var X6=ma(function(s,o,l){return s+(l?"_":"")+o.toLowerCase()});function Z6(s,o,l){return l&&typeof l!="number"&&Fr(s,o,l)&&(o=l=i),l=l===i?x:l>>>0,l?(s=$t(s),s&&(typeof o=="string"||o!=null&&!wu(o))&&(o=ci(o),!o&&ha(s))?ss(ji(s),0,l):s.split(o,l)):[]}var Q6=ma(function(s,o,l){return s+(l?" ":"")+Eu(o)});function e_(s,o,l){return s=$t(s),l=l==null?0:Rs(_t(l),0,s.length),o=ci(o),s.slice(l,l+o.length)==o}function t_(s,o,l){var I=$.templateSettings;l&&Fr(s,o,l)&&(o=i),s=$t(s),o=fc({},o,I,A0);var N=fc({},o.imports,I.imports,A0),z=br(N),Z=Th(N,z),Q,ie,ue=0,le=o.interpolate||Wr,ve="__p += '",Pe=Lh((o.escape||Wr).source+"|"+le.source+"|"+(le===Le?Rt:Wr).source+"|"+(o.evaluate||Wr).source+"|$","g"),Ve="//# sourceURL="+(qt.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ih+"]")+`
`;s.replace(Pe,function(ft,Mt,Ot,ui,kr,li){return Ot||(Ot=ui),ve+=s.slice(ue,li).replace(Bi,Om),Mt&&(Q=!0,ve+=`' +
__e(`+Mt+`) +
'`),kr&&(ie=!0,ve+=`';
`+kr+`;
__p += '`),Ot&&(ve+=`' +
((__t = (`+Ot+`)) == null ? '' : __t) +
'`),ue=li+ft.length,ft}),ve+=`';
`;var ot=qt.call(o,"variable")&&o.variable;if(!ot)ve=`with (obj) {
`+ve+`
}
`;else if(at.test(ot))throw new lt(d);ve=(ie?ve.replace(Ge,""):ve).replace(pt,"$1").replace(St,"$1;"),ve="function("+(ot||"obj")+`) {
`+(ot?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Q?", __e = _.escape":"")+(ie?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ve+`return __p
}`;var xt=yp(function(){return Tt(z,Ve+"return "+ve).apply(i,Z)});if(xt.source=ve,yu(xt))throw xt;return xt}function r_(s){return $t(s).toLowerCase()}function i_(s){return $t(s).toUpperCase()}function n_(s,o,l){if(s=$t(s),s&&(l||o===i))return Pd(s);if(!s||!(o=ci(o)))return s;var I=ji(s),N=ji(o),z=Dd(I,N),Z=Od(I,N)+1;return ss(I,z,Z).join("")}function s_(s,o,l){if(s=$t(s),s&&(l||o===i))return s.slice(0,Cd(s)+1);if(!s||!(o=ci(o)))return s;var I=ji(s),N=Od(I,ji(o))+1;return ss(I,0,N).join("")}function a_(s,o,l){if(s=$t(s),s&&(l||o===i))return s.replace(qe,"");if(!s||!(o=ci(o)))return s;var I=ji(s),N=Dd(I,ji(o));return ss(I,N).join("")}function o_(s,o){var l=U,I=m;if(Zt(o)){var N="separator"in o?o.separator:N;l="length"in o?_t(o.length):l,I="omission"in o?ci(o.omission):I}s=$t(s);var z=s.length;if(ha(s)){var Z=ji(s);z=Z.length}if(l>=z)return s;var Q=l-ua(I);if(Q<1)return I;var ie=Z?ss(Z,0,Q).join(""):s.slice(0,Q);if(N===i)return ie+I;if(Z&&(Q+=ie.length-Q),wu(N)){if(s.slice(Q).search(N)){var ue,le=ie;for(N.global||(N=Lh(N.source,$t(yt.exec(N))+"g")),N.lastIndex=0;ue=N.exec(le);)var ve=ue.index;ie=ie.slice(0,ve===i?Q:ve)}}else if(s.indexOf(ci(N),Q)!=Q){var Pe=ie.lastIndexOf(N);Pe>-1&&(ie=ie.slice(0,Pe))}return ie+I}function f_(s){return s=$t(s),s&&Ze.test(s)?s.replace(Ye,qm):s}var c_=ma(function(s,o,l){return s+(l?" ":"")+o.toUpperCase()}),Eu=w0("toUpperCase");function mp(s,o,l){return s=$t(s),o=l?i:o,o===i?Cm(s)?zm(s):Em(s):s.match(o)||[]}var yp=Et(function(s,o){try{return gr(s,i,o)}catch(l){return yu(l)?l:new lt(l)}}),h_=$n(function(s,o){return xi(o,function(l){l=un(l),Nn(s,l,bu(s[l],s))}),s});function u_(s){var o=s==null?0:s.length,l=it();return s=o?Xt(s,function(I){if(typeof I[1]!="function")throw new Ei(h);return[l(I[0]),I[1]]}):[],Et(function(I){for(var N=-1;++N<o;){var z=s[N];if(gr(z[0],this,I))return gr(z[1],this,I)}})}function l_(s){return qy(Mi(s,R))}function Su(s){return function(){return s}}function d_(s,o){return s==null||s!==s?o:s}var p_=x0(),v_=x0(!0);function Qr(s){return s}function Mu(s){return Zd(typeof s=="function"?s:Mi(s,R))}function g_(s){return e0(Mi(s,R))}function b_(s,o){return t0(s,Mi(o,R))}var m_=Et(function(s,o){return function(l){return ho(l,s,o)}}),y_=Et(function(s,o){return function(l){return ho(s,l,o)}});function Iu(s,o,l){var I=br(o),N=Hf(o,I);l==null&&!(Zt(o)&&(N.length||!I.length))&&(l=o,o=s,s=this,N=Hf(o,br(o)));var z=!(Zt(l)&&"chain"in l)||!!l.chain,Z=qn(s);return xi(N,function(Q){var ie=o[Q];s[Q]=ie,Z&&(s.prototype[Q]=function(){var ue=this.__chain__;if(z||ue){var le=s(this.__wrapped__),ve=le.__actions__=Yr(this.__actions__);return ve.push({func:ie,args:arguments,thisArg:s}),le.__chain__=ue,le}return ie.apply(s,Qn([this.value()],arguments))})}),s}function w_(){return Dt._===this&&(Dt._=Wm),this}function Au(){}function __(s){return s=_t(s),Et(function(o){return r0(o,s)})}var x_=nu(Xt),E_=nu(Ed),S_=nu(Dh);function wp(s){return uu(s)?Oh(un(s)):e2(s)}function M_(s){return function(o){return s==null?i:Cs(s,o)}}var I_=S0(),A_=S0(!0);function Pu(){return[]}function Du(){return!1}function P_(){return{}}function D_(){return""}function O_(){return!0}function R_(s,o){if(s=_t(s),s<1||s>S)return[];var l=x,I=Tr(s,x);o=it(o),s-=x;for(var N=Nh(I,o);++l<s;)o(l);return N}function C_(s){return gt(s)?Xt(s,un):hi(s)?[s]:Yr(z0($t(s)))}function N_(s){var o=++Km;return $t(s)+o}var T_=Jf(function(s,o){return s+o},0),$_=su("ceil"),L_=Jf(function(s,o){return s/o},1),q_=su("floor");function U_(s){return s&&s.length?kf(s,Qr,Kh):i}function B_(s,o){return s&&s.length?kf(s,it(o,2),Kh):i}function z_(s){return Id(s,Qr)}function F_(s,o){return Id(s,it(o,2))}function k_(s){return s&&s.length?kf(s,Qr,Gh):i}function H_(s,o){return s&&s.length?kf(s,it(o,2),Gh):i}var K_=Jf(function(s,o){return s*o},1),j_=su("round"),W_=Jf(function(s,o){return s-o},0);function V_(s){return s&&s.length?Ch(s,Qr):0}function G_(s,o){return s&&s.length?Ch(s,it(o,2)):0}return $.after=gw,$.ary=X0,$.assign=i6,$.assignIn=up,$.assignInWith=fc,$.assignWith=n6,$.at=s6,$.before=Z0,$.bind=bu,$.bindAll=h_,$.bindKey=Q0,$.castArray=Pw,$.chain=G0,$.chunk=q2,$.compact=U2,$.concat=B2,$.cond=u_,$.conforms=l_,$.constant=Su,$.countBy=V3,$.create=a6,$.curry=ep,$.curryRight=tp,$.debounce=rp,$.defaults=o6,$.defaultsDeep=f6,$.defer=bw,$.delay=mw,$.difference=z2,$.differenceBy=F2,$.differenceWith=k2,$.drop=H2,$.dropRight=K2,$.dropRightWhile=j2,$.dropWhile=W2,$.fill=V2,$.filter=J3,$.flatMap=Z3,$.flatMapDeep=Q3,$.flatMapDepth=ew,$.flatten=K0,$.flattenDeep=G2,$.flattenDepth=J2,$.flip=yw,$.flow=p_,$.flowRight=v_,$.fromPairs=Y2,$.functions=v6,$.functionsIn=g6,$.groupBy=tw,$.initial=Z2,$.intersection=Q2,$.intersectionBy=e3,$.intersectionWith=t3,$.invert=m6,$.invertBy=y6,$.invokeMap=iw,$.iteratee=Mu,$.keyBy=nw,$.keys=br,$.keysIn=Zr,$.map=rc,$.mapKeys=_6,$.mapValues=x6,$.matches=g_,$.matchesProperty=b_,$.memoize=nc,$.merge=E6,$.mergeWith=lp,$.method=m_,$.methodOf=y_,$.mixin=Iu,$.negate=sc,$.nthArg=__,$.omit=S6,$.omitBy=M6,$.once=ww,$.orderBy=sw,$.over=x_,$.overArgs=_w,$.overEvery=E_,$.overSome=S_,$.partial=mu,$.partialRight=ip,$.partition=aw,$.pick=I6,$.pickBy=dp,$.property=wp,$.propertyOf=M_,$.pull=s3,$.pullAll=W0,$.pullAllBy=a3,$.pullAllWith=o3,$.pullAt=f3,$.range=I_,$.rangeRight=A_,$.rearg=xw,$.reject=cw,$.remove=c3,$.rest=Ew,$.reverse=vu,$.sampleSize=uw,$.set=P6,$.setWith=D6,$.shuffle=lw,$.slice=h3,$.sortBy=vw,$.sortedUniq=b3,$.sortedUniqBy=m3,$.split=Z6,$.spread=Sw,$.tail=y3,$.take=w3,$.takeRight=_3,$.takeRightWhile=x3,$.takeWhile=E3,$.tap=U3,$.throttle=Mw,$.thru=tc,$.toArray=fp,$.toPairs=pp,$.toPairsIn=vp,$.toPath=C_,$.toPlainObject=hp,$.transform=O6,$.unary=Iw,$.union=S3,$.unionBy=M3,$.unionWith=I3,$.uniq=A3,$.uniqBy=P3,$.uniqWith=D3,$.unset=R6,$.unzip=gu,$.unzipWith=V0,$.update=C6,$.updateWith=N6,$.values=_a,$.valuesIn=T6,$.without=O3,$.words=mp,$.wrap=Aw,$.xor=R3,$.xorBy=C3,$.xorWith=N3,$.zip=T3,$.zipObject=$3,$.zipObjectDeep=L3,$.zipWith=q3,$.entries=pp,$.entriesIn=vp,$.extend=up,$.extendWith=fc,Iu($,$),$.add=T_,$.attempt=yp,$.camelCase=U6,$.capitalize=gp,$.ceil=$_,$.clamp=$6,$.clone=Dw,$.cloneDeep=Rw,$.cloneDeepWith=Cw,$.cloneWith=Ow,$.conformsTo=Nw,$.deburr=bp,$.defaultTo=d_,$.divide=L_,$.endsWith=B6,$.eq=Vi,$.escape=z6,$.escapeRegExp=F6,$.every=G3,$.find=Y3,$.findIndex=k0,$.findKey=c6,$.findLast=X3,$.findLastIndex=H0,$.findLastKey=h6,$.floor=q_,$.forEach=J0,$.forEachRight=Y0,$.forIn=u6,$.forInRight=l6,$.forOwn=d6,$.forOwnRight=p6,$.get=_u,$.gt=Tw,$.gte=$w,$.has=b6,$.hasIn=xu,$.head=j0,$.identity=Qr,$.includes=rw,$.indexOf=X2,$.inRange=L6,$.invoke=w6,$.isArguments=$s,$.isArray=gt,$.isArrayBuffer=Lw,$.isArrayLike=Xr,$.isArrayLikeObject=sr,$.isBoolean=qw,$.isBuffer=as,$.isDate=Uw,$.isElement=Bw,$.isEmpty=zw,$.isEqual=Fw,$.isEqualWith=kw,$.isError=yu,$.isFinite=Hw,$.isFunction=qn,$.isInteger=np,$.isLength=ac,$.isMap=sp,$.isMatch=Kw,$.isMatchWith=jw,$.isNaN=Ww,$.isNative=Vw,$.isNil=Jw,$.isNull=Gw,$.isNumber=ap,$.isObject=Zt,$.isObjectLike=er,$.isPlainObject=bo,$.isRegExp=wu,$.isSafeInteger=Yw,$.isSet=op,$.isString=oc,$.isSymbol=hi,$.isTypedArray=wa,$.isUndefined=Xw,$.isWeakMap=Zw,$.isWeakSet=Qw,$.join=r3,$.kebabCase=k6,$.last=Ai,$.lastIndexOf=i3,$.lowerCase=H6,$.lowerFirst=K6,$.lt=e6,$.lte=t6,$.max=U_,$.maxBy=B_,$.mean=z_,$.meanBy=F_,$.min=k_,$.minBy=H_,$.stubArray=Pu,$.stubFalse=Du,$.stubObject=P_,$.stubString=D_,$.stubTrue=O_,$.multiply=K_,$.nth=n3,$.noConflict=w_,$.noop=Au,$.now=ic,$.pad=j6,$.padEnd=W6,$.padStart=V6,$.parseInt=G6,$.random=q6,$.reduce=ow,$.reduceRight=fw,$.repeat=J6,$.replace=Y6,$.result=A6,$.round=j_,$.runInContext=ee,$.sample=hw,$.size=dw,$.snakeCase=X6,$.some=pw,$.sortedIndex=u3,$.sortedIndexBy=l3,$.sortedIndexOf=d3,$.sortedLastIndex=p3,$.sortedLastIndexBy=v3,$.sortedLastIndexOf=g3,$.startCase=Q6,$.startsWith=e_,$.subtract=W_,$.sum=V_,$.sumBy=G_,$.template=t_,$.times=R_,$.toFinite=Un,$.toInteger=_t,$.toLength=cp,$.toLower=r_,$.toNumber=Pi,$.toSafeInteger=r6,$.toString=$t,$.toUpper=i_,$.trim=n_,$.trimEnd=s_,$.trimStart=a_,$.truncate=o_,$.unescape=f_,$.uniqueId=N_,$.upperCase=c_,$.upperFirst=Eu,$.each=J0,$.eachRight=Y0,$.first=j0,Iu($,function(){var s={};return cn($,function(o,l){qt.call($.prototype,l)||(s[l]=o)}),s}(),{chain:!1}),$.VERSION=n,xi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){$[s].placeholder=$}),xi(["drop","take"],function(s,o){At.prototype[s]=function(l){l=l===i?1:pr(_t(l),0);var I=this.__filtered__&&!o?new At(this):this.clone();return I.__filtered__?I.__takeCount__=Tr(l,I.__takeCount__):I.__views__.push({size:Tr(l,x),type:s+(I.__dir__<0?"Right":"")}),I},At.prototype[s+"Right"]=function(l){return this.reverse()[s](l).reverse()}}),xi(["filter","map","takeWhile"],function(s,o){var l=o+1,I=l==u||l==A;At.prototype[s]=function(N){var z=this.clone();return z.__iteratees__.push({iteratee:it(N,3),type:l}),z.__filtered__=z.__filtered__||I,z}}),xi(["head","last"],function(s,o){var l="take"+(o?"Right":"");At.prototype[s]=function(){return this[l](1).value()[0]}}),xi(["initial","tail"],function(s,o){var l="drop"+(o?"":"Right");At.prototype[s]=function(){return this.__filtered__?new At(this):this[l](1)}}),At.prototype.compact=function(){return this.filter(Qr)},At.prototype.find=function(s){return this.filter(s).head()},At.prototype.findLast=function(s){return this.reverse().find(s)},At.prototype.invokeMap=Et(function(s,o){return typeof s=="function"?new At(this):this.map(function(l){return ho(l,s,o)})}),At.prototype.reject=function(s){return this.filter(sc(it(s)))},At.prototype.slice=function(s,o){s=_t(s);var l=this;return l.__filtered__&&(s>0||o<0)?new At(l):(s<0?l=l.takeRight(-s):s&&(l=l.drop(s)),o!==i&&(o=_t(o),l=o<0?l.dropRight(-o):l.take(o-s)),l)},At.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},At.prototype.toArray=function(){return this.take(x)},cn(At.prototype,function(s,o){var l=/^(?:filter|find|map|reject)|While$/.test(o),I=/^(?:head|last)$/.test(o),N=$[I?"take"+(o=="last"?"Right":""):o],z=I||/^find/.test(o);N&&($.prototype[o]=function(){var Z=this.__wrapped__,Q=I?[1]:arguments,ie=Z instanceof At,ue=Q[0],le=ie||gt(Z),ve=function(Mt){var Ot=N.apply($,Qn([Mt],Q));return I&&Pe?Ot[0]:Ot};le&&l&&typeof ue=="function"&&ue.length!=1&&(ie=le=!1);var Pe=this.__chain__,Ve=!!this.__actions__.length,ot=z&&!Pe,xt=ie&&!Ve;if(!z&&le){Z=xt?Z:new At(this);var ft=s.apply(Z,Q);return ft.__actions__.push({func:tc,args:[ve],thisArg:i}),new Si(ft,Pe)}return ot&&xt?s.apply(this,Q):(ft=this.thru(ve),ot?I?ft.value()[0]:ft.value():ft)})}),xi(["pop","push","shift","sort","splice","unshift"],function(s){var o=Af[s],l=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",I=/^(?:pop|shift)$/.test(s);$.prototype[s]=function(){var N=arguments;if(I&&!this.__chain__){var z=this.value();return o.apply(gt(z)?z:[],N)}return this[l](function(Z){return o.apply(gt(Z)?Z:[],N)})}}),cn(At.prototype,function(s,o){var l=$[o];if(l){var I=l.name+"";qt.call(va,I)||(va[I]=[]),va[I].push({name:o,func:l})}}),va[Gf(i,H).name]=[{name:"wrapper",func:i}],At.prototype.clone=fy,At.prototype.reverse=cy,At.prototype.value=hy,$.prototype.at=B3,$.prototype.chain=z3,$.prototype.commit=F3,$.prototype.next=k3,$.prototype.plant=K3,$.prototype.reverse=j3,$.prototype.toJSON=$.prototype.valueOf=$.prototype.value=W3,$.prototype.first=$.prototype.head,io&&($.prototype[io]=H3),$},la=Fm();nr?((nr.exports=la)._=la,Ht._=la):Dt._=la}).call(Wc)})(Kc,Kc.exports);var ZD=Kc.exports,Ll={exports:{}};(function(r,e){var t=typeof self<"u"?self:Wc,i=function(){function a(){this.fetch=!1,this.DOMException=t.DOMException}return a.prototype=t,new a}();(function(a){(function(c){var h={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function d(f){return f&&DataView.prototype.isPrototypeOf(f)}if(h.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=ArrayBuffer.isView||function(f){return f&&p.indexOf(Object.prototype.toString.call(f))>-1};function w(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(f))throw new TypeError("Invalid character in header field name");return f.toLowerCase()}function R(f){return typeof f!="string"&&(f=String(f)),f}function O(f){var u={next:function(){var y=f.shift();return{done:y===void 0,value:y}}};return h.iterable&&(u[Symbol.iterator]=function(){return u}),u}function C(f){this.map={},f instanceof C?f.forEach(function(u,y){this.append(y,u)},this):Array.isArray(f)?f.forEach(function(u){this.append(u[0],u[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(u){this.append(u,f[u])},this)}C.prototype.append=function(f,u){f=w(f),u=R(u);var y=this.map[f];this.map[f]=y?y+", "+u:u},C.prototype.delete=function(f){delete this.map[w(f)]},C.prototype.get=function(f){return f=w(f),this.has(f)?this.map[f]:null},C.prototype.has=function(f){return this.map.hasOwnProperty(w(f))},C.prototype.set=function(f,u){this.map[w(f)]=R(u)},C.prototype.forEach=function(f,u){for(var y in this.map)this.map.hasOwnProperty(y)&&f.call(u,this.map[y],y,this)},C.prototype.keys=function(){var f=[];return this.forEach(function(u,y){f.push(y)}),O(f)},C.prototype.values=function(){var f=[];return this.forEach(function(u){f.push(u)}),O(f)},C.prototype.entries=function(){var f=[];return this.forEach(function(u,y){f.push([y,u])}),O(f)},h.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function q(f){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}function V(f){return new Promise(function(u,y){f.onload=function(){u(f.result)},f.onerror=function(){y(f.error)}})}function Y(f){var u=new FileReader,y=V(u);return u.readAsArrayBuffer(f),y}function H(f){var u=new FileReader,y=V(u);return u.readAsText(f),y}function X(f){for(var u=new Uint8Array(f),y=new Array(u.length),A=0;A<u.length;A++)y[A]=String.fromCharCode(u[A]);return y.join("")}function k(f){if(f.slice)return f.slice(0);var u=new Uint8Array(f.byteLength);return u.set(new Uint8Array(f)),u.buffer}function W(){return this.bodyUsed=!1,this._initBody=function(f){this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:h.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:h.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:h.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():h.arrayBuffer&&h.blob&&d(f)?(this._bodyArrayBuffer=k(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):h.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||b(f))?this._bodyArrayBuffer=k(f):this._bodyText=f=Object.prototype.toString.call(f):this._bodyText="",this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):h.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},h.blob&&(this.blob=function(){var f=q(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?q(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Y)}),this.text=function(){var f=q(this);if(f)return f;if(this._bodyBlob)return H(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(X(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(ae)}),this.json=function(){return this.text().then(JSON.parse)},this}var J=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function M(f){var u=f.toUpperCase();return J.indexOf(u)>-1?u:f}function B(f,u){u=u||{};var y=u.body;if(f instanceof B){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,u.headers||(this.headers=new C(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!y&&f._bodyInit!=null&&(y=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=u.credentials||this.credentials||"same-origin",(u.headers||!this.headers)&&(this.headers=new C(u.headers)),this.method=M(u.method||this.method||"GET"),this.mode=u.mode||this.mode||null,this.signal=u.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&y)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(y)}B.prototype.clone=function(){return new B(this,{body:this._bodyInit})};function ae(f){var u=new FormData;return f.trim().split("&").forEach(function(y){if(y){var A=y.split("="),P=A.shift().replace(/\+/g," "),S=A.join("=").replace(/\+/g," ");u.append(decodeURIComponent(P),decodeURIComponent(S))}}),u}function de(f){var u=new C,y=f.replace(/\r?\n[\t ]+/g," ");return y.split(/\r?\n/).forEach(function(A){var P=A.split(":"),S=P.shift().trim();if(S){var v=P.join(":").trim();u.append(S,v)}}),u}W.call(B.prototype);function U(f,u){u||(u={}),this.type="default",this.status=u.status===void 0?200:u.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in u?u.statusText:"OK",this.headers=new C(u.headers),this.url=u.url||"",this._initBody(f)}W.call(U.prototype),U.prototype.clone=function(){return new U(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},U.error=function(){var f=new U(null,{status:0,statusText:""});return f.type="error",f};var m=[301,302,303,307,308];U.redirect=function(f,u){if(m.indexOf(u)===-1)throw new RangeError("Invalid status code");return new U(null,{status:u,headers:{location:f}})},c.DOMException=a.DOMException;try{new c.DOMException}catch{c.DOMException=function(u,y){this.message=u,this.name=y;var A=Error(u);this.stack=A.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function g(f,u){return new Promise(function(y,A){var P=new B(f,u);if(P.signal&&P.signal.aborted)return A(new c.DOMException("Aborted","AbortError"));var S=new XMLHttpRequest;function v(){S.abort()}S.onload=function(){var E={status:S.status,statusText:S.statusText,headers:de(S.getAllResponseHeaders()||"")};E.url="responseURL"in S?S.responseURL:E.headers.get("X-Request-URL");var x="response"in S?S.response:S.responseText;y(new U(x,E))},S.onerror=function(){A(new TypeError("Network request failed"))},S.ontimeout=function(){A(new TypeError("Network request failed"))},S.onabort=function(){A(new c.DOMException("Aborted","AbortError"))},S.open(P.method,P.url,!0),P.credentials==="include"?S.withCredentials=!0:P.credentials==="omit"&&(S.withCredentials=!1),"responseType"in S&&h.blob&&(S.responseType="blob"),P.headers.forEach(function(E,x){S.setRequestHeader(x,E)}),P.signal&&(P.signal.addEventListener("abort",v),S.onreadystatechange=function(){S.readyState===4&&P.signal.removeEventListener("abort",v)}),S.send(typeof P._bodyInit>"u"?null:P._bodyInit)})}return g.polyfill=!0,a.fetch||(a.fetch=g,a.Headers=C,a.Request=B,a.Response=U),c.Headers=C,c.Request=B,c.Response=U,c.fetch=g,Object.defineProperty(c,"__esModule",{value:!0}),c})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,r.exports=e})(Ll,Ll.exports);var QD=Ll.exports;const P1=gs(QD);var eO=Object.defineProperty,tO=Object.defineProperties,rO=Object.getOwnPropertyDescriptors,D1=Object.getOwnPropertySymbols,iO=Object.prototype.hasOwnProperty,nO=Object.prototype.propertyIsEnumerable,O1=(r,e,t)=>e in r?eO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,R1=(r,e)=>{for(var t in e||(e={}))iO.call(e,t)&&O1(r,t,e[t]);if(D1)for(var t of D1(e))nO.call(e,t)&&O1(r,t,e[t]);return r},C1=(r,e)=>tO(r,rO(e));const sO={Accept:"application/json","Content-Type":"application/json"},aO="POST",N1={headers:sO,method:aO},T1=10;let Dn=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new vi.EventEmitter,this.isAvailable=!1,this.registering=!1,!e1(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Jn(e),i=await(await P1(this.url,C1(R1({},N1),{body:t}))).json();this.onPayload({data:i})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!e1(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,n)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),n(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Jn({id:1,jsonrpc:"2.0",method:"test",params:[]});await P1(e,C1(R1({},N1),{body:t}))}this.onOpen()}catch(t){const i=this.parseError(t);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Gs(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),n=i.message||i.toString(),a=bh(e,n);this.events.emit("payload",a)}parseError(e,t=this.url){return Hb(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>T1&&this.events.setMaxListeners(T1)}};const $1="error",oO="wss://relay.walletconnect.org",fO="wc",cO="universal_provider",L1=`${fO}@2:${cO}:`,lm="https://rpc.walletconnect.org/v1/",Aa="generic",hO=`${lm}bundler`,an={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var uO=Object.defineProperty,lO=Object.defineProperties,dO=Object.getOwnPropertyDescriptors,q1=Object.getOwnPropertySymbols,pO=Object.prototype.hasOwnProperty,vO=Object.prototype.propertyIsEnumerable,U1=(r,e,t)=>e in r?uO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,pc=(r,e)=>{for(var t in e||(e={}))pO.call(e,t)&&U1(r,t,e[t]);if(q1)for(var t of q1(e))vO.call(e,t)&&U1(r,t,e[t]);return r},gO=(r,e)=>lO(r,dO(e));function nn(r,e,t){var i;const n=Ta(r);return((i=e.rpcMap)==null?void 0:i[n.reference])||`${lm}?chainId=${n.namespace}:${n.reference}&projectId=${t}`}function na(r){return r.includes(":")?r.split(":")[1]:r}function dm(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function bO(r,e){const t=Object.keys(e.namespaces).filter(n=>n.includes(r));if(!t.length)return[];const i=[];return t.forEach(n=>{const a=e.namespaces[n].accounts;i.push(...a)}),i}function al(r={},e={}){const t=B1(r),i=B1(e);return ZD.merge(t,i)}function B1(r){var e,t,i,n;const a={};if(!Fo(r))return a;for(const[c,h]of Object.entries(r)){const d=dd(c)?[c]:h.chains,p=h.methods||[],b=h.events||[],w=h.rpcMap||{},R=Ro(c);a[R]=gO(pc(pc({},a[R]),h),{chains:_c(d,(e=a[R])==null?void 0:e.chains),methods:_c(p,(t=a[R])==null?void 0:t.methods),events:_c(b,(i=a[R])==null?void 0:i.events),rpcMap:pc(pc({},w),(n=a[R])==null?void 0:n.rpcMap)})}return a}function mO(r){return r.includes(":")?r.split(":")[2]:r}function z1(r){const e={};for(const[t,i]of Object.entries(r)){const n=i.methods||[],a=i.events||[],c=i.accounts||[],h=dd(t)?[t]:i.chains?i.chains:dm(i.accounts);e[t]={chains:h,methods:n,events:a,accounts:c}}return e}function ol(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const pm={},Lt=r=>pm[r],fl=(r,e)=>{pm[r]=e};class yO{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const n=na(t);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||nn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new sn(new Dn(i,Lt("disableProviderPing")))}}var wO=Object.defineProperty,_O=Object.defineProperties,xO=Object.getOwnPropertyDescriptors,F1=Object.getOwnPropertySymbols,EO=Object.prototype.hasOwnProperty,SO=Object.prototype.propertyIsEnumerable,k1=(r,e,t)=>e in r?wO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,H1=(r,e)=>{for(var t in e||(e={}))EO.call(e,t)&&k1(r,t,e[t]);if(F1)for(var t of F1(e))SO.call(e,t)&&k1(r,t,e[t]);return r},K1=(r,e)=>_O(r,xO(e));class MO{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const i=t||nn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new sn(new Dn(i,Lt("disableProviderPing")))}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const n=parseInt(na(t));e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,i;let n=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;const a=parseInt(n,16);if(this.isChainApproved(a))this.setDefaultChain(`${a}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:n}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${a}`);else throw new Error(`Failed to switch to chain 'eip155:${a}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,i,n;const a=(i=(t=e.request)==null?void 0:t.params)==null?void 0:i[0];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const c=this.client.session.get(e.topic),h=((n=c==null?void 0:c.sessionProperties)==null?void 0:n.capabilities)||{};if(h!=null&&h[a])return h==null?void 0:h[a];const d=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:K1(H1({},c.sessionProperties||{}),{capabilities:K1(H1({},h||{}),{[a]:d})})})}catch(p){console.warn("Failed to update session with capabilities",p)}return d}async getCallStatus(e){var t,i;const n=this.client.session.get(e.topic),a=(t=n.sessionProperties)==null?void 0:t.bundler_name;if(a){const h=this.getBundlerUrl(e.chainId,a);try{return await this.getUserOperationReceipt(h,e)}catch(d){console.warn("Failed to fetch call status from bundler",d,h)}}const c=(i=n.sessionProperties)==null?void 0:i.bundler_url;if(c)try{return await this.getUserOperationReceipt(c,e)}catch(h){console.warn("Failed to fetch call status from custom bundler",h,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var i;const n=new URL(e),a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ds("eth_getUserOperationReceipt",[(i=t.request.params)==null?void 0:i[0]]))});if(!a.ok)throw new Error(`Failed to fetch user operation receipt - ${a.status}`);return await a.json()}getBundlerUrl(e,t){return`${hO}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}class IO{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const n=na(t);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||nn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new sn(new Dn(i,Lt("disableProviderPing")))}}class AO{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const n=na(t);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||nn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new sn(new Dn(i,Lt("disableProviderPing")))}}class PO{constructor(e){this.name="algorand",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const i=t||nn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||nn(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new sn(new Dn(i,Lt("disableProviderPing")))}}class DO{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const i=this.getCardanoRPCUrl(t),n=na(t);e[n]=this.createHttpProvider(n,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new sn(new Dn(i,Lt("disableProviderPing")))}}class OO{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const n=na(t);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||nn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new sn(new Dn(i,Lt("disableProviderPing")))}}class RO{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const n=na(t);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||nn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new sn(new Dn(i,Lt("disableProviderPing")))}}class CO{constructor(e){this.name="near",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||nn(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||nn(e,this.namespace);return typeof i>"u"?void 0:new sn(new Dn(i,Lt("disableProviderPing")))}}class NO{constructor(e){this.name=Aa,this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(an.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const i={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(n=>{const a=Ta(n);i[`${a.namespace}:${a.reference}`]=this.createHttpProvider(n)}),i}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||nn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new sn(new Dn(i,Lt("disableProviderPing")))}}var TO=Object.defineProperty,$O=Object.defineProperties,LO=Object.getOwnPropertyDescriptors,j1=Object.getOwnPropertySymbols,qO=Object.prototype.hasOwnProperty,UO=Object.prototype.propertyIsEnumerable,W1=(r,e,t)=>e in r?TO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vc=(r,e)=>{for(var t in e||(e={}))qO.call(e,t)&&W1(r,t,e[t]);if(j1)for(var t of j1(e))UO.call(e,t)&&W1(r,t,e[t]);return r},cl=(r,e)=>$O(r,LO(e));let BO=class vm{constructor(e){this.events=new kl,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:nf(vh({level:(e==null?void 0:e.logger)||$1})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new vm(e);return await t.initialize(),t}async request(e,t,i){const[n,a]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:vc({},e),chainId:`${n}:${a}`,topic:this.session.topic,expiry:i})}sendAsync(e,t,i,n){const a=new Date().getTime();this.request(e,i,n).then(c=>t(null,gh(a,c))).catch(c=>t(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ut("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:i,response:n}=await this.client.authenticate(e,t);i&&(this.uri=i,this.events.emit("display_uri",i));const a=await n();if(this.session=a.session,this.session){const c=z1(this.session.namespaces);this.namespaces=al(this.namespaces,c),this.persist("namespaces",this.namespaces),this.onConnect()}return a}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await n().then(a=>{this.session=a;const c=z1(a.namespaces);this.namespaces=al(this.namespaces,c),this.persist("namespaces",this.namespaces)}).catch(a=>{if(a.message!==um)throw a;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[i,n]=this.validateChain(e),a=this.getProvider(i);a.name===Aa?a.setDefaultChain(`${i}:${n}`,t):a.setDefaultChain(n,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Mn(t)){for(const i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await _d.init({core:this.providerOpts.core,logger:this.providerOpts.logger||$1,relayUrl:this.providerOpts.relayUrl||oO,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Ro(t)))];fl("client",this.client),fl("events",this.events),fl("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const i=bO(t,this.session),n=dm(i),a=al(this.namespaces,this.optionalNamespaces),c=cl(vc({},a[t]),{accounts:i,chains:n});switch(t){case"eip155":this.rpcProviders[t]=new MO({namespace:c});break;case"algorand":this.rpcProviders[t]=new PO({namespace:c});break;case"solana":this.rpcProviders[t]=new IO({namespace:c});break;case"cosmos":this.rpcProviders[t]=new AO({namespace:c});break;case"polkadot":this.rpcProviders[t]=new yO({namespace:c});break;case"cip34":this.rpcProviders[t]=new DO({namespace:c});break;case"elrond":this.rpcProviders[t]=new OO({namespace:c});break;case"multiversx":this.rpcProviders[t]=new RO({namespace:c});break;case"near":this.rpcProviders[t]=new CO({namespace:c});break;default:this.rpcProviders[Aa]?this.rpcProviders[Aa].updateNamespace(c):this.rpcProviders[Aa]=new NO({namespace:c})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:i}=t;if(i.name==="accountsChanged"){const n=i.data;n&&Mn(n)&&this.events.emit("accountsChanged",n.map(mO))}else if(i.name==="chainChanged"){const n=t.chainId,a=t.event.data,c=Ro(n),h=ol(n)!==ol(a)?`${c}:${ol(a)}`:n;this.onChainChanged(h)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i;const{namespaces:n}=t,a=(i=this.client)==null?void 0:i.session.get(e);this.session=cl(vc({},a),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",cl(vc({},Ut("USER_DISCONNECTED")),{data:e.topic}))}),this.on(an.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Aa]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:i,sessionProperties:n}=e;t&&Object.keys(t).length&&(this.namespaces=t),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=n,this.persist("namespaces",t),this.persist("optionalNamespaces",i)}validateChain(e){const[t,i]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,i];if(t&&!Object.keys(this.namespaces||{}).map(c=>Ro(c)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];const n=Ro(Object.keys(this.namespaces)[0]),a=this.rpcProviders[n].getDefaultChain();return[n,a]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[i,n]=this.validateChain(e);n&&(t||this.getProvider(i).setDefaultChain(n),this.namespaces[i]?this.namespaces[i].defaultChain=n:this.namespaces[`${i}:${n}`]?this.namespaces[`${i}:${n}`].defaultChain=n:this.namespaces[`${i}:${n}`]={defaultChain:n},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",n))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${L1}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${L1}/${e}`)}};const gm=BO,zO="wc",FO="ethereum_provider",kO=`${zO}@2:${FO}:`,HO="https://rpc.walletconnect.org/v1/",ql=["eth_sendTransaction","personal_sign"],KO=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],Ul=["chainChanged","accountsChanged"],jO=["chainChanged","accountsChanged","message","disconnect","connect"];var WO=Object.defineProperty,VO=Object.defineProperties,GO=Object.getOwnPropertyDescriptors,V1=Object.getOwnPropertySymbols,JO=Object.prototype.hasOwnProperty,YO=Object.prototype.propertyIsEnumerable,G1=(r,e,t)=>e in r?WO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Pa=(r,e)=>{for(var t in e||(e={}))JO.call(e,t)&&G1(r,t,e[t]);if(V1)for(var t of V1(e))YO.call(e,t)&&G1(r,t,e[t]);return r},hl=(r,e)=>VO(r,GO(e));function jc(r){return Number(r[0].split(":")[1])}function gc(r){return`0x${r.toString(16)}`}function XO(r){const{chains:e,optionalChains:t,methods:i,optionalMethods:n,events:a,optionalEvents:c,rpcMap:h}=r;if(!Mn(e))throw new Error("Invalid chains");const d={chains:e,methods:i||ql,events:a||Ul,rpcMap:Pa({},e.length?{[jc(e)]:h[jc(e)]}:{})},p=a==null?void 0:a.filter(O=>!Ul.includes(O)),b=i==null?void 0:i.filter(O=>!ql.includes(O));if(!t&&!c&&!n&&!(p!=null&&p.length)&&!(b!=null&&b.length))return{required:e.length?d:void 0};const w=(p==null?void 0:p.length)&&(b==null?void 0:b.length)||!t,R={chains:[...new Set(w?d.chains.concat(t||[]):t)],methods:[...new Set(d.methods.concat(n!=null&&n.length?n:KO))],events:[...new Set(d.events.concat(c!=null&&c.length?c:jO))],rpcMap:h};return{required:e.length?d:void 0,optional:t.length?R:void 0}}class xd{constructor(){this.events=new vi.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=kO,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new xd;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,i){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),i)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:i}=XO(this.rpc);try{const n=await new Promise(async(c,h)=>{var d;this.rpc.showQrModal&&((d=this.modal)==null||d.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),h(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(hl(Pa({namespaces:Pa({},t&&{[this.namespace]:t})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{c(p)}).catch(p=>{h(new Error(p.message))})});if(!n)return;const a=gv(n.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:gc(this.chainId)})}catch(n){throw this.signer.logger.error(n),n}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const i=await new Promise(async(a,c)=>{var h;this.rpc.showQrModal&&((h=this.modal)==null||h.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),c(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(hl(Pa({},e),{chains:this.rpc.chains}),t).then(d=>{a(d)}).catch(d=>{c(new Error(d.message))})}),n=i.session;if(n){const a=gv(n.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:gc(this.chainId)})}return i}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:i}=t;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",gc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",hl(Pa({},Ut("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,i;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(i=this.modal)==null||i.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",gc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,i,n]=e.split(":");return{chainId:`${t}:${i}`,address:n}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,i;const n=(t=e==null?void 0:e.chains)!=null?t:[],a=(i=e==null?void 0:e.optionalChains)!=null?i:[],c=n.concat(a);if(!c.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const h=n.length?(e==null?void 0:e.methods)||ql:[],d=n.length?(e==null?void 0:e.events)||Ul:[],p=(e==null?void 0:e.optionalMethods)||[],b=(e==null?void 0:e.optionalEvents)||[],w=(e==null?void 0:e.rpcMap)||this.buildRpcMap(c,e.projectId),R=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:n==null?void 0:n.map(O=>this.formatChainId(O)),optionalChains:a.map(O=>this.formatChainId(O)),methods:h,events:d,optionalMethods:p,optionalEvents:b,rpcMap:w,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:R,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const i={};return e.forEach(n=>{i[n]=this.getRpcUrl(n,t)}),i}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?jc(this.rpc.chains):jc(this.rpc.optionalChains),this.signer=await gm.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:i}=await zl(()=>import("./index-C_FqkN9J.js").then(n=>n.i),__vite__mapDeps([0,1]));t=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Pa({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:i,rpcMap:n}=e;t&&Mn(t)&&(this.rpc.chains=t.map(a=>this.formatChainId(a)),t.forEach(a=>{this.rpc.rpcMap[a]=(n==null?void 0:n[a])||this.getRpcUrl(a)})),i&&Mn(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(a=>this.formatChainId(a)),i.forEach(a=>{this.rpc.rpcMap[a]=(n==null?void 0:n[a])||this.getRpcUrl(a)}))}getRpcUrl(e,t){var i;return((i=this.rpc.rpcMap)==null?void 0:i[e])||`${HO}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}var ZO=class bm extends xd{constructor(e){super(),this.persistStorePrefix=e}static async initProvider(e,t){const i=new bm(t);return await i.initialize(e),i}async connect(e){const t=new MutationObserver(i=>{i.forEach(n=>{n.type!=="attributes"||n.attributeName!=="theme"||this.modal.closeModal()})});try{const i=document.querySelector("html");return t.observe(i,{attributes:!0}),await super.connect(e)}finally{t.disconnect()}}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?J1(this.rpc.chains):J1(this.rpc.optionalChains),this.signer=await gm.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions,storage:Da.init(this.persistStorePrefix)}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:i}=await zl(async()=>{const{WalletConnectModal:n}=await import("./index-C_FqkN9J.js").then(a=>a.i);return{WalletConnectModal:n}},__vite__mapDeps([0,1]));t=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t({projectId:this.rpc.projectId,...this.rpc.qrModalOptions})}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}async disconnect(){await super.disconnect(),await this.dropPersist()}async dropPersist(){return this.signer.client.core.storage.dropStorage()}},Da=class Co extends X_{static async dropStorage(e){await Co.init(e).dropStorage()}static async dropStorageByName(e){await new Co(e).dropStorage()}static getDatabaseName(e){return`wallet-connect-connection-storage-${e}`}static init(e){return new Co(Co.getDatabaseName(e))}constructor(e){super(e),this.version(1).stores({data:["key","value"].join(", ")})}async dropStorage(){this.delete()}async getKeys(){return await this.data.toCollection().keys()}async getEntries(){const e=[];return await this.data.each(t=>{e.push([t.key,t.value])}),e}async getItem(e){return await this.data.get(e).then(t=>t==null?void 0:t.value)}async setItem(e,t){await this.data.put({key:e,value:t})}async removeItem(e){await this.data.delete(e)}};function J1(r){return Number(r[0].split(":")[1])}var Y1=["accountsChanged"],NR=class Bl{constructor(){this.storage=new Map,this.activeAddress=null,this.eventEmitter=new i5}static async connect(){const e=new Bl;return await e.connect(),e}static async restoreConnect(){const e=new Bl;return await e.restoreConnect(),e}get signer(){var e;return this.activeAddress&&this.storage.has(this.activeAddress)?((e=this.storage.get(this.activeAddress))==null?void 0:e.provider)??null:null}get chainId(){var e;return((e=this.signer)==null?void 0:e.chainId)??J_.eth}async connect(){const e=Z_(10);try{const t=await X1(e),i=this.listenEvents(t),{topic:n,uri:a}=await t.signer.client.core.pairing.create();await t.connect({pairingTopic:n});const c=t.accounts[0];if(this.storage.has(c))return;const h={provider:t,topic:n,uri:a,address:c,persistStorePrefix:e,subscription:i};this.storage.set(c,h),this.activeAddress=c,this.updatePersist(),this.eventEmitter.emit("accountsChanged",this.getAddresses())}catch(t){throw await Da.dropStorage(e),t}}async restoreConnect(){const e=this.getPersistData();for(const t of e)try{const i=await X1(t.persistStorePrefix),n=this.listenEvents(i),a=i.accounts[0];if(a!==t.address){await Da.dropStorage(t.persistStorePrefix);continue}this.storage.set(a,{provider:i,uri:t.uri,topic:t.topic,address:t.address,persistStorePrefix:t.persistStorePrefix,subscription:n}),t.isActive&&(this.activeAddress=a)}catch(i){throw await Da.dropStorage(t.persistStorePrefix),i}this.eventEmitter.emit("accountsChanged",this.getAddresses())}setActiveAddress(e){e&&(this.activeAddress=e,this.eventEmitter.emit("accountsChanged",this.getAddresses()))}async disconnect(){}isConnected(){return this.activeAddress!==null}async request(e){var i;const t=e.method;return t==="eth_requestAccounts"||t==="eth_accounts"?this.getAddresses():await((i=this.signer)==null?void 0:i.request(e))??null}async enable(){return this.getAddresses()}on(e,t){var i;if(Y1.includes(e)){this.eventEmitter.on(e,t);return}(i=this.signer)==null||i.on(e,t)}removeListener(e,t){var i;if(Y1.includes(e)){this.eventEmitter.removeListener(e,t);return}(i=this.signer)==null||i.removeListener(e,t)}updatePersist(){const e=new Set,t=[];this.storage.forEach(({uri:i,topic:n,address:a,persistStorePrefix:c})=>{e.add(c),t.push({uri:i,topic:n,address:a,persistStorePrefix:c,isActive:!!this.activeAddress&&Q_(this.activeAddress,a)})}),this.cleanOldStorage().catch(),xp.set("wc2_persist",t)}getPersistData(){return xp.get("wc2_persist",JSON.parse)??[]}getAddresses(){const e=new Set;return this.activeAddress&&e.add(this.activeAddress),this.storage.forEach(t=>{e.add(t.address)}),[...e]}listenEvents(e){let t;return e5(Y_(e,"disconnect").pipe(t5(()=>{if(this.storage.forEach(i=>{i.provider===e&&(t=i.address)}),t&&this.storage.has(t)){const i=this.storage.get(t);if(this.storage.delete(t),i.subscription.unsubscribe(),this.activeAddress===t){const n=[...this.storage.values()][0];this.activeAddress=(n==null?void 0:n.address)??null}this.eventEmitter.emit("accountsChanged",this.getAddresses()),this.updatePersist()}}))).subscribe()}async cleanOldStorage(){const e=await indexedDB.databases(),t=new Set;this.storage.forEach(i=>t.add(Da.getDatabaseName(i.persistStorePrefix)));for(const i of e)i.name&&i.name.startsWith("wallet-connect")&&!t.has(i.name)&&await Da.dropStorageByName(i.name)}};async function X1(r){const e=await zl(()=>import("./wallet-connect-init-options-ACAHGVFG-DifWqtPm.js"),__vite__mapDeps([2,1,3,4,5])).then(t=>t.options());return await ZO.initProvider(e,r)}export{NR as MultiConnectProvider};
//# sourceMappingURL=multi-connect-provider-YOTZYVBH-e4dogchi.js.map
