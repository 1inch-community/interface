import{s as Ae,i as ge,r as b,k as S,Q as F}from"./index-DuIRcoZI.js";import{m as P,s as be,a as Me,L as p,f as we,O as $e,h as Y}from"./index.esm-DhwY4kHm.js";import{S as _e}from"./index.esm-OIwjBXxl.js";import{d as Ce}from"./defer-BRewiDsk.js";import{B as xe,c as ye}from"./combineLatest-Bzt_9bb6.js";import{a as J}from"./asap-D-qxMtYG.js";const{I:Ee}=Ae,Se=e=>e.strings===void 0,K=()=>document.createComment(""),mt=(e,t,n)=>{var i;const s=e._$AA.parentNode,a=t===void 0?e._$AB:t._$AA;if(n===void 0){const r=s.insertBefore(K(),a),u=s.insertBefore(K(),a);n=new Ee(r,u,e,e.options)}else{const r=n._$AB.nextSibling,u=n._$AM,h=u!==e;if(h){let d;(i=n._$AQ)==null||i.call(n,e),n._$AM=e,n._$AP!==void 0&&(d=e._$AU)!==u._$AU&&n._$AP(d)}if(r!==a||h){let d=n._$AA;for(;d!==r;){const v=d.nextSibling;s.insertBefore(d,a),d=v}}}return n},At=(e,t,n=e)=>(e._$AI(t,n),e),Re={},gt=(e,t=Re)=>e._$AH=t,bt=e=>e._$AH,Mt=e=>{var s;(s=e._$AP)==null||s.call(e,!1,!0);let t=e._$AA;const n=e._$AB.nextSibling;for(;t!==n;){const a=t.nextSibling;t.remove(),t=a}};const Ie={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},_=e=>(...t)=>({_$litDirective$:e,values:t});class X{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,n,s){this.t=t,this._$AM=n,this.i=s}_$AS(t,n){return this.update(t,n)}update(t,n){return this.render(...n)}}const m=(e,t)=>{var s;const n=e._$AN;if(n===void 0)return!1;for(const a of n)(s=a._$AO)==null||s.call(a,t,!1),m(a,t);return!0},M=e=>{let t,n;do{if((t=e._$AM)===void 0)break;n=t._$AN,n.delete(e),e=t}while((n==null?void 0:n.size)===0)},Z=e=>{for(let t;t=e._$AM;e=t){let n=t._$AN;if(n===void 0)t._$AN=n=new Set;else if(n.has(e))break;n.add(e),Le(t)}};function Te(e){this._$AN!==void 0?(M(this),this._$AM=e,Z(this)):this._$AM=e}function Ne(e,t=!1,n=0){const s=this._$AH,a=this._$AN;if(a!==void 0&&a.size!==0)if(t)if(Array.isArray(s))for(let i=n;i<s.length;i++)m(s[i],!1),M(s[i]);else s!=null&&(m(s,!1),M(s));else m(this,e)}const Le=e=>{e.type==Ie.CHILD&&(e._$AP??(e._$AP=Ne),e._$AQ??(e._$AQ=Te))};class D extends X{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,n,s){super._$AT(t,n,s),Z(this),this.isConnected=t._$AU}_$AO(t,n=!0){var s,a;t!==this.isConnected&&(this.isConnected=t,t?(s=this.reconnected)==null||s.call(this):(a=this.disconnected)==null||a.call(this)),n&&(m(this,t),M(this))}setValue(t){if(Se(this.t))this.t._$AI(t,this);else{const n=[...this.t._$AH];n[this.i]=t,this.t._$AI(n,this,0)}}disconnected(){}reconnected(){}}function Be(e,t){return Pe(e,t)}function Pe(e,t,n){if(e===t)return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;for(const i of s)if(!a.includes(i)||e[i]!==t[i])return!1;return!0}var De=class extends D{render(e,t){return this.subscription?this.lastValue??t??"":(this.subscription=e.pipe(Y(J)).subscribe(n=>{this.lastValue=n,this.setValue(n)}),t??"")}disconnected(){var e;(e=this.subscription)==null||e.unsubscribe()}},He=_(De),Oe=class extends D{constructor(){super(...arguments),this.isDisconnected=!1,this.handler=e=>{this.isDisconnected||this.setValue(e)}}render(e,t){return e.then(this.handler),t??""}disconnected(){this.isDisconnected=!0}},Ve=_(Oe);function T(e,t){for(const n in t)e.style[n]=t[n]??""}var ee=class extends X{constructor(e){super(e),this.view=document.createElement("div"),this.lock=!1,T(this.view,{display:"flex",gap:"8px",position:"relative"})}render(e,t){return this.applyDirection(t.direction),this.lock?S`${this.view}`:this.view.children.length?(this.transition(e,t).catch(console.error),S`${this.view}`):(this.addedElementsWithoutAnimation(e,t),S`${this.view}`)}async transition(e,t){var U,k,q,W;const[n,s]=this.getKeyMapAndIndexMap(e,t),a=this.getIndexMapFromView(),i=this.getAllRenderCandidate(a,s),r=this.getAllRemoveCandidate(a,s),u=this.getAllMoveCandidate(a,s),h=this.getAllRenderCandidateElements(i,n,t),d=this.getAllCandidateElements(r),v=this.getAllCandidateElements(u),x=new Map,y=new Map,E=new Map;h.forEach((c,o)=>{x.set(s.get(o),c)}),d.forEach((c,o)=>{y.set(a.get(o),c)}),v.forEach((c,o)=>{E.set([a.get(o),s.get(o)],c)});const O=[...h.entries()],V=[...d.entries()],z=[...v.entries()];await((U=t.onAnimationStart)==null?void 0:U.call(t));const[dt,ve,pe,me]=await Promise.all([(k=t.onBeforeAnimation)==null?void 0:k.call(t,this.view,x,y,E),this.executeHandlerAndReturnResultMap(O,(c,o)=>t.onBeforeRenderAnimateItem(c,s.get(o))),this.executeHandlerAndReturnResultMap(V,(c,o)=>t.onBeforeRemoveAnimateItem(c,a.get(o))),this.executeHandlerAndReturnResultMap(z,(c,o)=>{var l;return((l=t.onBeforeMoveAnimationItem)==null?void 0:l.call(t,c,a.get(o),s.get(o)))??Promise.resolve()})]);this.renderNode(h,s),this.removeNode(d),this.moveNode(v,a,s),await Promise.all([this.executeHandlerAndReturnResultMap(O,(c,o)=>{var l;return((l=t.onAfterRenderAnimateItem)==null?void 0:l.call(t,c,s.get(o),ve.get(o)))??Promise.resolve()}),this.executeHandlerAndReturnResultMap(V,(c,o)=>{var l;return((l=t.onAfterRemoveAnimateItem)==null?void 0:l.call(t,c,a.get(o),pe.get(o)))??Promise.resolve()}),this.executeHandlerAndReturnResultMap(z,(c,o)=>{var l;return((l=t.onAfterMoveAnimationItem)==null?void 0:l.call(t,c,me.get(o)))??Promise.resolve()}),(q=t.onAfterAnimation)==null?void 0:q.call(t,this.view,x,y,E)]),await((W=t.onAnimationComplete)==null?void 0:W.call(t))}async executeHandlerAndReturnResultMap(e,t){const n=new Map;return await Promise.all(e.map(async([s,a])=>{const i=await t(a,s);n.set(s,i)})),n}getAllRenderCandidate(e,t){const n=new Set;return t.forEach((s,a)=>{e.has(a)||n.add(a)}),n}getAllRemoveCandidate(e,t){const n=new Set;return e.forEach((s,a)=>{t.has(a)||n.add(a)}),n}getAllMoveCandidate(e,t){const n=new Set;return new Set([...e.keys(),...t.keys()]).forEach(a=>{const i=e.get(a),r=t.get(a);i===void 0||r===void 0||i!==r&&n.add(a)}),n}getAllRenderCandidateElements(e,t,n){const s=new Map;let a=0;return e.forEach(i=>{const r=t.get(i);if(!r)return;const u=this.createItem(i),h=n.onTemplateBuilder(r,a);F(h,u),s.set(i,u),a++}),s}getAllCandidateElements(e){const t=new Map;return e.forEach(n=>{const s=this.view.querySelector(`#${n}`);s&&t.set(n,s)}),t}renderNode(e,t){e.forEach((n,s)=>{const a=t.get(s)??0,i=this.view.children[a];i?this.view.insertBefore(n,i):this.view.appendChild(n)})}removeNode(e){e.forEach(t=>{t.remove()})}moveNode(e,t,n){const s=this.getIndexMapFromView();e.forEach((a,i)=>{const r=t.get(i),u=n.get(i);if(s.get(i)===u)return;let d;r>u&&(d=this.view.children[u]),r<u&&(d=this.view.children[r]),d&&this.view.insertBefore(a,d)})}getKeyMapAndIndexMap(e,t){const n=new Map,s=new Map;let a=0;for(const i of e){const r=t.onKeyExtractor(i,a);n.set(r,i),s.set(r,a),a++}return[n,s]}getIndexMapFromView(){const e=new Map;let t=0;return this.view.childNodes.forEach(n=>{e.set(n.id,t++)}),e}addedElementsWithoutAnimation(e,t){let n=0;for(const s of e){const a=t.onKeyExtractor(s,n),i=this.createItem(a),r=t.onTemplateBuilder(s,n);F(r,i),this.view.appendChild(i),n++}}createItem(e){const t=document.createElement("div");return t.id=e.toString(),t}applyDirection(e){let t;e==="vertical"&&(t="column"),e==="horizontal"&&(t="row"),T(this.view,{flexDirection:t})}},ze=_(ee);function te(e,t){const n=document.createElement(e);if(t&&typeof t=="function")try{t(n)}catch(s){console.error("call side effect error",s)}return document.head.appendChild(n),n}function Ue(e){te("style",t=>ne(t,e))}function ne(e,t){e.textContent=t.cssText}function se(e,t,n){return new CustomEvent(e,{bubbles:!0,composed:!0,detail:{value:t,event:n}})}function ke(e,t,n,s){e.dispatchEvent(se(t,n,s))}function qe(e=40){try{navigator.vibrate(e)}catch{}}var We={requestUpdate:!0},Fe=class{constructor(e,t,n){this.host=e,this.observers=t,e.addController(this),this.config={...We,...n},this.subscribe()}hostDisconnected(){var e;(e=this.subscription)==null||e.unsubscribe()}subscribe(){const e=ye(Array.isArray(this.observers)?this.observers:[this.observers]);this.subscription=e.subscribe(()=>{this.config.requestUpdate&&this.host.requestUpdate()})}};function ae(e,t,n){return new Fe(e,t,n)}var ie="screen and (max-width: 610px)",R;function A(){return R||(R=matchMedia(ie)),R}function Ke(e){return ge`
      @media ${b(ie)} {
          ${b(e)}
      }
  `}var re=Ce(()=>we(A(),"change")).pipe(P(()=>A()),be(A()),Me({bufferSize:0,refCount:!0}));function oe(e){ae(e,[re])}function Qe(){return re}function je(e){return oe(e),A()}function ce(){const e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")&&!e.includes("crios")}function de(){var e;return((e=window==null?void 0:window.navigator)==null?void 0:e.standalone)??!1}function Ge(e){return ce()&&de()?b(e):b("")}var I=new WeakMap;function Ye(e){if(I.has(e))return I.get(e);const t=new $e(n=>{const s=new ResizeObserver(a=>n.next(a[0]));return s.observe(e),()=>{s.unobserve(e)}});return I.set(e,t),t}var Je=[p.ar];function H(e){return Je.includes(e)}var w=at(),$=new Map,C=new xe(null),N,L,g=p.en,Q=0,j=0,B=document.querySelector("html"),Xe=C.pipe(P(()=>g));function ue(e){B=e}async function Ze(e){for(const t in e){const n=Reflect.get(e,t),s=$.get(t)??[];s.push(n),$.set(t,s)}await fe(g)}async function f(e){await fe(e)}function le(e,t){return C.pipe(P(n=>{if(!n)return"";const s=n[e]??"";return t&&s.includes("{{")&&s.includes("}}")?et(s,t):s}))}function et(e,t){let n=e;for(const s in t){const a=t[s],i=`{{${s}}}`;n=n.replaceAll(i,`${a}`)}return n}var he=e=>e.reduce((t,n)=>({...t,...n}),{});async function fe(e){B.dir=H(e)?"rtl":"ltr",await Promise.all([tt(),nt(e)]),g=e,B.lang=e}async function tt(){const e=$.get(w)??[];if(e.length!==Q){const t=await Promise.all(e.map(n=>n()));N=he(t),C.next({...N,...L}),Q=e.length}}async function nt(e){const t=$.get(e)??[];if(g!==e||t.length!==j){const n=await Promise.all(t.map(s=>s()));L=he(n),C.next({...N,...L}),j=t.length}}function st(){return H(g)}function at(){try{const t=(navigator.language||navigator.userLanguage).slice(0,2);return t in p?t:p.en}catch{return p.en}}Reflect.set(window,"changeLocale",f);var G="",it=class extends D{render(e,t){return this.subscription&&this.lastPath===e&&Be(this.lastContext,t)?this.lastValue??G:(this.disconnected(),this.subscription=le(e,t).pipe(Y(J)).subscribe(n=>{this.setValue(n),this.lastValue=n,this.lastPath=e,this.lastContext=t}),this.lastValue??G)}disconnected(){var e;(e=this.subscription)==null||e.unsubscribe()}},rt=_(it),ot=class{constructor(){this.i18nSettings=new _e("i18n",w)}async init(){const e=this.i18nSettings.value??w;await f(e)}async changeLocale(e){return this.i18nSettings.setValue(e),await f(e)}},ct=class{constructor(e,t){this.localeCode=e,ue(t)}async init(){await f(this.localeCode)}async changeLocale(e){return await f(e)}};const wt=Object.freeze(Object.defineProperty({__proto__:null,AnimationMap:ee,I18nController:ot,I18nEmbeddedController:ct,addTranslation:Ze,animationMap:ze,appendStyle:T,applyStyle:ne,async:Ve,buildEvent:se,changeLocaleAndUpdate:f,changeMobileMatchMedia:oe,createAndAppendInHeaderElement:te,createAndApplyStyle:Ue,defaultLocaleCode:w,dispatchEvent:ke,getMobileMatchMedia:A,getMobileMatchMediaAndSubscribe:je,getMobileMatchMediaEmitter:Qe,isRTL:H,isRTLCurrentLocale:st,isSafari:ce,isStandalone:de,listenChangesByPath:le,localeChange$:Xe,mobileMediaCSS:Ke,observe:He,resizeObserver:Ye,safariPWACss:Ge,setTargetHost:ue,subscribe:ae,translate:rt,vibrate:qe},Symbol.toStringTag,{value:"Module"}));export{D as $,Qe as A,de as B,ze as C,ne as D,te as E,Ue as F,wt as G,ae as a,T as b,oe as c,ke as d,je as e,Ve as f,A as g,se as h,st as i,ce as j,Ze as k,Xe as l,Ke as m,_ as n,He as o,X as p,Ie as q,Ye as r,Ge as s,rt as t,bt as u,qe as v,At as w,mt as x,Mt as y,gt as z};
//# sourceMappingURL=index.esm-CXOrnIqP.js.map
