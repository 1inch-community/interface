import{i as h,a as T,c as y,t as k,b as F,n as g,s as z,d as w,e as X,f as O,x as o,h as Q,R as G,B as S,S as H,j as J,k as R,l as V,o as q,p as K,q as E,u as f,T as m,v as L,w as A,y as $,z as Y,A as B,C as Z,D as N,E as tt,F as et,G as P,H as st,I as C,J as M,K as nt,L as rt,M as it,N as j,O as U,P as W,Q as ot,U as at,V as ct}from"./index-B1ZAnK58.js";var lt=Object.defineProperty,dt=Object.getOwnPropertyDescriptor,n=(t,e,s,i)=>{for(var r=i>1?void 0:i?dt(e,s):e,a=t.length-1,p;a>=0;a--)(p=t[a])&&(r=(i?p(e,s,r):p(r))||r);return i&&r&&lt(e,s,r),r},ht=h`:host{display:flex;flex-direction:column;height:100%;width:100%}`,I=Q(Symbol("select token context")),pt=class{constructor(){this.chainId$=new G(1),this.connectedWalletAddress$=new S(null),this.searchToken$=new S(""),this.changeFavoriteTokenState$=new H,this.searchInProgress$=new S(!1),this.favoriteTokens$=this.chainId$.pipe(J(t=>m.liveQuery(()=>m.getAllFavoriteTokenAddresses(t)))),this.tokenAddressList$=R([this.chainId$,this.connectedWalletAddress$,this.searchToken$.pipe(V(300),q(""),K())]).pipe(E(([t,e,s])=>m.getSortedForViewTokenAddresses(t,s,e??void 0)),f(()=>this.searchInProgress$.next(!1)))}setChainId(t){this.chainId$.next(t)}setConnectedWalletAddress(t){this.connectedWalletAddress$.next(t??null)}async setFavoriteTokenState(t,e,s){await m.setFavoriteState(t,e,s),this.changeFavoriteTokenState$.next([t,e])}setSearchToken(t){this.searchInProgress$.next(!0),this.searchToken$.next(t)}getSearchTokenValue(){return this.searchToken$.value}},ut=h`.search-token-input-container{display:flex;background-color:var(--color-background-bg-secondary);height:48px;border-radius:12px;color:var(--color-content-content-tertiary);align-items:center;padding-left:12px;padding-right:12px;box-sizing:border-box;gap:8px;margin-top:5px;transition:box-shadow .2s}.search-token-input{border:none;background-color:transparent;height:100%;width:100%;outline:0;color:var(--color-content-content-primary);font-size:16px;font-style:normal;font-weight:400;line-height:24px}.loader{width:24px;min-width:24px;height:24px;min-height:24px;border-radius:50%;border:2px solid;border-bottom-color:var(--secondary);border-top-color:var(--secondary);animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.search-token-input::placeholder{color:var(--color-content-content-secondary)}@media (hover:hover){.search-token-input-container:hover{box-shadow:0 0 0 1px var(--primary)}}.search-token-input-container__focused{box-shadow:0 0 0 1px var(--primary)}`,l=class extends w{constructor(){super(...arguments),this.isFocused=!1,this.searchInProgress=!1}render(){const t={"search-token-input-container":!0,"search-token-input-container__focused":this.isFocused};return o`<div class="${L(t)}"><inch-icon icon="search24"></inch-icon><input id="search" autofocus autocomplete="off" maxlength="40" @input="${e=>this.onChange(e)}" @focus="${()=>this.isFocused=!0}" @blur="${()=>this.isFocused=!1}" placeholder="Search token by name or address" class="search-token-input"> ${A(this.searchInProgress,()=>o`<span class="loader"></span>`,()=>o``)}</div>`}async firstUpdated(){var e;const t=this.renderRoot.querySelector("#search");t&&(this.sceneContext&&this.sceneContext.animationInProgress&&await this.sceneContext.animationInEnd,requestAnimationFrame(()=>t.focus()),$(this,[((e=this.context)==null?void 0:e.searchInProgress$.pipe(f(s=>this.searchInProgress=s)))??Y()],{requestUpdate:!1}))}onChange(t){var s;const e=t.target.value;(s=this.context)==null||s.setSearchToken(e)}};l.tagName="inch-search-token-input";l.styles=ut;n([T()],l.prototype,"isFocused",2);n([T()],l.prototype,"searchInProgress",2);n([y({context:B})],l.prototype,"sceneContext",2);n([y({context:I})],l.prototype,"context",2);l=n([k(l.tagName)],l);var mt=h`:host{height:72px;width:100%;outline:0;user-select:none;-webkit-tap-highlight-color:transparent}.item-container{padding:12px 16px;display:flex;gap:8px;align-items:center;cursor:pointer;border-radius:16px;transition:background-color .2s}.name-and-balance{display:flex;flex-direction:column;gap:4px;max-width:50%}.name-and-balance .name{color:var(--color-content-content-primary);font-size:16px;font-style:normal;font-weight:500;line-height:24px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.name-and-balance .balance{color:var(--color-content-content-secondary);font-size:14px;font-style:normal;font-weight:400;line-height:20px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.usd-balance{color:var(--color-content-content-primary);text-align:right;font-size:16px;font-style:normal;font-weight:500;line-height:24px;white-space:nowrap}.usd-balance-and-favorite-start{display:flex;align-items:center;margin-left:auto}.is-favorite-start{width:32px;height:32px;display:flex;align-items:center;justify-content:center}@media (hover:hover){.item-container:hover{background-color:var(--color-background-bg-secondary)}.item-container:not(.is-favorite-token) .usd-balance{transform:translateX(24px);transition:transform .2s}.item-container:not(.is-favorite-token) .is-favorite-start{transform:scale(0);transition:transform .2s}.item-container:hover .is-favorite-start{transform:scale(1)}.item-container:hover .usd-balance{transform:translateX(0)}}${F(h`.item-container{padding:8px 8px}`)}.item-container:active{background-color:var(--color-background-bg-secondary)}`,ft=h`:host{height:72px;width:100%}.item-container{padding:12px 16px;display:flex;gap:8px;align-items:center;cursor:pointer;border-radius:16px;transition:background-color .2s}.name-and-balance{display:flex;flex-direction:column;gap:4px;width:100%}.stub-loader{will-change:filter;animation:stub-loader-animation 3s ease-in-out infinite}.stub-token-icon{min-width:40px;min-height:40px;border-radius:50%;background-color:var(--color-background-bg-secondary)}.name-stub{background-color:var(--color-background-bg-secondary);height:24px;width:40%;border-radius:8px}.balance-stub{background-color:var(--color-background-bg-secondary);height:20px;width:30%;border-radius:8px}@keyframes stub-loader-animation{0%,100%{filter:opacity(1)}50%{filter:opacity(.5)}}${F(h`.item-container{padding:8px 8px}`)}`,x=class extends w{constructor(){super(...arguments),this.notShowLoader=!1}render(){const t={"item-container":!0,"stub-loader":!this.notShowLoader};return o`<div class="${L(t)}"><div class="stub-token-icon"></div><div class="name-and-balance"><span class="name-stub"></span> <span class="balance-stub"></span></div></div>`}};x.tagName="inch-token-list-stub-item";x.styles=ft;n([g({type:Boolean,attribute:!0})],x.prototype,"notShowLoader",2);x=n([k(x.tagName)],x);function D(t,e,s){ot(t,"selectToken",e,s)}var d=class extends w{constructor(){super(...arguments),this.isDestroy=!1,this.preRenderTemplate=null,this.isFavorite=!1,this.task=new Z(this,async([t,e,s,i])=>{if(i){const u=this.task.value;if(u)return u}if(!t||!e)return[];if(this.isDestroy)throw new Error("");const r=await m.getToken(t,e);let a=null,p=null;if(s&&r){a=await m.getTokenBalance(t,e,s);const u=await m.getTokenUSDPrice(t,e),_=N(BigInt((a==null?void 0:a.amount)??0),r.decimals);p=Number(_)*Number(u)}return[r,a,p]},()=>[this.chainId,this.tokenAddress,this.walletAddress,!1])}disconnectedCallback(){super.disconnectedCallback(),this.isDestroy=!0}firstUpdated(){$(this,tt(et(12e3),this.getTokenUpdateEmitter()).pipe(E(()=>this.task.run([this.chainId,this.tokenAddress,this.walletAddress,!1]))),{requestUpdate:!1})}render(){return o`${this.task.render({complete:([t,e,s])=>this.getTokenView(t,e,s),pending:()=>this.preRenderTemplate?this.preRenderTemplate:this.getStub(),error:()=>this.preRenderTemplate?this.preRenderTemplate:this.getStub()})}`}getTokenView(t,e,s){if(!t)return this.getStub();this.isFavorite=t.isFavorite??!1;let i="0";e&&(i=P(N(BigInt(e.amount),t.decimals),6));let r="$0";s&&(r="$"+P(s.toString(),2));let a={border:"var(--color-border-border-secondary)",body:"none"};this.isFavorite&&(a={border:"var(--color-core-orange-warning)",body:"var(--color-core-orange-warning)"});const p={"item-container":!0,"is-favorite-token":t.isFavorite};return this.preRenderTemplate=o`<div class="${L(p)}" @click="${u=>D(this,t,u)}"><inch-token-icon symbol="${t.symbol}" address="${t.address}" chainId="${t.chainId}" size="40"></inch-token-icon><div class="name-and-balance"><span class="name">${t.name}</span> <span class="balance">${i} ${t.symbol}</span></div><div class="usd-balance-and-favorite-start"><span class="usd-balance">${r}</span><inch-icon class="is-favorite-start" @click="${u=>this.onMarkFavoriteToken(u,t)}" icon="startDefault16" .props="${a}"></inch-icon></div></div>`,this.preRenderTemplate}async onMarkFavoriteToken(t,e){var s;t.preventDefault(),t.stopPropagation(),this.isFavorite=!e.isFavorite,await this.task.run([this.chainId,this.tokenAddress,this.walletAddress,!0]),await((s=this.context)==null?void 0:s.setFavoriteTokenState(e.chainId,e.address,!e.isFavorite))}getTokenUpdateEmitter(){if(!this.context)throw new Error("");return this.context.changeFavoriteTokenState$.pipe(st(([t,e])=>{var i,r;const s=((r=(i=this.task)==null?void 0:i.value)==null?void 0:r[0])??null;return s&&s.chainId===t&&at(s.address,e)}))}getStub(){return o`<inch-token-list-stub-item></inch-token-list-stub-item>`}};d.tagName="inch-token-list-item";d.styles=mt;n([g({type:String,attribute:!0})],d.prototype,"tokenAddress",2);n([g({type:String,attribute:!0})],d.prototype,"walletAddress",2);n([g({type:Number,attribute:!0})],d.prototype,"chainId",2);n([y({context:I})],d.prototype,"context",2);d=n([k(d.tagName)],d);var vt=h`:host{height:50vh;width:100%}.overlay-message{position:absolute;top:35%;left:0;width:100%;text-align:center;color:var(--color-content-content-primary);display:flex;flex-direction:column;justify-content:center;align-items:center}${F(h`:host{height:100%;width:100%}`)}`,c=class extends w{constructor(){super(...arguments),this.chainId=null,this.walletAddress=null,this.isEmpty=!1,this.addressList$=C(()=>this.getTokenAddressList()).pipe(f(t=>{this.isEmpty=t.length===0,this.requestUpdate()}),M({refCount:!0,bufferSize:1}))}render(){var r;const e=(((r=this.context)==null?void 0:r.getSearchTokenValue())??"")!=="",s=!nt(this.chainId),i=rt(this.chainId??it.eth);return o`${A(s,()=>o`<div class="overlay-message"><h3>Unsupported chain</h3></div>`)} ${A(this.isEmpty&&e&&!s,()=>o`<div class="overlay-message"><inch-icon icon="emptySearch"></inch-icon><h3>Token not found on ${i.name} Network</h3><span>Try changing your search query, or switch to another Network</span></div>`)}<inch-scroll-view-virtualizer-consumer .header="${this.header}" .items="${j(this.addressList$,this.getStubAddresses())}" .keyFunction="${a=>[this.chainId,this.walletAddress,a].join(":")}" .renderItem="${a=>o`<inch-token-list-item tokenAddress="${a}" walletAddress="${U(this.walletAddress??void 0)}" chainId="${U(this.chainId??void 0)}"></inch-token-list-item>`}"></inch-scroll-view-virtualizer-consumer>`}async firstUpdated(){$(this,[this.getConnectedWalletAddress().pipe(f(t=>this.walletAddress=t)),this.getChainId().pipe(f(t=>this.chainId=t)),this.addressList$],{requestUpdate:!1}),$(this,[this.getFavoriteTokens()])}getTokenAddressList(){if(!this.context)throw new Error("");return this.context.tokenAddressList$}getChainId(){if(!this.context)throw new Error("");return this.context.chainId$}getFavoriteTokens(){if(!this.context)throw new Error("");return this.context.favoriteTokens$}getConnectedWalletAddress(){if(!this.context)throw new Error("");return this.context.connectedWalletAddress$}getStubAddresses(){return Array.from(Array(30)).map((t,e)=>`0x${e.toString(16)}`)}};c.tagName="inch-token-list";c.styles=[vt,z];n([g({type:Object})],c.prototype,"header",2);n([y({context:I})],c.prototype,"context",2);n([y({context:B})],c.prototype,"sceneContext",2);n([T()],c.prototype,"chainId",2);n([T()],c.prototype,"walletAddress",2);n([T()],c.prototype,"isEmpty",2);c=n([k(c.tagName)],c);var gt=h`:host{display:flex;width:100%;height:60px}:host(.empty){height:16px;padding-bottom:0;margin-bottom:0}:host(.transition-host){transition:height .2s,padding-bottom .2s,margin-bottom .2s}:host(.remove-favorite-token-show) .remove-favorite-token{transform:scale(1) translate(0,0)}.favorite-container-scroll{overflow-y:hidden;overflow-x:auto;position:relative;width:100%;padding-top:16px;padding-bottom:8px;margin-bottom:8px;height:36px}.favorite-container{display:flex;gap:12px;height:36px;position:absolute}::-webkit-scrollbar{height:2px}.favorite-container-scroll::-webkit-scrollbar-thumb{transition:background-color .2s;background:var(--color-background-bg-primary)}.favorite-token-item-container{position:relative}.remove-favorite-token{position:absolute;top:-8px;right:-8px;width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center;background-color:var(--color-background-bg-secondary);z-index:9;transition:transform .2s;transform:scale(0) translate(-16px,16px);cursor:pointer;color:var(--color-content-content-primary)}@media (hover:hover){.favorite-container-scroll:hover::-webkit-scrollbar-thumb{background:var(--primary)}.favorite-token-item-container:hover .remove-favorite-token{transform:scale(1) translate(0,0)}.remove-favorite-token:hover{background-color:var(--secondary-hover)}.edit-favorite-token-list{display:none}}`,b=class extends w{constructor(){super(...arguments),this.editAllMode$=new S(!1),this.favoriteTokensView$=R([C(()=>this.getFavoriteTokens()),C(()=>this.getChainId())]).pipe(V(0),E(([t,e])=>m.getTokenList(e,t)),W(t=>t.sort((e,s)=>s.priority-e.priority)),q([]),f(t=>{t.length&&this.classList.contains("empty")&&this.classList.remove("empty"),!t.length&&!this.classList.contains("empty")&&this.classList.add("empty")}),f(()=>{this.classList.contains("transition-host")||setTimeout(()=>{this.classList.add("transition-host")},300)}),W(t=>(t.length&&t.push(null),o`<div class="favorite-container-scroll"><div class="favorite-container">${o`${ct(t,e=>e!==null?"t"+e.address:"edit",xt,e=>A(e,s=>o`<div class="favorite-token-item-container"><div class="remove-favorite-token" @click="${i=>this.onRemoveFavoriteToken(s,i)}"><inch-icon icon="cross8"></inch-icon></div><inch-button size="m" type="secondary" class="favorite-token-item" @click="${i=>D(this,s,i)}"><inch-token-icon symbol="${s.symbol}" address="${s.address}" chainId="${s.chainId}"></inch-token-icon><span>${s.symbol}</span></inch-button></div>`,()=>o`<inch-button size="l" type="secondary" class="favorite-token-item edit-favorite-token-list" @click="${()=>this.editAllMode$.next(!this.editAllMode$.value)}"><inch-icon icon="edit24"></inch-icon></inch-button>`))}`}</div></div>`)),M({bufferSize:1,refCount:!0}))}firstUpdated(){$(this,this.editAllMode$.pipe(f(t=>{t?this.classList.add("remove-favorite-token-show"):this.classList.remove("remove-favorite-token-show")})),{requestUpdate:!1})}render(){return o`${j(this.favoriteTokensView$)}`}getFavoriteTokens(){if(!this.context)throw new Error("");return this.context.favoriteTokens$}getChainId(){if(!this.context)throw new Error("");return this.context.chainId$}async onRemoveFavoriteToken(t,e){var s;e.stopPropagation(),e.preventDefault(),await((s=this.context)==null?void 0:s.setFavoriteTokenState(t.chainId,t.address,!1))}};b.tagName="inch-favorite-tokens";b.styles=[gt,z];n([y({context:I})],b.prototype,"context",2);b=n([k(b.tagName)],b);var xt={deleteElement:async t=>{t.style.overflow="hidden",await t.animate([{flexBasis:`${t.offsetWidth}px`,transform:"scale(1) translateX(0)"},{flexBasis:"0",transform:"scale(0) translateX(-20%)"}],{duration:t.id==="edit"?50:150}).finished,t.style.overflow=""},addedElement:async t=>{t.style.overflow="hidden",t.style.transform="scale(0) translateX(-20%)",t.style.position="absolute",t.style.top="-9999",t.style.left="-9999",document.body.appendChild(t),await new Promise(s=>requestAnimationFrame(s));const e=t.offsetWidth;return t.remove(),t.style.position="",t.style.top="",t.style.left="",async s=>{await s.animate([{flexBasis:"0",transform:"scale(0) translateX(-20%)"},{flexBasis:`${e}px`,transform:"scale(1) translateX(0)"}],{duration:150}).finished,s.style.transform="",s.style.overflow=""}}},v=class extends w{constructor(){super(...arguments),this.context=new X(this,{context:I})}connectedCallback(){super.connectedCallback(),O(this)}render(){return this.initContext(),o`<inch-token-list .header="${()=>o`<div style="margin-left:1px;margin-right:1px"><inch-card-header backButton headerText="Select token"></inch-card-header><inch-search-token-input></inch-search-token-input><inch-favorite-tokens></inch-favorite-tokens></div>`}"></inch-token-list>`}updated(t){let e=!1;const s=this.context.value;t.has("chainId")&&this.chainId&&(s.setChainId(this.chainId),e=!0),t.has("connectedWalletAddress")&&(s.setConnectedWalletAddress(this.connectedWalletAddress),e=!0),e&&this.requestUpdate()}initContext(){if(this.context.value)return;const{chainId:t,connectedWalletAddress:e}=this;if(!t)throw new Error("");const s=new pt;s.setChainId(t),s.setConnectedWalletAddress(e),this.context.setValue(s)}};v.tagName="inch-select-token";v.styles=ht;n([g({type:Number})],v.prototype,"chainId",2);n([g({type:String})],v.prototype,"connectedWalletAddress",2);v=n([k(v.tagName)],v);export{v as SelectTokenElement};
//# sourceMappingURL=index.esm-DdLNRXdt.js.map
