{"version":3,"file":"index.esm-CjXD2v0E.js","sources":["../../../libs/core/settings/index.esm.js"],"sourcesContent":["// libs/core/src/lib/settings/settings.controller.ts\nimport { BehaviorSubject } from \"rxjs\";\nimport { JsonParser, storage } from \"@one-inch-community/core/storage\";\nvar SettingsController = class {\n  constructor(name, initValue = null) {\n    this.name = name;\n    this.initValue = initValue;\n    this.valueState$ = new BehaviorSubject(getPersistValue(this.name) ?? this.initValue);\n    this.value$ = this.valueState$;\n    this.originalValue = null;\n  }\n  get value() {\n    return this.valueState$.value;\n  }\n  setValue(value) {\n    this.valueState$.next(value);\n    updatePersist(this.name, value);\n  }\n  resetValue() {\n    this.valueState$.next(this.originalValue);\n    updatePersist(this.name, this.originalValue);\n  }\n  cleanValue() {\n    this.valueState$.next(null);\n    updatePersist(this.name, null);\n  }\n  startChangingValue() {\n    if (this.originalValue !== null) {\n      throw new Error(\"value changing in progress\");\n    }\n    this.originalValue = this.value;\n  }\n  endChangingValue() {\n    this.originalValue = null;\n  }\n};\nvar persistStorageKey = \"one-inch-settings\";\nfunction updatePersist(name, value) {\n  const data = storage.get(persistStorageKey, JsonParser) ?? {};\n  storage.set(persistStorageKey, { ...data, [name]: value });\n}\nfunction getPersistValue(name) {\n  const data = storage.get(persistStorageKey, JsonParser);\n  if (data === null) return null;\n  return Reflect.get(data, name);\n}\nexport {\n  SettingsController\n};\n//# sourceMappingURL=index.esm.js.map\n"],"names":["SettingsController","name","initValue","BehaviorSubject","getPersistValue","value","updatePersist","persistStorageKey","data","storage","JsonParser"],"mappings":"kHAGG,IAACA,EAAqB,KAAM,CAC7B,YAAYC,EAAMC,EAAY,KAAM,CAClC,KAAK,KAAOD,EACZ,KAAK,UAAYC,EACjB,KAAK,YAAc,IAAIC,EAAgBC,EAAgB,KAAK,IAAI,GAAK,KAAK,SAAS,EACnF,KAAK,OAAS,KAAK,YACnB,KAAK,cAAgB,IACtB,CACD,IAAI,OAAQ,CACV,OAAO,KAAK,YAAY,KACzB,CACD,SAASC,EAAO,CACd,KAAK,YAAY,KAAKA,CAAK,EAC3BC,EAAc,KAAK,KAAMD,CAAK,CAC/B,CACD,YAAa,CACX,KAAK,YAAY,KAAK,KAAK,aAAa,EACxCC,EAAc,KAAK,KAAM,KAAK,aAAa,CAC5C,CACD,YAAa,CACX,KAAK,YAAY,KAAK,IAAI,EAC1BA,EAAc,KAAK,KAAM,IAAI,CAC9B,CACD,oBAAqB,CACnB,GAAI,KAAK,gBAAkB,KACzB,MAAM,IAAI,MAAM,4BAA4B,EAE9C,KAAK,cAAgB,KAAK,KAC3B,CACD,kBAAmB,CACjB,KAAK,cAAgB,IACtB,CACH,EACIC,EAAoB,oBACxB,SAASD,EAAcL,EAAMI,EAAO,CAClC,MAAMG,EAAOC,EAAQ,IAAIF,EAAmBG,CAAU,GAAK,GAC3DD,EAAQ,IAAIF,EAAmB,CAAE,GAAGC,EAAM,CAACP,CAAI,EAAGI,CAAK,CAAE,CAC3D,CACA,SAASD,EAAgBH,EAAM,CAC7B,MAAMO,EAAOC,EAAQ,IAAIF,EAAmBG,CAAU,EACtD,OAAIF,IAAS,KAAa,KACnB,QAAQ,IAAIA,EAAMP,CAAI,CAC/B"}