const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/esm-WMGHUIL7-8ufgayIY.js","assets/index-sLWOp1cP.js","assets/index.esm-7KRQhKpb.js","assets/index.esm-MFwAEsBN.js","assets/index.esm-DfotAdpM.js","assets/index.esm-OfUlTTgs.js","assets/index.esm-COc-PyqV.js","assets/import-wrapper-prod-mRNndFxq.js","assets/index.esm-CjXD2v0E.js","assets/combineLatest-Cx3jWXTV.js","assets/tap-CWNNm5Pt.js","assets/firstValueFrom-Ch7AjPMY.js"])))=>i.map(i=>d[i]);
import{_ as se}from"./index-sLWOp1cP.js";import{O as ae,B as X,i as ue}from"./index.esm-7KRQhKpb.js";import{JsonParser as ce}from"./index.esm-COc-PyqV.js";import{r as he,o as le,i as pe,c as xt,t as de,n as fe,k as Ut,l as bt,C as H,h as Lt,d as Pt,S as ot,m as F,s as wt,a as tt,g as we}from"./index.esm-DfotAdpM.js";import{e as me,a0 as $t,j as nt,a1 as ye,a2 as ge,a3 as Be,b as Ft,a4 as Ee,a as Ie,a5 as Se,c as Ae,$ as Te}from"./index.esm-MFwAEsBN.js";import{S as Rt}from"./index.esm-CjXD2v0E.js";import{B as Ce,c as vt}from"./combineLatest-Cx3jWXTV.js";import{d as V,s as st,o as ke,m as Dt,a as _e,c as xe}from"./index.esm-OfUlTTgs.js";import{t as Mt}from"./tap-CWNNm5Pt.js";import{f as it}from"./firstValueFrom-Ch7AjPMY.js";function Ue(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var h=he(a);return le(function(p,l){for(var d=a.length,o=new Array(d),g=a.map(function(){return!1}),m=!1,_=function(E){pe(a[E]).subscribe(xt(l,function(T){o[E]=T,!m&&!g[E]&&(g[E]=!0,(m=g.every(de))&&(g=null))},fe))},B=0;B<d;B++)_(B);p.subscribe(xt(l,function(E){if(m){var T=Ut([E],bt(o));l.next(h?h.apply(void 0,Ut([],bt(T))):T)}}))})}var be=Object.create,at=Object.defineProperty,Pe=Object.getOwnPropertyDescriptor,mt=Object.getOwnPropertyNames,$e=Object.getPrototypeOf,Re=Object.prototype.hasOwnProperty,Q=(a,s)=>function(){return a&&(s=(0,a[mt(a)[0]])(a=0)),s},ar=(a,s)=>function(){return s||(0,a[mt(a)[0]])((s={exports:{}}).exports,s),s.exports},ur=(a,s)=>{for(var h in s)at(a,h,{get:s[h],enumerable:!0})},jt=(a,s,h,p)=>{if(s&&typeof s=="object"||typeof s=="function")for(let l of mt(s))!Re.call(a,l)&&l!==h&&at(a,l,{get:()=>s[l],enumerable:!(p=Pe(s,l))||p.enumerable});return a},cr=(a,s,h)=>(h=a!=null?be($e(a)):{},jt(!a||!a.__esModule?at(h,"default",{value:a,enumerable:!0}):h,a)),hr=a=>jt(at({},"__esModule",{value:!0}),a),b=Q({"<define:__environment__>"(){}}),P=Q({"node_modules/.pnpm/esbuild-plugin-polyfill-node@0.3.0_esbuild@0.23.0/node_modules/esbuild-plugin-polyfill-node/polyfills/__dirname.js"(){}});function ve(){if(pt)return J;pt=!0,J.byteLength=g,J.toByteArray=_,J.fromByteArray=T;for(var a=[],s=[],h=typeof Uint8Array<"u"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,d=p.length;l<d;++l)a[l]=p[l],s[p.charCodeAt(l)]=l;s[45]=62,s[95]=63;function o(f){var w=f.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var I=f.indexOf("=");I===-1&&(I=w);var k=I===w?0:4-I%4;return[I,k]}function g(f){var w=o(f),I=w[0],k=w[1];return(I+k)*3/4-k}function m(f,w,I){return(w+I)*3/4-I}function _(f){var w,I=o(f),k=I[0],v=I[1],A=new h(m(f,k,v)),D=0,O=v>0?k-4:k,N;for(N=0;N<O;N+=4)w=s[f.charCodeAt(N)]<<18|s[f.charCodeAt(N+1)]<<12|s[f.charCodeAt(N+2)]<<6|s[f.charCodeAt(N+3)],A[D++]=w>>16&255,A[D++]=w>>8&255,A[D++]=w&255;return v===2&&(w=s[f.charCodeAt(N)]<<2|s[f.charCodeAt(N+1)]>>4,A[D++]=w&255),v===1&&(w=s[f.charCodeAt(N)]<<10|s[f.charCodeAt(N+1)]<<4|s[f.charCodeAt(N+2)]>>2,A[D++]=w>>8&255,A[D++]=w&255),A}function B(f){return a[f>>18&63]+a[f>>12&63]+a[f>>6&63]+a[f&63]}function E(f,w,I){for(var k,v=[],A=w;A<I;A+=3)k=(f[A]<<16&16711680)+(f[A+1]<<8&65280)+(f[A+2]&255),v.push(B(k));return v.join("")}function T(f){for(var w,I=f.length,k=I%3,v=[],A=16383,D=0,O=I-k;D<O;D+=A)v.push(E(f,D,D+A>O?O:D+A));return k===1?(w=f[I-1],v.push(a[w>>2]+a[w<<4&63]+"==")):k===2&&(w=(f[I-2]<<8)+f[I-1],v.push(a[w>>10]+a[w>>4&63]+a[w<<2&63]+"=")),v.join("")}return J}function De(){return dt||(dt=!0,et.read=function(a,s,h,p,l){var d,o,g=l*8-p-1,m=(1<<g)-1,_=m>>1,B=-7,E=h?l-1:0,T=h?-1:1,f=a[s+E];for(E+=T,d=f&(1<<-B)-1,f>>=-B,B+=g;B>0;d=d*256+a[s+E],E+=T,B-=8);for(o=d&(1<<-B)-1,d>>=-B,B+=p;B>0;o=o*256+a[s+E],E+=T,B-=8);if(d===0)d=1-_;else{if(d===m)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,p),d=d-_}return(f?-1:1)*o*Math.pow(2,d-p)},et.write=function(a,s,h,p,l,d){var o,g,m,_=d*8-l-1,B=(1<<_)-1,E=B>>1,T=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=p?0:d-1,w=p?1:-1,I=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(g=isNaN(s)?1:0,o=B):(o=Math.floor(Math.log(s)/Math.LN2),s*(m=Math.pow(2,-o))<1&&(o--,m*=2),o+E>=1?s+=T/m:s+=T*Math.pow(2,1-E),s*m>=2&&(o++,m/=2),o+E>=B?(g=0,o=B):o+E>=1?(g=(s*m-1)*Math.pow(2,l),o=o+E):(g=s*Math.pow(2,E-1)*Math.pow(2,l),o=0));l>=8;a[h+f]=g&255,f+=w,g/=256,l-=8);for(o=o<<l|g,_+=l;_>0;a[h+f]=o&255,f+=w,o/=256,_-=8);a[h+f-w]|=I*128}),et}function Me(){if(ft)return G;ft=!0;const a=ve(),s=De(),h=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;G.Buffer=o,G.SlowBuffer=v,G.INSPECT_MAX_BYTES=50;const p=2147483647;G.kMaxLength=p,o.TYPED_ARRAY_SUPPORT=l(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const r=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(r,t),r.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function d(r){if(r>p)throw new RangeError('The value "'+r+'" is invalid for option "size"');const t=new Uint8Array(r);return Object.setPrototypeOf(t,o.prototype),t}function o(r,t,e){if(typeof r=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B(r)}return g(r,t,e)}o.poolSize=8192;function g(r,t,e){if(typeof r=="string")return E(r,t);if(ArrayBuffer.isView(r))return f(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(j(r,ArrayBuffer)||r&&j(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(j(r,SharedArrayBuffer)||r&&j(r.buffer,SharedArrayBuffer)))return w(r,t,e);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return o.from(n,t,e);const i=I(r);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return o.from(r[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}o.from=function(r,t,e){return g(r,t,e)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function m(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function _(r,t,e){return m(r),r<=0?d(r):t!==void 0?typeof e=="string"?d(r).fill(t,e):d(r).fill(t):d(r)}o.alloc=function(r,t,e){return _(r,t,e)};function B(r){return m(r),d(r<0?0:k(r)|0)}o.allocUnsafe=function(r){return B(r)},o.allocUnsafeSlow=function(r){return B(r)};function E(r,t){if((typeof t!="string"||t==="")&&(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const e=A(r,t)|0;let n=d(e);const i=n.write(r,t);return i!==e&&(n=n.slice(0,i)),n}function T(r){const t=r.length<0?0:k(r.length)|0,e=d(t);for(let n=0;n<t;n+=1)e[n]=r[n]&255;return e}function f(r){if(j(r,Uint8Array)){const t=new Uint8Array(r);return w(t.buffer,t.byteOffset,t.byteLength)}return T(r)}function w(r,t,e){if(t<0||r.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');let n;return t===void 0&&e===void 0?n=new Uint8Array(r):e===void 0?n=new Uint8Array(r,t):n=new Uint8Array(r,t,e),Object.setPrototypeOf(n,o.prototype),n}function I(r){if(o.isBuffer(r)){const t=k(r.length)|0,e=d(t);return e.length===0||r.copy(e,0,0,t),e}if(r.length!==void 0)return typeof r.length!="number"||ht(r.length)?d(0):T(r);if(r.type==="Buffer"&&Array.isArray(r.data))return T(r.data)}function k(r){if(r>=p)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+p.toString(16)+" bytes");return r|0}function v(r){return+r!=r&&(r=0),o.alloc(+r)}o.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==o.prototype},o.compare=function(t,e){if(j(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),j(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,i=e.length;for(let u=0,c=Math.min(n,i);u<c;++u)if(t[u]!==e[u]){n=t[u],i=e[u];break}return n<i?-1:i<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return o.alloc(0);let n;if(e===void 0)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const i=o.allocUnsafe(e);let u=0;for(n=0;n<t.length;++n){let c=t[n];if(j(c,Uint8Array))u+c.length>i.length?(o.isBuffer(c)||(c=o.from(c)),c.copy(i,u)):Uint8Array.prototype.set.call(i,c,u);else if(o.isBuffer(c))c.copy(i,u);else throw new TypeError('"list" argument must be an Array of Buffers');u+=c.length}return i};function A(r,t){if(o.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||j(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const e=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&e===0)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return ct(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return _t(r).length;default:if(i)return n?-1:ct(r).length;t=(""+t).toLowerCase(),i=!0}}o.byteLength=A;function D(r,t,e){let n=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(r||(r="utf8");;)switch(r){case"hex":return Xt(this,t,e);case"utf8":case"utf-8":return gt(this,t,e);case"ascii":return zt(this,t,e);case"latin1":case"binary":return Jt(this,t,e);case"base64":return qt(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Qt(this,t,e);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}o.prototype._isBuffer=!0;function O(r,t,e){const n=r[t];r[t]=r[e],r[e]=n}o.prototype.swap16=function(){const t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)O(this,e,e+1);return this},o.prototype.swap32=function(){const t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)O(this,e,e+3),O(this,e+1,e+2);return this},o.prototype.swap64=function(){const t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)O(this,e,e+7),O(this,e+1,e+6),O(this,e+2,e+5),O(this,e+3,e+4);return this},o.prototype.toString=function(){const t=this.length;return t===0?"":arguments.length===0?gt(this,0,t):D.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:o.compare(this,t)===0},o.prototype.inspect=function(){let t="";const e=G.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},h&&(o.prototype[h]=o.prototype.inspect),o.prototype.compare=function(t,e,n,i,u){if(j(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),n===void 0&&(n=t?t.length:0),i===void 0&&(i=0),u===void 0&&(u=this.length),e<0||n>t.length||i<0||u>this.length)throw new RangeError("out of range index");if(i>=u&&e>=n)return 0;if(i>=u)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,u>>>=0,this===t)return 0;let c=u-i,y=n-e;const x=Math.min(c,y),C=this.slice(i,u),U=t.slice(e,n);for(let S=0;S<x;++S)if(C[S]!==U[S]){c=C[S],y=U[S];break}return c<y?-1:y<c?1:0};function N(r,t,e,n,i){if(r.length===0)return-1;if(typeof e=="string"?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,ht(e)&&(e=i?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(i)return-1;e=r.length-1}else if(e<0)if(i)e=0;else return-1;if(typeof t=="string"&&(t=o.from(t,n)),o.isBuffer(t))return t.length===0?-1:yt(r,t,e,n,i);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):yt(r,[t],e,n,i);throw new TypeError("val must be string, number or Buffer")}function yt(r,t,e,n,i){let u=1,c=r.length,y=t.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||t.length<2)return-1;u=2,c/=2,y/=2,e/=2}function x(U,S){return u===1?U[S]:U.readUInt16BE(S*u)}let C;if(i){let U=-1;for(C=e;C<c;C++)if(x(r,C)===x(t,U===-1?0:C-U)){if(U===-1&&(U=C),C-U+1===y)return U*u}else U!==-1&&(C-=C-U),U=-1}else for(e+y>c&&(e=c-y),C=e;C>=0;C--){let U=!0;for(let S=0;S<y;S++)if(x(r,C+S)!==x(t,S)){U=!1;break}if(U)return C}return-1}o.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1},o.prototype.indexOf=function(t,e,n){return N(this,t,e,n,!0)},o.prototype.lastIndexOf=function(t,e,n){return N(this,t,e,n,!1)};function Ht(r,t,e,n){e=Number(e)||0;const i=r.length-e;n?(n=Number(n),n>i&&(n=i)):n=i;const u=t.length;n>u/2&&(n=u/2);let c;for(c=0;c<n;++c){const y=parseInt(t.substr(c*2,2),16);if(ht(y))return c;r[e+c]=y}return c}function Wt(r,t,e,n){return rt(ct(t,r.length-e),r,e,n)}function Kt(r,t,e,n){return rt(re(t),r,e,n)}function Gt(r,t,e,n){return rt(_t(t),r,e,n)}function Vt(r,t,e,n){return rt(ne(t,r.length-e),r,e,n)}o.prototype.write=function(t,e,n,i){if(e===void 0)i="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")i=e,n=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const u=this.length-e;if((n===void 0||n>u)&&(n=u),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let c=!1;for(;;)switch(i){case"hex":return Ht(this,t,e,n);case"utf8":case"utf-8":return Wt(this,t,e,n);case"ascii":case"latin1":case"binary":return Kt(this,t,e,n);case"base64":return Gt(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vt(this,t,e,n);default:if(c)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),c=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function qt(r,t,e){return t===0&&e===r.length?a.fromByteArray(r):a.fromByteArray(r.slice(t,e))}function gt(r,t,e){e=Math.min(r.length,e);const n=[];let i=t;for(;i<e;){const u=r[i];let c=null,y=u>239?4:u>223?3:u>191?2:1;if(i+y<=e){let x,C,U,S;switch(y){case 1:u<128&&(c=u);break;case 2:x=r[i+1],(x&192)===128&&(S=(u&31)<<6|x&63,S>127&&(c=S));break;case 3:x=r[i+1],C=r[i+2],(x&192)===128&&(C&192)===128&&(S=(u&15)<<12|(x&63)<<6|C&63,S>2047&&(S<55296||S>57343)&&(c=S));break;case 4:x=r[i+1],C=r[i+2],U=r[i+3],(x&192)===128&&(C&192)===128&&(U&192)===128&&(S=(u&15)<<18|(x&63)<<12|(C&63)<<6|U&63,S>65535&&S<1114112&&(c=S))}}c===null?(c=65533,y=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|c&1023),n.push(c),i+=y}return Yt(n)}const Bt=4096;function Yt(r){const t=r.length;if(t<=Bt)return String.fromCharCode.apply(String,r);let e="",n=0;for(;n<t;)e+=String.fromCharCode.apply(String,r.slice(n,n+=Bt));return e}function zt(r,t,e){let n="";e=Math.min(r.length,e);for(let i=t;i<e;++i)n+=String.fromCharCode(r[i]&127);return n}function Jt(r,t,e){let n="";e=Math.min(r.length,e);for(let i=t;i<e;++i)n+=String.fromCharCode(r[i]);return n}function Xt(r,t,e){const n=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>n)&&(e=n);let i="";for(let u=t;u<e;++u)i+=ie[r[u]];return i}function Qt(r,t,e){const n=r.slice(t,e);let i="";for(let u=0;u<n.length-1;u+=2)i+=String.fromCharCode(n[u]+n[u+1]*256);return i}o.prototype.slice=function(t,e){const n=this.length;t=~~t,e=e===void 0?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);const i=this.subarray(t,e);return Object.setPrototypeOf(i,o.prototype),i};function M(r,t,e){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(t,e,n){t=t>>>0,e=e>>>0,n||M(t,e,this.length);let i=this[t],u=1,c=0;for(;++c<e&&(u*=256);)i+=this[t+c]*u;return i},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,e,n){t=t>>>0,e=e>>>0,n||M(t,e,this.length);let i=this[t+--e],u=1;for(;e>0&&(u*=256);)i+=this[t+--e]*u;return i},o.prototype.readUint8=o.prototype.readUInt8=function(t,e){return t=t>>>0,e||M(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,e){return t=t>>>0,e||M(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,e){return t=t>>>0,e||M(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,e){return t=t>>>0,e||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,e){return t=t>>>0,e||M(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readBigUInt64LE=W(function(t){t=t>>>0,Y(t,"offset");const e=this[t],n=this[t+7];(e===void 0||n===void 0)&&Z(t,this.length-8);const i=e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,u=this[++t]+this[++t]*2**8+this[++t]*2**16+n*2**24;return BigInt(i)+(BigInt(u)<<BigInt(32))}),o.prototype.readBigUInt64BE=W(function(t){t=t>>>0,Y(t,"offset");const e=this[t],n=this[t+7];(e===void 0||n===void 0)&&Z(t,this.length-8);const i=e*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],u=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(u)}),o.prototype.readIntLE=function(t,e,n){t=t>>>0,e=e>>>0,n||M(t,e,this.length);let i=this[t],u=1,c=0;for(;++c<e&&(u*=256);)i+=this[t+c]*u;return u*=128,i>=u&&(i-=Math.pow(2,8*e)),i},o.prototype.readIntBE=function(t,e,n){t=t>>>0,e=e>>>0,n||M(t,e,this.length);let i=e,u=1,c=this[t+--i];for(;i>0&&(u*=256);)c+=this[t+--i]*u;return u*=128,c>=u&&(c-=Math.pow(2,8*e)),c},o.prototype.readInt8=function(t,e){return t=t>>>0,e||M(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},o.prototype.readInt16LE=function(t,e){t=t>>>0,e||M(t,2,this.length);const n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n},o.prototype.readInt16BE=function(t,e){t=t>>>0,e||M(t,2,this.length);const n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n},o.prototype.readInt32LE=function(t,e){return t=t>>>0,e||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t=t>>>0,e||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readBigInt64LE=W(function(t){t=t>>>0,Y(t,"offset");const e=this[t],n=this[t+7];(e===void 0||n===void 0)&&Z(t,this.length-8);const i=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)}),o.prototype.readBigInt64BE=W(function(t){t=t>>>0,Y(t,"offset");const e=this[t],n=this[t+7];(e===void 0||n===void 0)&&Z(t,this.length-8);const i=(e<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n)}),o.prototype.readFloatLE=function(t,e){return t=t>>>0,e||M(t,4,this.length),s.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t=t>>>0,e||M(t,4,this.length),s.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t=t>>>0,e||M(t,8,this.length),s.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t=t>>>0,e||M(t,8,this.length),s.read(this,t,!1,52,8)};function L(r,t,e,n,i,u){if(!o.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<u)throw new RangeError('"value" argument is out of bounds');if(e+n>r.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e=e>>>0,n=n>>>0,!i){const y=Math.pow(2,8*n)-1;L(this,t,e,n,y,0)}let u=1,c=0;for(this[e]=t&255;++c<n&&(u*=256);)this[e+c]=t/u&255;return e+n},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e=e>>>0,n=n>>>0,!i){const y=Math.pow(2,8*n)-1;L(this,t,e,n,y,0)}let u=n-1,c=1;for(this[e+u]=t&255;--u>=0&&(c*=256);)this[e+u]=t/c&255;return e+n},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,1,255,0),this[e]=t&255,e+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};function Et(r,t,e,n,i){kt(t,n,i,r,e,7);let u=Number(t&BigInt(4294967295));r[e++]=u,u=u>>8,r[e++]=u,u=u>>8,r[e++]=u,u=u>>8,r[e++]=u;let c=Number(t>>BigInt(32)&BigInt(4294967295));return r[e++]=c,c=c>>8,r[e++]=c,c=c>>8,r[e++]=c,c=c>>8,r[e++]=c,e}function It(r,t,e,n,i){kt(t,n,i,r,e,7);let u=Number(t&BigInt(4294967295));r[e+7]=u,u=u>>8,r[e+6]=u,u=u>>8,r[e+5]=u,u=u>>8,r[e+4]=u;let c=Number(t>>BigInt(32)&BigInt(4294967295));return r[e+3]=c,c=c>>8,r[e+2]=c,c=c>>8,r[e+1]=c,c=c>>8,r[e]=c,e+8}o.prototype.writeBigUInt64LE=W(function(t,e=0){return Et(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=W(function(t,e=0){return It(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e=e>>>0,!i){const x=Math.pow(2,8*n-1);L(this,t,e,n,x-1,-x)}let u=0,c=1,y=0;for(this[e]=t&255;++u<n&&(c*=256);)t<0&&y===0&&this[e+u-1]!==0&&(y=1),this[e+u]=(t/c>>0)-y&255;return e+n},o.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e=e>>>0,!i){const x=Math.pow(2,8*n-1);L(this,t,e,n,x-1,-x)}let u=n-1,c=1,y=0;for(this[e+u]=t&255;--u>=0&&(c*=256);)t<0&&y===0&&this[e+u+1]!==0&&(y=1),this[e+u]=(t/c>>0)-y&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e=e>>>0,n||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4},o.prototype.writeBigInt64LE=W(function(t,e=0){return Et(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=W(function(t,e=0){return It(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function St(r,t,e,n,i,u){if(e+n>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function At(r,t,e,n,i){return t=+t,e=e>>>0,i||St(r,t,e,4),s.write(r,t,e,n,23,4),e+4}o.prototype.writeFloatLE=function(t,e,n){return At(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return At(this,t,e,!1,n)};function Tt(r,t,e,n,i){return t=+t,e=e>>>0,i||St(r,t,e,8),s.write(r,t,e,n,52,8),e+8}o.prototype.writeDoubleLE=function(t,e,n){return Tt(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return Tt(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,i){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);const u=i-n;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,n,i):Uint8Array.prototype.set.call(t,this.subarray(n,i),e),u},o.prototype.fill=function(t,e,n,i){if(typeof t=="string"){if(typeof e=="string"?(i=e,e=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!o.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(t.length===1){const c=t.charCodeAt(0);(i==="utf8"&&c<128||i==="latin1")&&(t=c)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e=e>>>0,n=n===void 0?this.length:n>>>0,t||(t=0);let u;if(typeof t=="number")for(u=e;u<n;++u)this[u]=t;else{const c=o.isBuffer(t)?t:o.from(t,i),y=c.length;if(y===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(u=0;u<n-e;++u)this[u+e]=c[u%y]}return this};const q={};function ut(r,t,e){q[r]=class extends e{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}ut("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ut("ERR_INVALID_ARG_TYPE",function(r,t){return`The "${r}" argument must be of type number. Received type ${typeof t}`},TypeError),ut("ERR_OUT_OF_RANGE",function(r,t,e){let n=`The value of "${r}" is out of range.`,i=e;return Number.isInteger(e)&&Math.abs(e)>2**32?i=Ct(String(e)):typeof e=="bigint"&&(i=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(i=Ct(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);function Ct(r){let t="",e=r.length;const n=r[0]==="-"?1:0;for(;e>=n+4;e-=3)t=`_${r.slice(e-3,e)}${t}`;return`${r.slice(0,e)}${t}`}function Zt(r,t,e){Y(t,"offset"),(r[t]===void 0||r[t+e]===void 0)&&Z(t,r.length-(e+1))}function kt(r,t,e,n,i,u){if(r>e||r<t){const c=typeof t=="bigint"?"n":"";let y;throw t===0||t===BigInt(0)?y=`>= 0${c} and < 2${c} ** ${(u+1)*8}${c}`:y=`>= -(2${c} ** ${(u+1)*8-1}${c}) and < 2 ** ${(u+1)*8-1}${c}`,new q.ERR_OUT_OF_RANGE("value",y,r)}Zt(n,i,u)}function Y(r,t){if(typeof r!="number")throw new q.ERR_INVALID_ARG_TYPE(t,"number",r)}function Z(r,t,e){throw Math.floor(r)!==r?(Y(r,e),new q.ERR_OUT_OF_RANGE("offset","an integer",r)):t<0?new q.ERR_BUFFER_OUT_OF_BOUNDS:new q.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,r)}const te=/[^+/0-9A-Za-z-_]/g;function ee(r){if(r=r.split("=")[0],r=r.trim().replace(te,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function ct(r,t){t=t||1/0;let e;const n=r.length;let i=null;const u=[];for(let c=0;c<n;++c){if(e=r.charCodeAt(c),e>55295&&e<57344){if(!i){if(e>56319){(t-=3)>-1&&u.push(239,191,189);continue}else if(c+1===n){(t-=3)>-1&&u.push(239,191,189);continue}i=e;continue}if(e<56320){(t-=3)>-1&&u.push(239,191,189),i=e;continue}e=(i-55296<<10|e-56320)+65536}else i&&(t-=3)>-1&&u.push(239,191,189);if(i=null,e<128){if((t-=1)<0)break;u.push(e)}else if(e<2048){if((t-=2)<0)break;u.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;u.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;u.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return u}function re(r){const t=[];for(let e=0;e<r.length;++e)t.push(r.charCodeAt(e)&255);return t}function ne(r,t){let e,n,i;const u=[];for(let c=0;c<r.length&&!((t-=2)<0);++c)e=r.charCodeAt(c),n=e>>8,i=e%256,u.push(i),u.push(n);return u}function _t(r){return a.toByteArray(ee(r))}function rt(r,t,e,n){let i;for(i=0;i<n&&!(i+e>=t.length||i>=r.length);++i)t[i+e]=r[i];return i}function j(r,t){return r instanceof t||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===t.name}function ht(r){return r!==r}const ie=function(){const r="0123456789abcdef",t=new Array(256);for(let e=0;e<16;++e){const n=e*16;for(let i=0;i<16;++i)t[n+i]=r[e]+r[i]}return t}();function W(r){return typeof BigInt>"u"?oe:r}function oe(){throw new Error("BigInt not supported")}return G}var J,pt,et,dt,G,ft,K,Ne,Oe=Q({"node_modules/.pnpm/@jspm+core@2.0.1/node_modules/@jspm/core/nodelibs/browser/buffer.js"(){b(),P(),$(),R(),J={},pt=!1,et={},dt=!1,G={},ft=!1,K=Me(),K.Buffer,K.SlowBuffer,K.INSPECT_MAX_BYTES,K.kMaxLength,Ne=K.Buffer,K.INSPECT_MAX_BYTES,K.kMaxLength}}),$=Q({"node_modules/.pnpm/esbuild-plugin-polyfill-node@0.3.0_esbuild@0.23.0/node_modules/esbuild-plugin-polyfill-node/polyfills/buffer.js"(){Oe()}}),z,lt,Le=Q({"node_modules/.pnpm/@jspm+core@2.0.1/node_modules/@jspm/core/nodelibs/browser/process.js"(){b(),P(),$(),R(),z={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0},z.now===void 0&&(lt=Date.now(),z.timing&&z.timing.navigationStart&&(lt=z.timing.navigationStart),z.now=()=>Date.now()-lt)}}),R=Q({"node_modules/.pnpm/esbuild-plugin-polyfill-node@0.3.0_esbuild@0.23.0/node_modules/esbuild-plugin-polyfill-node/polyfills/process.js"(){Le()}});b();P();$();R();b();P();$();R();b();P();$();R();b();P();$();R();var Nt=class{constructor(){this.lastSnapshot={token:null,amount:null},this.signalChange$=new ot}setToken(a){const{token:s}=this.lastSnapshot;s&&a&&ue(s,a)||(this.lastSnapshot={...this.lastSnapshot,token:a,amount:0n},this.signalChange$.next())}setAmount(a){const{amount:s}=this.lastSnapshot;s!==a&&(this.lastSnapshot={...this.lastSnapshot,amount:a},this.signalChange$.next())}getSnapshot(){return this.lastSnapshot}streamSnapshot(){return this.signalChange$.pipe(F(()=>this.lastSnapshot),wt(this.lastSnapshot),V(),tt({bufferSize:1,refCount:!0}))}};b();P();$();R();function Fe(a){return H[a]!==void 0}b();P();$();R();function Ot(a,s){const h=Te(a.address,s.address),p=a.chainId===s.chainId;return h&&p}var je=class{constructor(a){this.applicationContext=a,this.subscription=new Lt,this.source=new Nt,this.destination=new Nt,this.pairChance$=new ot}init(){this.restorePair(),this.startChainTokenSync()}restorePair(){this.restoreToken("source"),this.restoreToken("destination")}switchPair(){const{source:a,destination:s}=this;this.source=s,this.destination=a,this.updateTokenStore("source"),this.updateTokenStore("destination"),this.pairChance$.next()}setPair(a){this.setTokenInner(a.source,"source"),this.setTokenInner(a.destination,"destination"),this.pairChance$.next()}setToken(a,s){if(s==="source"&&a!==null){const h=this.destination.getSnapshot();if(h.token!==null&&Ot(a,h.token))return this.switchPair()}if(s==="destination"&&a!==null){const h=this.source.getSnapshot();if(h.token!==null&&Ot(a,h.token))return this.switchPair()}this.setTokenInner(a,s)}setAmount(a,s){this.getTokenContext(a).setAmount(s),this.updateTokenStore(a)}streamSnapshot(a){return this.pairChance$.pipe(wt(null),st(()=>this.getTokenContext(a).streamSnapshot()))}getSnapshot(a){return this.getTokenContext(a).getSnapshot()}destroy(){this.subscription.unsubscribe()}setTokenInner(a,s){this.getTokenContext(s).setToken(a),this.updateTokenStore(s)}getTokenContext(a){if(a==="source")return this.source;if(a==="destination")return this.destination;throw new Error(`invalid token type ${a}`)}updateTokenStore(a){const h=this.getTokenContext(a).getSnapshot(),p=h.amount;if(p!==null&&this.applicationContext.storageController.set(this.tokenStoreKey(a)+"_amount",p.toString()),h.token!==null){const{symbol:l,address:d,chainId:o,name:g,decimals:m}=h.token;this.applicationContext.storageController.set(this.tokenStoreKey(a),{symbol:l,address:d,chainId:o,name:g,decimals:m})}}restoreToken(a){const s=this.getTokenContext(a),h=this.applicationContext.storageController.get(this.tokenStoreKey(a)+"_amount",String),p=this.applicationContext.storageController.get(this.tokenStoreKey(a),ce);p!==null&&s.setToken(p),h!==null&&s.setAmount(BigInt(h))}tokenStoreKey(a){return`token_${a}`}startChainTokenSync(){this.subscription.add(this.applicationContext.connectWalletController.data.chainId$.pipe(st(async a=>{if(!a||!Fe(a))return;const s=this.source.getSnapshot(),h=this.destination.getSnapshot();if(s.token&&s.token.chainId!==a){const p=await this.applicationContext.tokenController.getNativeToken(a);this.setTokenInner(p,"source")}h.token&&h.token.chainId!==a&&this.setTokenInner(null,"destination")})).subscribe())}};b();P();$();R();var He=class{constructor(a,s,h){this.pairHolder=a,this.walletController=s,this.rateProvider=h}async getDataSnapshot(){const a=this.pairHolder.getSnapshot("source"),s=this.pairHolder.getSnapshot("destination"),{token:h,amount:p}=a,{token:l}=s,d=await this.walletController.data.getChainId(),o=await this.walletController.data.getActiveAddress();if(d===null||h===null||l===null||p===null||o===null)throw new Error("");const g=await this.rateProvider.getOnChainRate(d,h,l);if(g===null)throw new Error("");let m;return g.revertedRate?m=X.div(p,g.revertedRate,h.decimals,l.decimals,l.decimals):m=X.mul(p,g.rate,h.decimals,h.decimals,l.decimals),{chainId:d,sourceToken:h,destinationToken:l,sourceTokenAmount:p,destinationTokenAmount:m,rate:g,minReceive:m,autoAuctionTime:null,autoSlippage:null,rawResponseData:null}}};b();P();$();R();var We=class{constructor(a,s,h,p,l){this.swapContext=a,this.pairHolder=s,this.walletController=h,this.settings=p,this.devPortalAdapter=l}async getDataSnapshot(){const a=this.pairHolder.getSnapshot("source"),s=this.pairHolder.getSnapshot("destination");let{token:h}=a;const{amount:p}=a,{token:l}=s,d=await this.walletController.data.getChainId(),o=await this.walletController.data.getActiveAddress();if(d===null||h===null||l===null||p===null||o===null||p===0n)throw new Error("");if(await this.swapContext.getMaxAmount()<p)throw new Error("");Ft(h.address)&&(h=Ae(d));const m=await this.devPortalAdapter.getFusionQuoteReceive(d,h.address,l.address,p,o);if(m===null)throw new Error("");const{toTokenAmount:_,recommended_preset:B,presets:E,autoK:T}=m,f=E[B],w=BigInt(_),I=X.div(w,p,l.decimals,h.decimals),k=X.div(p,w,h.decimals,l.decimals),v={chainId:d,rate:I,revertedRate:k,isReverted:!1,sourceToken:h,destinationToken:l},A=this.settings.slippage;let D=BigInt(f.auctionEndAmount);if(A.value!==null){const[O]=A.value,N=X.calculatePercentage(w,O);D=w-N}return{chainId:d,sourceToken:h,destinationToken:l,sourceTokenAmount:p,minReceive:D,destinationTokenAmount:w,autoAuctionTime:f.auctionDuration,autoSlippage:T,rate:v,rawResponseData:m}}},Ke=class{constructor(a){this.applicationContext=a,this.pairHolder=new je(this.applicationContext),this.subscription=new Lt,this.oneInchApiAdapter=new ae,this.walletController=this.applicationContext.connectWalletController,this.settings={slippage:new Rt("slippage"),auctionTime:new Rt("auctionTime")},this.contextStrategy={onChain:new He(this.pairHolder,this.walletController,this.applicationContext.tokenRateProvider),fusion:new We(this,this.pairHolder,this.walletController,this.settings,this.oneInchApiAdapter)},this.loading$=new Ce(!1),this.chainId$=Pt(()=>this.walletController.data.chainId$).pipe(V()),this.connectedWalletAddress$=Pt(()=>this.walletController.data.activeAddress$).pipe(V()),this.block$=this.chainId$.pipe(st(s=>s?me(s):ke(null))),this.updateData$=new ot,this.updateDataComplete$=new ot,this.dataUpdateEmitter$=Dt(this.block$,this.chainId$,this.connectedWalletAddress$,this.pairHolder.streamSnapshot("source"),this.pairHolder.streamSnapshot("destination"),this.updateData$).pipe(_e(500),F(()=>{}),wt(void 0),tt({bufferSize:1,refCount:!0})),this.dataSnapshot$=this.dataUpdateEmitter$.pipe(Ue(this.connectedWalletAddress$),st(([s,h])=>(this.loading$.next(!0),this.getDataSnapshot(h===null))),Mt(()=>{this.loading$.next(!1),this.updateDataComplete$.next()}),tt({bufferSize:1,refCount:!0})),this.rate$=this.dataSnapshot$.pipe(F(s=>(s==null?void 0:s.rate)??null)),this.minReceive$=this.dataSnapshot$.pipe(F(s=>(s==null?void 0:s.minReceive)??0n)),this.destinationTokenAmount$=this.dataSnapshot$.pipe(F(s=>(s==null?void 0:s.destinationTokenAmount)??0n)),this.autoSlippage$=this.dataSnapshot$.pipe(F(s=>(s==null?void 0:s.autoSlippage)??null)),this.autoAuctionTime$=this.dataSnapshot$.pipe(F(s=>(s==null?void 0:s.autoAuctionTime)??null)),this.slippage$=vt([this.autoSlippage$,this.settings.slippage.value$]).pipe(F(([s,h])=>h?{type:h[1],value:h[0]}:{type:"auto",value:s}),tt({bufferSize:1,refCount:!0})),this.auctionTime$=vt([this.autoAuctionTime$,this.settings.auctionTime.value$]).pipe(F(([s,h])=>h?{type:h[1],value:h[0]}:{type:"auto",value:s}),tt({bufferSize:1,refCount:!0}))}init(){this.pairHolder.init(),this.subscription.add(Dt(this.destinationTokenAmount$.pipe(V(),Mt(a=>{this.setTokenAmountByType("destination",a)}),we(xe))).subscribe())}wrapNativeToken(a){throw new Error("Method not implemented.")}getApprove(){throw new Error("Method not implemented.")}getSettingsController(a){const s=this.settings[a];if(!s)throw new Error("");return s}async getPermit(){const a=await this.walletController.data.getChainId(),s=await this.walletController.data.getActiveAddress(),h=this.pairHolder.getSnapshot("source");if(!a||!s||!Ge(h))throw new Error("");if(await $t(a,h.token.address,s,nt(a))!==null)return;const l=await ye(a,h.token.address,s,nt(a)),d=await this.walletController.signTypedData(l);await ge(a,h.token.address,s,nt(a),d,l.message)}destroy(){this.pairHolder.destroy(),this.subscription.unsubscribe()}setPair(a){this.pairHolder.setPair(a)}setToken(a,s){this.pairHolder.setToken(s,a)}switchPair(){this.pairHolder.switchPair()}async getSnapshot(){this.updateData$.next(),await it(this.updateDataComplete$);const[a,s,h]=await Promise.all([it(this.dataSnapshot$),it(this.slippage$),it(this.auctionTime$)]);return{...a,slippage:s,auctionTime:h}}async fusionSwap(a){const{chainId:s,sourceToken:h,destinationToken:p,sourceTokenAmount:l,destinationTokenAmount:d,slippage:o,auctionTime:g,rawResponseData:m}=a,_=await this.walletController.data.getActiveAddress();if(_===null)throw new Error("Wallet not connected");if(!m)throw new Error("");const B=await this.getFusionSDKInstance(s),E=await $t(s,h.address,_,nt(s)),T={walletAddress:_,fromTokenAddress:h.address,toTokenAddress:p.address,amount:l.toString(),preset:m.recommended_preset};E&&(T.permit=await Be(s,_,E.signature,E.permitSingle),T.isPermit2=!0);const{type:f,value:w}=o,{type:I,value:k}=g;if(f!=="auto"||I!=="auto"){const A=m.presets[m.recommended_preset],D=d-X.calculatePercentage(d,w??m.autoK);T.customPreset={auctionEndAmount:D.toString(),auctionDuration:k??A.auctionDuration,auctionStartAmount:A.auctionStartAmount},T.preset="custom"}const v=await B.createOrder(T);await B.submitOrder(v.order,v.quoteId)}async getMaxAmount(){const s=this.pairHolder.getSnapshot("source").token,h=await this.walletController.data.getActiveAddress();if(!s||!h)return 0n;const p=await this.applicationContext.tokenController.getTokenBalance(s.chainId,s.address,h);let l=BigInt((p==null?void 0:p.amount)??0);if(Ft(s.address)){const d=await this.walletController.data.getChainId();if(!d)return 0n;const[o,g]=await Promise.all([Ee(d,l),this.oneInchApiAdapter.getGasPrice(d)]);if(!g)return 0n;const m=g.high,_=o*(BigInt(m.maxFeePerGas)+BigInt(m.maxPriorityFeePerGas));l=l-_,l<0n&&(l=0n)}return l}async setMaxAmount(){const a=await this.getMaxAmount();this.setTokenAmountByType("source",a)}getTokenByType(a){return this.pairHolder.streamSnapshot(a).pipe(F(s=>s.token),V())}getTokenAmountByType(a){return this.pairHolder.streamSnapshot(a).pipe(F(s=>s.amount),V())}getTokenRawAmountByType(a){return this.pairHolder.streamSnapshot(a).pipe(F(s=>s.amount),V())}setTokenAmountByType(a,s){this.pairHolder.setAmount(a,s)}async getFusionSDKInstance(a){const{FusionSDK:s}=await se(async()=>{const{FusionSDK:h}=await import("./esm-WMGHUIL7-8ufgayIY.js");return{FusionSDK:h}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]));return new s({url:Ie("oneInchDevPortalHost")+"/fusion",network:a,blockchainProvider:new Ve(a,this.walletController),httpProvider:new qe})}async getDataSnapshot(a){if(!a)try{return await this.contextStrategy.fusion.getDataSnapshot()}catch{return this.getDataSnapshot(!0)}try{return await this.contextStrategy.onChain.getDataSnapshot()}catch{return null}}};function Ge(a){return a.token!==null&&a.amount!==null}var Ve=class{constructor(a,s){this.chainId=a,this.walletController=s,this.client=Se(this.chainId)}async signTypedData(a,s){return await this.walletController.signTypedData(s)}async ethCall(a,s){return(await this.client.call({to:a,data:s})).data??""}},qe=class{async get(a){return(await fetch(a)).json()}async post(a,s){return(await fetch(a,{method:"POST",body:JSON.stringify(s)})).json().catch(()=>{})}};b();P();$();R();b();P();$();R();b();P();$();R();b();P();$();R();b();P();$();R();b();P();$();R();b();P();$();R();b();P();$();R();b();P();$();R();b();P();$();R();var Ye=Symbol("SwapContextToken");b();P();$();R();var ze=[H.eth,H.bnb,H.matic,H.arbitrum,H.avalanche,H.op,H.gnosis,H.fantom];function Je(a){return ze.includes(a)}const pr=Object.freeze(Object.defineProperty({__proto__:null,SwapContext:Ke,SwapContextToken:Ye,isSupportFusion:Je},Symbol.toStringTag,{value:"Module"}));export{Ne as B,Ye as S,ur as _,b as a,P as b,$ as c,R as d,cr as e,Q as f,ar as g,hr as h,Je as i,pr as j,Ue as w};
//# sourceMappingURL=index.esm-BBcS9skV.js.map
