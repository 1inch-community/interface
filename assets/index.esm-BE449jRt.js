import{z as ge,i as $e,r as g,x as E,j as K}from"./index-B_Ed81Ho.js";import{m as N,s as be,a as Me,L as v,f as we,O as _e,h as J}from"./index.esm-DhwY4kHm.js";import{S as Ce}from"./index.esm-OIwjBXxl.js";import{d as xe}from"./defer-BRewiDsk.js";import{B as ye,c as Ee}from"./combineLatest-Bzt_9bb6.js";import{a as X}from"./asap-D-qxMtYG.js";const{I:Se}=ge,Re=e=>e.strings===void 0,j=()=>document.createComment(""),At=(e,t,n)=>{var a;const s=e._$AA.parentNode,i=t===void 0?e._$AB:t._$AA;if(n===void 0){const r=s.insertBefore(j(),i),u=s.insertBefore(j(),i);n=new Se(r,u,e,e.options)}else{const r=n._$AB.nextSibling,u=n._$AM,h=u!==e;if(h){let d;(a=n._$AQ)==null||a.call(n,e),n._$AM=e,n._$AP!==void 0&&(d=e._$AU)!==u._$AU&&n._$AP(d)}if(r!==i||h){let d=n._$AA;for(;d!==r;){const f=d.nextSibling;s.insertBefore(d,i),d=f}}}return n},gt=(e,t,n=e)=>(e._$AI(t,n),e),Ie={},$t=(e,t=Ie)=>e._$AH=t,bt=e=>e._$AH,Mt=e=>{var s;(s=e._$AP)==null||s.call(e,!1,!0);let t=e._$AA;const n=e._$AB.nextSibling;for(;t!==n;){const i=t.nextSibling;t.remove(),t=i}};const Te={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},w=e=>(...t)=>({_$litDirective$:e,values:t});class Z{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,n,s){this._$Ct=t,this._$AM=n,this._$Ci=s}_$AS(t,n){return this.update(t,n)}update(t,n){return this.render(...n)}}const p=(e,t)=>{var s;const n=e._$AN;if(n===void 0)return!1;for(const i of n)(s=i._$AO)==null||s.call(i,t,!1),p(i,t);return!0},$=e=>{let t,n;do{if((t=e._$AM)===void 0)break;n=t._$AN,n.delete(e),e=t}while((n==null?void 0:n.size)===0)},ee=e=>{for(let t;t=e._$AM;e=t){let n=t._$AN;if(n===void 0)t._$AN=n=new Set;else if(n.has(e))break;n.add(e),Be(t)}};function Ne(e){this._$AN!==void 0?($(this),this._$AM=e,ee(this)):this._$AM=e}function Le(e,t=!1,n=0){const s=this._$AH,i=this._$AN;if(i!==void 0&&i.size!==0)if(t)if(Array.isArray(s))for(let a=n;a<s.length;a++)p(s[a],!1),$(s[a]);else s!=null&&(p(s,!1),$(s));else p(this,e)}const Be=e=>{e.type==Te.CHILD&&(e._$AP??(e._$AP=Le),e._$AQ??(e._$AQ=Ne))};class L extends Z{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,n,s){super._$AT(t,n,s),ee(this),this.isConnected=t._$AU}_$AO(t,n=!0){var s,i;t!==this.isConnected&&(this.isConnected=t,t?(s=this.reconnected)==null||s.call(this):(i=this.disconnected)==null||i.call(this)),n&&(p(this,t),$(this))}setValue(t){if(Re(this._$Ct))this._$Ct._$AI(t,this);else{const n=[...this._$Ct._$AH];n[this._$Ci]=t,this._$Ct._$AI(n,this,0)}}disconnected(){}reconnected(){}}function Pe(e,t){return De(e,t)}function De(e,t,n){if(e===t)return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(const a of s)if(!i.includes(a)||e[a]!==t[a])return!1;return!0}var He=class extends L{render(e,t){return this.subscription?this.lastValue??t??"":(this.subscription=e.pipe(J(X)).subscribe(n=>{this.lastValue=n,this.setValue(n)}),t??"")}disconnected(){var e;(e=this.subscription)==null||e.unsubscribe()}},Oe=w(He),Ve=class extends L{constructor(){super(...arguments),this.isDisconnected=!1,this.handler=e=>{this.isDisconnected||this.setValue(e)}}render(e,t){return e.then(this.handler),t??""}disconnected(){this.isDisconnected=!0}},ze=w(Ve);function I(e,t){for(const n in t)e.style[n]=t[n]??""}var te=class extends Z{constructor(e){super(e),this.view=document.createElement("div"),this.lock=!1,I(this.view,{display:"flex",gap:"8px",position:"relative"})}render(e,t){return this.applyDirection(t.direction),this.lock?E`${this.view}`:this.view.children.length?(this.transition(e,t).catch(console.error),E`${this.view}`):(this.addedElementsWithoutAnimation(e,t),E`${this.view}`)}async transition(e,t){var q,k,W,F;const[n,s]=this.getKeyMapAndIndexMap(e,t),i=this.getIndexMapFromView(),a=this.getAllRenderCandidate(i,s),r=this.getAllRemoveCandidate(i,s),u=this.getAllMoveCandidate(i,s),h=this.getAllRenderCandidateElements(a,n,t),d=this.getAllCandidateElements(r),f=this.getAllCandidateElements(u),C=new Map,x=new Map,y=new Map;h.forEach((c,o)=>{C.set(s.get(o),c)}),d.forEach((c,o)=>{x.set(i.get(o),c)}),f.forEach((c,o)=>{y.set([i.get(o),s.get(o)],c)});const V=[...h.entries()],z=[...d.entries()],U=[...f.entries()];await((q=t.onAnimationStart)==null?void 0:q.call(t));const[ut,pe,me,Ae]=await Promise.all([(k=t.onBeforeAnimation)==null?void 0:k.call(t,this.view,C,x,y),this.executeHandlerAndReturnResultMap(V,(c,o)=>t.onBeforeRenderAnimateItem(c,s.get(o))),this.executeHandlerAndReturnResultMap(z,(c,o)=>t.onBeforeRemoveAnimateItem(c,i.get(o))),this.executeHandlerAndReturnResultMap(U,(c,o)=>{var l;return((l=t.onBeforeMoveAnimationItem)==null?void 0:l.call(t,c,i.get(o),s.get(o)))??Promise.resolve()})]);this.renderNode(h,s),this.removeNode(d),this.moveNode(f,i,s),await Promise.all([this.executeHandlerAndReturnResultMap(V,(c,o)=>{var l;return((l=t.onAfterRenderAnimateItem)==null?void 0:l.call(t,c,s.get(o),pe.get(o)))??Promise.resolve()}),this.executeHandlerAndReturnResultMap(z,(c,o)=>{var l;return((l=t.onAfterRemoveAnimateItem)==null?void 0:l.call(t,c,i.get(o),me.get(o)))??Promise.resolve()}),this.executeHandlerAndReturnResultMap(U,(c,o)=>{var l;return((l=t.onAfterMoveAnimationItem)==null?void 0:l.call(t,c,Ae.get(o)))??Promise.resolve()}),(W=t.onAfterAnimation)==null?void 0:W.call(t,this.view,C,x,y)]),await((F=t.onAnimationComplete)==null?void 0:F.call(t))}async executeHandlerAndReturnResultMap(e,t){const n=new Map;return await Promise.all(e.map(async([s,i])=>{const a=await t(i,s);n.set(s,a)})),n}getAllRenderCandidate(e,t){const n=new Set;return t.forEach((s,i)=>{e.has(i)||n.add(i)}),n}getAllRemoveCandidate(e,t){const n=new Set;return e.forEach((s,i)=>{t.has(i)||n.add(i)}),n}getAllMoveCandidate(e,t){const n=new Set;return new Set([...e.keys(),...t.keys()]).forEach(i=>{const a=e.get(i),r=t.get(i);a===void 0||r===void 0||a!==r&&n.add(i)}),n}getAllRenderCandidateElements(e,t,n){const s=new Map;let i=0;return e.forEach(a=>{const r=t.get(a);if(!r)return;const u=this.createItem(a),h=n.onTemplateBuilder(r,i);K(h,u),s.set(a,u),i++}),s}getAllCandidateElements(e){const t=new Map;return e.forEach(n=>{const s=this.view.querySelector(`#${n}`);s&&t.set(n,s)}),t}renderNode(e,t){e.forEach((n,s)=>{const i=t.get(s)??0,a=this.view.children[i];a?this.view.insertBefore(n,a):this.view.appendChild(n)})}removeNode(e){e.forEach(t=>{t.remove()})}moveNode(e,t,n){const s=this.getIndexMapFromView();e.forEach((i,a)=>{const r=t.get(a),u=n.get(a);if(s.get(a)===u)return;let d;r>u&&(d=this.view.children[u]),r<u&&(d=this.view.children[r]),d&&this.view.insertBefore(i,d)})}getKeyMapAndIndexMap(e,t){const n=new Map,s=new Map;let i=0;for(const a of e){const r=t.onKeyExtractor(a,i);n.set(r,a),s.set(r,i),i++}return[n,s]}getIndexMapFromView(){const e=new Map;let t=0;return this.view.childNodes.forEach(n=>{e.set(n.id,t++)}),e}addedElementsWithoutAnimation(e,t){let n=0;for(const s of e){const i=t.onKeyExtractor(s,n),a=this.createItem(i),r=t.onTemplateBuilder(s,n);K(r,a),this.view.appendChild(a),n++}}createItem(e){const t=document.createElement("div");return t.id=e.toString(),t}applyDirection(e){let t;e==="vertical"&&(t="column"),e==="horizontal"&&(t="row"),I(this.view,{flexDirection:t})}},Ue=w(te);function ne(e,t){const n=document.createElement(e);if(t&&typeof t=="function")try{t(n)}catch(s){console.error("call side effect error",s)}return document.head.appendChild(n),n}function qe(e){ne("style",t=>se(t,e))}function se(e,t){e.textContent=t.cssText}function ie(e,t,n){return new CustomEvent(e,{bubbles:!0,composed:!0,detail:{value:t,event:n}})}function ke(e,t,n,s){e.dispatchEvent(ie(t,n,s))}function We(e=40){try{navigator.vibrate(e)}catch{}}var Fe={requestUpdate:!0},Ke=class{constructor(e,t,n){this.host=e,this.observers=t,e.addController(this),this.config={...Fe,...n},this.subscribe()}hostDisconnected(){var e;(e=this.subscription)==null||e.unsubscribe()}subscribe(){const e=Ee(Array.isArray(this.observers)?this.observers:[this.observers]);this.subscription=e.subscribe(()=>{this.config.requestUpdate&&this.host.requestUpdate()})}};function ae(e,t,n){return new Ke(e,t,n)}var re="screen and (max-width: 610px)",S;function m(){return S||(S=matchMedia(re)),S}function je(e){return $e`
      @media ${g(re)} {
          ${g(e)}
      }
  `}var oe=xe(()=>we(m(),"change")).pipe(N(()=>m()),be(m()),Me({bufferSize:0,refCount:!0}));function ce(e){ae(e,[oe])}function Qe(){return oe}function Ge(e){return ce(e),m()}function de(){const e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")&&!e.includes("crios")}function ue(){var e;return((e=window==null?void 0:window.navigator)==null?void 0:e.standalone)??!1}function Ye(e){return de()&&ue()?g(e):g("")}var R=new WeakMap;function Je(e){if(R.has(e))return R.get(e);const t=new _e(n=>{const s=new ResizeObserver(i=>n.next(i[0]));return s.observe(e),()=>{s.unobserve(e)}});return R.set(e,t),t}var Xe=[v.ar];function B(e){return Xe.includes(e)}var b=at(),M=new Map,P=new ye(null),le,A=v.en,Q=0,G=0,D=!1,T=document.querySelector("html"),Ze=P.pipe(N(()=>A));function he(e){T=e}async function et(e){for(const t in e){const n=Reflect.get(e,t),s=M.get(t)??[];s.push(n),M.set(t,s)}D&&await O(A)}async function _(e){D&&await O(e)}async function H(e){await O(e),D=!0}function fe(e,t){return P.pipe(N(n=>{if(!n)return"";const s=n[e]??"";return t&&s.includes("{{")&&s.includes("}}")?tt(s,t):s}))}function tt(e,t){let n=e;for(const s in t){const i=t[s],a=`{{${s}}}`;n=n.replaceAll(a,`${i}`)}return n}var ve=e=>e.reduce((t,n)=>({...t,...n}),{});async function O(e){T.dir=B(e)?"rtl":"ltr",await Promise.all([nt(),st(e)]),A=e,T.lang=e}async function nt(){const e=M.get(b)??[];if(e.length!==Q){const t=await Promise.all(e.map(n=>n()));le=ve(t),Q=e.length}}async function st(e){const t=M.get(e)??[];if(A!==e||t.length!==G){const n=await Promise.all(t.map(i=>i())),s=ve(n);P.next({...le,...s}),G=t.length}}function it(){return B(A)}function at(){try{const t=(navigator.language||navigator.userLanguage).slice(0,2);return t in v?t:v.en}catch{return v.en}}Reflect.set(window,"changeLocale",_);var Y="",rt=class extends L{render(e,t){return this.subscription&&this.lastPath===e&&Pe(this.lastContext,t)?this.lastValue??Y:(this.disconnected(),this.subscription=fe(e,t).pipe(J(X)).subscribe(n=>{this.setValue(n),this.lastValue=n,this.lastPath=e,this.lastContext=t}),this.lastValue??Y)}disconnected(){var e;(e=this.subscription)==null||e.unsubscribe()}},ot=w(rt),ct=class{constructor(){this.i18nSettings=new Ce("i18n",b)}async init(){const e=this.i18nSettings.value??b;await H(e)}async changeLocale(e){return this.i18nSettings.setValue(e),await _(e)}},dt=class{constructor(e,t){this.localeCode=e,he(t)}async init(){await H(this.localeCode)}async changeLocale(e){return await _(e)}};const wt=Object.freeze(Object.defineProperty({__proto__:null,AnimationMap:te,I18nController:ct,I18nEmbeddedController:dt,addTranslation:et,animationMap:Ue,appendStyle:I,applyStyle:se,async:ze,buildEvent:ie,changeLocaleAndUpdate:_,changeMobileMatchMedia:ce,createAndAppendInHeaderElement:ne,createAndApplyStyle:qe,defaultLocaleCode:b,dispatchEvent:ke,getMobileMatchMedia:m,getMobileMatchMediaAndSubscribe:Ge,getMobileMatchMediaEmitter:Qe,initLocale:H,isRTL:B,isRTLCurrentLocale:it,isSafari:de,isStandalone:ue,listenChangesByPath:fe,localeChange$:Ze,mobileMediaCSS:je,observe:Oe,resizeObserver:Je,safariPWACss:Ye,setTargetHost:he,subscribe:ae,translate:ot,vibrate:We},Symbol.toStringTag,{value:"Module"}));export{$t as A,Qe as B,ue as C,Ue as D,se as E,ne as F,qe as G,wt as H,ae as a,I as b,ce as c,ke as d,Ge as e,ze as f,m as g,ie as h,it as i,de as j,et as k,Ze as l,je as m,w as n,Oe as o,Z as p,Te as q,Je as r,Ye as s,ot as t,L as u,We as v,bt as w,gt as x,At as y,Mt as z};
//# sourceMappingURL=index.esm-BE449jRt.js.map
